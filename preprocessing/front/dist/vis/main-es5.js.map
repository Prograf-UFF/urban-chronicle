{"version":3,"sources":["webpack:///$_lazy_route_resource lazy namespace object","webpack:///src/app/app.component.ts","webpack:///src/app/app.component.html","webpack:///src/app/app.module.ts","webpack:///src/app/charts/bar.ts","webpack:///src/app/charts/cmap.ts","webpack:///src/app/charts/line.ts","webpack:///src/app/charts/matrix.ts","webpack:///src/app/components/config/config.component.ts","webpack:///src/app/components/config/config.component.html","webpack:///src/app/components/filter/filter.component.ts","webpack:///src/app/components/filter/filter.component.html","webpack:///src/app/components/layers/layers.component.ts","webpack:///src/app/components/layers/layers.component.html","webpack:///src/app/components/legend/legend.component.ts","webpack:///src/app/components/legend/legend.component.html","webpack:///src/app/components/map/map.component.ts","webpack:///src/app/components/map/map.component.html","webpack:///src/app/components/menu/menu.component.ts","webpack:///src/app/components/menu/menu.component.html","webpack:///src/app/components/tooltip/tooltip.component.ts","webpack:///src/app/components/tooltip/tooltip.component.html","webpack:///src/app/components/vis/vis.component.ts","webpack:///src/app/components/vis/vis.component.html","webpack:///src/app/mapview/building-layer.ts","webpack:///src/app/mapview/camera.ts","webpack:///src/app/mapview/colormap.ts","webpack:///src/app/mapview/constants.ts","webpack:///src/app/mapview/data-api.ts","webpack:///src/app/mapview/data-loader.ts","webpack:///src/app/mapview/geoutils.ts","webpack:///src/app/mapview/heatmap-layer.ts","webpack:///src/app/mapview/key-events.ts","webpack:///src/app/mapview/layer-manager.ts","webpack:///src/app/mapview/layer.ts","webpack:///src/app/mapview/mapview.ts","webpack:///src/app/mapview/mouse-events.ts","webpack:///src/app/mapview/physical-layer.ts","webpack:///src/app/mapview/point-layer.ts","webpack:///src/app/mapview/polygon-layer.ts","webpack:///src/app/material/material.module.ts","webpack:///src/app/services/api.service.ts","webpack:///src/app/services/data.service.ts","webpack:///src/app/services/events.service.ts","webpack:///src/app/services/state.service.ts","webpack:///src/environments/environment.ts","webpack:///src/main.ts"],"names":["webpackEmptyAsyncContext","req","Promise","resolve","then","e","Error","code","keys","module","exports","id","AppComponent","events","title","root","initialized","emit","selector","templateUrl","AppModule","declarations","imports","providers","bootstrap","Bar","chartDiv","callbacks","key","_data","_chartDiv","_svgCanvas","_svgGroup","_margin","top","right","bottom","left","_xScale","_yScale","_xAxis","_yAxis","_brush","_brushedBins","_callbacks","_key","labelFormat","label","parts","split","isNaN","join","map","el","initSvgAndGroups","initScalesAndAxes","initWindowEvents","initBrush","data","brush","updateScales","updateAxes","updateBars","remove","render","_width","clientWidth","_height","clientHeight","append","attr","style","text","range","padding","tickFormat","ticks","window","addEventListener","resize","bind","bins","obj","bin","extent","count","domain","scale","select","call","selectAll","length","barsGroup","rects","d","bandwidth","on","barChartOnBrush","first","final","paddingInner","move","selection","i0","i1","slice","includes","event","value","Cmap","_cScale","N_COLORS","ALIVE_COLOR","ACTVE_COLOR","VALID_COLOR","ALIVE_LABEL","ACTVE_LABEL","VALID_LABEL","val","minMax","zero","frac","Math","ceil","values","push","toFixed","unshift","updateRectangles","tickValues","cmap","Line","defaults","_yLabel","_line","x","year","y","curve","defined","valid","yLabel","years","updateLines","updateLegend","Number","MAX_VALUE","MIN_VALUE","lines","forEach","line","vals","min","max","names","name","elements","i","circles","labels","width","lSize","content","size","getComputedTextLength","mouse","pageX","pageY","lHover","svgOut","Matrix","_lScale","Y_LABEL_SIZE","MODE","_yCallbackEnabled","_xLabelSelected","_yLabelSelected","_sortIconSelected","_lineIconSelected","xLabel","sIcon","lIcon","mode","sort","click","updateSortIcons","updateLineIcons","highlightSortIcon","highlightLineIcon","highlightXLabel","highlightYLabel","paddingOuter","align","polys","texts","substring","current","filter","yHover","isAlive","isActive","isValid","changeValid","nodes","parentNode","__data__","rHover","icons","type","updateLineIconsClick","indexOf","splice","ConfigComponent","api","state","colorControl","fontSizeControl","vis","lineIconClicked","levels","meta","updates","str","reduce","prev","undefined","previous","activeGeometryParameters","Object","assign","activeFilterParameters","filters","borough","config","boroughSelectChanged","polygon","polygonSelectChanged","navigation","navigationSelectChanged","modeSelectChanged","styleUrls","FilterComponent","filterExp","_filters","subscribeDataEvents","_filtersDivs","changes","subscribe","renderFilters","updateFilters","keepBrush","divId","div","nativeElement","cbs","brushChanged","hist","findIndex","setData","currentFilterId","params","activeConfigParameters","attribute","category","addFilterExp","updated","updateSummary","delFilterExp","attributes","categories","filtered","histogramAlloed","brushed","LayersComponent","layer","layersActive","activeLayer","layers","activeLayerChanged","LegendComponent","_matColorMap","_matColorMatDiv","_mapColorMap","_mapColorMapDiv","updateVisMatrix","loadCmap","updateMapGeometryAndFunction","updateMapFunction","visElement","activeSummaryParameters","summary","changeMin","changeMax","cmapPercentiles","configCMapChanged","static","MapComponent","_mapView","mouseDown","highlightPoly","_mapDiv","initLayers","subscribeStateEvents","selectedPolygonChanged","updateHighlightedPolygon","loadPopsLayer","loadLayerGeometryAndFunction","loadLayerScalarField","loadLayerGeometry","delLayer","selectable","visible","addLayer","geometry","feats","features","a","b","func","nId","properties","pos","Array","fill","fMin","fMax","updateLayerFunction","polyPicked","origin","selectedPolygon","pick","MenuComponent","configActive","widget","matrixActive","legendActive","TooltipComponent","info","toLocaleString","minimumFractionDigits","VisComponent","tooltip","show","matDefaults","matCallbacks","yearLabelClicked","polyLabelClicked","polyLabelHovered","sortIconClicked","polyRectHovered","_matrix","_matrixDiv","toLowerCase","lineDefaults","lineCallbacks","lineLegendHovered","_lineDiv","loadMatrix","loadLine","pageParametersChanged","sortParametersChanged","lineCurvesChanged","highlightPolyLabel","activeSortParameters","sortBy","page","activePageParameters","currentPage","pageSize","sortYear","original","yearCopy","matrixSortFunction","matData","activeLineChartCurves","activeLevel","prepareMatrixData","neighs","lineData","neighData","find","prepareLineData","setYLabel","yearStep","yearStepSelectChanged","metric","metrics","attributeSelectChanged","categorySelectChanged","metricSelectChanged","sortBySelectChanged","poly","polygonLabelHovered","neighborhood","polygonLabelClicked","block","lot","setHighlight","level","navButtonClicked","filterActive","direction","total","totalPages","navPageChanged","BuildingLayer","_features","_glPositionBuffer","_glIndexBuffer","_glBuildingIdBuffer","_positionId","_buildingIdId","_uModelViewMatrixId","_uProjectionMatrixId","_uWorldOrigin","_uGroundRes","_uEye","_highlight","_fboWidth","_fboHeight","_fbo","_readfbo","_normalTexture","_depthTexture","_positionTexture","_idTexture","glContext","N_SHADER","vertUrl","fragUrl","getTextData","vsShader","fsShader","initShaderProgram","getUniformLocation","_shaderProgram","getAttribLocation","console","log","_layerId","getLayerFeature","feature","coordinates","ids","indices","createBuffers","generateNoise","bindFramebuffer","FRAMEBUFFER","result","Float32Array","readPixels","RGBA","FLOAT","setupFBO","enable","DEPTH_TEST","depthFunc","LESS","renderBuildings","renderSSAO","disable","useProgram","uniformMatrix4fv","_camera","getModelViewMatrix","getProjectionMatrix","worldOrigin","getWorldOrigin","uniform2f","eye","getEye","gres","getGroundResolution","uniform1f","uniform3f","bindBuffer","ARRAY_BUFFER","vertexAttribPointer","COORDS","enableVertexAttribArray","clearColor","clear","COLOR_BUFFER_BIT","DEPTH_BUFFER_BIT","ELEMENT_ARRAY_BUFFER","drawElements","TRIANGLES","UNSIGNED_INT","BLEND","blendFunc","SRC_ALPHA","ONE_MINUS_SRC_ALPHA","normalLocation","positionLocation","IDLocation","depthLocation","matModelView","uProjectionMatrix","highlightId","getViewMatrix","activeTexture","TEXTURE0","bindTexture","TEXTURE_2D","uniform1i","TEXTURE1","TEXTURE2","TEXTURE3","drawArrays","TRIANGLE_STRIP","createFramebuffer","createTexture","ext","getExtension","error","viewPort","getViewportResolution","texImage2D","RGBA32F","texParameteri","TEXTURE_MIN_FILTER","NEAREST","TEXTURE_MAG_FILTER","TEXTURE_WRAP_S","CLAMP_TO_EDGE","TEXTURE_WRAP_T","DEPTH_COMPONENT32F","DEPTH_COMPONENT","framebufferTexture2D","DEPTH_ATTACHMENT","COLOR_ATTACHMENT0","COLOR_ATTACHMENT1","COLOR_ATTACHMENT2","drawBuffers","createBuffer","bufferData","STATIC_DRAW","Uint32Array","uNoiseLocation","uSamplesLocation","samples","nSamples","sample","fromValues","random","normalize","s2","uniform3fv","noise","noiseSize","n","Camera","wx","wy","wz","wOrigin","create","wEye","wEyeDir","wLookAt","wUp","fovy","PI","mProjectionMatrix","mViewMatrix","mModelMatrix","groundRes","groundResolution","wNear","wFar","projectedCenter","zScaling","status","Camera3D","Camera2D","wEyeLength","modelViewMatrix","mul","viewportWidth","viewportHeight","sub","updateEyeDirAndLen","delta","dir","screenCoordToWorldDir","scaleAndAdd","dx","dy","X","cross","D","add","rotateZ","sin","cos","fromScaling","lookAt","perspective","wRight","upOffset","tan","rightOffset","offset","t","intersectPoint","originCoord","latLng2Coord","latLng","coord2LatLng","ColorMap","reverse","cscale","colors","color","match","SEQUENTIAL_RED_MAP","sequentialRed","SEQUENTIAL_BLUE_MAP","sequentialBlue","DIVERGING_RED_BLUE_MAP","divergingRedBlue","DIVERGING_RED_YEL_BLUE_MAP","divergingRedYelBlue","DIVERGING_GREEN_BROWN_MAP","divergingGreenBrown","QUALITATIVE_MAP","qualitative","neutral","sValue","LayerTypes","PHYSICAL_LAYER","BUILDING_LAYER","POLYGON_LAYER","HEATMAP_LAYER","POINT_LAYER","LINE_LAYER","ColorMapType","MapViewStatus","IDLE","DRAG","CameraStatus","DataApi","index","url","backend","folder","getJsonData","datasets","camera","layerId","DataLoader","fetch","response","json","txt","GeoUtils","latitude","longitude","pi_4","pi_180","sinLatitude","pixelY","pixelX","exp","asin","lat","lng","zoom","pow","HeatmapLayer","_glTexCoordsBuffer","_glColorMapTex","_glFunctionTex","_functionResX","_functionResY","_texCoordsId","_uWorldOriginId","_uColorMapId","_uFunctionId","_visible","corners","position","texCoords","resX","resY","scalar","grid","noNull","createFunctionTexture","createColorMapTexture","cMap","setUniforms","R16F","RED","LINEAR","getColorMap","UNSIGNED_BYTE","Uint8Array","KeyEvents","_map","keyDown","layerManager","toggleCameraMode","LayerManager","indexUrl","_layers","_index","layerType","Layer","_selectable","vsSource","fsSource","vertexShader","buildShader","VERTEX_SHADER","fragmentShader","FRAGMENT_SHADER","shader","createProgram","attachShader","linkProgram","getProgramParameter","LINK_STATUS","getProgramInfoLog","source","createShader","shaderSource","compileShader","getShaderParameter","COMPILE_STATUS","getShaderInfoLog","deleteShader","MapView","mapDiv","_canvas","_glContext","_layerManager","document","createElement","getContext","appendChild","initCamera","initMouseEvents","initKeyboardEvents","currentCameraStatus","getCameraStatus","setCameraStatus","getMapIndex","element","createLayer","layerConfig","loadShaders","updateFeatures","_buildingLayer","updateColorMap","lId","lay","updateFunction","cleanFunction","_mouse","bindEvents","_keyboard","elementId","getLayer","setPickId","update","targetWidth","targetHeight","viewport","height","setViewportResolution","MouseEvents","_status","_lastPoint","canvas","mouseWheel","mouseMove","mouseUp","ctrlKey","picks","pickId","buttons","shiftKey","yaw","pitch","translate","maxAxisLength","deltaY","PhysicalLayer","_glColorBuffer","_positionBuffer","_colorBuffer","_indexBuffer","_colorId","nverts","hex","rgb","start","parseInt","apply","PointLayer","_glScalarBuffer","_scalarId","createScalarBuffer","getLayerFunction","POINTS","PolygonLayer","_glPolygonIdBuffer","_polygonId","_uScalarTextureId","_uHighlightId","_readFbo","_scalarTexture","_polygonIdTexture","_colorMapTexture","nfeatures","part","fId","nVerts","computeScalarValue","polyId","pId","abs","renderToTexture","renderTexture","renderSelection","high","vertsCount","curr","LINE_STRIP","cHigh","materialModules","MaterialModule","ApiService","arr","elm","JSON","stringify","headers","method","body","loadNeighborhoodsGeometry","loadBlocksGeometry","loadLotsGeometry","loadNeighborhoodsSummary","loadBlocksSummary","loadLotsSummary","limits","providedIn","DataService","modes","boroughs","polygons","subscribeRootEvents","subscribeMapEvents","subscribeFilterEvents","initializeMeta","loadModes","loadYears","loadAttributes","loadBoroughs","loadPolygons","loadNavigation","loadLevels","loadSortBy","loadYearStep","loadSummaryThenGeometryAndFunction","configBoroughChanged","loadAllFilters","configPolygonChanged","configNavigationChanged","configModeChanged","loadFunction","filterParametersChanged","loadFilter","geometryParametersChanged","summaryParametersChanged","loadSummaryThenFunction","isYear","applyFilter","loadSummary","loadGeometry","loadPopsGeometry","initializePagination","parents","parameters","step","filterYears","computeDifferences","subYears","yId","stepSummary","Infinity","cngs","change","EventsService","menu","buttonClicked","StateService","PAGINATION_SIZE","CURRENT_FILTER_ID","subscribeLayersEvents","subscribeConfigEvents","subscribeVisEvents","updateSelectedPolygon","updateActiveConfigBorough","updateActiveConfigPolygon","updateActiveConfigNavigation","updateActiveConfigMode","updateActiveGeometryParameters","updateActiveSummaryParameters","updateActiveSortParameters","updateActivePageParameters","updateActiveLineChartCurves","updateFilterParameters","updateFilterBrush","den","changeActiveLayer","environment","production","bootstrapModule","catch","err"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA,aAASA,wBAAT,CAAkCC,GAAlC,EAAuC;AACtC;AACA;AACA,aAAOC,OAAO,CAACC,OAAR,GAAkBC,IAAlB,CAAuB,YAAW;AACxC,YAAIC,CAAC,GAAG,IAAIC,KAAJ,CAAU,yBAAyBL,GAAzB,GAA+B,GAAzC,CAAR;AACAI,SAAC,CAACE,IAAF,GAAS,kBAAT;AACA,cAAMF,CAAN;AACA,OAJM,CAAP;AAKA;;AACDL,4BAAwB,CAACQ,IAAzB,GAAgC,YAAW;AAAE,aAAO,EAAP;AAAY,KAAzD;;AACAR,4BAAwB,CAACG,OAAzB,GAAmCH,wBAAnC;AACAS,UAAM,CAACC,OAAP,GAAiBV,wBAAjB;AACAA,4BAAwB,CAACW,EAAzB,GAA8B,yCAA9B;;;;;;;;;;;;;;;;ACZA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;;QAOaC,Y;;;AAGX,4BAAmBC,MAAnB,EAA0C;AAAA;;AAAvB,aAAAA,MAAA,GAAAA,MAAA;AAFnB,aAAAC,KAAA,GAAQ,WAAR;AAE6C;;;;mCAElC;AACT,eAAKD,MAAL,CAAYE,IAAZ,CAAiBC,WAAjB,CAA6BC,IAA7B;AACD;;;;;;;uBAPUL,Y,EAAY,uI;AAAA,K;;;YAAZA,Y;AAAY,+B;AAAA,c;AAAA,a;AAAA;AAAA;ACNzB;;AAEA;;AACA;;AAEA;;AACA;;;;;;;;;sEDAaA,Y,EAAY;cAJxB,uDAIwB;eAJd;AACTM,kBAAQ,EAAE,UADD;AAETC,qBAAW,EAAE;AAFJ,S;AAIc,Q;;;;;;;;;;;;;;;;;;;;;;AEPzB;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;;QAoCaC,S;;;;;YAAAA,S;AAAS,kBAFR,2DAEQ;;;;yBAATA,S;AAAS,O;AAAA,iBAHT,E;AAAE,gBALJ,CACP,uEADO,EAEP,4FAFO,EAGP,wEAHO,CAKI;;;;0HAGFA,S,EAAS;AAAA,uBAlBlB,2DAkBkB,EAjBlB,0EAiBkB,EAhBlB,0EAgBkB,EAflB,6EAekB,EAdlB,mFAckB,EAblB,mFAakB,EAZlB,oFAYkB,EAXlB,uFAWkB,EAVlB,oFAUkB;AAVH,kBAGf,uEAHe,EAIf,4FAJe,EAKf,wEALe;AAUG,O;AALJ,K;;;;;sEAKLA,S,EAAS;cApBrB,sDAoBqB;eApBZ;AACRC,sBAAY,EAAE,CACZ,2DADY,EAEZ,0EAFY,EAGZ,0EAHY,EAIZ,6EAJY,EAKZ,mFALY,EAMZ,mFANY,EAOZ,oFAPY,EAQZ,uFARY,EASZ,oFATY,CADN;AAYRC,iBAAO,EAAE,CACP,uEADO,EAEP,4FAFO,EAGP,wEAHO,CAZD;AAiBRC,mBAAS,EAAE,EAjBH;AAkBRC,mBAAS,EAAE,CAAC,2DAAD;AAlBH,S;AAoBY,Q;;;;;;;;;;;;;;;;;;ACpCtB;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;;QAGaC,G;;;AA8CX,mBAAYC,QAAZ,EAAmCC,SAAnC,EAAmDC,GAAnD,EAAgE;AAAA;;AA7ChE;AACU,aAAAC,KAAA,GAAa,IAAb,CA4CsD,CA1ChE;;AACU,aAAAC,SAAA,GAAyB,IAAzB,CAyCsD,CAxChE;;AACU,aAAAC,UAAA,GAAkB,IAAlB,CAuCsD,CAtChE;;AACU,aAAAC,SAAA,GAAiB,IAAjB,CAqCsD,CAnChE;;AACU,aAAAC,OAAA,GAAU;AAAEC,aAAG,EAAE,EAAP;AAAWC,eAAK,EAAE,EAAlB;AAAsBC,gBAAM,EAAE,EAA9B;AAAkCC,cAAI,EAAE;AAAxC,SAAV,CAkCsD,CA3BhE;;AACU,aAAAC,OAAA,GAAe,IAAf;AACA,aAAAC,OAAA,GAAe,IAAf,CAyBsD,CAxBhE;;AACU,aAAAC,MAAA,GAAc,IAAd;AACA,aAAAC,MAAA,GAAc,IAAd,CAsBsD,CApBhE;;AACU,aAAAC,MAAA,GAAS,2CAAT;AACA,aAAAC,YAAA,GAAe,EAAf,CAkBsD,CAhBhE;;AACU,aAAAC,UAAA,GAAa,IAAb;AACA,aAAAC,IAAA,GAAO,IAAP,CAcsD,CAZhE;;AACU,aAAAC,WAAA,GAAc,UAACC,KAAD,EAAW;AACjC,cAAIC,KAAK,GAAGD,KAAK,CAACE,KAAN,CAAY,GAAZ,CAAZ;;AAEA,cAAIC,KAAK,CAAC,CAACF,KAAK,CAAC,CAAD,CAAP,CAAT,EAAsB;AACpB,mBAAOD,KAAK,CAACE,KAAN,CAAY,GAAZ,EAAiBE,IAAjB,CAAsB,GAAtB,CAAP;AACD;;AAEDH,eAAK,GAAGA,KAAK,CAACI,GAAN,CAAU,UAAAC,EAAE;AAAA,mBAAI,0CAAU,KAAV,EAAiBA,EAAjB,CAAJ;AAAA,WAAZ,CAAR;AACA,iBAAOL,KAAK,CAACG,IAAN,CAAW,GAAX,CAAP;AACD,SATS;;AAYR,aAAKrB,SAAL,GAAiBJ,QAAjB;AACA,aAAKkB,UAAL,GAAkBjB,SAAlB;AACA,aAAKkB,IAAL,GAAYjB,GAAZ;AAEA,aAAK0B,gBAAL;AACA,aAAKC,iBAAL;AACA,aAAKC,gBAAL;AACA,aAAKC,SAAL;AACD;;;;gCAEOC,I,EAAWC,K,EAAY;AAC7B,eAAK9B,KAAL,GAAa6B,IAAb;AACA,eAAKf,YAAL,GAAoBgB,KAApB;AACD;;;iCAEQ;AACP,eAAKC,YAAL;AACA,eAAKC,UAAL;AACA,eAAKC,UAAL;AACA,eAAKL,SAAL;AACD;;;iCAEQ;AACP,eAAK1B,UAAL,CAAgBgC,MAAhB;;AAEA,eAAKT,gBAAL;AACA,eAAKC,iBAAL;AACA,eAAKS,MAAL;AACD;;;2CAGkB;AACjB;AACA,eAAKC,MAAL,GAAc,KAAKnC,SAAL,CAAeoC,WAAf,GAA6B,KAAKjC,OAAL,CAAaI,IAA1C,GAAiD,KAAKJ,OAAL,CAAaE,KAA5E;AACA,eAAKgC,OAAL,GAAe,KAAKrC,SAAL,CAAesC,YAAf,GAA8B,KAAKnC,OAAL,CAAaC,GAA3C,GAAiD,KAAKD,OAAL,CAAaG,MAA7E,CAHiB,CAKjB;;AACA,eAAKL,UAAL,GAAkB,0CAAU,KAAKD,SAAf,EACfuC,MADe,CACR,KADQ,EAEfC,IAFe,CAEV,OAFU,EAED,KAAKxC,SAAL,CAAeoC,WAFd,EAGfI,IAHe,CAGV,QAHU,EAGA,KAAKxC,SAAL,CAAesC,YAHf,CAAlB,CANiB,CAWjB;;AACA,eAAKpC,SAAL,GAAiB,KAAKD,UAAL,CACdsC,MADc,CACP,GADO,EAEdC,IAFc,CAET,OAFS,EAEA,UAFA,EAGdA,IAHc,CAGT,WAHS,EAGI,eAAe,KAAKrC,OAAL,CAAaI,IAA5B,GAAmC,GAAnC,GAAyC,KAAKJ,OAAL,CAAaC,GAAtD,GAA4D,GAHhE,CAAjB,CAZiB,CAiBjB;;AACA,eAAKF,SAAL,CACGqC,MADH,CACU,GADV,EAEGC,IAFH,CAEQ,OAFR,EAEiB,cAFjB,EAGGA,IAHH,CAGQ,WAHR,EAGqB,iBAAkB,KAAKH,OAAvB,GAAkC,GAHvD;;AAKA,eAAKnC,SAAL,CACGqC,MADH,CACU,GADV,EAEGC,IAFH,CAEQ,OAFR,EAEiB,OAFjB;;AAIA,eAAKtC,SAAL,CACGqC,MADH,CACU,GADV,EAEGC,IAFH,CAEQ,OAFR,EAEiB,cAFjB,EA3BiB,CA+BjB;;;AACA,eAAKtC,SAAL,CACGqC,MADH,CACU,MADV,EAEGC,IAFH,CAEQ,OAFR,EAEiB,aAFjB,EAGGA,IAHH,CAGQ,WAHR,sBAII,KAAKL,MAAL,GAAc,CAJlB,eAMI,KAAKE,OAAL,GAAe,KAAKlC,OAAL,CAAaC,GAA5B,GAAkC,EANtC,QAQGqC,KARH,CAQS,aART,EAQwB,QARxB,EASGC,IATH,CASQ,gBATR,EAhCiB,CA2CjB;;;AACA,eAAKxC,SAAL,CACGqC,MADH,CACU,MADV,EAEGC,IAFH,CAEQ,OAFR,EAEiB,aAFjB,EAGGA,IAHH,CAGQ,WAHR,EAGqB,aAHrB,EAIGA,IAJH,CAIQ,GAJR,EAIa,IAAI,KAAKrC,OAAL,CAAaI,IAAjB,GAAwB,EAJrC,EAKGiC,IALH,CAKQ,GALR,EAKa,IAAI,KAAKH,OAAL,GAAe,CALhC,EAMGG,IANH,CAMQ,IANR,EAMc,KANd,EAOGC,KAPH,CAOS,aAPT,EAOwB,QAPxB,EAQGC,IARH;AAUD;;;4CAEmB;AAClB,eAAKlC,OAAL,GAAe,+CAAemC,KAAf,CAAqB,CAAC,CAAD,EAAI,KAAKR,MAAT,CAArB,EAAuCS,OAAvC,CAA+C,GAA/C,CAAf;AACA,eAAKlC,MAAL,GAAc,8CAAc,KAAKF,OAAnB,EAA4BqC,UAA5B,CAAuC,KAAK7B,WAA5C,CAAd;AAEA,eAAKP,OAAL,GAAe,iDAAiBkC,KAAjB,CAAuB,CAAC,KAAKN,OAAN,EAAe,CAAf,CAAvB,CAAf;AACA,eAAK1B,MAAL,GAAc,4CAAY,KAAKF,OAAjB,EAA0BqC,KAA1B,CAAgC,EAAhC,EAAoC,IAApC,CAAd;AACD;;;2CAEkB;AACjBC,gBAAM,CAACC,gBAAP,CAAwB,QAAxB,EAAkC,KAAKC,MAAL,CAAYC,IAAZ,CAAiB,IAAjB,CAAlC;AACD;;;uCAEc;AACb,cAAMC,IAAI,GAAG,KAAKpD,KAAL,CAAWuB,GAAX,CAAe,UAAA8B,GAAG;AAAA,6BAAOA,GAAG,CAACC,GAAX;AAAA,WAAlB,CAAb;;AACA,cAAMC,MAAM,GAAG,0CAAU,KAAKvD,KAAL,CAAWuB,GAAX,CAAe,UAAA8B,GAAG;AAAA,mBAAIA,GAAG,CAACG,KAAR;AAAA,WAAlB,CAAV,CAAf,CAFa,CAIb;;AACA,eAAK/C,OAAL,CAAagD,MAAb,CAAoBL,IAApB;;AACA,eAAK1C,OAAL,CAAa+C,MAAb,CAAoBF,MAApB;AACD;;;qCAEY;AACX,cAAMH,IAAI,GAAG,KAAKpD,KAAL,CAAWuB,GAAX,CAAe,UAAA8B,GAAG;AAAA,6BAAOA,GAAG,CAACC,GAAX;AAAA,WAAlB,CAAb;;AAEA,eAAK3C,MAAL,CAAY+C,KAAZ,CAAkB,KAAKjD,OAAvB;;AACA,eAAKN,SAAL,CAAewD,MAAf,CAAsB,UAAtB,EAAkCC,IAAlC,CAAuC,KAAKjD,MAA5C,EACGkD,SADH,CACa,MADb,EAEGnB,KAFH,CAES,aAFT,EAEwB,KAFxB,EAGGD,IAHH,CAGQ,WAHR,EAGqB,YAAM;AACvB,gBAAIW,IAAI,CAACU,MAAL,GAAc,EAAlB,EAAsB;AACpB,qBAAO,KAAP;AACD;;AACD,mBAAO,MAAP;AACD,WARH,EASGrB,IATH,CASQ,IATR,EASc,OATd,EAUGA,IAVH,CAUQ,IAVR,EAUc;AAAA,mBAAMW,IAAI,CAACU,MAAL,GAAc,EAAd,GAAmB,OAAnB,GAA6B,OAAnC;AAAA,WAVd,EAWGrB,IAXH,CAWQ,WAXR,EAWqB,YAAM;AACvB,gBAAIW,IAAI,CAACU,MAAL,GAAc,EAAlB,EAAsB;AACpB,qBAAO,aAAP;AACD;;AACD,mBAAO,aAAP;AACD,WAhBH;;AAkBA,eAAKlD,MAAL,CAAY8C,KAAZ,CAAkB,KAAKhD,OAAvB;;AACA,eAAKP,SAAL,CAAewD,MAAf,CAAsB,UAAtB,EAAkCC,IAAlC,CAAuC,KAAKhD,MAA5C;AACD;;;qCAEY;AAAA;;AACX,cAAMmD,SAAS,GAAG,KAAK5D,SAAL,CACf0D,SADe,CACL,aADK,EAEfhC,IAFe,CAEV,CAAC,KAAK7B,KAAN,CAFU,EAGfsB,IAHe,CAGV,GAHU,CAAlB;;AAKAyC,mBAAS,CACNtB,IADH,CACQ,OADR,EACiB,YADjB;AAGA,cAAMuB,KAAK,GAAGD,SAAS,CACpBF,SADW,CACD,MADC,EAEXhC,IAFW,CAEN,UAAAoC,CAAC;AAAA,mBAAIA,CAAJ;AAAA,WAFK,EAGX3C,IAHW,CAGN,MAHM,CAAd;AAKA0C,eAAK,CACFvB,IADH,CACQ,OADR,EACiB,KADjB,EAEGA,IAFH,CAEQ,GAFR,EAEa,UAAAwB,CAAC;AAAA,mBAAI,KAAI,CAACxD,OAAL,WAAgBwD,CAAC,CAACX,GAAlB,EAAJ;AAAA,WAFd,EAGGb,IAHH,CAGQ,GAHR,EAGa,UAAAwB,CAAC;AAAA,mBAAI,KAAI,CAACvD,OAAL,CAAauD,CAAC,CAACT,KAAf,CAAJ;AAAA,WAHd,EAIGf,IAJH,CAIQ,OAJR,EAIiB,KAAKhC,OAAL,CAAayD,SAAb,EAJjB,EAKGzB,IALH,CAKQ,QALR,EAKkB,UAAAwB,CAAC;AAAA,mBAAI,KAAI,CAAC3B,OAAL,GAAe,KAAI,CAAC5B,OAAL,CAAauD,CAAC,CAACT,KAAf,CAAnB;AAAA,WALnB,EAMGf,IANH,CAMQ,MANR,EAMgB,SANhB;AAOD;;;oCAEW;AACV,eAAK5B,MAAL,CACGsD,EADH,CACM,iBADN,EACyB,KAAKC,eAAL,CAAqBjB,IAArB,CAA0B,IAA1B,CADzB,EAEGI,MAFH,CAEU,CAAC,CAAC,CAAD,EAAI,CAAJ,CAAD,EAAS,CAAC,KAAKnB,MAAN,EAAc,KAAKE,OAAnB,CAAT,CAFV;;AAIA,eAAKnC,SAAL,CAAewD,MAAf,CAAsB,QAAtB,EAAgCC,IAAhC,CAAqC,KAAK/C,MAA1C;;AAEA,cAAI,KAAKC,YAAL,CAAkBgD,MAAtB,EAA8B;AAC5B,gBAAMO,KAAK,GAAG,KAAKvD,YAAL,CAAkB,CAAlB,CAAd;AACA,gBAAMwD,KAAK,GAAG,KAAKxD,YAAL,CAAkB,KAAKA,YAAL,CAAkBgD,MAAlB,GAA2B,CAA7C,CAAd;AACA,gBAAMlB,KAAK,GAAG,CAAC,KAAKnC,OAAL,CAAa4D,KAAb,IAAsB,KAAK5D,OAAL,CAAa8D,YAAb,EAAvB,EAAoD,KAAK9D,OAAL,CAAa6D,KAAb,IAAsB,KAAK7D,OAAL,CAAayD,SAAb,EAA1E,CAAd;;AAEA,iBAAK/D,SAAL,CAAewD,MAAf,CAAsB,QAAtB,EAAgCC,IAAhC,CAAqC,KAAK/C,MAAL,CAAY2D,IAAjD,EAAuD5B,KAAvD;AACD;AACF;;;0CAEiB;AAAA;;AAChB,cAAM6B,SAAS,GAAG,yCAASA,SAA3B;;AAEA,cAAMT,KAAK,GAAG,KAAK7D,SAAL,CACX0D,SADW,CACD,aADC,EAEXA,SAFW,CAED,MAFC,CAAd;;AAIA,cAAIY,SAAJ,EAAe;AACb,gBAAM7B,KAAK,GAAG,KAAKnC,OAAL,CAAagD,MAAb,GAAsBlC,GAAtB,CAA0B,KAAKd,OAA/B,CAAd;;AAEA,gBAAMiE,EAAE,GAAG,+CAAe9B,KAAf,EAAsB6B,SAAS,CAAC,CAAD,CAA/B,CAAX;AACA,gBAAME,EAAE,GAAG,+CAAe/B,KAAf,EAAsB6B,SAAS,CAAC,CAAD,CAA/B,CAAX;AAEA,iBAAK3D,YAAL,GAAoB,KAAKL,OAAL,CAAagD,MAAb,GAAsBmB,KAAtB,CAA4BF,EAA5B,EAAgCC,EAAhC,CAApB;AACD,WAPD,MAOO;AACL,iBAAK7D,YAAL,GAAoB,EAApB;AACD;;AAEDkD,eAAK,CAACvB,IAAN,CAAW,MAAX,EAAmB,UAAAwB,CAAC;AAAA,mBAAI,MAAI,CAACnD,YAAL,CAAkB+D,QAAlB,CAA2BZ,CAAC,CAACX,GAA7B,IAAoC,SAApC,GAAgD,SAApD;AAAA,WAApB;AAEA,cAAMwB,KAAK,GAAG;AAAEC,iBAAK,EAAE,KAAKjE;AAAd,WAAd;;AACA,eAAKC,UAAL,CAAgBe,KAAhB,CAAsB,KAAKd,IAA3B,EAAiC8D,KAAjC;AACD;;;;;;;;;;;;;;;;;;;;;ACrPH;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;;QAEaE,I;;;AAiDX,oBAAYnF,QAAZ,EAAmC;AAAA;;AAhDnC;AACU,aAAAG,KAAA,GAAa,EAAb,CA+CyB,CA7CnC;;AACU,aAAAC,SAAA,GAAyB,IAAzB,CA4CyB,CA3CnC;;AACU,aAAAC,UAAA,GAAkB,IAAlB,CA0CyB,CAzCnC;;AACU,aAAAC,SAAA,GAAiB,IAAjB,CAwCyB,CAtCnC;;AACU,aAAAC,OAAA,GAAU;AAAEC,aAAG,EAAE,CAAP;AAAUC,eAAK,EAAE,EAAjB;AAAqBC,gBAAM,EAAE,EAA7B;AAAiCC,cAAI,EAAE;AAAvC,SAAV,CAqCyB,CA9BnC;;AACU,aAAAC,OAAA,GAAe,IAAf;AACA,aAAAwE,OAAA,GAAe,IAAf;AACA,aAAAtE,MAAA,GAAc,IAAd,CA2ByB,CAzBnC;;AACU,aAAAuE,QAAA,GAAW,EAAX,CAwByB,CAtBnC;AACA;AACA;;AACU,aAAAC,WAAA,GAAc,yCAAS,SAAT,CAAd;AACA,aAAAC,WAAA,GAAc,yCAAS,SAAT,CAAd;AACA,aAAAC,WAAA,GAAc,yCAAS,SAAT,CAAd;AAEA,aAAAC,WAAA,GAAc,GAAd;AACA,aAAAC,WAAA,GAAc,GAAd;AACA,aAAAC,WAAA,GAAc,GAAd,CAayB,CAXnC;;AACU,aAAA1C,UAAA,GAAa,UAAC2C,GAAD,EAAS;AAC9B,cAAKpE,KAAK,CAACoE,GAAD,CAAV,EAAkB;AACd,mBAAOA,GAAP;AACH,WAFD,MAGK;AACD,mBAAO,0CAAU,KAAV,EAAiBA,GAAjB,CAAP;AACH;AACF,SAPS;;AAWR,aAAKxF,SAAL,GAAiBJ,QAAjB;AAEA,aAAK4B,gBAAL;AACA,aAAKC,iBAAL;AACA,aAAKC,gBAAL;AACD;;;;2CAEkB;AACjBqB,gBAAM,CAACC,gBAAP,CAAwB,QAAxB,EAAkC,KAAKC,MAAL,CAAYC,IAAZ,CAAiB,IAAjB,CAAlC;AACD;;;gCAGOuC,M,EAAa;AAEnB,cAAIC,IAAI,GAAG,CAAX;;AAEA,cAAID,MAAM,CAAC,CAAD,CAAN,GAAY,CAAZ,IAAiBA,MAAM,CAAC,CAAD,CAAN,GAAY,CAAjC,EAAoC;AAClCC,gBAAI,GAAG,CAAP;AACD,WAFD,MAEO,IAAID,MAAM,CAAC,CAAD,CAAN,IAAa,CAAb,IAAkBA,MAAM,CAAC,CAAD,CAAN,GAAY,CAAlC,EAAqC;AAC1CC,gBAAI,GAAGD,MAAM,CAAC,CAAD,CAAb;AACD,WAFM,MAEA,IAAIA,MAAM,CAAC,CAAD,CAAN,GAAY,CAAZ,IAAiBA,MAAM,CAAC,CAAD,CAAN,IAAa,CAAlC,EAAqC;AAC1CC,gBAAI,GAAGD,MAAM,CAAC,CAAD,CAAb;AACD;;AAED,cAAIA,MAAM,CAAC,CAAD,CAAN,KAAcA,MAAM,CAAC,CAAD,CAAxB,EAA6B;AAC3B,gBAAIE,IAAI,GAAGC,IAAI,CAACC,IAAL,CAAW,KAAKZ,QAAL,IAAiBS,IAAI,GAAGD,MAAM,CAAC,CAAD,CAA9B,KAAsCA,MAAM,CAAC,CAAD,CAAN,GAAYA,MAAM,CAAC,CAAD,CAAxD,CAAX,CAAX;;AAEA,gBAAIE,IAAI,GAAG,CAAX,EAAc;AACZA,kBAAI,GAAG,CAAP;AACD;;AACD,gBAAIA,IAAI,GAAG,KAAKV,QAAL,GAAgB,CAA3B,EAA8B;AAC5BU,kBAAI,GAAG,KAAKV,QAAL,GAAgB,CAAvB;AACD;;AAED,iBAAKlF,KAAL,CAAW+F,MAAX,GAAoB,EAApB;;AAEA,iBAAK,IAAIjH,EAAE,GAAG,CAAd,EAAiBA,EAAE,GAAG8G,IAAtB,EAA4B9G,EAAE,EAA9B,EAAmC;AACjC,kBAAM2G,GAAG,GAAGC,MAAM,CAAC,CAAD,CAAN,GAAY5G,EAAE,IAAI6G,IAAI,GAAGD,MAAM,CAAC,CAAD,CAAjB,CAAF,IAA2BE,IAAI,GAAG,CAAlC,CAAxB;;AACA,mBAAK5F,KAAL,CAAW+F,MAAX,CAAkBC,IAAlB,CAAuBP,GAAG,CAACQ,OAAJ,CAAY,CAAZ,CAAvB;AACD;;AAED,iBAAK,IAAInH,GAAE,GAAG,CAAd,EAAiBA,GAAE,GAAG,KAAKoG,QAAL,GAAgBU,IAAtC,EAA4C9G,GAAE,EAA9C,EAAmD;AACjD,kBAAM2G,IAAG,GAAGE,IAAI,GAAG7G,GAAE,IAAI4G,MAAM,CAAC,CAAD,CAAN,GAAYC,IAAhB,CAAF,IAA2B,KAAKT,QAAL,GAAgBU,IAAhB,GAAuB,CAAlD,CAAnB;;AACA,mBAAK5F,KAAL,CAAW+F,MAAX,CAAkBC,IAAlB,CAAuBP,IAAG,CAACQ,OAAJ,CAAY,CAAZ,CAAvB;AACD;;AAED,iBAAKjG,KAAL,CAAW0F,MAAX,GAAoBA,MAAM,CAACnE,GAAP,CAAW,UAAAC,EAAE;AAAA,qBAAIA,EAAE,CAACyE,OAAH,CAAW,CAAX,CAAJ;AAAA,aAAb,CAApB;AACA,iBAAKjG,KAAL,CAAW2F,IAAX,GAAkBA,IAAI,CAACM,OAAL,CAAa,CAAb,CAAlB;AACD,WAxBD,MAyBK;AACH,iBAAKjG,KAAL,CAAW0F,MAAX,GAAoBA,MAApB;AACA,iBAAK1F,KAAL,CAAW2F,IAAX,GAAkBD,MAAM,CAAC,CAAD,CAAxB;AACA,iBAAK1F,KAAL,CAAW+F,MAAX,GAAoB,CAAC,KAAK/F,KAAL,CAAW2F,IAAZ,CAApB;AACD;;AAED,eAAK3F,KAAL,CAAW+F,MAAX,CAAkBG,OAAlB,CAA0B,KAAKZ,WAA/B,EAA4C,KAAKC,WAAjD,EAA8D,KAAKC,WAAnE;AACD;;;iCAEQ;AACP,eAAKzD,YAAL;AACA,eAAKC,UAAL;AACA,eAAKmE,gBAAL;AACD;;;iCAEQ;AACP,eAAKjG,UAAL,CAAgBgC,MAAhB;;AAEA,eAAKT,gBAAL;AACA,eAAKC,iBAAL;AACA,eAAKS,MAAL;AACD;;;2CAEkB;AACjB;AACA,eAAKC,MAAL,GAAc,KAAKnC,SAAL,CAAeoC,WAAf,GAA6B,KAAKjC,OAAL,CAAaI,IAA1C,GAAiD,KAAKJ,OAAL,CAAaE,KAA5E;AACA,eAAKgC,OAAL,GAAe,KAAKrC,SAAL,CAAesC,YAAf,GAA8B,KAAKnC,OAAL,CAAaC,GAA3C,GAAiD,KAAKD,OAAL,CAAaG,MAA7E,CAHiB,CAKjB;;AACA,eAAKL,UAAL,GAAkB,0CAAU,KAAKD,SAAf,EACfuC,MADe,CACR,KADQ,EAEfC,IAFe,CAEV,OAFU,EAED,KAAKxC,SAAL,CAAeoC,WAFd,EAGfI,IAHe,CAGV,QAHU,EAGA,KAAKxC,SAAL,CAAesC,YAHf,CAAlB,CANiB,CAWjB;;AACA,eAAKpC,SAAL,GAAiB,KAAKD,UAAL,CACdsC,MADc,CACP,GADO,EAEdC,IAFc,CAET,OAFS,EAEA,UAFA,EAGdA,IAHc,CAGT,WAHS,EAGI,eAAe,KAAKrC,OAAL,CAAaI,IAA5B,GAAmC,GAAnC,GAAyC,KAAKJ,OAAL,CAAaC,GAAtD,GAA4D,GAHhE,CAAjB,CAZiB,CAiBjB;;AACA,eAAKF,SAAL,CACGqC,MADH,CACU,GADV,EAEGC,IAFH,CAEQ,OAFR,EAEiB,cAFjB,EAGGA,IAHH,CAGQ,WAHR,EAGqB,iBAAkB,KAAKH,OAAvB,GAAkC,GAHvD;AAID;;;4CAEmB;AAClB,eAAK7B,OAAL,GAAe,+CAAemC,KAAf,CAAqB,CAAC,CAAD,EAAI,KAAKR,MAAT,CAArB,EAAuCS,OAAvC,CAA+C,GAA/C,CAAf;AACA,eAAKlC,MAAL,GAAc,8CAAc,KAAKF,OAAnB,CAAd;AACA,eAAKwE,OAAL,GAAe,kDAAkB,kDAAlB,CAAf;AACD;;;uCAEc;AACb,eAAKxE,OAAL,CAAagD,MAAb,CAAoB,KAAKzD,KAAL,CAAW+F,MAA/B;;AAEA,eAAKd,OAAL,CAAaxB,MAAb,CAAoB,CAClB,KAAKzD,KAAL,CAAW0F,MAAX,CAAkB,CAAlB,CADkB,EACI,KAAK1F,KAAL,CAAW2F,IADf,EACqB,KAAK3F,KAAL,CAAW0F,MAAX,CAAkB,CAAlB,CADrB,CAApB;AAGD;;;qCAEY;AACX,eAAK/E,MAAL,CAAY+C,KAAZ,CAAkB,KAAKjD,OAAvB,EAAgC2F,UAAhC,CAA2C,CACvC,KAAKd,WADkC,EAEvC,KAAKC,WAFkC,EAGvC,KAAKC,WAHkC,EAIvC,KAAKxF,KAAL,CAAW0F,MAAX,CAAkB,CAAlB,CAJuC,EAKvC,KAAK1F,KAAL,CAAW2F,IAL4B,EAMvC,KAAK3F,KAAL,CAAW0F,MAAX,CAAkB,CAAlB,CANuC,CAA3C;;AASE,eAAKvF,SAAL,CAAewD,MAAf,CAAsB,UAAtB,EAAkCC,IAAlC,CAAuC,KAAKjD,MAAL,CAAYmC,UAAZ,CAAuB,KAAKA,UAA5B,CAAvC,EACCe,SADD,CACW,MADX,EAECnB,KAFD,CAEO,aAFP,EAEsB,KAFtB,EAGCD,IAHD,CAGM,IAHN,EAGY,MAHZ,EAICA,IAJD,CAIM,IAJN,EAIY,QAJZ,EAKCA,IALD,CAKM,WALN,EAKmB,aALnB;;AAOA,eAAKtC,SAAL,CAAewD,MAAf,CAAsB,UAAtB,EAAkCA,MAAlC,CAAyC,SAAzC,EAAoDzB,MAApD;AACH;;;2CAEkB;AAAA;;AACjB,cAAMmE,IAAI,GAAG,KAAKlG,SAAL,CACV0D,SADU,CACA,aADA,EAEVhC,IAFU,CAEL,CAAC,KAAK7B,KAAL,CAAW+F,MAAZ,CAFK,EAGVzE,IAHU,CAGL,GAHK,CAAb;;AAKA+E,cAAI,CAAC5D,IAAL,CAAU,OAAV,EAAmB,YAAnB;AAEA,cAAMuB,KAAK,GAAGqC,IAAI,CACfxC,SADW,CACD,MADC,EAEXhC,IAFW,CAEN,UAAAoC,CAAC;AAAA,mBAAIA,CAAJ;AAAA,WAFK,EAGX3C,IAHW,CAGN,MAHM,CAAd;AAKA0C,eAAK,CACFvB,IADH,CACQ,GADR,EACa,UAAAwB,CAAC;AAAA,mBAAG,MAAI,CAACxD,OAAL,CAAawD,CAAb,CAAH;AAAA,WADd,EAEGxB,IAFH,CAEQ,GAFR,EAEa,CAFb,EAGGA,IAHH,CAGQ,OAHR,EAGiB,KAAKhC,OAAL,CAAayD,SAAb,EAHjB,EAIGzB,IAJH,CAIQ,QAJR,EAIkB,KAAKH,OAJvB,EAKGG,IALH,CAKQ,MALR,EAKgB,UAAAwB,CAAC,EAAI;AACjB,gBAAGA,CAAC,KAAK,MAAI,CAACqB,WAAd,EAA2B;AACvB,qBAAO,MAAI,CAACH,WAAZ;AACH,aAFD,MAGK,IAAIlB,CAAC,KAAK,MAAI,CAACuB,WAAf,EAA4B;AAC7B,qBAAO,MAAI,CAACH,WAAZ;AACH,aAFI,MAGA,IAAIpB,CAAC,KAAK,MAAI,CAACsB,WAAf,EAA4B;AAC7B,qBAAO,MAAI,CAACH,WAAZ;AACH,aAFI,MAGA;AACD,qBAAO,MAAI,CAACH,OAAL,CAAahB,CAAb,CAAP;AACH;AACF,WAlBH,EAmBGxB,IAnBH,CAmBQ,QAnBR,EAmBkB,MAnBlB;AAoBD;;;;;;;;;;;;;;;;;;;;;ACvNH;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;;QAEa6D,I;;;AAwCX,oBAAYzG,QAAZ,EAAmCC,SAAnC,EAAmDyG,QAAnD,EAAkE;AAAA;;AAAA;;AAvClE;AACU,aAAAvG,KAAA,GAAa,IAAb,CAsCwD,CApClE;;AACU,aAAAC,SAAA,GAAyB,IAAzB,CAmCwD,CAlClE;;AACU,aAAAC,UAAA,GAAkB,IAAlB,CAiCwD,CAhClE;;AACU,aAAAC,SAAA,GAAiB,IAAjB,CA+BwD,CA7BlE;;AACU,aAAAC,OAAA,GAAU;AAAEC,aAAG,EAAE,EAAP;AAAWC,eAAK,EAAE,EAAlB;AAAsBC,gBAAM,EAAE,EAA9B;AAAkCC,cAAI,EAAE;AAAxC,SAAV,CA4BwD,CArBlE;;AACU,aAAAC,OAAA,GAAe,IAAf;AACA,aAAAC,OAAA,GAAe,IAAf;AACA,aAAAuE,OAAA,GAAe,IAAf;AAEA,aAAAuB,OAAA,GAAkB,EAAlB,CAgBwD,CAdlE;;AACU,aAAA7F,MAAA,GAAc,IAAd;AACA,aAAAC,MAAA,GAAc,IAAd,CAYwD,CAVlE;;AACU,aAAAG,UAAA,GAAa,IAAb,CASwD,CAPlE;;AACU,aAAA0F,KAAA,GAAQ,0CACfC,CADe,CACb,UAACzC,CAAD;AAAA,iBAAY,MAAI,CAACxD,OAAL,CAAawD,CAAC,CAAC0C,IAAf,CAAZ;AAAA,SADa,EAEfC,CAFe,CAEb,UAAC3C,CAAD;AAAA,iBAAY,MAAI,CAACvD,OAAL,CAAauD,CAAC,CAACc,KAAf,CAAZ;AAAA,SAFa,EAGf8B,KAHe,CAGT,8CAHS,EAIfC,OAJe,CAIP,UAAU7C,CAAV,EAAkB;AAAE,iBAAOA,CAAC,CAAC8C,KAAT;AAAiB,SAJ9B,CAAR;AAOR,aAAK9G,SAAL,GAAiBJ,QAAjB;AACA,aAAKkB,UAAL,GAAkBjB,SAAlB;AACA,aAAK0G,OAAL,GAAeD,QAAQ,CAACS,MAAxB;AAEA,aAAKvF,gBAAL;AACA,aAAKC,iBAAL;AACA,aAAKC,gBAAL;AACD;;;;gCAEOE,I,EAAWoF,K,EAAY;AAC7B,eAAKjH,KAAL,GAAa6B,IAAb;AACA,eAAK7B,KAAL,CAAWiH,KAAX,GAAmBA,KAAnB;AACD;;;kCAES/F,K,EAAe;AACvB,eAAKsF,OAAL,GAAetF,KAAf;AACD;;;iCAEQ;AACP,eAAKa,YAAL;AACA,eAAKC,UAAL;AACA,eAAKkF,WAAL;AACA,eAAKC,YAAL;AACD;;;iCAEQ;AACP,eAAKjH,UAAL,CAAgBgC,MAAhB;;AAEA,eAAKT,gBAAL;AACA,eAAKC,iBAAL;AACA,eAAKS,MAAL;AACD;;;2CAGkB;AAAA;;AACjB;AACA,eAAKC,MAAL,GAAc,KAAKnC,SAAL,CAAeoC,WAAf,GAA6B,KAAKjC,OAAL,CAAaI,IAA1C,GAAiD,KAAKJ,OAAL,CAAaE,KAA5E;AACA,eAAKgC,OAAL,GAAe,KAAKrC,SAAL,CAAesC,YAAf,GAA8B,KAAKnC,OAAL,CAAaC,GAA3C,GAAiD,KAAKD,OAAL,CAAaG,MAA7E,CAHiB,CAKjB;;AACA,eAAKL,UAAL,GAAkB,0CAAU,KAAKD,SAAf,EACfuC,MADe,CACR,KADQ,EAEfC,IAFe,CAEV,OAFU,EAED,KAAKxC,SAAL,CAAeoC,WAFd,EAGfI,IAHe,CAGV,QAHU,EAGA,KAAKxC,SAAL,CAAesC,YAHf,CAAlB,CANiB,CAWjB;;AACA,eAAKpC,SAAL,GAAiB,KAAKD,UAAL,CACdsC,MADc,CACP,GADO,EAEdC,IAFc,CAET,OAFS,EAEA,UAFA,EAGdA,IAHc,CAGT,WAHS,EAGI,eAAe,KAAKrC,OAAL,CAAaI,IAA5B,GAAmC,GAAnC,GAAyC,KAAKJ,OAAL,CAAaC,GAAtD,GAA4D,GAHhE,CAAjB;;AAKA,eAAKF,SAAL,CACGqC,MADH,CACU,GADV,EAEGC,IAFH,CAEQ,OAFR,EAEiB,QAFjB,EAGGA,IAHH,CAGQ,WAHR,EAGqB,iBAHrB,EAjBiB,CAsBjB;;;AACA,eAAKtC,SAAL,CACGqC,MADH,CACU,GADV,EAEGC,IAFH,CAEQ,OAFR,EAEiB,cAFjB,EAGGA,IAHH,CAGQ,WAHR,EAGqB,iBAAkB,KAAKH,OAAvB,GAAkC,GAHvD;;AAKA,eAAKnC,SAAL,CACGqC,MADH,CACU,GADV,EAEGC,IAFH,CAEQ,OAFR,EAEiB,cAFjB,EA5BiB,CAgCjB;;;AACA,eAAKtC,SAAL,CACGqC,MADH,CACU,MADV,EAEGC,IAFH,CAEQ,OAFR,EAEiB,aAFjB,EAGGA,IAHH,CAGQ,WAHR,sBAII,KAAKL,MAAL,GAAc,CAJlB,eAMI,KAAKE,OAAL,GAAe,KAAKlC,OAAL,CAAaC,GAA5B,GAAkC,EANtC,QAQGqC,KARH,CAQS,aART,EAQwB,QARxB,EASGC,IATH,CASQ,YAAM;AACN,gBAAMxB,KAAK,GAAG,MAAI,CAACqF,OAAL,CAAapF,KAAb,CAAmB,GAAnB,CAAd;;AACA,gBAAID,KAAK,CAACA,KAAK,CAAC2C,MAAN,GAAe,CAAhB,CAAL,KAA4B,QAAhC,EAA0C;AACtC,+BAAU3C,KAAK,CAAC,CAAD,CAAf,cAAsBA,KAAK,CAAC,CAAD,CAA3B;AACH;;AACD,gBAAIA,KAAK,CAACA,KAAK,CAAC2C,MAAN,GAAe,CAAhB,CAAL,KAA4B,OAAhC,EAAyC;AACrC,+BAAU3C,KAAK,CAAC,CAAD,CAAf,cAAsBA,KAAK,CAAC,CAAD,CAA3B;AACH;AACN,WAjBH,EAjCiB,CAoDjB;;;AACA,eAAKhB,SAAL,CACGqC,MADH,CACU,MADV,EAEGC,IAFH,CAEQ,OAFR,EAEiB,aAFjB,EAGGA,IAHH,CAGQ,WAHR,EAGqB,aAHrB,EAIGA,IAJH,CAIQ,GAJR,EAIa,IAAI,KAAKrC,OAAL,CAAaI,IAAb,GAAoB,CAJrC,EAKGiC,IALH,CAKQ,GALR,EAKa,IAAK,KAAKH,OAAL,GAAe,CALjC,EAMGG,IANH,CAMQ,IANR,EAMc,KANd,EAOGC,KAPH,CAOS,aAPT,EAOwB,QAPxB,EAQGC,IARH,WAQW,KAAK6D,OARhB;AASD;;;4CAEmB;AAClB,eAAK/F,OAAL,GAAe,gDAAgBmC,KAAhB,CAAsB,CAAC,CAAD,EAAI,KAAKR,MAAT,CAAtB,EAAwCS,OAAxC,CAAgD,GAAhD,CAAf;AACA,eAAKlC,MAAL,GAAc,8CAAc,KAAKF,OAAnB,CAAd;AAEA,eAAKC,OAAL,GAAe,iDAAiBkC,KAAjB,CAAuB,CAAC,KAAKN,OAAN,EAAe,CAAf,CAAvB,CAAf;AACA,eAAK1B,MAAL,GAAc,4CAAY,KAAKF,OAAjB,CAAd;AAEA,eAAKuE,OAAL,GAAe,gDAAgB,mDAAhB,CAAf;AACD;;;2CAEkB;AACjBjC,gBAAM,CAACC,gBAAP,CAAwB,QAAxB,EAAkC,KAAKC,MAAL,CAAYC,IAAZ,CAAiB,IAAjB,CAAlC;AACD;;;uCAEc;AACb,cAAM8D,KAAK,GAAG,KAAKjH,KAAL,CAAWiH,KAAzB;AAEA,cAAIrE,KAAK,GAAG,CAACwE,MAAM,CAACC,SAAR,EAAmBD,MAAM,CAACE,SAA1B,CAAZ;;AACA,eAAKtH,KAAL,CAAWuH,KAAX,CAAiBC,OAAjB,CAAyB,UAAAC,IAAI,EAAI;AAC/B,gBAAMC,IAAI,GAAGD,IAAI,CAAC5F,IAAL,CAAUN,GAAV,CAAc,UAAAC,EAAE;AAAA,qBAAIA,EAAE,CAACuD,KAAP;AAAA,aAAhB,CAAb;AAEA,gBAAM4C,GAAG,GAAG9B,IAAI,CAAC8B,GAAL,OAAA9B,IAAI,qBAAQ6B,IAAR,EAAhB;AACA,gBAAME,GAAG,GAAG/B,IAAI,CAAC+B,GAAL,OAAA/B,IAAI,qBAAQ6B,IAAR,EAAhB;AAEA9E,iBAAK,CAAC,CAAD,CAAL,GAAWiD,IAAI,CAAC8B,GAAL,CAAS/E,KAAK,CAAC,CAAD,CAAd,EAAmB+E,GAAnB,CAAX;AACA/E,iBAAK,CAAC,CAAD,CAAL,GAAWiD,IAAI,CAAC+B,GAAL,CAAShF,KAAK,CAAC,CAAD,CAAd,EAAmBgF,GAAnB,CAAX;AACD,WARD;;AAUA,cAAI,KAAK5H,KAAL,CAAWuH,KAAX,CAAiBzD,MAAjB,KAA4B,CAAhC,EAAmC;AACjClB,iBAAK,GAAG,KAAK5C,KAAL,CAAW0F,MAAnB;AACD,WAhBY,CAkBb;;;AACA,eAAKjF,OAAL,CAAagD,MAAb,CAAoBwD,KAApB;;AACA,eAAKvG,OAAL,CAAa+C,MAAb,CAAoBb,KAApB;;AAEA,cAAMiF,KAAK,GAAG,KAAK7H,KAAL,CAAWuH,KAAX,CAAiBhG,GAAjB,CAAqB,UAAA8B,GAAG;AAAA,mBAAIA,GAAG,CAACyE,IAAR;AAAA,WAAxB,CAAd;;AACA,eAAK7C,OAAL,CAAaxB,MAAb,CAAoBoE,KAApB;AACD;;;qCAEY;AAAA;;AACX,eAAKlH,MAAL,CAAY+C,KAAZ,CAAkB,KAAKjD,OAAvB;;AACA,eAAKN,SAAL,CAAewD,MAAf,CAAsB,UAAtB,EAAkCC,IAAlC,CAAuC,KAAKjD,MAA5C,EACGkD,SADH,CACa,MADb,EAEGnB,KAFH,CAES,aAFT,EAEwB,KAFxB,EAGGD,IAHH,CAGQ,IAHR,EAGc,OAHd,EAIGA,IAJH,CAIQ,IAJR,EAIc,OAJd,EAKGA,IALH,CAKQ,WALR,EAKqB,aALrB;;AAOA,eAAK7B,MAAL,CAAY8C,KAAZ,CAAkB,KAAKhD,OAAvB;;AACA,eAAKP,SAAL,CAAewD,MAAf,CAAsB,UAAtB,EAAkCC,IAAlC,CAAuC,KAAKhD,MAAL,CAAYkC,UAAZ,CAAuB,0CAAU,KAAV,CAAvB,CAAvC;;AAEA,eAAK3C,SAAL,CAAewD,MAAf,CAAsB,cAAtB,EAAsChB,IAAtC,WAA8C,KAAK6D,OAAnD;;AACA,eAAKrG,SAAL,CAAewD,MAAf,CAAsB,cAAtB,EAAsChB,IAAtC,CAA2C,YAAM;AAC7C,gBAAMxB,KAAK,GAAG,MAAI,CAACqF,OAAL,CAAapF,KAAb,CAAmB,GAAnB,CAAd;;AACA,gBAAID,KAAK,CAACA,KAAK,CAAC2C,MAAN,GAAe,CAAhB,CAAL,KAA4B,QAAhC,EAA0C;AACtC,+BAAU3C,KAAK,CAAC,CAAD,CAAf,cAAsBA,KAAK,CAAC,CAAD,CAA3B;AACH;;AACD,gBAAIA,KAAK,CAACA,KAAK,CAAC2C,MAAN,GAAe,CAAhB,CAAL,KAA4B,OAAhC,EAAyC;AACrC,+BAAU3C,KAAK,CAAC,CAAD,CAAf,cAAsBA,KAAK,CAAC,CAAD,CAA3B;AACH;AACJ,WARD;AASD;;;sCAEa;AAAA;;AACZ,cAAMoG,KAAK,GAAG,KAAKpH,SAAL,CAAe0D,SAAf,CAAyB,QAAzB,EACXhC,IADW,CACN,KAAK7B,KAAL,CAAWuH,KADL,EAEXjG,IAFW,CAEN,MAFM,CAAd;;AAIAiG,eAAK,CACF9E,IADH,CACQ,OADR,EACiB,OADjB,EAEGA,IAFH,CAEQ,GAFR,EAEa,UAAAwB,CAAC;AAAA,mBAAI,MAAI,CAACwC,KAAL,CAAWxC,CAAC,CAACpC,IAAb,CAAJ;AAAA,WAFd,EAGGY,IAHH,CAGQ,QAHR,EAGkB,UAAAwB,CAAC;AAAA,mBAAI,MAAI,CAACgB,OAAL,CAAahB,CAAC,CAAC6D,IAAf,CAAJ;AAAA,WAHnB;AAID;;;uCAEc;AAAA;;AACb,cAAMC,QAAQ,GAAG,KAAK5H,SAAL,CAAewD,MAAf,CAAsB,SAAtB,EACdE,SADc,CACJ,iBADI,EAEdhC,IAFc,CAET,KAAK7B,KAAL,CAAWuH,KAFF,EAGdjG,IAHc,CAGT,GAHS,EAIdmB,IAJc,CAIT,WAJS,EAII,UAACwB,CAAD,EAAI+D,CAAJ;AAAA,uCAAuB,MAAI,CAAC5F,MAAL,GAAc,CAAd,GAAkB4F,CAAC,IAAI,IAAI,MAAI,CAAC5F,MAAT,GAAkB,CAAtB,CAAD,GAA4B,MAAI,CAACpC,KAAL,CAAWuH,KAAX,CAAiBzD,MAAtF,eAAiG,CAAC,MAAI,CAAC1D,OAAL,CAAaC,GAAd,GAAoB,CAArH;AAAA,WAJJ,CAAjB;;AAMA0H,kBAAQ,CACLtF,IADH,CACQ,OADR,EACiB,gBADjB,EAEGA,IAFH,CAEQ,OAFR,EAEiB,IAAI,KAAKL,MAAT,GAAkB,CAAlB,GAAsB,KAAKpC,KAAL,CAAWuH,KAAX,CAAiBzD,MAFxD;AAKA,cAAMmE,OAAO,GAAGF,QAAQ,CACrBlE,SADa,CACH,QADG,EAEbhC,IAFa,CAER,UAAAoC,CAAC;AAAA,mBAAI,CAACA,CAAC,CAAC6D,IAAH,CAAJ;AAAA,WAFO,EAGbxG,IAHa,CAGR,QAHQ,CAAhB;AAKA2G,iBAAO,CACJxF,IADH,CACQ,GADR,EACa,CADb,EAEGA,IAFH,CAEQ,MAFR,EAEgB,UAAAwB,CAAC;AAAA,mBAAI,MAAI,CAACgB,OAAL,CAAahB,CAAb,CAAJ;AAAA,WAFjB;AAIA,cAAMiE,MAAM,GAAGH,QAAQ,CACpBlE,SADY,CACF,MADE,EAEZhC,IAFY,CAEP,UAAAoC,CAAC;AAAA,mBAAI,CAACA,CAAC,CAAC6D,IAAH,CAAJ;AAAA,WAFM,EAGZxG,IAHY,CAGP,MAHO,CAAf;AAKA,cAAI6G,KAAK,GAAI,KAAK/F,MAAL,GAAc,CAAf,GAAoB,KAAKpC,KAAL,CAAWuH,KAAX,CAAiBzD,MAAjD;AACA,cAAIsE,KAAK,GAAG,EAAZ;AAEAF,gBAAM,CACHzF,IADH,CACQ,OADR,EACiB,aADjB,EAEGA,IAFH,CAEQ,aAFR,EAEuB,OAFvB,EAGGA,IAHH,CAGQ,GAHR,EAGa,EAHb,EAIGA,IAJH,CAIQ,GAJR,EAIa,CAJb,EAKGE,IALH,CAKQ,UAAAsB,CAAC,EAAI;AACT,gBAAMoE,OAAO,GAAGpE,CAAC,CAACH,MAAF,GAAWsE,KAAX,GAAmBnE,CAAC,CAACW,KAAF,CAAQ,CAAR,EAAWwD,KAAX,IAAoB,KAAvC,GAA+CnE,CAA/D;AACA,mBAAOoE,OAAP;AACD,WARH,EASG1F,IATH,CASQ,UAAUsB,CAAV,EAAa;AACjB,gBAAMoE,OAAO,GAAGpE,CAAC,CAACH,MAAF,GAAWsE,KAAX,GAAmBnE,CAAC,CAACW,KAAF,CAAQ,CAAR,EAAWwD,KAAX,IAAoB,KAAvC,GAA+CnE,CAA/D;AACA,gBAAMqE,IAAI,GAAG,KAAKC,qBAAL,EAAb;AACA,mBAAOD,IAAI,GAAGH,KAAP,GAAeE,OAAf,GAAyBA,OAAO,CAACzD,KAAR,CAAc,CAAd,EAAiBwD,KAAK,GAAGD,KAAR,GAAgBG,IAAjC,IAAyC,KAAzE;AACD,WAbH,EAcGnE,EAdH,CAcM,WAdN,EAcmB,UAAAF,CAAC,EAAI;AACpB,gBAAMuE,KAAK,GAAG,CAAC,yCAASC,KAAT,GAAe,EAAhB,EAAoB,yCAASC,KAAT,GAAe,EAAnC,CAAd;;AACA,kBAAI,CAAC3H,UAAL,CAAgB4H,MAAhB,CAAuB;AAAClB,kBAAI,EAAExD,CAAP;AAAUuE,mBAAK,EAALA;AAAV,aAAvB;AACD,WAjBH,EAkBGrE,EAlBH,CAkBM,UAlBN,EAkBkB,KAAKpD,UAAL,CAAgB6H,MAlBlC;AAmBD;;;;;;;;;;;;;;;;;;;;;ACxQH;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;;QAEaC,M;;;AAsDT,sBAAYhJ,QAAZ,EAAmCC,SAAnC,EAAmDyG,QAAnD,EAAkE;AAAA;;AArDlE;AACU,aAAAvG,KAAA,GAAa,IAAb,CAoDwD,CAlDlE;;AACU,aAAAC,SAAA,GAAyB,IAAzB,CAiDwD,CAhDlE;;AACU,aAAAC,UAAA,GAAkB,IAAlB,CA+CwD,CA9ClE;;AACU,aAAAC,SAAA,GAAiB,IAAjB,CA6CwD,CA3ClE;;AACU,aAAAC,OAAA,GAAU;AAAEC,aAAG,EAAE,EAAP;AAAWC,eAAK,EAAE,EAAlB;AAAsBC,gBAAM,EAAE,EAA9B;AAAkCC,cAAI,EAAE;AAAxC,SAAV,CA0CwD,CAnClE;;AACU,aAAAC,OAAA,GAAe,IAAf;AACA,aAAAC,OAAA,GAAe,IAAf;AACA,aAAAuE,OAAA,GAAe,IAAf;AACA,aAAA6D,OAAA,GAAe,IAAf,CA+BwD,CA9BlE;;AACU,aAAAnI,MAAA,GAAc,IAAd;AACA,aAAAC,MAAA,GAAc,IAAd,CA4BwD,CA1BlE;;AACU,aAAAmI,YAAA,GAAe,EAAf,CAyBwD,CAvBlE;AACA;AACA;;AACU,aAAA5D,WAAA,GAAc,yCAAS,SAAT,CAAd;AACA,aAAAC,WAAA,GAAc,yCAAS,SAAT,CAAd;AACA,aAAAC,WAAA,GAAc,yCAAS,SAAT,CAAd;AAEA,aAAA2D,IAAA,GAAO,IAAP,CAgBwD,CAdlE;;AACU,aAAAC,iBAAA,GAAoB,IAApB,CAawD,CAXlE;;AACU,aAAAC,eAAA,GAAkB,IAAlB;AACA,aAAAC,eAAA,GAAkB,IAAlB;AAEA,aAAAC,iBAAA,GAAoB,IAApB;AACA,aAAAC,iBAAA,GAAoB,EAApB,CAMwD,CAHlE;;AACU,aAAAtI,UAAA,GAAa,IAAb;AAGN,aAAKd,SAAL,GAAiBJ,QAAjB;AACA,aAAKkB,UAAL,GAAkBjB,SAAlB;AAEA,aAAKoJ,eAAL,GAAuB3C,QAAQ,CAAC+C,MAAhC;AACA,aAAKH,eAAL,GAAuB,IAAvB;AAEA,aAAKC,iBAAL,GAAyB7C,QAAQ,CAACgD,KAAlC;AACA,aAAKF,iBAAL,GAAyB9C,QAAQ,CAACiD,KAAlC;AAEA,aAAK/H,gBAAL;AACA,aAAKC,iBAAL;AACA,aAAKC,gBAAL;AACH;;;;gCAEOE,I,EAAW4H,I,EAAchC,I,EAAWiC,I,EAAcC,K,EAAgB;AACtE,eAAKX,IAAL,GAAYS,IAAZ;AACA,eAAKzJ,KAAL,GAAa6B,IAAb;AACA,eAAKwH,iBAAL,GAAyB5B,IAAzB;AACA,eAAK2B,iBAAL,GAAyBM,IAAzB;AACA,eAAKT,iBAAL,GAAyBU,KAAzB;AACH;;;qCAEYzI,K,EAAe;AACxB,eAAKiI,eAAL,GAAuBjI,KAAvB;AACH;;;iCAEQ;AACL,eAAKa,YAAL;AACA,eAAKC,UAAL;AAEA,eAAKmE,gBAAL;AACA,eAAKyD,eAAL;AACA,eAAKC,eAAL;AAEA,eAAKC,iBAAL;AACA,eAAKC,iBAAL;AAEA,eAAKC,eAAL;AACA,eAAKC,eAAL;AACH;;;iCAEQ;AACL,eAAK/J,UAAL,CAAgBgC,MAAhB;;AAEA,eAAKT,gBAAL;AACA,eAAKC,iBAAL;AACA,eAAKS,MAAL;AACH;;;2CAEkB;AACf;AACA,eAAKC,MAAL,GAAc,KAAKnC,SAAL,CAAeoC,WAAf,GAA6B,KAAKjC,OAAL,CAAaI,IAA1C,GAAiD,KAAKJ,OAAL,CAAaE,KAA5E;AACA,eAAKgC,OAAL,GAAe,KAAKrC,SAAL,CAAesC,YAAf,GAA8B,KAAKnC,OAAL,CAAaC,GAA3C,GAAiD,KAAKD,OAAL,CAAaG,MAA7E,CAHe,CAKf;;AACA,eAAKL,UAAL,GAAkB,0CAAU,KAAKD,SAAf,EACbuC,MADa,CACN,KADM,EAEbC,IAFa,CAER,OAFQ,EAEC,KAAKxC,SAAL,CAAeoC,WAFhB,EAGbI,IAHa,CAGR,QAHQ,EAGE,KAAKxC,SAAL,CAAesC,YAHjB,EAIb4B,EAJa,CAIV,UAJU,EAIE,KAAKpD,UAAL,CAAgB6H,MAJlB,CAAlB,CANe,CAYf;;AACA,eAAKzI,SAAL,GAAiB,KAAKD,UAAL,CACZsC,MADY,CACL,GADK,EAEZC,IAFY,CAEP,OAFO,EAEE,UAFF,EAGZA,IAHY,CAGP,WAHO,EAGM,eAAe,KAAKrC,OAAL,CAAaI,IAA5B,GAAmC,GAAnC,GAAyC,KAAKJ,OAAL,CAAaC,GAAtD,GAA4D,GAHlE,CAAjB,CAbe,CAkBf;;AACA,eAAKF,SAAL,CACKqC,MADL,CACY,GADZ,EAEKC,IAFL,CAEU,OAFV,EAEmB,cAFnB,EAGKA,IAHL,CAGU,WAHV,EAGuB,iBAAkB,KAAKH,OAAvB,GAAkC,GAHzD;;AAKA,eAAKnC,SAAL,CACKqC,MADL,CACY,GADZ,EAEKC,IAFL,CAEU,OAFV,EAEmB,cAFnB,EAxBe,CA4Bf;;;AACA,eAAKtC,SAAL,CACKqC,MADL,CACY,GADZ,EAEKC,IAFL,CAEU,OAFV,EAEmB,kBAFnB;;AAIA,eAAKtC,SAAL,CACKqC,MADL,CACY,GADZ,EAEKC,IAFL,CAEU,OAFV,EAEmB,kBAFnB;AAGH;;;4CAEmB;AAChB,eAAKhC,OAAL,GAAe,+CAAemC,KAAf,CAAqB,CAAC,CAAD,EAAI,KAAKR,MAAT,CAArB,EAAuCS,OAAvC,CAA+C,KAA/C,CAAf;AACA,eAAKlC,MAAL,GAAc,8CAAc,KAAKF,OAAnB,CAAd;AAEA,eAAKC,OAAL,GAAe,+CAAekC,KAAf,CAAqB,CAAC,KAAKN,OAAN,EAAe,CAAf,CAArB,EAAwCiC,YAAxC,CAAqD,KAArD,EAA4D2F,YAA5D,CAAyE,IAAzE,EAA+EC,KAA/E,CAAqF,GAArF,CAAf;AACA,eAAKvJ,MAAL,GAAc,4CAAY,KAAKF,OAAjB,CAAd;AAEA,eAAKuE,OAAL,GAAe,kDAAkB,kDAAlB,CAAf;AACA,eAAK6D,OAAL,GAAe,gDAAgB,mDAAhB,CAAf;AACH;;;2CAEkB;AACf9F,gBAAM,CAACC,gBAAP,CAAwB,QAAxB,EAAkC,KAAKC,MAAL,CAAYC,IAAZ,CAAiB,IAAjB,CAAlC;AACH;;;uCAEc;AACX,cAAMxE,IAAI,GAAG,KAAKqB,KAAL,CAAWuB,GAAX,CAAe,UAAA8B,GAAG;AAAA,mBAAIA,GAAG,CAACtD,GAAR;AAAA,WAAlB,CAAb;;AACA,cAAIpB,IAAI,CAACmF,MAAL,GAAc,CAAlB,EAAqB;AAAE;AAAS;;AAEhC,cAAMsG,KAAK,GAAG,KAAKpK,KAAL,CAAW,CAAX,EAAc+E,KAAd,CAAoBxD,GAApB,CAAwB,UAAA8B,GAAG;AAAA,mBAAIA,GAAG,CAACyE,IAAR;AAAA,WAA3B,CAAd;;AACA,cAAIsC,KAAK,CAACtG,MAAN,GAAe,CAAnB,EAAsB;AAAE;AAAS,WALtB,CAOX;;;AACA,eAAKrD,OAAL,CAAagD,MAAb,CAAoB9E,IAApB;;AACA,eAAK+B,OAAL,CAAa+C,MAAb,CAAoB2G,KAApB;;AAEA,cAAIzE,IAAI,GAAG,CAAX;;AACA,cAAI,KAAK3F,KAAL,CAAW0F,MAAX,CAAkB,CAAlB,IAAuB,CAAvB,IAA4B,KAAK1F,KAAL,CAAW0F,MAAX,CAAkB,CAAlB,IAAuB,CAAvD,EAA0D;AACtDC,gBAAI,GAAG,CAAP;AACH,WAFD,MAEO,IAAI,KAAK3F,KAAL,CAAW0F,MAAX,CAAkB,CAAlB,KAAwB,CAAxB,IAA6B,KAAK1F,KAAL,CAAW0F,MAAX,CAAkB,CAAlB,IAAuB,CAAxD,EAA2D;AAC9DC,gBAAI,GAAG,KAAK3F,KAAL,CAAW0F,MAAX,CAAkB,CAAlB,CAAP;AACH,WAFM,MAEA,IAAI,KAAK1F,KAAL,CAAW0F,MAAX,CAAkB,CAAlB,IAAuB,CAAvB,IAA4B,KAAK1F,KAAL,CAAW0F,MAAX,CAAkB,CAAlB,KAAwB,CAAxD,EAA2D;AAC9DC,gBAAI,GAAG,KAAK3F,KAAL,CAAW0F,MAAX,CAAkB,CAAlB,CAAP;AACH;;AAED,eAAKT,OAAL,CAAaxB,MAAb,CAAoB,CAChB,KAAKzD,KAAL,CAAW0F,MAAX,CAAkB,CAAlB,CADgB,EACMC,IADN,EACY,KAAK3F,KAAL,CAAW0F,MAAX,CAAkB,CAAlB,CADZ,CAApB;;AAGA,eAAKoD,OAAL,CAAarF,MAAb,CAAoB,KAAK4F,iBAAzB;AACH;;;qCAEY;AAAA;;AACT,eAAK1I,MAAL,CAAY+C,KAAZ,CAAkB,KAAKjD,OAAvB;;AACA,eAAKN,SAAL,CAAewD,MAAf,CAAsB,UAAtB,EAAkCC,IAAlC,CAAuC,KAAKjD,MAA5C,EACKkD,SADL,CACe,MADf,EAEKnB,KAFL,CAEW,aAFX,EAE0B,KAF1B,EAGKA,KAHL,CAGW,gBAHX,EAG6B,MAH7B,EAIKA,KAJL,CAIW,QAJX,EAIqB,SAJrB,EAKKD,IALL,CAKU,IALV,EAKgB,OALhB,EAMKA,IANL,CAMU,IANV,EAMgB,OANhB,EAOKA,IAPL,CAOU,WAPV,EAOuB,aAPvB,EAQK0B,EARL,CAQQ,OARR,EAQiB,UAAAF,CAAC,EAAI;AACd,kBAAI,CAACiF,eAAL,GAAuBjF,CAAvB;;AACA,kBAAI,CAAClD,UAAL,CAAgBuI,MAAhB,CAAuBrF,CAAvB;;AACA,kBAAI,CAAC+F,eAAL;AACH,WAZL;;AAeA,eAAKpJ,MAAL,CAAY8C,KAAZ,CAAkB,KAAKhD,OAAvB;;AACA,cAAM2J,KAAK,GAAG,KAAKlK,SAAL,CAAewD,MAAf,CAAsB,UAAtB,EAAkCC,IAAlC,CAAuC,KAAKhD,MAA5C,EACTiD,SADS,CACC,MADD,EAETlB,IAFS,CAEJ,UAAAsB,CAAC,EAAI;AACP,gBAAIA,CAAC,CAACH,MAAF,GAAW,MAAI,CAACiF,YAApB,EAAkC;AAC9B,+BAAU9E,CAAC,CAACqG,SAAF,CAAY,CAAZ,EAAe,MAAI,CAACvB,YAAL,GAAoB,CAAnC,CAAV;AACH;;AACD,mBAAO9E,CAAP;AACH,WAPS,EAQTvB,KARS,CAQH,gBARG,EAQe,MARf,EASTA,KATS,CASH,QATG,EASO,aATP,EAUTyB,EAVS,CAUN,WAVM,EAUO,UAAAF,CAAC,EAAI;AAClB,gBAAIsG,OAAO,GAAG,MAAI,CAACvK,KAAL,CAAW,CAAX,EAAc+E,KAAd,CAAoByF,MAApB,CAA2B,UAAAnH,GAAG;AAAA,qBAAIA,GAAG,CAACyE,IAAJ,KAAa7D,CAAjB;AAAA,aAA9B,CAAd;;AACAsG,mBAAO,GAAGA,OAAO,CAACzG,MAAR,GAAiB,CAAjB,GAAqByG,OAAO,CAAC,CAAD,CAAP,CAAWzC,IAAhC,GAAuC,EAAjD;AAEA,kBAAI,CAACqB,eAAL,GAAuBoB,OAAvB;;AACA,kBAAI,CAACxJ,UAAL,CAAgB0J,MAAhB,CAAuBF,OAAvB;;AACA,kBAAI,CAACN,eAAL;AACH,WAjBS,CAAd;;AAmBA,cAAI,KAAKhB,iBAAT,EAA4B;AACxBoB,iBAAK,CACA3H,KADL,CACW,QADX,EACqB,SADrB,EAEKyB,EAFL,CAEQ,OAFR,EAEiB,UAAAF,CAAC;AAAA,qBAAI,MAAI,CAAClD,UAAL,CAAgBiG,MAAhB,CAAuB/C,CAAvB,CAAJ;AAAA,aAFlB;AAIH;AACJ;;;2CAEkB;AAAA;;AACf,cAAMmG,KAAK,GAAG,KAAKjK,SAAL,CACT0D,SADS,CACC,aADD,EAEThC,IAFS,CAEJ,KAAK7B,KAFD,EAGTsB,IAHS,CAGJ,GAHI,CAAd;;AAKA8I,eAAK,CACA3H,IADL,CACU,OADV,EACmB,YADnB,EAEKA,IAFL,CAEU,WAFV,EAEuB,UAAAwB,CAAC;AAAA,uCAAiB,OAAI,CAACxD,OAAL,CAAawD,CAAC,CAAClE,GAAf,CAAjB;AAAA,WAFxB;AAIA,cAAMiE,KAAK,GAAGoG,KAAK,CACdvG,SADS,CACC,MADD,EAEThC,IAFS,CAEJ,UAAAoC,CAAC;AAAA,mBAAIA,CAAC,CAACc,KAAN;AAAA,WAFG,EAGTzD,IAHS,CAGJ,MAHI,CAAd;AAKA0C,eAAK,CACAvB,IADL,CACU,GADV,EACe,UAAAwB,CAAC;AAAA,mBAAI,OAAI,CAACvD,OAAL,CAAauD,CAAC,CAAC6D,IAAf,CAAJ;AAAA,WADhB,EAEKrF,IAFL,CAEU,OAFV,EAEmB,KAAKhC,OAAL,CAAayD,SAAb,EAFnB,EAGKzB,IAHL,CAGU,QAHV,EAGoB,KAAK/B,OAAL,CAAawD,SAAb,EAHpB,EAIKzB,IAJL,CAIU,MAJV,EAIkB,UAAAwB,CAAC,EAAI;AACf,gBAAI,OAAI,CAAC+E,IAAL,KAAc,OAAlB,EAA2B;AACvB,kBAAI,CAAC/E,CAAC,CAACyG,OAAP,EAAgB;AACZ,uBAAO,OAAI,CAACvF,WAAZ;AACH,eAFD,MAGK,IAAI,CAAClB,CAAC,CAAC0G,QAAP,EAAiB;AAClB,uBAAO,OAAI,CAACvF,WAAZ;AACH,eAFI,MAGA,IAAI,CAACnB,CAAC,CAAC2G,OAAP,EAAgB;AACjB,uBAAO,OAAI,CAACvF,WAAZ;AACH,eAFI,MAGA;AACD,uBAAO,OAAI,CAACJ,OAAL,CAAahB,CAAC,CAAC,OAAI,CAAC+E,IAAN,CAAd,CAAP;AACH;AACJ,aAbD,MAeK,IAAI,OAAI,CAACA,IAAL,KAAc,QAAlB,EAA4B;AAC7B,kBAAI,CAAC/E,CAAC,CAACyG,OAAP,EAAgB;AACZ,uBAAO,OAAI,CAACvF,WAAZ;AACH,eAFD,MAGK,IAAI,CAAClB,CAAC,CAAC0G,QAAP,EAAiB;AAClB,uBAAO,OAAI,CAACvF,WAAZ;AACH,eAFI,MAGA,IAAI,CAACnB,CAAC,CAAC4G,WAAP,EAAoB;AACrB,uBAAO,OAAI,CAACxF,WAAZ;AACH,eAFI,MAGA;AACD,uBAAO,OAAI,CAACJ,OAAL,CAAahB,CAAC,CAAC,OAAI,CAAC+E,IAAN,CAAd,CAAP;AACH;AACJ;AACJ,WAlCL,EAmCK7E,EAnCL,CAmCQ,WAnCR,EAmCqB,UAACF,CAAD,EAAI+D,CAAJ,EAAO8C,KAAP,EAAiB;AAC9B,gBAAMnE,IAAI,GAAGmE,KAAK,CAAC9C,CAAD,CAAL,CAAS+C,UAAT,CAAoBC,QAApB,CAA6BjL,GAA1C;AACA,gBAAMyI,KAAK,GAAG,CAAC,yCAASC,KAAT,GAAiB,EAAlB,EAAsB,yCAASC,KAAT,GAAiB,EAAvC,CAAd;;AACA,mBAAI,CAAC3H,UAAL,CAAgBkK,MAAhB,CAAuB;AAAEtE,kBAAI,EAAJA,IAAF;AAAQ9E,kBAAI,EAAEoC,CAAd;AAAiBuE,mBAAK,EAALA;AAAjB,aAAvB;AACH,WAvCL;AAwCH;;;0CAEiB;AAAA;;AACd,cAAM0C,KAAK,GAAG,KAAK/K,SAAL,CAAewD,MAAf,CAAsB,mBAAtB,EACTE,SADS,CACC,MADD,EAEThC,IAFS,CAEJ,KAAK7B,KAFD,EAGTsB,IAHS,CAGJ,MAHI,CAAd;;AAKA4J,eAAK,CACAzI,IADL,CACU,GADV,EACe,4CAAY0I,IAAZ,CAAiB,iDAAjB,EAAoC7C,IAApC,CAAyC,GAAzC,CADf,EAEK5F,KAFL,CAEW,gBAFX,EAE6B,MAF7B,EAGKA,KAHL,CAGW,QAHX,EAGqB,SAHrB,EAIKD,IAJL,CAIU,WAJV,EAIuB,UAAAwB,CAAC,EAAI;AACpB,mDAAgC,CAAC,OAAI,CAACxD,OAAL,CAAawD,CAAC,CAAClE,GAAf,CAAD,GAAuB,MAAM,OAAI,CAACU,OAAL,CAAayD,SAAb,EAA7D,QAA0F,CAA1F;AACH,WANL,EAOKC,EAPL,CAOQ,OAPR,EAOiB,UAAAF,CAAC,EAAI;AACd,mBAAI,CAACmF,iBAAL,GAAyB,OAAI,CAACA,iBAAL,KAA2BnF,CAAC,CAAClE,GAA7B,GAAmC,MAAnC,GAA4CkE,CAAC,CAAClE,GAAvE;;AACA,mBAAI,CAACgB,UAAL,CAAgBwI,KAAhB,CAAsB,OAAI,CAACH,iBAA3B;;AACA,mBAAI,CAACU,iBAAL;AACH,WAXL;AAYH;;;0CAEiB;AAAA;;AACd,cAAMoB,KAAK,GAAG,KAAK/K,SAAL,CAAewD,MAAf,CAAsB,mBAAtB,EACTE,SADS,CACC,MADD,EAEThC,IAFS,CAEJ,KAAK7B,KAAL,CAAW,CAAX,EAAc+E,KAFV,EAGTzD,IAHS,CAGJ,MAHI,CAAd;;AAKA4J,eAAK,CACAzI,IADL,CACU,GADV,EACe,4CAAY0I,IAAZ,CAAiB,+CAAjB,EAAkC7C,IAAlC,CAAuC,GAAvC,CADf,EAEK5F,KAFL,CAEW,gBAFX,EAE6B,MAF7B,EAGKA,KAHL,CAGW,QAHX,EAGqB,SAHrB,EAIKD,IAJL,CAIU,WAJV,EAIuB,UAAAwB,CAAC,EAAI;AACpB,uCAAoB,OAAI,CAAC7B,MAAL,GAAc,MAAM,OAAI,CAAChC,OAAL,CAAaE,KAArD,eACS,OAAI,CAACI,OAAL,CAAauD,CAAC,CAAC6D,IAAf,IAAuB,MAAM,OAAI,CAACpH,OAAL,CAAawD,SAAb,EADtC;AAGH,WARL,EASKC,EATL,CASQ,OATR,EASiB,KAAKiH,oBAAL,CAA0BjI,IAA1B,CAA+B,IAA/B,CATjB;AAUH;;;0CAEiB;AAAA;;AAEd,eAAKhD,SAAL,CAAewD,MAAf,CAAsB,UAAtB,EAAkCC,IAAlC,CAAuC,KAAKhD,MAA5C,EACKiD,SADL,CACe,MADf,EAEKlB,IAFL,CAEU,UAAAsB,CAAC,EAAI;AACP,gBAAIA,CAAC,CAACH,MAAF,GAAW,OAAI,CAACiF,YAApB,EAAkC;AAC9B,+BAAU9E,CAAC,CAACqG,SAAF,CAAY,CAAZ,EAAe,OAAI,CAACvB,YAAL,GAAoB,CAAnC,CAAV;AACH;;AACD,mBAAO9E,CAAP;AACH,WAPL,EAQKxB,IARL,CAQU,MARV,EAQkB,UAAAwB,CAAC,EAAI;AACf,gBAAIsG,OAAO,GAAG,OAAI,CAACvK,KAAL,CAAW,CAAX,EAAc+E,KAAd,CAAoByF,MAApB,CAA2B,UAAAnH,GAAG;AAAA,qBAAIA,GAAG,CAACyE,IAAJ,KAAa,OAAI,CAACqB,eAAtB;AAAA,aAA9B,CAAd;;AACAoB,mBAAO,GAAGA,OAAO,CAACzG,MAAR,GAAiB,CAAjB,GAAqByG,OAAO,CAAC,CAAD,CAAP,CAAWzC,IAAhC,GAAuC,EAAjD;AAEA,mBAAOyC,OAAO,KAAKtG,CAAZ,GAAgB,WAAhB,GAA8B,cAArC;AACH,WAbL,EAcKxB,IAdL,CAcU,aAdV,EAcyB,UAAAwB,CAAC,EAAI;AACtB,gBAAIsG,OAAO,GAAG,OAAI,CAACvK,KAAL,CAAW,CAAX,EAAc+E,KAAd,CAAoByF,MAApB,CAA2B,UAAAnH,GAAG;AAAA,qBAAIA,GAAG,CAACyE,IAAJ,KAAa,OAAI,CAACqB,eAAtB;AAAA,aAA9B,CAAd;;AACAoB,mBAAO,GAAGA,OAAO,CAACzG,MAAR,GAAiB,CAAjB,GAAqByG,OAAO,CAAC,CAAD,CAAP,CAAWzC,IAAhC,GAAuC,EAAjD;AAEA,mBAAOyC,OAAO,KAAKtG,CAAZ,GAAgB,MAAhB,GAAyB,QAAhC;AACH,WAnBL;AAoBH;;;0CAEiB;AAAA;;AACd,eAAK9D,SAAL,CAAewD,MAAf,CAAsB,UAAtB,EAAkCC,IAAlC,CAAuC,KAAKjD,MAA5C,EACKkD,SADL,CACe,MADf,EAEKpB,IAFL,CAEU,MAFV,EAEkB,UAAAwB,CAAC;AAAA,mBAAIA,CAAC,KAAK,OAAI,CAACiF,eAAX,GAA6B,SAA7B,GAAyC,cAA7C;AAAA,WAFnB,EAGKzG,IAHL,CAGU,aAHV,EAGyB,UAAAwB,CAAC;AAAA,mBAAIA,CAAC,KAAK,OAAI,CAACiF,eAAX,GAA6B,MAA7B,GAAsC,QAA1C;AAAA,WAH1B;AAIH;;;4CAEmB;AAAA;;AAChB,eAAK/I,SAAL,CAAewD,MAAf,CAAsB,mBAAtB,EACKE,SADL,CACe,MADf,EAEKpB,IAFL,CAEU,MAFV,EAEkB,UAAAwB,CAAC,EAAI;AACf,mBAAO,CAAC,OAAI,CAACmF,iBAAN,IAA2BnF,CAAC,CAAClE,GAAF,KAAU,OAAI,CAACqJ,iBAA1C,GAA8D,SAA9D,GAA0E,SAAjF;AACH,WAJL;AAKH;;;4CAEmB;AAAA;;AAChB,eAAKjJ,SAAL,CAAewD,MAAf,CAAsB,mBAAtB,EACKE,SADL,CACe,MADf,EAEKpB,IAFL,CAEU,MAFV,EAEkB,UAAAwB,CAAC,EAAI;AACf,mBAAO,OAAI,CAACoF,iBAAL,CAAuBxE,QAAvB,CAAgCZ,CAAC,CAAC6D,IAAlC,IAA0C,OAAI,CAACgB,OAAL,CAAa7E,CAAC,CAAC6D,IAAf,CAA1C,GAAiE,SAAxE;AACH,WAJL;AAKH;;;6CAEoB7D,C,EAAQ;AACzB,cAAMnF,EAAE,GAAG,KAAKuK,iBAAL,CAAuBgC,OAAvB,CAA+BpH,CAAC,CAAC6D,IAAjC,CAAX;;AAEA,cAAIhJ,EAAE,GAAG,CAAT,EAAY;AACR,iBAAKuK,iBAAL,CAAuBrD,IAAvB,CAA4B/B,CAAC,CAAC6D,IAA9B;AACH,WAFD,MAEO;AACH,iBAAKuB,iBAAL,CAAuBiC,MAAvB,CAA8BxM,EAA9B,EAAkC,CAAlC;AACH;;AAED,eAAKgK,OAAL,CAAarF,MAAb,CAAoB,KAAK4F,iBAAzB;;AAEA,eAAKtI,UAAL,CAAgByI,KAAhB,CAAsB,KAAKH,iBAA3B;;AACA,eAAKU,iBAAL;AACH;;;;;;;;;;;;;;;;;;;;;ACjYL;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;;;;ACOQ;;AACE;;AACF;;;;;;AAFyD;;AACvD;;AAAA;;;;;;AASF;;AACE;;AACF;;;;;;AAFyD;;AACvD;;AAAA;;;;;;AASF;;AACE;;AACF;;;;;;AAF0D;;AACxD;;AAAA;;;;;;AASF;;AACE;;AACF;;;;;;AAFsD;;AACpD;;AAAA;;;;QDzBGwB,e;;;AAIX,+BAAmBC,GAAnB,EAA2C3J,IAA3C,EAAqE7C,MAArE,EAAmGyM,KAAnG,EAAwH;AAAA;;AAArG,aAAAD,GAAA,GAAAA,GAAA;AAAwB,aAAA3J,IAAA,GAAAA,IAAA;AAA0B,aAAA7C,MAAA,GAAAA,MAAA;AAA8B,aAAAyM,KAAA,GAAAA,KAAA;AAH5F,aAAAC,YAAA,GAAe,IAAI,0DAAJ,CAAgB,MAAhB,CAAf;AACA,aAAAC,eAAA,GAAkB,IAAI,0DAAJ,CAAgB,EAAhB,CAAlB;AAEoH;;;;mCAEnH,CAAW;;;6CAEE7G,K,EAAO;AAC1B;AACA,eAAK9F,MAAL,CAAY4M,GAAZ,CAAgBC,eAAhB,CAAgCzM,IAAhC,CAAqC,EAArC,EAF0B,CAG1B;;AACA,cAAM0M,MAAM,GAAG,KAAKjK,IAAL,CAAUkK,IAAV,CAAeD,MAA9B;AACA,cAAIE,OAAO,GAAGF,MAAM,CACftB,MADS,CACF,UAAAyB,GAAG;AAAA,mBAAIA,GAAG,KAAK,SAAZ;AAAA,WADD,EAETC,MAFS,CAEF,UAACC,IAAD,EAAOpM,GAAP;AAAA,mBAAgB,MAAD,OAAC,CAAD,kBAAKoM,IAAL,CAAC,sBAAWpM,GAAX,EAAiBqM,SAAjB,EAAhB;AAAA,WAFE,EAE4C,EAF5C,CAAd;AAIA,cAAMC,QAAQ,GAAG,KAAKZ,KAAL,CAAWa,wBAA5B;AACA,eAAKb,KAAL,CAAWa,wBAAX,GAAsCC,MAAM,CAACC,MAAP,CAAcH,QAAd,EAAwBL,OAAxB,CAAtC,CAV0B,CAY1B;;AACA,eAAKP,KAAL,CAAWgB,sBAAX,GAAoC,EAApC;AACA,eAAK5K,IAAL,CAAU6K,OAAV,GAAoB,EAApB,CAd0B,CAgB1B;;AACA,cAAMC,OAAO,GAAG;AAACA,mBAAO,EAAE7H,KAAK,CAACC;AAAhB,WAAhB,CAjB0B,CAkB1B;;AACA,eAAK/F,MAAL,CAAY4N,MAAZ,CAAmBC,oBAAnB,CAAwCzN,IAAxC,CAA6CuN,OAA7C;AACD;;;8CAEqB7H,K,EAAO;AAC3B;AACA,eAAK9F,MAAL,CAAY4M,GAAZ,CAAgBC,eAAhB,CAAgCzM,IAAhC,CAAqC,EAArC,EAF2B,CAI3B;;AACA,cAAM0M,MAAM,GAAG,KAAKjK,IAAL,CAAUkK,IAAV,CAAeD,MAA9B;AACA,cAAIE,OAAO,GAAGF,MAAM,CACftB,MADS,CACF,UAAAyB,GAAG;AAAA,mBAAIA,GAAG,KAAK,SAAZ;AAAA,WADD,EAETC,MAFS,CAEF,UAACC,IAAD,EAAOpM,GAAP;AAAA,mBAAgB,MAAD,OAAC,CAAD,kBAAKoM,IAAL,CAAC,sBAAWpM,GAAX,EAAiBqM,SAAjB,EAAhB;AAAA,WAFE,EAE4C,EAF5C,CAAd;AAIA,cAAMC,QAAQ,GAAG,KAAKZ,KAAL,CAAWa,wBAA5B;AACA,eAAKb,KAAL,CAAWa,wBAAX,GAAsCC,MAAM,CAACC,MAAP,CAAcH,QAAd,EAAwBL,OAAxB,CAAtC,CAX2B,CAa3B;;AACA,eAAKP,KAAL,CAAWgB,sBAAX,GAAoC,EAApC;AACA,eAAK5K,IAAL,CAAU6K,OAAV,GAAoB,EAApB,CAf2B,CAiB3B;;AACA,cAAMI,OAAO,GAAG;AAACA,mBAAO,EAAEhI,KAAK,CAACC;AAAhB,WAAhB,CAlB2B,CAmB3B;;AACA,eAAK/F,MAAL,CAAY4N,MAAZ,CAAmBG,oBAAnB,CAAwC3N,IAAxC,CAA6C0N,OAA7C;AACD;;;gDAEuBhI,K,EAAO;AAC7B;AACA,eAAK9F,MAAL,CAAY4M,GAAZ,CAAgBC,eAAhB,CAAgCzM,IAAhC,CAAqC,EAArC,EAF6B,CAI7B;;AACA,cAAM0M,MAAM,GAAG,KAAKjK,IAAL,CAAUkK,IAAV,CAAeD,MAA9B;AACA,cAAIE,OAAO,GAAGF,MAAM,CACftB,MADS,CACF,UAAAyB,GAAG;AAAA,mBAAIA,GAAG,KAAK,SAAZ;AAAA,WADD,EAETC,MAFS,CAEF,UAACC,IAAD,EAAOpM,GAAP;AAAA,mBAAgB,MAAD,OAAC,CAAD,kBAAKoM,IAAL,CAAC,sBAAWpM,GAAX,EAAiBqM,SAAjB,EAAhB;AAAA,WAFE,EAE4C,EAF5C,CAAd;AAIA,cAAMC,QAAQ,GAAG,KAAKZ,KAAL,CAAWa,wBAA5B;AACA,eAAKb,KAAL,CAAWa,wBAAX,GAAsCC,MAAM,CAACC,MAAP,CAAcH,QAAd,EAAwBL,OAAxB,CAAtC,CAX6B,CAa7B;;AACA,eAAKP,KAAL,CAAWgB,sBAAX,GAAoC,EAApC;AACA,eAAK5K,IAAL,CAAU6K,OAAV,GAAoB,EAApB,CAf6B,CAiB7B;;AACA,cAAMM,UAAU,GAAG;AAACA,sBAAU,EAAElI,KAAK,CAACC;AAAnB,WAAnB,CAlB6B,CAmB7B;;AACA,eAAK/F,MAAL,CAAY4N,MAAZ,CAAmBK,uBAAnB,CAA2C7N,IAA3C,CAAgD4N,UAAhD;AAED;;;6CAEoBlI,K,EAAO;AAC1B;AACA,cAAM2E,IAAI,GAAG;AAACA,gBAAI,EAAE3E,KAAK,CAACC;AAAb,WAAb,CAF0B,CAI1B;;AACA,eAAK/F,MAAL,CAAY4N,MAAZ,CAAmBM,iBAAnB,CAAqC9N,IAArC,CAA0CqK,IAA1C;AACD;;;;;;;uBAnFU8B,e,EAAe,wI,EAAA,0I,EAAA,8I,EAAA,4I;AAAA,K;;;YAAfA,e;AAAe,iC;AAAA,e;AAAA,c;AAAA,iK;AAAA;AAAA;ACb5B;;AAEE;;AACE;;AACE;;AAAW;;AAAO;;AAClB;;AACE;AAAA,mBAAmB,gCAAnB;AAAoD,WAApD;;AACA;;AAGF;;AACF;;AAEA;;AACE;;AAAW;;AAAQ;;AACnB;;AACE;AAAA,mBAAmB,iCAAnB;AAAqD,WAArD;;AACA;;AAGF;;AACF;;AAEA;;AACE;;AAAW;;AAAU;;AACrB;;AACE;AAAA,mBAAmB,mCAAnB;AAAuD,WAAvD;;AACA;;AAGF;;AACF;;AAEA;;AACE;;AAAW;;AAAQ;;AACnB;;AACE;AAAA,mBAAmB,gCAAnB;AAAoD,WAApD;;AACA;;AAGF;;AACF;;AACF;;AAEF;;;;AA5CgC,iHAAmD,SAAnD,EAAmD,kCAAnD;;AAER;;AAAA;;AACJ;;AAAA;;AAEF;;AAAA;;AAEE;;AAAA;;AAMA;;AAAA;;AAEF;;AAAA;;AAEE;;AAAA;;AAMA;;AAAA;;AAEF;;AAAA;;AAEE;;AAAA;;AAMA;;AAAA;;AAEF;;AAAA;;AAEE;;AAAA;;;;;;;;;sEDxBPA,e,EAAe;cAL3B,uDAK2B;eALjB;AACTlM,kBAAQ,EAAE,YADD;AAETC,qBAAW,EAAE,yBAFJ;AAGT6N,mBAAS,EAAE,CAAC,wBAAD;AAHF,S;AAKiB,Q;;;;;;;;;;;;;;;;;;;;;;;;;;;;AEb5B;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;;;;;;ACa4B;;AACI;;AACJ;;;;;;AAFsD;;AAClD;;AAAA;;;;;;AAUJ;;AACI;;AACJ;;;;;;AAF2D;;AACvD;;AAAA;;;;;;;;AANZ;;AAEI;;AAAW;;AAAU;;AACrB;;AACI;AAAA;;AAAA;;AAAA;;AAAA;AAAA;;AACA;;AAGJ;;AACJ;;;;;;;;AATgB;;AAGA;;AAAA;;AAEI;;AAAA;;;;;;;;AApBhC;;AACI;;AACI;;AAAkC;;AAAY;;AAC9C;;AAEI;;AACI;;AAAW;;AAAU;;AACrB;;AACI;AAAA;;AAAA;;AAAA;;AAAA;AAAA;;AACA;;AAGJ;;AACJ;;AAEA;;AAWJ;;AAEA;;AAEA;;AAAwB;AAAA;;AAAA;;AAAA;;AAAA;AAAA;;AACpB;;AAA2B;;AAAM;;AACrC;;AACJ;;AACA;;AACJ;;;;;;;;AAjC0C;;AAAA;;AACZ;;AAAA;;AAEF;;AAAA;;AAEA;;AAAA;;AAEI;;AAAA;;AAOhB;;AAAA;;AAeM;;AAAA;;;;QDnBjBC,e;;;AAQX,+BAAmB5B,GAAnB,EAA2C3J,IAA3C,EAAqE7C,MAArE,EAAmGyM,KAAnG,EAAwH;AAAA;;AAArG,aAAAD,GAAA,GAAAA,GAAA;AAAwB,aAAA3J,IAAA,GAAAA,IAAA;AAA0B,aAAA7C,MAAA,GAAAA,MAAA;AAA8B,aAAAyM,KAAA,GAAAA,KAAA;AAP5F,aAAAC,YAAA,GAAe,IAAI,0DAAJ,CAAgB,MAAhB,CAAf;AACA,aAAAC,eAAA,GAAkB,IAAI,0DAAJ,CAAgB,EAAhB,CAAlB;AACA,aAAA0B,SAAA,GAAY,EAAZ;AAGC,aAAAC,QAAA,GAAgB,EAAhB;AAEkH;;;;mCAElH;AACN,eAAKC,mBAAL;AACD;;;0CAEc;AACb,eAAKC,YAAL,CAAkBC,OAAlB,CAA0BC,SAA1B,CAAoC,KAAKC,aAAL,CAAmBxK,IAAnB,CAAwB,IAAxB,CAApC;AACD;;;8CAEqB;AACpB,eAAKnE,MAAL,CAAY6C,IAAZ,CAAiB+L,aAAjB,CAA+BF,SAA/B,CAAyC,KAAKC,aAAL,CAAmBxK,IAAnB,CAAwB,IAAxB,CAAzC;AACD;;;sCAEa0K,S,EAAoB;AAAA;;AAChC,cAAMlP,IAAI,GAAG4N,MAAM,CAAC5N,IAAP,CAAY,KAAKkD,IAAL,CAAU6K,OAAtB,CAAb;;AAEA,eAAKc,YAAL,CAAkBhG,OAAlB,CAA0B,UAAChG,EAAD,EAAKsM,KAAL,EAAe;AACvC,gBAAM/N,GAAG,GAAGpB,IAAI,CAACmP,KAAD,CAAhB;;AACA,gBAAI,CAAC/N,GAAL,EAAU;AAAE;AAAS;;AAErB,gBAAMgO,GAAG,GAAGvM,EAAE,CAACwM,aAAf;AACA,gBAAMC,GAAG,GAAG;AACVnM,mBAAK,EAAE,OAAI,CAACoM,YAAL,CAAkB/K,IAAlB,CAAuB,OAAvB;AADG,aAAZ;AAIA,gBAAMgL,IAAI,GAAG,IAAI,sDAAJ,CAAQJ,GAAR,EAAaE,GAAb,EAAkBlO,GAAlB,CAAb;AACA,mBAAI,CAACuN,QAAL,CAAcvN,GAAd,IAAqBoO,IAArB;AAEA,gBAAMvL,KAAK,GAAGiL,SAAS,GAAG,OAAI,CAACpC,KAAL,CAAWgB,sBAAX,CAAkC1M,GAAlC,EAAuC6C,KAAvC,IAAgD,EAAnD,GAAwD,EAA/E;;AAEA,gBAAM9D,EAAE,GAAG,OAAI,CAAC+C,IAAL,CAAU6K,OAAV,CAAkB3M,GAAlB,EAAuBqO,SAAvB,CAAiC,UAAC/K,GAAD,EAAS;AACnD,qBAAOA,GAAG,CAACC,GAAJ,KAAY,OAAnB;AACD,aAFU,CAAX;;AAGA,gBAAIxE,EAAE,IAAE,CAAR,EAAW;AACT,qBAAI,CAAC+C,IAAL,CAAU6K,OAAV,CAAkB3M,GAAlB,EAAuBuL,MAAvB,CAA8BxM,EAA9B,EAAkC,CAAlC;AACD;;AAED,gBAAM+C,IAAI,GAAG,OAAI,CAACA,IAAL,CAAU6K,OAAV,CAAkB3M,GAAlB,EAAuByK,MAAvB,CAA8B,UAACnH,GAAD,EAAS;AAClD,qBAAOA,GAAG,CAACG,KAAJ,GAAY,CAAnB;AACD,aAFY,CAAb,CArBuC,CAyBvC;;;AACA,mBAAI,CAAC8J,QAAL,CAAcvN,GAAd,EAAmBsO,OAAnB,CAA2BxM,IAA3B,EAAiCe,KAAjC;;AACA,mBAAI,CAAC0K,QAAL,CAAcvN,GAAd,EAAmBoC,MAAnB;AACD,WA5BD;AA6BD,S,CAED;;;;oCAEY;AACV,cAAMsJ,KAAK,GAAG;AACZ1L,eAAG,EAAE,KAAK0L,KAAL,CAAW6C,eADJ;AAEZC,kBAAM,EAAE;AACN5B,qBAAO,EAAE,KAAKlB,KAAL,CAAW+C,sBAAX,CAAkC7B,OADrC;AAEN8B,uBAAS,EAAE,MAFL;AAGNC,sBAAQ,EAAE;AAHJ;AAFI,WAAd;AASA,eAAKC,YAAL,CAAkBlD,KAAK,CAAC1L,GAAxB;AACA,eAAKf,MAAL,CAAY0N,OAAZ,CAAoBkC,OAApB,CAA4BxP,IAA5B,CAAiCqM,KAAjC;AACD;;;qCAEY1L,G,EAAK;AAChB,cAAI,KAAKsN,SAAL,KAAmB,EAAvB,EAA2B;AACvB,iBAAKA,SAAL,aAAoBtN,GAApB;AACH,WAFD,MAGK;AACD,iBAAKsN,SAAL,mBAA0BtN,GAA1B;AACH;AACF;;;wCAEe;AACd,eAAK0L,KAAL,CAAW+C,sBAAX,CAAkCnB,SAAlC,GAA8C,KAAKA,SAAnD;AACA,eAAKrO,MAAL,CAAY0N,OAAZ,CAAoBmC,aAApB,CAAkCzP,IAAlC;AACD,S,CAED;;;;kCAEUW,G,EAAa;AACrB,cAAM0L,KAAK,GAAG;AACZ1L,eAAG,EAAEA,GADO;AAEZwO,kBAAM,EAAE;AAFI,WAAd;AAKA,eAAKO,YAAL,CAAkB/O,GAAlB;AACA,eAAKf,MAAL,CAAY0N,OAAZ,CAAoBkC,OAApB,CAA4BxP,IAA5B,CAAiCqM,KAAjC;AACD;;;qCAEY1L,G,EAAK;AAChB,cAAIoB,KAAK,GAAG,KAAKkM,SAAL,CAAejM,KAAf,CAAqB,GAArB,CAAZ;AAEA,cAAItC,EAAE,GAAGqC,KAAK,CAACkK,OAAN,CAActL,GAAd,CAAT;;AACA,cAAIjB,EAAE,KAAK,CAAX,EAAc;AACVqC,iBAAK,CAACmK,MAAN,CAAaxM,EAAb,EAAiB,CAAjB;AACH,WAFD,MAGK;AACDqC,iBAAK,CAACmK,MAAN,CAAaxM,EAAE,GAAC,CAAhB,EAAmB,CAAnB;AACH;;AAED,eAAKuO,SAAL,GAAiBlM,KAAK,CAACG,IAAN,CAAW,GAAX,CAAjB;AACD;;;+CAGsBvB,G,EAAK+E,K,EAAO;AACjC,cAAM2G,KAAK,GAAG;AACZ1L,eAAG,EAAHA,GADY;AAEZwO,kBAAM,EAAE;AACNE,uBAAS,EAAE3J,KAAK,CAACC,KADX;AAEN2J,sBAAQ,EAAE,KAAK7M,IAAL,CAAUkK,IAAV,CAAegD,UAAf,CAA0BjK,KAAK,CAACC,KAAhC,EAAuCiK,UAAvC,CAAkD,CAAlD;AAFJ;AAFI,WAAd;AAOA,eAAKhQ,MAAL,CAAY0N,OAAZ,CAAoBkC,OAApB,CAA4BxP,IAA5B,CAAiCqM,KAAjC;AACD;;;wCAEe;AAAA;;AACd,cAAMwD,QAAQ,GAAG1C,MAAM,CAAC5N,IAAP,CAAY,KAAKkD,IAAL,CAAUkK,IAAV,CAAegD,UAA3B,EAAuCvE,MAAvC,CAA8C,UAAAzK,GAAG,EAAI;AACpE,gBAAMsD,GAAG,GAAG,OAAI,CAACxB,IAAL,CAAUkK,IAAV,CAAegD,UAAf,CAA0BhP,GAA1B,CAAZ;AACA,mBAAOsD,GAAG,CAAC6L,eAAX;AACD,WAHgB,CAAjB;AAKA,iBAAOD,QAAP;AACD;;;8CAEqBlP,G,EAAK+E,K,EAAO;AAChC,cAAM2G,KAAK,GAAG;AACZ1L,eAAG,EAAHA,GADY;AAEZwO,kBAAM,EAAE;AAAEG,sBAAQ,EAAE5J,KAAK,CAACC;AAAlB;AAFI,WAAd;AAIA,eAAK/F,MAAL,CAAY0N,OAAZ,CAAoBkC,OAApB,CAA4BxP,IAA5B,CAAiCqM,KAAjC;AACD;;;oCAEW1L,G,EAAK;AACf,cAAM0C,IAAI,GAAG,KAAKgJ,KAAL,CAAWgB,sBAAX,CAAkC1M,GAAlC,EAAuC0O,SAApD;;AAEA,cAAI,KAAKhD,KAAL,CAAWgB,sBAAX,CAAkC1M,GAAlC,EAAuC0O,SAA3C,EAAsD;AACpD,mBAAO,KAAK5M,IAAL,CAAUkK,IAAV,CAAegD,UAAf,CAA0BtM,IAA1B,EAAgCuM,UAAvC;AACD;;AACD,iBAAO,EAAP;AACD,S,CAED;;;;qCAEajP,G,EAAK+E,K,EAAO;AACvB,cAAM2G,KAAK,GAAG;AACZ1L,eAAG,EAAHA,GADY;AAEZwO,kBAAM,EAAE;AAAE3L,mBAAK,EAAEkC,KAAK,CAACC;AAAf;AAFI,WAAd;AAIA,eAAK/F,MAAL,CAAY0N,OAAZ,CAAoByC,OAApB,CAA4B/P,IAA5B,CAAiCqM,KAAjC;AACD;;;;;;;uBA9JU2B,e,EAAe,wI,EAAA,0I,EAAA,8I,EAAA,4I;AAAA,K;;;YAAfA,e;AAAe,iC;AAAA;AAAA;;;;;;;;;;;;;;;AChB5B;;AAGI;;AACI;;;;AAoCJ;;AAEA;;AACI;;AAAwB;AAAA,mBAAS,eAAT;AAAyB,WAAzB;;AACpB;;AAA8B;;AAAU;;AAC5C;;AAEA;;AAA8D;;AAAmB;;AACjF;;AAAiE;AAAA;AAAA;;AAAjE;;AAEA;;AAEA;;AAAwB;AAAA,mBAAS,mBAAT;AAA6B,WAA7B;;AACpB;;AAA8B;;AAAkB;;AACpD;;AACJ;;AACJ;;;;AAxD6B,2IAA8E,SAA9E,EAA8E,4DAA9E;;AAIhB;;AAAA;;AAwCS;;AAAA;;AAImD;;AAAA;;AAKnD;;AAAA;;;;;;;;;;sEDrCTA,e,EAAe;cAL3B,uDAK2B;eALjB;AACT/N,kBAAQ,EAAE,YADD;AAETC,qBAAW,EAAE,yBAFJ;AAGT6N,mBAAS,EAAE,CAAC,wBAAD;AAHF,S;AAKiB,Q;;;;;;;;;;;;gBAKzB,0D;iBAAa,Q;;;;;;;;;;;;;;;;;;;;AErBhB;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;;;;;;;;QAYaiC,e;;;AAEX,+BAAmB5D,GAAnB,EAA2C3J,IAA3C,EAAqE7C,MAArE,EAAmGyM,KAAnG,EAAwH;AAAA;;AAArG,aAAAD,GAAA,GAAAA,GAAA;AAAwB,aAAA3J,IAAA,GAAAA,IAAA;AAA0B,aAAA7C,MAAA,GAAAA,MAAA;AAA8B,aAAAyM,KAAA,GAAAA,KAAA;AAAwB;;;;mCAEnH,CAAW;;;sCAEL4D,K,EAAe;AAE3B,cAAM5D,KAAK,GAAG;AACZ6D,wBAAY,EAAE,KADF;AAEZC,uBAAW,EAAE,KAAK9D,KAAL,CAAW8D,WAAX,KAA2BF,KAA3B,GAAmC,EAAnC,GAAwCA;AAFzC,WAAd;AAKA,eAAKrQ,MAAL,CAAYwQ,MAAZ,CAAmBC,kBAAnB,CAAsCrQ,IAAtC,CAA2CqM,KAA3C;AACD;;;;;;;uBAdU2D,e,EAAe,wI,EAAA,0I,EAAA,8I,EAAA,4I;AAAA,K;;;YAAfA,e;AAAe,iC;AAAA,c;AAAA,a;AAAA,iH;AAAA;AAAA;ACZ5B;;AAEE;;AAAgC;AAAA,mBAAS,kBAAmB,MAAnB,CAAT;AAAmC,WAAnC;;AAC9B;;AAA2E;;AAAW;;AACtF;;AAAiC;;AAAI;;AACvC;;AAGF;;;;AAR4B,iHAAmD,SAAnD,EAAmD,kCAAnD;;AAGd;;AAAA;;AACL;;AAAA;;;;;;;;;sEDQIA,e,EAAe;cAL3B,uDAK2B;eALjB;AACT/P,kBAAQ,EAAE,YADD;AAETC,qBAAW,EAAE,yBAFJ;AAGT6N,mBAAS,EAAE,CAAC,wBAAD;AAHF,S;AAKiB,Q;;;;;;;;;;;;;;;;;;;;;;;;;;;;AEZ5B;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;;;;;;;ACaM;;AACE;;AAAU;;AAAoB;;AAC9B;;AAAoB;;;;AAA+I;;AACrK;;;;;;AADsB;;AAAA;;;;;;AAGtB;;AACE;;AAAU;;AAAoB;;AAC9B;;AAAoB;;AAA6C;;AACnE;;;;;;AADsB;;AAAA;;;;;;AAmBtB;;AACE;;AAAU;;AAAoB;;AAC9B;;AAAoB;;AAA6D;;AACnF;;;;;;AADsB;;AAAA;;;;;;AA4BtB;;AACE;;AAAU;;AAAoB;;AAC9B;;AAAoB;;AAA6D;;AACnF;;;;;;AADsB;;AAAA;;;;QD1DfuC,e;;;AAQX,+BAAmB7N,IAAnB,EAA6C7C,MAA7C,EAA4EyM,KAA5E,EAAiG;AAAA;;AAA9E,aAAA5J,IAAA,GAAAA,IAAA;AAA0B,aAAA7C,MAAA,GAAAA,MAAA;AAA+B,aAAAyM,KAAA,GAAAA,KAAA;AAAwB;;;;mCAE5F;AACN,eAAK8B,mBAAL;AACA,eAAKoC,YAAL,GAAoB,IAAI,wDAAJ,CAAS,KAAKC,eAAL,CAAqB5B,aAA9B,CAApB;AACA,eAAK6B,YAAL,GAAoB,IAAI,wDAAJ,CAAS,KAAKC,eAAL,CAAqB9B,aAA9B,CAApB;AACD;;;8CAEqB;AACpB,eAAKhP,MAAL,CAAY6C,IAAZ,CAAiBkO,eAAjB,CAAiCrC,SAAjC,CAA2C,KAAKsC,QAAL,CAAc7M,IAAd,CAAmB,IAAnB,EAAyB,KAAzB,CAA3C;AAEA,eAAKnE,MAAL,CAAY6C,IAAZ,CAAiBoO,4BAAjB,CAA8CvC,SAA9C,CAAwD,KAAKsC,QAAL,CAAc7M,IAAd,CAAmB,IAAnB,EAAyB,KAAzB,CAAxD;AACA,eAAKnE,MAAL,CAAY6C,IAAZ,CAAiBqO,iBAAjB,CAAmCxC,SAAnC,CAA6C,KAAKsC,QAAL,CAAc7M,IAAd,CAAmB,IAAnB,EAAyB,KAAzB,CAA7C;AACD;;;iCAEQgN,U,EAAY;AACnB,cAAM1G,IAAI,GAAG0G,UAAU,KAAK,KAAf,GAAuB,KAAK1E,KAAL,CAAW2E,uBAAX,CAAmC3G,IAA1D,GAAiE,KAAKgC,KAAL,CAAW+C,sBAAX,CAAkC/E,IAAhH,CADmB,CAGnB;;AACA,cAAI/D,MAAM,GAAG,EAAb;;AACA,cAAI+D,IAAI,KAAK,OAAb,EAAsB;AACpB/D,kBAAM,GAAG,CAAC,CAAC,KAAK7D,IAAL,CAAUwO,OAAV,CAAkB1I,GAAlB,CAAsB1B,OAAtB,CAA8B,CAA9B,CAAF,EAAoC,CAAC,KAAKpE,IAAL,CAAUwO,OAAV,CAAkBzI,GAAlB,CAAsB3B,OAAtB,CAA8B,CAA9B,CAArC,CAAT;AACD,WAFD,MAEO;AACLP,kBAAM,GAAG,CAAC,CAAC,KAAK7D,IAAL,CAAUwO,OAAV,CAAkBC,SAAlB,CAA4BrK,OAA5B,CAAoC,CAApC,CAAF,EAA0C,CAAC,KAAKpE,IAAL,CAAUwO,OAAV,CAAkBE,SAAlB,CAA4BtK,OAA5B,CAAoC,CAApC,CAA3C,CAAT;AACD;;AAED,cAAIkK,UAAU,KAAK,KAAnB,EAA0B;AACxB,iBAAKR,YAAL,CAAkBtB,OAAlB,CAA0B3I,MAA1B;;AACA,iBAAKiK,YAAL,CAAkBxN,MAAlB;AACD,WAHD,MAGO;AACL,iBAAK0N,YAAL,CAAkBxB,OAAlB,CAA0B3I,MAA1B;;AACA,iBAAKmK,YAAL,CAAkB1N,MAAlB;AACD;AACF;;;qCAEY;AACT,eAAKsJ,KAAL,CAAW+C,sBAAX,CAAkCgC,eAAlC,GAAoD,CAAC,KAAK/E,KAAL,CAAW+C,sBAAX,CAAkCgC,eAAvF;AACA,eAAKxR,MAAL,CAAYyM,KAAZ,CAAkBgF,iBAAlB,CAAoCrR,IAApC;AACD;;;;;;;uBA9CQsQ,e,EAAe,0I,EAAA,8I,EAAA,4I;AAAA,K;;;YAAfA,e;AAAe,iC;AAAA;AAAA;;;;;;;;;;;;;;;;;;ACb5B;;AAEE;;AACE;;AACE;;AACE;;AAAoB;;AAA4C;;AAClE;;AAEA;;AACE;;AAAU;;AAAoB;;AAC9B;;AAAoB;;AAA6C;;AACnE;;AAEA;;AAKA;;AAKA;;AAEA;;AAA6C;AAAA,mBAAU,gBAAV;AAA2B,WAA3B;;AAA8B;;AAAU;;AACvF;;AACF;;AACA;;AACE;;AACE;;AACE;;AAAoB;;AAAG;;AACzB;;AAEA;;AACE;;AAAU;;AAAoB;;AAC9B;;AAAoB;;AAA8D;;AACpF;;AAEA;;AAKA;;AACE;;AAAU;;AAAoB;;AAC9B;;AAAoB;;AAA2D;;AACjF;;AAEA;;AACE;;AAAU;;AAAoB;;AAC9B;;AAAoB;;AAAyD;;AAC/E;;AACF;;AACA;;AACF;;AAGA;;AACE;;AACE;;AACE;;AAAoB;;AAAG;;AACzB;;AAEA;;AACE;;AAAU;;AAAoB;;AAC9B;;AAAoB;;AAA8D;;AACpF;;AAEA;;AAKA;;AACE;;AAAU;;AAAoB;;AAC9B;;AAAoB;;AAA2D;;AACjF;;AAEA;;AACE;;AAAU;;AAAoB;;AAC9B;;AAAoB;;AAAwD;;AAC9E;;AACF;;AACA;;AACF;;AAEF;;;;AAvFiC,iHAAmD,SAAnD,EAAmD,kCAAnD;;AAKL;;AAAA;;AAKA;;AAAA;;AAGA;;AAAA;;AAKA;;AAAA;;AAOM;;AAAA;;AAWN;;AAAA;;AAGA;;AAAA;;AAOA;;AAAA;;AAKA;;AAAA;;AAeA;;AAAA;;AAGA;;AAAA;;AAOA;;AAAA;;AAKA;;AAAA;;;;;;;;;;sEDpEfA,e,EAAe;cAL3B,uDAK2B;eALjB;AACTrQ,kBAAQ,EAAE,YADD;AAETC,qBAAW,EAAE,yBAFJ;AAGT6N,mBAAS,EAAE,CAAC,wBAAD;AAHF,S;AAKiB,Q;;;;;;;;;;gBAEzB,uD;iBAAU,a,EAAe;AAACuD,kBAAM,EAAE;AAAT,W;;;gBAGzB,uD;iBAAU,a,EAAe;AAACA,kBAAM,EAAE;AAAT,W;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;4CElB5B;AAGA;;;;;QAcaC,Y;;;AAMX;AACA,4BAAmBnF,GAAnB,EAA2C3J,IAA3C,EAAqE7C,MAArE,EAAmGyM,KAAnG,EAAwH;AAAA;;AAArG,aAAAD,GAAA,GAAAA,GAAA;AAAwB,aAAA3J,IAAA,GAAAA,IAAA;AAA0B,aAAA7C,MAAA,GAAAA,MAAA;AAA8B,aAAAyM,KAAA,GAAAA,KAAA,CAAqB,CAJxH;;AACU,aAAAmF,QAAA,GAAoB,IAApB;AAGiH,O,CAE3H;;;;;mCACiB;;;;;;;;;AACf;AACM9Q,6B,GAAY;AAChB0I,2BAAK,EAAE;AAAEqI,iCAAS,EAAE,KAAKC,aAAL,CAAmB3N,IAAnB,CAAwB,IAAxB;AAAb,uBADS;AAEhBpD,yBAAG,EAAE;AAFW,qB,EAKlB;;AACA,yBAAK6Q,QAAL,GAAiB,IAAI,+DAAJ,CAAY,KAAKG,OAAL,CAAa/C,aAAzB,EAAwClO,SAAxC,CAAjB;;AACA,2BAAM,KAAK8Q,QAAL,CAAcI,UAAd,CAAyB,YAAzB,CAAN;;;AAEA;AACA,yBAAKzD,mBAAL;AACA,yBAAK0D,oBAAL,G,CAEA;;AACA,yBAAKjS,MAAL,CAAYuC,GAAZ,CAAgBpC,WAAhB,CAA4BC,IAA5B;;;;;;;;;AACD,S,CAED;;;;+CACuB;AACrB,eAAKJ,MAAL,CAAYyM,KAAZ,CAAkByF,sBAAlB,CAAyCxD,SAAzC,CAAmD,KAAKyD,wBAAL,CAA8BhO,IAA9B,CAAmC,IAAnC,CAAnD;AACA,eAAKnE,MAAL,CAAYyM,KAAZ,CAAkBgE,kBAAlB,CAAqC/B,SAArC,CAA+C,KAAK0D,aAAL,CAAmBjO,IAAnB,CAAwB,IAAxB,CAA/C;AACD,S,CAGD;;;;8CACsB;AACpB,eAAKnE,MAAL,CAAY6C,IAAZ,CAAiBoO,4BAAjB,CAA8CvC,SAA9C,CAAwD,KAAK2D,4BAAL,CAAkClO,IAAlC,CAAuC,IAAvC,CAAxD;AACA,eAAKnE,MAAL,CAAY6C,IAAZ,CAAiBqO,iBAAjB,CAAmCxC,SAAnC,CAA6C,KAAK4D,oBAAL,CAA0BnO,IAA1B,CAA+B,IAA/B,CAA7C;AACD;;;uDAEoC;;;;;;;;;AACnC,2BAAM,KAAKoO,iBAAL,EAAN;;;;AACA,2BAAM,KAAKD,oBAAL,EAAN;;;;AAEA,2BAAM,KAAKF,aAAL,EAAN;;;;;;;;;AACD;;;wCAEqB;;;;;;;;;AACpB;AACA,yBAAKR,QAAL,CAAcY,QAAd,CAAuB,MAAvB,E,CAEA;;;AACM5E,0B,GAAS;AAAC6E,gCAAU,EAAE,KAAb;AAAoBC,6BAAO,EAAE,KAAKjG,KAAL,CAAW8D,WAAX,KAA2B;AAAxD,qB,EAEf;;;AACA,2BAAM,KAAKqB,QAAL,CAAce,QAAd,CAAuB,OAAvB,EAAgC,MAAhC,EAAwC,KAAK9P,IAAL,CAAU2N,MAAV,CAAiB,MAAjB,CAAxC,EAAkE5C,MAAlE,CAAN;;;;;;;;;AACD,S,CAED;;;;4CAC0B;;;;;;;;;AACxB;AACA,yBAAKgE,QAAL,CAAcY,QAAd,CAAuB,OAAvB,E,CAEA;;;AACM5E,0B,GAAS;AAAC6E,gCAAU,EAAE;AAAb,qB,EAEf;;;AACA,2BAAM,KAAKb,QAAL,CAAce,QAAd,CAAuB,SAAvB,EAAkC,OAAlC,EAA2C,KAAK9P,IAAL,CAAU+P,QAArD,EAA+DhF,MAA/D,CAAN;;;;;;;;;AACD,S,CAED;;;;+CAC6B;;;;;;;;;;AACrBnD,wB,GAAO,KAAKgC,KAAL,CAAW+C,sBAAX,CAAkC/E,I;AACzC9C,wB,GAAO,KAAK8E,KAAL,CAAWa,wBAAX,CAAoC3F,I;;wBAC5CA,I;;;;;;;;AAECkL,yB,GAAQ,KAAKhQ,IAAL,CAAU+P,QAAV,CAAmBE,Q;AAE3B/L,0B,GAAS,KAAKlE,IAAL,CAAUwO,OAAV,CAAkB1J,IAAlB,EAAwB6D,MAAxB,CAA+B,UAAAnH,GAAG;AAAA,6BAAIA,GAAG,CAACqH,OAAR;AAAA,qBAAlC,C;AACf3E,0BAAM,CAAC2D,IAAP,CAAY,UAACqI,CAAD,EAAIC,CAAJ;AAAA,6BAAUD,CAAC,CAACjK,IAAF,GAASkK,CAAC,CAAClK,IAAX,GAAkB,CAAlB,GAAsB,CAAC,CAAjC;AAAA,qBAAZ;AAEMmK,wB,GAAO,E;;2CACJC,G;AACP,0BAAM1O,KAAK,GAAGqO,KAAK,CAACK,GAAD,CAAL,CAAWN,QAAX,CAAoB9N,MAAlC;AACA,0BAAMgE,IAAI,GAAG+J,KAAK,CAACK,GAAD,CAAL,CAAWC,UAAX,CAAsBrK,IAAnC;AAEA,0BAAMsK,GAAG,GAAGrM,MAAM,CAACqI,SAAP,CAAiB,UAAA/K,GAAG,EAAI;AAClC,+BAAOA,GAAG,CAACyE,IAAJ,KAAaA,IAApB;AACD,uBAFW,CAAZ;AAIA,0BAAI/C,KAAK,GAAG,IAAZ;;AACA,0BAAIqN,GAAG,IAAI,CAAX,EAAc;AACZ,4BAAM7H,OAAO,GAAGxE,MAAM,CAACqM,GAAD,CAAtB;AACR;;AACQ,4BAAK,CAAC7H,OAAO,CAACG,OAAd,EAAwB;AACpB3F,+BAAK,GAAG,UAAR;AACH,yBAFD,MAGK,IAAK,CAACwF,OAAO,CAACI,QAAd,EAAyB;AAC1B5F,+BAAK,GAAG,WAAR;AACH,yBAFI,MAGA,IAAK0E,IAAI,KAAK,OAAT,IAAoB,CAACc,OAAO,CAACK,OAAlC,EAA2C;AAC5C7F,+BAAK,GAAG,UAAR;AACH,yBAFI,MAGA,IAAK0E,IAAI,KAAK,QAAT,IAAqB,CAACc,OAAO,CAACM,WAAnC,EAAgD;AACjD9F,+BAAK,GAAG,WAAR;AACH,yBAFI,MAGA;AACDA,+BAAK,GAAGwF,OAAO,CAACd,IAAD,CAAf;AACH;AACF;;AACDwI,0BAAI,CAACjM,IAAL,OAAAiM,IAAI,qBAASI,KAAK,CAAC7O,KAAD,CAAL,CAAa8O,IAAb,CAAkBvN,KAAlB,CAAT,EAAJ;;;AA5BF,yBAASmN,GAAT,GAAe,CAAf,EAAkBA,GAAG,GAAGL,KAAK,CAAC/N,MAA9B,EAAsCoO,GAAG,EAAzC,EAA6C;AAAA,4BAApCA,GAAoC;AA6B5C;;AAEGK,wB,GAAO,I,EAAMC,I,GAAO,I;;AACxB,wBAAI/I,IAAI,KAAK,OAAb,EAAsB;AAAA,6BACL,CAAC,KAAK5H,IAAL,CAAUwO,OAAV,CAAkB1I,GAAnB,EAAwB,KAAK9F,IAAL,CAAUwO,OAAV,CAAkBzI,GAA1C,CADK;AACnB2K,0BADmB;AACbC,0BADa;AAErB,qBAFD,MAGK;AAAA,8BACY,CAAC,KAAK3Q,IAAL,CAAUwO,OAAV,CAAkBC,SAAnB,EAA8B,KAAKzO,IAAL,CAAUwO,OAAV,CAAkBE,SAAhD,CADZ;AACFgC,0BADE;AACIC,0BADJ;AAEJ;;;AAED,2BAAM,KAAK5B,QAAL,CAAc6B,mBAAd,CAAkC,OAAlC,EAA2C;AAACR,0BAAI,EAAJA,IAAD;AAAOM,0BAAI,EAAJA,IAAP;AAAaC,0BAAI,EAAJA;AAAb,qBAA3C,CAAN;;;;;;;;;AACD;;;sCAEa1F,O,EAAiB;AAC7B,cAAIhF,IAAI,GAAG,EAAX;AACA,cAAMhJ,EAAE,GAAG,CAACgO,OAAO,CAAC,CAAD,CAAnB;;AAEA,cAAIhO,EAAE,IAAI,CAAV,EAAa;AACXgJ,gBAAI,GAAG,KAAKjG,IAAL,CAAU+P,QAAV,CAAmBE,QAAnB,CAA4BhT,EAA5B,EAAgCqT,UAAhC,CAA2CrK,IAAlD;AACD;;AAED,eAAK9I,MAAL,CAAYuC,GAAZ,CAAgBmR,UAAhB,CAA2BtT,IAA3B,CAAgC;AAAC0I,gBAAI,EAAJA,IAAD;AAAO6K,kBAAM,EAAE;AAAf,WAAhC;AACD;;;iDAEwBA,M,EAAgB;AAAA;;AACvC,cAAIA,MAAM,KAAK,KAAf,EAAsB;AACpB,gBAAM7T,EAAE,GAAG,KAAK+C,IAAL,CAAU+P,QAAV,CAAmBE,QAAnB,CAA4B1D,SAA5B,CAAsC,UAAA/K,GAAG;AAAA,qBAAIA,GAAG,CAAC8O,UAAJ,CAAerK,IAAf,KAAwB,OAAI,CAAC2D,KAAL,CAAWmH,eAAvC;AAAA,aAAzC,CAAX;;AACA,iBAAKhC,QAAL,CAAciC,IAAd,CAAmB,OAAnB,EAA4B/T,EAA5B;AACD;AACF;;;;;;;uBA9IU6R,Y,EAAY,wI,EAAA,0I,EAAA,8I,EAAA,4I;AAAA,K;;;YAAZA,Y;AAAY,8B;AAAA;AAAA;;;;;;;;;;;;;;;ACjBzB;;;;;;;;sEDiBaA,Y,EAAY;cALxB,uDAKwB;eALd;AACTtR,kBAAQ,EAAE,SADD;AAETC,qBAAW,EAAE,sBAFJ;AAGT6N,mBAAS,EAAE,CAAC,qBAAD;AAHF,S;AAKc,Q;;;;;;;;;;;;gBAEtB,uD;iBAAU,S,EAAW;AAACuD,kBAAM,EAAE;AAAT,W;;;;;;;;;;;;;;;;;;;;AEnBxB;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA,uD,CAAA;;;;;;;;;QAcaoC,a;;;AAIX,6BAAmBtH,GAAnB,EAA2C3J,IAA3C,EAAqE7C,MAArE,EAAmGyM,KAAnG,EAAwH;AAAA;;AAArG,aAAAD,GAAA,GAAAA,GAAA;AAAwB,aAAA3J,IAAA,GAAAA,IAAA;AAA0B,aAAA7C,MAAA,GAAAA,MAAA;AAA8B,aAAAyM,KAAA,GAAAA,KAAA;AAF5F,aAAAsH,YAAA,GAAe,KAAf;AAEoH;;;;mCAEnH,CAAW;;;sCAELC,M,EAAgB;AAC5B,cAAIA,MAAM,KAAK,QAAf,EAAyB;AACvB,iBAAKvH,KAAL,CAAWsH,YAAX,GAA0B,CAAC,KAAKtH,KAAL,CAAWsH,YAAtC;AACD,WAFD,MAEO,IAAIC,MAAM,KAAK,QAAf,EAAyB;AAC9B,iBAAKvH,KAAL,CAAW6D,YAAX,GAA0B,CAAC,KAAK7D,KAAL,CAAW6D,YAAtC;AACD,WAFM,MAEA,IAAI0D,MAAM,KAAK,QAAf,EAAwB;AAC7B,iBAAKvH,KAAL,CAAWwH,YAAX,GAA0B,CAAC,KAAKxH,KAAL,CAAWwH,YAAtC;AACD;AACF;;;uCAEc;AACb,eAAKxH,KAAL,CAAWyH,YAAX,GAA0B,CAAC,KAAKzH,KAAL,CAAWyH,YAAtC;AACD;;;;;;;uBApBUJ,a,EAAa,wI,EAAA,0I,EAAA,8I,EAAA,4I;AAAA,K;;;YAAbA,a;AAAa,+B;AAAA,e;AAAA,c;AAAA,iM;AAAA;AAAA;ACd1B;;AAEE;;AAAgC;AAAA,mBAAS,kBAAmB,QAAnB,CAAT;AAAqC,WAArC;;AAC9B;;AAAiE;;AAAQ;;AACzE;;AAAiC;;AAAM;;AACzC;;AAEA;;AAAgC;AAAA,mBAAS,kBAAmB,QAAnB,CAAT;AAAqC,WAArC;;AAC9B;;AAAiE;;AAAI;;AACrE;;AAAiC;;AAAM;;AACzC;;AAEA;;AAAgC;AAAA,mBAAS,kBAAmB,QAAnB,CAAT;AAAqC,WAArC;;AAC9B;;AAAiE;;AAAM;;AACvE;;AAAiC;;AAAM;;AACzC;;AAEA;;AAAyC;AAAA,mBAAS,kBAAT;AAA4B,WAA5B;;AACvC;;AAA8E;;AAAU;;AACxF;;AAAiC;;AAAM;;AACzC;;AAEF;;AAEA;;AACA;;;;AAtBc;;AAAA;;AACL;;AAAA;;AAIK;;AAAA;;AACL;;AAAA;;AAIK;;AAAA;;AACL;;AAAA;;AAIkB;;AAAA;;AAClB;;AAAA;;;;;;;;;sEDLIA,a,EAAa;cALzB,uDAKyB;eALf;AACTzT,kBAAQ,EAAE,UADD;AAETC,qBAAW,EAAE,uBAFJ;AAGT6N,mBAAS,EAAE,CAAC,sBAAD;AAHF,S;AAKe,Q;;;;;;;;;;;;;;;;;;;;;;;;;;;;AEd1B;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;;;;ACKA;;AACE;;AACE;;AAAoB;;AAAkB;;AACxC;;AAEA;;AACE;;AAAU;;AAAoB;;AAC9B;;AAAoB;;;;AAKpB;;AACF;;AACF;;;;;;AAZwB;;AAAA;;AAKA;;AAAA;;;;;;AAQxB;;AACE;;AACE;;AAAoB;;AAAyB;;AAC/C;;AACF;;;;;;AAFwB;;AAAA;;;;;;AAIxB;;AACE;;AACE;;AAAoB;;AAAkB;;AACxC;;AACF;;;;;;AAFwB;;AAAA;;;;QDrBXgG,gB;;;AAOX,kCAAc;AAAA;AAAG;;;;mCAET,CAAW;;;yCAEF;AACf,cAAI,CAAC,KAAKC,IAAL,CAAUvR,IAAf,EAAqB,OAAO,EAAP;;AAErB,cAAI,CAAC,KAAKuR,IAAL,CAAUvR,IAAV,CAAe6I,OAApB,EAA8B;AAC1B,mBAAO,eAAP;AACH,WAFD,MAGK,IAAK,CAAC,KAAK0I,IAAL,CAAUvR,IAAV,CAAe8I,QAArB,EAAgC;AACjC,mBAAO,cAAP;AACH,WAFI,MAGA,IAAK,KAAKyI,IAAL,CAAU3J,IAAV,KAAmB,OAAnB,IAA8B,CAAC,KAAK2J,IAAL,CAAUvR,IAAV,CAAe+I,OAAnD,EAA6D;AAC9D,mBAAO,eAAP;AACH,WAFI,MAGA,IAAK,KAAKwI,IAAL,CAAU3J,IAAV,KAAmB,QAAnB,IAA+B,CAAC,KAAK2J,IAAL,CAAUvR,IAAV,CAAegJ,WAApD,EAAkE;AACnE,mBAAO,gBAAP;AACH,WAFI,MAGA;AACD,mBAAO,KAAKuI,IAAL,CAAUvR,IAAV,CAAe,KAAKuR,IAAL,CAAU3J,IAAzB,EAA+B4J,cAA/B,CACHjH,SADG,EACQ;AAAEkH,mCAAqB,EAAE;AAAzB,aADR,CAAP;AAGF;AACH;;;;;;;uBA/BUH,gB;AAAgB,K;;;YAAhBA,gB;AAAgB,kC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,O;AAAA,c;AAAA,c;AAAA,+V;AAAA;AAAA;ACP7B;;AAKA;;AAeA;;AAMA;;AAKA;;;;AA/BK;;AACL,uGAAyC,SAAzC,EAAyC,wBAAzC,EAAyC,MAAzC,EAAyC,QAAzC,EAAyC,IAAzC,EAAyC,KAAzC,EAAyC,OAAzC,EAAyC,IAAzC;;AAI4C;;AAAA;;AAevC;;AAAA;;AAMgD;;AAAA;;;;;;;;;;sEDnBxCA,gB,EAAgB;cAL5B,uDAK4B;eALlB;AACT9T,kBAAQ,EAAE,aADD;AAETC,qBAAW,EAAE,0BAFJ;AAGT6N,mBAAS,EAAE,CAAC,yBAAD;AAHF,S;AAKkB,Q;;;;gBAE1B;;;gBACA;;;gBACA;;;gBACA;;;;;;;;;;;;;;;;;;;;AEZH;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;;;;;;;ACSoB;;AACI;;AACJ;;;;;;AAFyD;;AACrD;;AAAA;;;;;;AASJ;;AACI;;AACJ;;;;;;AAFsE;;AAClE;;AAAA;;;;;;AASJ;;AACI;;AACJ;;;;;;AAFqD,mFAAa,UAAb,EAAa,kBAAb;;AACjD;;AAAA;;;;;;AASJ;;AACI;;AACJ;;;;;;AAFkD;;AAC9C;;AAAA;;;;;;AASJ;;AACI;;AACJ;;;;;;AAFsD;;AAClD;;AAAA;;;;;;AAUJ;;AACI;;AACJ;;;;;;AAFuD,oFAAc,UAAd,EAAc,mBAAd;;AACnD;;AAAA;;;;;;;;AAsBhB;;AACI;;AAAU;;AAAoB;;AAC9B;;AACI;AAAA;;AAAA;;AAAA,0CAA+B,cAA/B;AAA6C,SAA7C;;AAAgD;;;;AAA+I;;AACvM;;;;;;AAFuB;;AAAA;;AACiC;;AAAA;;;;;;;;AAGxD;;AACI;;AAAU;;AAAoB;;AAC9B;;AACI;AAAA;;AAAA;;AAAA,0CAA+B,OAA/B;AAAsC,SAAtC;;AAAyC;;AAA6C;;AAC9F;;;;;;AAFuB;;AAAA;;AAC0B;;AAAA;;;;QD5E5CoG,Y;;;AAiBT,4BAAmB/H,GAAnB,EAA2C3J,IAA3C,EAAqE7C,MAArE,EAAmGyM,KAAnG,EAAwH;AAAA;;AAArG,aAAAD,GAAA,GAAAA,GAAA;AAAwB,aAAA3J,IAAA,GAAAA,IAAA;AAA0B,aAAA7C,MAAA,GAAAA,MAAA;AAA8B,aAAAyM,KAAA,GAAAA,KAAA;AAhB5F,aAAAC,YAAA,GAAe,IAAI,0DAAJ,CAAgB,MAAhB,CAAf;AACA,aAAAC,eAAA,GAAkB,IAAI,0DAAJ,CAAgB,EAAhB,CAAlB;AAEA,aAAA6H,OAAA,GAAU;AACbC,cAAI,EAAE,KADO;AACApT,aAAG,EAAE,EADL;AAEbG,cAAI,EAAE,EAFO;AAEH4S,cAAI,EAAE;AAFH,SAAV;AAcN;;;;mCAEO;AACJ,eAAK7F,mBAAL;AACA,eAAK0D,oBAAL;AAEA,cAAMyC,WAAW,GAAG;AAChBpK,kBAAM,EAAE,KAAKmC,KAAL,CAAWa,wBAAX,CAAoC3F,IAD5B;AAEhB4C,iBAAK,EAAE;AAFS,WAApB;AAIA,cAAMoK,YAAY,GAAG;AACjBrK,kBAAM,EAAE,KAAKsK,gBAAL,CAAsBzQ,IAAtB,CAA2B,IAA3B,CADS;AAGjB6D,kBAAM,EAAE,KAAK6M,gBAAL,CAAsB1Q,IAAtB,CAA2B,IAA3B,CAHS;AAIjBsH,kBAAM,EAAE,KAAKqJ,gBAAL,CAAsB3Q,IAAtB,CAA2B,IAA3B,CAJS;AAMjBoG,iBAAK,EAAE,KAAKwK,eAAL,CAAqB5Q,IAArB,CAA0B,IAA1B,CANU;AAOjBqG,iBAAK,EAAE,KAAKqC,eAAL,CAAqB1I,IAArB,CAA0B,IAA1B,CAPU;AASjB8H,kBAAM,EAAE,KAAK+I,eAAL,CAAqB7Q,IAArB,CAA0B,IAA1B,CATS;AAUjByF,kBAAM,EAAE,KAAKA,MAAL,CAAYzF,IAAZ,CAAiB,IAAjB;AAVS,WAArB;AAaA,eAAK8Q,OAAL,GAAe,IAAI,4DAAJ,CAAW,KAAKC,UAAL,CAAgBlG,aAA3B,EAA0C2F,YAA1C,EAAwDD,WAAxD,CAAf;AAEA,cAAIjR,IAAI,GAAG,UAAG,KAAKgJ,KAAL,CAAW2E,uBAAX,CAAmC3B,SAAtC,eAAoD,KAAKhD,KAAL,CAAW2E,uBAAX,CAAmC1B,QAAvF,OAAmGyF,WAAnG,EAAX;AACA,cAAMC,YAAY,GAAG;AACjBpN,kBAAM,EAAE,KAAKyE,KAAL,CAAW2E,uBAAX,CAAmC3G,IAAnC,KAA4C,QAA5C,aAA0DhH,IAA1D,wBAA4EA,IAA5E;AADS,WAArB;AAGA,cAAM4R,aAAa,GAAG;AAClB1L,kBAAM,EAAE,KAAK2L,iBAAL,CAAuBnR,IAAvB,CAA4B,IAA5B,CADU;AAElByF,kBAAM,EAAE,KAAKA,MAAL,CAAYzF,IAAZ,CAAiB,IAAjB;AAFU,WAAtB;AAIA,eAAKsD,KAAL,GAAa,IAAI,wDAAJ,CAAS,KAAK8N,QAAL,CAAcvG,aAAvB,EAAsCqG,aAAtC,EAAqDD,YAArD,CAAb;AACH,S,CAED;;;;8CAEsB;AAAA;;AAClB,eAAKpV,MAAL,CAAY6C,IAAZ,CAAiBkO,eAAjB,CAAiCrC,SAAjC,CAA2C,YAAM;AAC7C,mBAAI,CAAC8G,UAAL;;AACA,mBAAI,CAACC,QAAL;AACH,WAHD;AAIH;;;+CAEsB;AAAA;;AACnB,eAAKzV,MAAL,CAAYyM,KAAZ,CAAkBiJ,qBAAlB,CAAwChH,SAAxC,CAAkD,YAAM;AACpD,mBAAI,CAAC8G,UAAL;;AACA,mBAAI,CAACC,QAAL;AACH,WAHD;AAKA,eAAKzV,MAAL,CAAYyM,KAAZ,CAAkBkJ,qBAAlB,CAAwCjH,SAAxC,CAAkD,YAAM;AACpD,mBAAI,CAAC8G,UAAL;;AACA,mBAAI,CAACC,QAAL;AACH,WAHD;AAKA,eAAKzV,MAAL,CAAYyM,KAAZ,CAAkBmJ,iBAAlB,CAAoClH,SAApC,CAA8C,KAAK+G,QAAL,CAActR,IAAd,CAAmB,IAAnB,CAA9C;AAEA,eAAKnE,MAAL,CAAYyM,KAAZ,CAAkByF,sBAAlB,CAAyCxD,SAAzC,CAAmD,KAAKmH,kBAAL,CAAwB1R,IAAxB,CAA6B,IAA7B,CAAnD;AACH;;;6CAEoB;AAAA;;AACjB,cAAI,KAAKsI,KAAL,CAAWqJ,oBAAX,CAAgCC,MAAhC,KAA2C,MAA/C,EAAuD;AACnD,mBAAO,UAAChD,CAAD,EAAIC,CAAJ;AAAA,qBAAUD,CAAC,CAACjK,IAAF,CAAOqM,WAAP,KAAuBnC,CAAC,CAAClK,IAAF,CAAOqM,WAAP,EAAvB,GAA8C,CAAC,CAA/C,GAAmD,CAA7D;AAAA,aAAP;AACH;;AAED,cAAI,CAAC9S,KAAK,CAAC,CAAC,KAAKoK,KAAL,CAAWqJ,oBAAX,CAAgCC,MAAlC,CAAV,EAAqD;AACjD,mBAAO,UAAChD,CAAD,EAAIC,CAAJ,EAAU;AACb,kBAAMvI,IAAI,GAAG,OAAI,CAACgC,KAAL,CAAW2E,uBAAX,CAAmC3G,IAAhD;;AAEA,kBAAI,CAACsI,CAAC,CAACrH,OAAH,IAAc,CAACqH,CAAC,CAACpH,QAArB,EAAgC;AAC5B,uBAAO,CAAC,CAAR;AACH;;AAED,kBAAI,CAACqH,CAAC,CAACtH,OAAH,IAAc,CAACsH,CAAC,CAACrH,QAArB,EAAgC;AAC5B,uBAAO,CAAP;AACH;;AAED,kBAAIlB,IAAI,KAAK,OAAb,EAAsB;AAClB,oBAAI,CAACsI,CAAC,CAACnH,OAAP,EAAgB;AACZ,yBAAO,CAAC,CAAR;AACH;;AAED,oBAAI,CAACoH,CAAC,CAACpH,OAAP,EAAgB;AACZ,yBAAO,CAAP;AACH;AACJ;;AAED,kBAAInB,IAAI,KAAK,QAAb,EAAuB;AACnB,oBAAI,CAACsI,CAAC,CAAClH,WAAP,EAAoB;AAChB,yBAAO,CAAC,CAAR;AACH;;AAED,oBAAI,CAACmH,CAAC,CAACnH,WAAP,EAAoB;AAChB,yBAAO,CAAP;AACH;AACJ;;AAED,qBAAOkH,CAAC,CAACtI,IAAD,CAAD,GAAUuI,CAAC,CAACvI,IAAD,CAAX,GAAoB,CAAC,CAArB,GAAyB,CAAhC;AACH,aAhCD;AAiCH;AACJ;;;4CAEmB;AAChB,cAAM5H,IAAI,GAAG,KAAKA,IAAL,CAAUwO,OAAvB;AACA,cAAM5G,IAAI,GAAG,KAAKgC,KAAL,CAAW2E,uBAAX,CAAmC3G,IAAhD;AAEA,cAAMuL,IAAI,GAAG,KAAKvJ,KAAL,CAAWwJ,oBAAX,CAAgCC,WAA7C;AACA,cAAM5M,IAAI,GAAG,KAAKmD,KAAL,CAAWwJ,oBAAX,CAAgCE,QAA7C;AAEA,cAAMlO,KAAK,GAAGsF,MAAM,CAAC5N,IAAP,CAAYkD,IAAZ,EAAkB2I,MAAlB,CAAyB,UAAAvG,CAAC;AAAA,mBAAI,CAAC5C,KAAK,CAAC,CAAC4C,CAAF,CAAV;AAAA,WAA1B,CAAd;AAEA,cAAImR,QAAQ,GAAG,EAAf;;AACA,cAAI/T,KAAK,CAAC,CAAC,KAAKoK,KAAL,CAAWqJ,oBAAX,CAAgCC,MAAlC,CAAT,EAAoD;AAChDK,oBAAQ,GAAGnO,KAAK,CAAC,CAAD,CAAhB;AACH,WAFD,MAEO;AACHmO,oBAAQ,GAAG,KAAK3J,KAAL,CAAWqJ,oBAAX,CAAgCC,MAA3C;AACH,WAde,CAgBhB;;;AACA,cAAMM,QAAQ,GAAG,EAAjB;AACAxT,cAAI,CAACuT,QAAD,CAAJ,CAAe5N,OAAf,CAAuB,UAACvD,CAAD,EAAI+D,CAAJ,EAAU;AAC7BqN,oBAAQ,CAACpR,CAAC,CAAC6D,IAAH,CAAR,GAAmBE,CAAnB;AACH,WAFD,EAlBgB,CAsBhB;;AACA,cAAIsN,QAAQ,sBAAOzT,IAAI,CAACuT,QAAD,CAAX,CAAZ;;AACAE,kBAAQ,CAAC5L,IAAT,CAAc,KAAK6L,kBAAL,GAA0BpS,IAA1B,CAA+B,IAA/B,CAAd,EAxBgB,CA0BhB;;AACAmS,kBAAQ,GAAGA,QAAQ,CAAC1Q,KAAT,CAAeoQ,IAAI,GAAG1M,IAAtB,EAA4B,CAAC0M,IAAI,GAAG,CAAR,IAAa1M,IAAzC,CAAX,CA3BgB,CA6BhB;;AACA,cAAMkN,OAAO,GAAG,EAAhB;AA9BgB;AAAA;AAAA;;AAAA;AAAA;AAAA,kBA+BP7O,IA/BO;AAgCZ,kBAAMtD,GAAG,GAAG;AACRtD,mBAAG,EAAE4G,IADG;AAER5B,qBAAK,EAAEuQ,QAAQ,CAAC/T,GAAT,CACH,UAAA0C,CAAC,EAAI;AACD,sBAAMmO,GAAG,GAAGiD,QAAQ,CAACpR,CAAC,CAAC6D,IAAH,CAApB;AACA,yBAAOjG,IAAI,CAAC8E,IAAD,CAAJ,CAAWyL,GAAX,CAAP;AACH,iBAJE;AAFC,eAAZ;AAUAoD,qBAAO,CAACxP,IAAR,CAAa3C,GAAb;AA1CY;;AA+BhB,iCAAiB4D,KAAjB,8HAAwB;AAAA;AAYvB,aA3Ce,CA6ChB;;AA7CgB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AA8ChB,cAAIvB,MAAM,GAAG,EAAb;;AACA,cAAI+D,IAAI,KAAK,OAAb,EAAsB;AAClB/D,kBAAM,GAAG,CAAC,CAAC7D,IAAI,CAAC8F,GAAL,CAAS1B,OAAT,CAAiB,CAAjB,CAAF,EAAuB,CAACpE,IAAI,CAAC+F,GAAL,CAAS3B,OAAT,CAAiB,CAAjB,CAAxB,CAAT;AACH,WAFD,MAEO;AACHP,kBAAM,GAAG,CAAC,CAAC7D,IAAI,CAACyO,SAAL,CAAerK,OAAf,CAAuB,CAAvB,CAAF,EAA6B,CAACpE,IAAI,CAAC0O,SAAL,CAAetK,OAAf,CAAuB,CAAvB,CAA9B,CAAT;AACH;;AACDuP,iBAAO,CAAC,QAAD,CAAP,GAAoB9P,MAApB;AAEA,iBAAO8P,OAAP;AACH;;;qCAEY;AACT,cAAM/L,IAAI,GAAG,KAAKgC,KAAL,CAAW2E,uBAAX,CAAmC3G,IAAhD;AACA,cAAMhC,IAAI,GAAG,KAAKgE,KAAL,CAAWgK,qBAAxB;AACA,cAAM/L,IAAI,GAAG,KAAK+B,KAAL,CAAWqJ,oBAAX,CAAgCC,MAA7C;AACA,cAAMpL,KAAK,GAAG,EAAE,KAAK8B,KAAL,CAAWiK,WAAX,KAA2B,cAA3B,IAA6C,KAAKjK,KAAL,CAAW+C,sBAAX,CAAkCxB,UAAlC,KAAiD,aAAhG,KACV,EAAE,KAAKvB,KAAL,CAAWiK,WAAX,KAA2B,OAA3B,IAAsC,KAAKjK,KAAL,CAAW+C,sBAAX,CAAkCxB,UAAlC,KAAiD,UAAzF,CADJ;AAGA,cAAMnL,IAAI,GAAG,KAAK8T,iBAAL,EAAb;;AAEA,eAAK1B,OAAL,CAAa5F,OAAb,CAAqBxM,IAArB,EAA2B4H,IAA3B,EAAiChC,IAAjC,EAAuCiC,IAAvC,EAA6CC,KAA7C;;AACA,eAAKsK,OAAL,CAAa9R,MAAb;AACH;;;0CAEiB;AACd,cAAMN,IAAI,GAAG,KAAKA,IAAL,CAAUwO,OAAvB;AACA,cAAMpJ,KAAK,GAAGsF,MAAM,CAAC5N,IAAP,CAAYkD,IAAZ,EAAkB2I,MAAlB,CAAyB,UAAAvG,CAAC;AAAA,mBAAI,CAAC5C,KAAK,CAAC,CAAC4C,CAAF,CAAV;AAAA,WAA1B,CAAd;AACA,cAAMwF,IAAI,GAAG,KAAKgC,KAAL,CAAW2E,uBAAX,CAAmC3G,IAAnC,KAA4C,QAA5C,GAAuD,OAAvD,GAAiE,QAA9E;AACA,cAAMmM,MAAM,GAAG,KAAKnK,KAAL,CAAWgK,qBAA1B;AAEA,cAAMI,QAAQ,GAAG;AAAEnQ,kBAAM,EAAE,EAAV;AAAc6B,iBAAK,EAAE;AAArB,WAAjB;AANc;AAAA;AAAA;;AAAA;AAAA;AAAA,kBAQLO,IARK;AASV,kBAAMgO,SAAS,GAAG;AAAEhO,oBAAI,EAAJA,IAAF;AAAQjG,oBAAI,EAAE;AAAd,eAAlB;AATU;AAAA;AAAA;;AAAA;AAWV,sCAAiBoF,KAAjB,mIAAwB;AAAA,sBAAfN,IAAe;AACpB,sBAAM4D,OAAO,GAAG1I,IAAI,CAAC8E,IAAD,CAAJ,CAAWoP,IAAX,CAAgB,UAAA1S,GAAG;AAAA,2BAAIA,GAAG,CAACyE,IAAJ,KAAaA,IAAjB;AAAA,mBAAnB,CAAhB;AAEA,sBAAM/C,KAAK,GAAGwF,OAAO,CAACd,IAAD,CAArB;AACA,sBAAM1C,KAAK,GAAGwD,OAAO,CAACG,OAAR,IAAmBH,OAAO,CAACI,QAA3B,IAAuCJ,OAAO,CAACK,OAA7D;AAEAkL,2BAAS,CAACjU,IAAV,CAAemE,IAAf,CAAoB;AAAEW,wBAAI,EAAJA,IAAF;AAAQ5B,yBAAK,EAALA,KAAR;AAAegC,yBAAK,EAALA;AAAf,mBAApB;AACH;AAlBS;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAoBV8O,sBAAQ,CAACtO,KAAT,CAAevB,IAAf,CAAoB8P,SAApB;AApBU;;AAQd,kCAAiBF,MAAjB,mIAAyB;AAAA;AAaxB,aArBa,CAuBd;;AAvBc;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAwBd,cAAIlQ,MAAM,GAAG,EAAb;;AACA,cAAI+D,IAAI,KAAK,OAAb,EAAsB;AAClB/D,kBAAM,GAAG,CAAC,CAAC7D,IAAI,CAAC8F,GAAL,CAAS1B,OAAT,CAAiB,CAAjB,CAAF,EAAuB,CAACpE,IAAI,CAAC+F,GAAL,CAAS3B,OAAT,CAAiB,CAAjB,CAAxB,CAAT;AACH,WAFD,MAEO;AACHP,kBAAM,GAAG,CAAC,CAAC7D,IAAI,CAACyO,SAAL,CAAerK,OAAf,CAAuB,CAAvB,CAAF,EAA6B,CAACpE,IAAI,CAAC0O,SAAL,CAAetK,OAAf,CAAuB,CAAvB,CAA9B,CAAT;AACH;;AAED4P,kBAAQ,CAAC,QAAD,CAAR,GAAqBnQ,MAArB;AACA,iBAAO;AAAEmQ,oBAAQ,EAARA,QAAF;AAAY5O,iBAAK,EAALA;AAAZ,WAAP;AACH;;;mCAEU;AAAA,sCACqB,KAAK+O,eAAL,EADrB;AAAA,cACCH,QADD,yBACCA,QADD;AAAA,cACW5O,KADX,yBACWA,KADX;;AAEP,cAAIxE,IAAI,GAAG,UAAG,KAAKgJ,KAAL,CAAW2E,uBAAX,CAAmC3B,SAAtC,eAAoD,KAAKhD,KAAL,CAAW2E,uBAAX,CAAmC1B,QAAvF,OAAmGyF,WAAnG,EAAX;AACA,cAAInN,MAAM,GAAG,KAAKyE,KAAL,CAAW2E,uBAAX,CAAmC3G,IAAnC,KAA4C,QAA5C,aAA0DhH,IAA1D,wBAA4EA,IAA5E,YAAb;;AAEA,eAAKgE,KAAL,CAAWwP,SAAX,CAAqBjP,MAArB;;AACA,eAAKP,KAAL,CAAW4H,OAAX,CAAmBwH,QAAnB,EAA6B5O,KAA7B,EAAoCD,MAApC;;AACA,eAAKP,KAAL,CAAWtE,MAAX;AACH,S,CAED;;;;8CACsB2C,K,EAAO;AACzB,cAAMoR,QAAQ,GAAG;AAAEA,oBAAQ,EAAEpR,KAAK,CAACC;AAAlB,WAAjB;AACA,eAAK/F,MAAL,CAAY4M,GAAZ,CAAgBuK,qBAAhB,CAAsC/W,IAAtC,CAA2C8W,QAA3C;AACH;;;+CAEsBpR,K,EAAO;AAC1B,cAAM2J,SAAS,GAAG;AACdA,qBAAS,EAAE3J,KAAK,CAACC,KADH;AAEd2J,oBAAQ,EAAE,KAAK7M,IAAL,CAAUkK,IAAV,CAAegD,UAAf,CAA0BjK,KAAK,CAACC,KAAhC,EAAuCiK,UAAvC,CAAkD,CAAlD,CAFI;AAGdoH,kBAAM,EAAE,KAAKvU,IAAL,CAAUkK,IAAV,CAAegD,UAAf,CAA0BjK,KAAK,CAACC,KAAhC,EAAuCsR,OAAvC,CAA+C,CAA/C;AAHM,WAAlB;AAKA,eAAKrX,MAAL,CAAY4M,GAAZ,CAAgB0K,sBAAhB,CAAuClX,IAAvC,CAA4CqP,SAA5C;AACH;;;8CAEqB3J,K,EAAO;AACzB,cAAMsR,MAAM,GAAG;AAAE1H,oBAAQ,EAAE5J,KAAK,CAACC;AAAlB,WAAf;AACA,eAAK/F,MAAL,CAAY4M,GAAZ,CAAgB2K,qBAAhB,CAAsCnX,IAAtC,CAA2CgX,MAA3C;AACH;;;wCAEe;AACZ,cAAI,KAAKvU,IAAL,CAAUkK,IAAV,CAAegD,UAAf,CAA0B,KAAKtD,KAAL,CAAW2E,uBAAX,CAAmC3B,SAA7D,CAAJ,EAA6E;AACzE,mBAAO,KAAK5M,IAAL,CAAUkK,IAAV,CAAegD,UAAf,CAA0B,KAAKtD,KAAL,CAAW2E,uBAAX,CAAmC3B,SAA7D,EAAwEO,UAA/E;AACH;;AACD,iBAAO,EAAP;AACH;;;4CAEmBlK,K,EAAO;AACvB,cAAMsR,MAAM,GAAG;AAAEA,kBAAM,EAAEtR,KAAK,CAACC;AAAhB,WAAf;AACA,eAAK/F,MAAL,CAAY4M,GAAZ,CAAgB4K,mBAAhB,CAAoCpX,IAApC,CAAyCgX,MAAzC;AACH;;;qCAEY;AACT,cAAI,KAAKvU,IAAL,CAAUkK,IAAV,CAAegD,UAAf,CAA0B,KAAKtD,KAAL,CAAW2E,uBAAX,CAAmC3B,SAA7D,CAAJ,EAA6E;AACzE,mBAAO,KAAK5M,IAAL,CAAUkK,IAAV,CAAegD,UAAf,CAA0B,KAAKtD,KAAL,CAAW2E,uBAAX,CAAmC3B,SAA7D,EAAwE4H,OAA/E;AACH;;AACD,iBAAO,EAAP;AACH;;;0CAEiBvR,K,EAAO;AACrB,cAAM2E,IAAI,GAAG;AAAEA,gBAAI,EAAE3E,KAAK,CAACC;AAAd,WAAb;AACA,eAAK/F,MAAL,CAAY4M,GAAZ,CAAgBsB,iBAAhB,CAAkC9N,IAAlC,CAAuCqK,IAAvC;AACH;;;0CAEiB3E,K,EAAO;AACrB,cAAM4E,IAAI,GAAG;AAAEqL,kBAAM,EAAEjQ,KAAK,CAACC;AAAhB,WAAb;AACA,eAAK/F,MAAL,CAAY4M,GAAZ,CAAgB6K,mBAAhB,CAAoCrX,IAApC,CAAyCsK,IAAzC;AACH,S,CACD;;;;yCAEiB3E,K,EAAO;AACpB,cAAM4B,IAAI,GAAG;AAAEA,gBAAI,EAAE5B;AAAR,WAAb;AACA,eAAK/F,MAAL,CAAY4M,GAAZ,CAAgBgI,gBAAhB,CAAiCxU,IAAjC,CAAsCuH,IAAtC;AACH;;;yCAEgB5B,K,EAAO;AACpB,cAAM2R,IAAI,GAAG;AAAE5O,gBAAI,EAAE/C,KAAR;AAAe4N,kBAAM,EAAE;AAAvB,WAAb;AACA,eAAK3T,MAAL,CAAY4M,GAAZ,CAAgB+K,mBAAhB,CAAoCvX,IAApC,CAAyCsX,IAAzC;AACH;;;yCAEgB3R,K,EAAO;AACpB;AACA,eAAK/F,MAAL,CAAY4M,GAAZ,CAAgBC,eAAhB,CAAgCzM,IAAhC,CAAqC,EAArC;;AAEA,cAAI,KAAKqM,KAAL,CAAWiK,WAAX,KAA2B,SAA/B,EAA0C;AACtC,gBAAMkB,YAAY,GAAG;AAAEA,0BAAY,EAAE7R;AAAhB,aAArB;AACA,iBAAK/F,MAAL,CAAY4M,GAAZ,CAAgBiL,mBAAhB,CAAoCzX,IAApC,CAAyCwX,YAAzC;AACH,WAHD,MAIK,IAAI,KAAKnL,KAAL,CAAWiK,WAAX,KAA2B,cAA/B,EAA+C;AAChD,gBAAMoB,KAAK,GAAG;AAAEA,mBAAK,EAAE/R;AAAT,aAAd;AACA,iBAAK/F,MAAL,CAAY4M,GAAZ,CAAgBiL,mBAAhB,CAAoCzX,IAApC,CAAyC0X,KAAzC;AACH,WAHI,MAIA,IAAI,KAAKrL,KAAL,CAAWiK,WAAX,KAA2B,OAA/B,EAAwC;AACzC,gBAAMqB,GAAG,GAAG;AAAEA,iBAAG,EAAEhS;AAAP,aAAZ;AACA,iBAAK/F,MAAL,CAAY4M,GAAZ,CAAgBiL,mBAAhB,CAAoCzX,IAApC,CAAyC2X,GAAzC;AACH;AACJ;;;2CAEkBpE,M,EAAgB;AAC/B,cAAIA,MAAM,KAAK,KAAf,EAAsB;AAClB,iBAAKsB,OAAL,CAAa+C,YAAb,CAA0B,KAAKvL,KAAL,CAAWmH,eAArC;;AACA,iBAAKqB,OAAL,CAAa9R,MAAb;AACH;AACJ;;;yCAEgB8U,K,EAAO;AACpB;AACA,eAAKjY,MAAL,CAAY4M,GAAZ,CAAgBC,eAAhB,CAAgCzM,IAAhC,CAAqC,EAArC;AAEA,cAAM0M,MAAM,GAAG,KAAKjK,IAAL,CAAUkK,IAAV,CAAeD,MAA9B;AAEA,cAAIE,OAAO,GAAG,EAAd;;AACA,cAAIiL,KAAK,KAAK,SAAd,EAAyB;AACrBjL,mBAAO,GAAGF,MAAM,CACXtB,MADK,CACE,UAAAyB,GAAG;AAAA,qBAAIA,GAAG,KAAK,SAAZ;AAAA,aADL,EAELC,MAFK,CAEE,UAACC,IAAD,EAAOpM,GAAP;AAAA,qBAAgB,MAAD,OAAC,CAAD,kBAAMoM,IAAN,CAAC,sBAAYpM,GAAZ,EAAkBqM,SAAlB,EAAhB;AAAA,aAFF,EAEkD,EAFlD,CAAV;AAGH,WAJD,MAKK,IAAI6K,KAAK,KAAK,cAAd,EAA8B;AAC/BjL,mBAAO,GAAGF,MAAM,CACXtB,MADK,CACE,UAAAyB,GAAG;AAAA,qBAAIA,GAAG,KAAK,SAAR,IAAqBA,GAAG,KAAK,cAAjC;AAAA,aADL,EAELC,MAFK,CAEE,UAACC,IAAD,EAAOpM,GAAP;AAAA,qBAAgB,MAAD,OAAC,CAAD,kBAAMoM,IAAN,CAAC,sBAAYpM,GAAZ,EAAkBqM,SAAlB,EAAhB;AAAA,aAFF,EAEkD,EAFlD,CAAV;AAGH,WAJI,MAKA,IAAI6K,KAAK,KAAK,OAAd,EAAuB;AACxBjL,mBAAO,GAAGF,MAAM,CACXtB,MADK,CACE,UAAAyB,GAAG;AAAA,qBAAIA,GAAG,KAAK,SAAR,IAAqBA,GAAG,KAAK,cAA7B,IAA+CA,GAAG,KAAK,OAA3D;AAAA,aADL,EAELC,MAFK,CAEE,UAACC,IAAD,EAAOpM,GAAP;AAAA,qBAAgB,MAAD,OAAC,CAAD,kBAAMoM,IAAN,CAAC,sBAAYpM,GAAZ,EAAkBqM,SAAlB,EAAhB;AAAA,aAFF,EAEkD,EAFlD,CAAV;AAGH,WArBmB,CAuBpB;;;AACA,eAAKpN,MAAL,CAAY4M,GAAZ,CAAgBsL,gBAAhB,CAAiC9X,IAAjC,CAAsC4M,OAAtC;AACH;;;wCAEe;AACZ,eAAKP,KAAL,CAAW0L,YAAX,GAA0B,CAAC,KAAK1L,KAAL,CAAW0L,YAAtC;AACH;;;6CAEoB;AACjB,iBAAO,KAAK1L,KAAL,CAAW0L,YAAX,GAA0B,MAA1B,GAAoC5K,MAAM,CAAC5N,IAAP,CAAY,KAAK8M,KAAL,CAAWgB,sBAAvB,EAA+C3I,MAA/C,KAA0D,CAA1D,GAA8D,SAA9D,GAA0E,QAArH;AACH;;;uCAEcsT,S,EAAmB;AAC9B,cAAI7M,OAAO,GAAG,KAAKkB,KAAL,CAAWwJ,oBAAX,CAAgCC,WAA9C;AACA,cAAImC,KAAK,GAAG,KAAK5L,KAAL,CAAWwJ,oBAAX,CAAgCqC,UAAhC,GAA6C,CAAzD;;AAEA,cAAIF,SAAS,KAAK,MAAd,IAAwB7M,OAAO,GAAG,CAAtC,EAAyC;AACrCA,mBAAO,IAAI,CAAX;AACH,WAFD,MAGK,IAAI6M,SAAS,KAAK,OAAd,IAAyB7M,OAAO,GAAG8M,KAAvC,EAA8C;AAC/C9M,mBAAO,IAAI,CAAX;AACH,WAFI,MAGA,IAAI6M,SAAS,KAAK,OAAlB,EAA2B;AAC5B7M,mBAAO,GAAG,CAAV;AACH,WAFI,MAGA,IAAI6M,SAAS,KAAK,MAAlB,EAA0B;AAC3B7M,mBAAO,GAAG8M,KAAV;AACH,WAFI,MAGA,IAAI,CAAChW,KAAK,CAAC,CAAC+V,SAAF,CAAV,EAAuB;AAExB,gBAAI3R,GAAG,GAAG,CAAC2R,SAAD,GAAa,CAAvB;;AAEA,gBAAI3R,GAAG,GAAG,CAAV,EAAa;AAAEA,iBAAG,GAAG,CAAN;AAAU;;AACzB,gBAAIA,GAAG,GAAG4R,KAAV,EAAiB;AAAE5R,iBAAG,GAAG4R,KAAN;AAAc;;AAEjC9M,mBAAO,GAAG9E,GAAV;AACH;;AAED,cAAMuP,IAAI,GAAG;AAAEE,uBAAW,EAAE3K;AAAf,WAAb;AACA,eAAKvL,MAAL,CAAY4M,GAAZ,CAAgB2L,cAAhB,CAA+BnY,IAA/B,CAAoC4V,IAApC;AACH;;;wCAEejQ,K,EAAO;AACnB,cAAM2E,IAAI,GAAG;AAAEqL,kBAAM,EAAEhQ;AAAV,WAAb;AACA,eAAK/F,MAAL,CAAY4M,GAAZ,CAAgBmI,eAAhB,CAAgC3U,IAAhC,CAAqCsK,IAArC;AACH;;;wCAEe3E,K,EAAO;AACnB,cAAM0G,KAAK,GAAG1G,KAAd;AACA,eAAK/F,MAAL,CAAY4M,GAAZ,CAAgBC,eAAhB,CAAgCzM,IAAhC,CAAqCqM,KAArC;AACH;;;0CAEiB1G,K,EAAO;AACrB,eAAKyO,OAAL,GAAe;AACXC,gBAAI,EAAE,IADK;AAEXjT,gBAAI,EAAEuE,KAAK,CAACyD,KAAN,CAAY,CAAZ,CAFK;AAGXnI,eAAG,EAAE0E,KAAK,CAACyD,KAAN,CAAY,CAAZ,CAHM;AAIX4K,gBAAI,EAAE;AAAE3L,kBAAI,EAAE1C,KAAK,CAAC0C;AAAd;AAJK,WAAf;AAMH;;;wCAEe1C,K,EAAO;AACnB,cAAM0E,IAAI,GAAG,KAAKgC,KAAL,CAAW2E,uBAAX,CAAmC3G,IAAhD;AAEA,eAAK+J,OAAL,GAAe;AACXC,gBAAI,EAAE,IADK;AAEXjT,gBAAI,EAAEuE,KAAK,CAACyD,KAAN,CAAY,CAAZ,CAFK;AAGXnI,eAAG,EAAE0E,KAAK,CAACyD,KAAN,CAAY,CAAZ,CAHM;AAIX4K,gBAAI,EAAE;AAAEzM,kBAAI,EAAE5B,KAAK,CAAC4B,IAAd;AAAoB8C,kBAAI,EAAJA,IAApB;AAA0B5H,kBAAI,EAAEkD,KAAK,CAAClD;AAAtC;AAJK,WAAf;AAMH;;;iCAEQ;AACL,eAAK2R,OAAL,CAAaC,IAAb,GAAoB,KAApB;AACA,eAAKD,OAAL,CAAaJ,IAAb,GAAoB,EAApB;AACH;;;;;;;uBAnaQG,Y,EAAY,wI,EAAA,0I,EAAA,8I,EAAA,4I;AAAA,K;;;YAAZA,Y;AAAY,8B;AAAA;AAAA;;;;;;;;;;;;;;;;;;;;AChBzB;;AAEI;;AACI;;AAEI;;AACI;;AAAW;;AAAS;;AACpB;;AACI;AAAA,mBAAmB,iCAAnB;AAAqD,WAArD;;AACA;;AAGJ;;AACJ;;AAEA;;AACI;;AAAW;;AAAU;;AACrB;;AACI;AAAA,mBAAmB,kCAAnB;AAAsD,WAAtD;;AACA;;;;AAGJ;;AACJ;;AAEA;;AACI;;AAAW;;AAAU;;AACrB;;AACI;AAAA,mBAAmB,iCAAnB;AAAqD,WAArD;;AACA;;AAGJ;;AACJ;;AAEA;;AACI;;AAAW;;AAAO;;AAClB;;AACI;AAAA,mBAAmB,+BAAnB;AAAmD,WAAnD;;AACA;;AAGJ;;AACJ;;AAEA;;AACI;;AAAW;;AAAI;;AACf;;AACI;AAAA,mBAAmB,6BAAnB;AAAiD,WAAjD;;AACA;;AAGJ;;AACJ;;AAEA;;AACI;;AAAW;;AAAc;;AACzB;;AAEI;AAAA,mBAAmB,6BAAnB;AAAiD,WAAjD;;AACA;;AAGJ;;AACJ;;AAEJ;;AACJ;;AAEA;;AAEA;;AAEA;;AAEA;;AACI;;AAAgC;AAAA,mBAAS,mBAAT;AAA6B,WAA7B;;AAC5B;;AAA8C;;AAAW;;AAC7D;;AAEA;;AACI;AAAA,mBAAS,qBAAsB,SAAtB,CAAT;AAAyC,WAAzC;;AAA2C;;AAA6C;;AAE5F;;AAMA;;AAMA;;AAEA;;AACI;;AAA8B;;AAAI;;AAClC;;AAAuG;AAAA;;AAAA;;AAAA,mBAAU,8BAAV;AAAgD,WAAhD;;AAAvG;;AACA;;AACI;;AAGJ;;AACA;;AAA0C;AAAA,mBAAS,mBAAoB,OAApB,CAAT;AAAqC,WAArC;;AAEtC;;AAAU;;AAAU;;AACxB;;AACA;;AAA0C;AAAA,mBAAS,mBAAoB,MAApB,CAAT;AAAoC,WAApC;;AAEtC;;AAAU;;AAAmB;;AACjC;;AACA;;AAA2C;AAAA,mBAAS,mBAAoB,OAApB,CAAT;AAAqC,WAArC;;AAEvC;;AAAU;;AAAoB;;AAClC;;AACA;;AAA2C;AAAA,mBAAS,mBAAoB,MAApB,CAAT;AAAoC,WAApC;;AAEvC;;AAAU;;AAAS;;AACvB;;AACJ;;AACJ;;AACJ;;AAEA;;;;AA7H6B,iHAAmD,SAAnD,EAAmD,kCAAnD;;AAGC;;AAAA;;AAEQ;;AAAA;;AAEV;;AAAA;;AAEI;;AAAA;;AAMJ;;AAAA;;AAEA;;AAAA;;AAEI;;AAAA;;AAMJ;;AAAA;;AAEA;;AAAA;;AAEI;;AAAA;;AAMJ;;AAAA;;AAEA;;AAAA;;AAEI;;AAAA;;AAMJ;;AAAA;;AAEA;;AAAA;;AAEI;;AAAA;;AAMJ;;AAAA;;AAGR;;AAAA;;AAEY;;AAAA;;AAiBV;;AAAA;;AAGK;;AAAA;;AAC4B;;AAAA;;AAEzB;;AAAA;;AAMA;;AAAA;;AAU2B;;AAAA;;AAEzC;;AAAA;;AAKA;;AAAA;;AAIA;;AAAA;;AAIA;;AAAA;;AAIA;;AAAA;;AAOH;;AAAA,iGAA8B,KAA9B,EAA8B,eAA9B,EAA8B,MAA9B,EAA8B,gBAA9B,EAA8B,MAA9B,EAA8B,gBAA9B;;;;;;;;;;sED7GAA,Y,EAAY;cALxB,uDAKwB;eALd;AACPlU,kBAAQ,EAAE,SADH;AAEPC,qBAAW,EAAE,sBAFN;AAGP6N,mBAAS,EAAE,CAAC,qBAAD;AAHJ,S;AAKc,Q;;;;;;;;;;;;gBAUpB,uD;iBAAU,Q,EAAU;AAAEuD,kBAAM,EAAE;AAAV,W;;;gBAIpB,uD;iBAAU,M,EAAQ;AAAEA,kBAAM,EAAE;AAAV,W;;;;;;;;;;;;;;;;;;;;AE9BvB;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA,6C,CAAA;;;QASa8G,a;;;;;AAsCX;;;;AAIA,6BAAY1Y,EAAZ,EAAwB;AAAA;;AAAA;;AACtB,6FAAMA,EAAN,GADsB,CApCxB;;AACU,gBAAA2Y,SAAA,GAAiB,EAAjB,CAmCc,CAjCxB;;AACU,gBAAAC,iBAAA,GAAiC,IAAjC;AACA,gBAAAC,cAAA,GAA8B,IAA9B;AACA,gBAAAC,mBAAA,GAAmC,IAAnC,CA8Bc,CA5BxB;;AACU,gBAAAC,WAAA,GAAc,CAAC,CAAf;AACA,gBAAAC,aAAA,GAAgB,CAAC,CAAjB,CA0Bc,CAxBxB;;AACU,gBAAAC,mBAAA,GAA4C,CAAC,CAA7C;AACA,gBAAAC,oBAAA,GAA6C,CAAC,CAA9C;AACA,gBAAAC,aAAA,GAAsC,CAAC,CAAvC;AACA,gBAAAC,WAAA,GAAoC,CAAC,CAArC;AACA,gBAAAC,KAAA,GAA8B,CAAC,CAA/B,CAmBc,CAjBxB;;AACU,gBAAAC,UAAA,GAAa,CAAC,CAAd,CAgBc,CAdxB;;AACU,gBAAAC,SAAA,GAAY,CAAC,CAAb;AACA,gBAAAC,UAAA,GAAa,CAAC,CAAd;AACA,gBAAAC,IAAA,GAAyB,IAAzB;AACA,gBAAAC,QAAA,GAA6B,IAA7B;AACA,gBAAAC,cAAA,GAA+B,IAA/B;AACA,gBAAAC,aAAA,GAA8B,IAA9B;AACA,gBAAAC,gBAAA,GAAiC,IAAjC;AACA,gBAAAC,UAAA,GAA2B,IAA3B;AAMc;AAEvB;AAED;;;;;;;;oCAIkBC,S,EAAmC;;;;;;;;;AAE1C/Z,sB,GAAK,C;;;0BAAGA,EAAE,GAAG0Y,aAAa,CAACsB,Q;;;;;AAClC;AACMC,2B,qCAAqCja,E;AACrCka,2B,qCAAqCla,E,aAE3C;;;AACiB,2BAAM,wDAAWma,WAAX,CAAuBF,OAAvB,CAAN;;;AAAXG,4B;;AAEW,2BAAM,wDAAWD,WAAX,CAAuBD,OAAvB,CAAN;;;AAAXG,4B;AAEN;AACA,yBAAKC,iBAAL,CAAuBF,QAAvB,EAAiCC,QAAjC,EAA2CN,SAA3C;;;AAX4C/Z,sBAAE,E;;;;;AAchD;AACA,yBAAKiZ,mBAAL,GAA2Bc,SAAS,CAACQ,kBAAV,CAA6B,KAAKC,cAAL,CAAoB,CAApB,CAA7B,EAAqD,kBAArD,CAA3B;AACA,yBAAKtB,oBAAL,GAA4Ba,SAAS,CAACQ,kBAAV,CAA6B,KAAKC,cAAL,CAAoB,CAApB,CAA7B,EAAqD,mBAArD,CAA5B;AACA,yBAAKrB,aAAL,GAAqBY,SAAS,CAACQ,kBAAV,CAA6B,KAAKC,cAAL,CAAoB,CAApB,CAA7B,EAAqD,cAArD,CAArB;AACA,yBAAKpB,WAAL,GAAmBW,SAAS,CAACQ,kBAAV,CAA6B,KAAKC,cAAL,CAAoB,CAApB,CAA7B,EAAqD,YAArD,CAAnB;AACA,yBAAKnB,KAAL,GAAaU,SAAS,CAACQ,kBAAV,CAA6B,KAAKC,cAAL,CAAoB,CAApB,CAA7B,EAAqD,MAArD,CAAb;AAEA,yBAAKzB,WAAL,GAAmBgB,SAAS,CAACU,iBAAV,CAA4B,KAAKD,cAAL,CAAoB,CAApB,CAA5B,EAAoD,SAApD,CAAnB;AACA,yBAAKxB,aAAL,GAAqBe,SAAS,CAACU,iBAAV,CAA4B,KAAKD,cAAL,CAAoB,CAApB,CAA5B,EAAoD,YAApD,CAArB,C,CAEA;;AACAE,2BAAO,CAACC,GAAR,YAAgBjC,aAAa,CAACsB,QAA9B,oDAAgF,KAAKY,QAArF;;;;;;;;;AACD;AAED;;;;;;;uCAIqBb,S,EAAqD;AAAA,cAAlBhX,IAAkB,uEAAN,IAAM;;;;;;;;;;;AAEjE,2BAAM,kDAAQ8X,eAAR,CAAwB,KAAKD,QAA7B,CAAN;;;AAAP7X,wB;AAEA;AACA,yBAAK4V,SAAL,GAAiB;AAAE,kCAAY,EAAd;AAAkB,6BAAO,EAAzB;AAA6B,+BAAS;AAAtC,qBAAjB,C,CAEA;;;;;;;AACA,sCAAsB5V,IAAI,CAACiQ,QAA3B,2HAAqC;AAA1B8H,6BAA0B;AACnC,2BAAKnC,SAAL,CAAe,UAAf,IAA6BmC,OAAO,CAAChI,QAAR,CAAiBiI,WAA9C;AACA,2BAAKpC,SAAL,CAAe,KAAf,IAAwBmC,OAAO,CAAChI,QAAR,CAAiBkI,GAAzC;AACA,2BAAKrC,SAAL,CAAe,OAAf,IAA0BmC,OAAO,CAAChI,QAAR,CAAiBmI,OAA3C;AACD,qB,CAED;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AACA,yBAAKC,aAAL,CAAmBnB,SAAnB,E,CACA;;AACA,yBAAKoB,aAAL,CAAmBpB,SAAnB;;;;;;;;;AACD;AAED;;;;;;;;;6BAMKA,S,EAAmCnS,C,EAAWE,C,EAAW;AAC5DiS,mBAAS,CAACqB,eAAV,CAA0BrB,SAAS,CAACsB,WAApC,EAAiD,KAAK3B,QAAtD;AAEA,cAAM4B,MAAM,GAAG,IAAIC,YAAJ,CAAiB,CAAjB,CAAf;AACAxB,mBAAS,CAACyB,UAAV,CAAqB5T,CAArB,EAAwBE,CAAxB,EAA2B,CAA3B,EAA8B,CAA9B,EAAiCiS,SAAS,CAAC0B,IAA3C,EAAiD1B,SAAS,CAAC2B,KAA3D,EAAkEJ,MAAlE;;AAEA,cAAIA,MAAM,CAAC,CAAD,CAAN,GAAY,CAAhB,EAAmB;AACjB,iBAAKhC,UAAL,GAAkBgC,MAAM,CAAC,CAAD,CAAxB;AACD;;AAEDvB,mBAAS,CAACqB,eAAV,CAA0BrB,SAAS,CAACsB,WAApC,EAAiD,IAAjD;AACD;AAED;;;;;;;+BAIOtB,S,EAAmC;AACxC;AACA,cACE,KAAKS,cAAL,CAAoBxV,MAApB,KAA+B,CAA/B,IACA,KAAKwV,cAAL,CAAoB,CAApB,MAA2B,IAD3B,IAEA,KAAKA,cAAL,CAAoB,CAApB,MAA2B,IAF3B,IAGA,KAAK5B,iBAAL,KAA2B,IAH3B,IAIA,KAAKC,cAAL,KAAwB,IAJxB,IAKA,KAAKE,WAAL,GAAmB,CANrB,EAOE;AACA;AACD,WAXuC,CAYxC;;;AACA,eAAK4C,QAAL,CAAc5B,SAAd,EAbwC,CAexC;;AACAA,mBAAS,CAAC6B,MAAV,CAAiB7B,SAAS,CAAC8B,UAA3B;AACA9B,mBAAS,CAAC+B,SAAV,CAAoB/B,SAAS,CAACgC,IAA9B,EAjBwC,CAmBxC;;AACAhC,mBAAS,CAACqB,eAAV,CAA0BrB,SAAS,CAACsB,WAApC,EAAiD,KAAK5B,IAAtD;AACA,eAAKuC,eAAL,CAAqBjC,SAArB;AACAA,mBAAS,CAACqB,eAAV,CAA0BrB,SAAS,CAACsB,WAApC,EAAiD,IAAjD,EAtBwC,CAwBxC;;AACA,eAAKY,UAAL,CAAgBlC,SAAhB,EAzBwC,CA0BxC;;AACAA,mBAAS,CAACmC,OAAV,CAAkBnC,SAAS,CAAC8B,UAA5B;AACD;AAED;;;;;;;wCAI0B9B,S,EAAmC;AAC3D;AACAA,mBAAS,CAACoC,UAAV,CAAqB,KAAK3B,cAAL,CAAoB,CAApB,CAArB,EAF2D,CAI3D;;AACAT,mBAAS,CAACqC,gBAAV,CAA2B,KAAKnD,mBAAhC,EAAqD,KAArD,EAA4D,KAAKoD,OAAL,CAAaC,kBAAb,EAA5D;AACAvC,mBAAS,CAACqC,gBAAV,CAA2B,KAAKlD,oBAAhC,EAAsD,KAAtD,EAA6D,KAAKmD,OAAL,CAAaE,mBAAb,EAA7D,EAN2D,CAQ3D;;AACA,cAAMC,WAAW,GAAG,KAAKH,OAAL,CAAaI,cAAb,EAApB;;AACA1C,mBAAS,CAAC2C,SAAV,CAAoB,KAAKvD,aAAzB,EAAwCqD,WAAW,CAAC,CAAD,CAAnD,EAAwDA,WAAW,CAAC,CAAD,CAAnE,EAV2D,CAY3D;;AACA,cAAMG,GAAG,GAAG,KAAKN,OAAL,CAAaO,MAAb,EAAZ;;AACA,cAAMC,IAAI,GAAG,KAAKR,OAAL,CAAaS,mBAAb,EAAb;;AACA/C,mBAAS,CAACgD,SAAV,CAAoB,KAAK3D,WAAzB,EAAsCyD,IAAtC;AACA9C,mBAAS,CAACiD,SAAV,CAAoB,KAAK3D,KAAzB,EAAgCsD,GAAG,CAAC,CAAD,CAAnC,EAAwCA,GAAG,CAAC,CAAD,CAA3C,EAAgDA,GAAG,CAAC,CAAD,CAAnD,EAhB2D,CAkB3D;;AACA5C,mBAAS,CAACkD,UAAV,CAAqBlD,SAAS,CAACmD,YAA/B,EAA6C,KAAKtE,iBAAlD;AACAmB,mBAAS,CAACoD,mBAAV,CAA8B,KAAKpE,WAAnC,EAAgDL,aAAa,CAAC0E,MAA9D,EAAsErD,SAAS,CAAC2B,KAAhF,EAAuF,KAAvF,EAA8F,CAA9F,EAAiG,CAAjG;AACA3B,mBAAS,CAACsD,uBAAV,CAAkC,KAAKtE,WAAvC,EArB2D,CAuB3D;;AACAgB,mBAAS,CAACkD,UAAV,CAAqBlD,SAAS,CAACmD,YAA/B,EAA6C,KAAKpE,mBAAlD;AACAiB,mBAAS,CAACoD,mBAAV,CAA8B,KAAKnE,aAAnC,EAAkD,CAAlD,EAAqDe,SAAS,CAAC2B,KAA/D,EAAsE,KAAtE,EAA6E,CAA7E,EAAgF,CAAhF;AACA3B,mBAAS,CAACsD,uBAAV,CAAkC,KAAKrE,aAAvC;AAEAe,mBAAS,CAACuD,UAAV,CAAqB,GAArB,EAA0B,GAA1B,EAA+B,GAA/B,EAAoC,GAApC,EA5B2D,CA6B3D;;AACAvD,mBAAS,CAACwD,KAAV,CAAgBxD,SAAS,CAACyD,gBAAV,GAA6BzD,SAAS,CAAC0D,gBAAvD,EA9B2D,CAgC3D;;AACA1D,mBAAS,CAACkD,UAAV,CAAqBlD,SAAS,CAAC2D,oBAA/B,EAAqD,KAAK7E,cAA1D,EAjC2D,CAkC3D;;AACAkB,mBAAS,CAAC4D,YAAV,CAAuB5D,SAAS,CAAC6D,SAAjC,EAA4C,KAAKjF,SAAL,CAAe,OAAf,EAAwB3T,MAApE,EAA4E+U,SAAS,CAAC8D,YAAtF,EAAoG,CAApG;AACD;AAGD;;;;;;;mCAIqB9D,S,EAAmC;AACtDA,mBAAS,CAAC6B,MAAV,CAAiB7B,SAAS,CAAC+D,KAA3B;AACA/D,mBAAS,CAACgE,SAAV,CAAoBhE,SAAS,CAACiE,SAA9B,EAAyCjE,SAAS,CAACkE,mBAAnD;AAEAlE,mBAAS,CAACoC,UAAV,CAAqB,KAAK3B,cAAL,CAAoB,CAApB,CAArB;AAEA,cAAM0D,cAAc,GAAyBnE,SAAS,CAACQ,kBAAV,CAA6B,KAAKC,cAAL,CAAoB,CAApB,CAA7B,EAAqD,WAArD,CAA7C;AACA,cAAM2D,gBAAgB,GAAyBpE,SAAS,CAACQ,kBAAV,CAA6B,KAAKC,cAAL,CAAoB,CAApB,CAA7B,EAAqD,aAArD,CAA/C;AACA,cAAM4D,UAAU,GAAyBrE,SAAS,CAACQ,kBAAV,CAA6B,KAAKC,cAAL,CAAoB,CAApB,CAA7B,EAAqD,OAArD,CAAzC;AACA,cAAM6D,aAAa,GAAyBtE,SAAS,CAACQ,kBAAV,CAA6B,KAAKC,cAAL,CAAoB,CAApB,CAA7B,EAAqD,UAArD,CAA5C;AACA,cAAM8D,YAAY,GAAyBvE,SAAS,CAACQ,kBAAV,CAA6B,KAAKC,cAAL,CAAoB,CAApB,CAA7B,EAAqD,cAArD,CAA3C;AACA,cAAM+D,iBAAiB,GAAyBxE,SAAS,CAACQ,kBAAV,CAA6B,KAAKC,cAAL,CAAoB,CAApB,CAA7B,EAAqD,mBAArD,CAAhD;AACA,cAAMgE,WAAW,GAAyBzE,SAAS,CAACQ,kBAAV,CAA6B,KAAKC,cAAL,CAAoB,CAApB,CAA7B,EAAqD,aAArD,CAA1C;AAEAT,mBAAS,CAACqC,gBAAV,CAA2BkC,YAA3B,EAAyC,KAAzC,EAAgD,KAAKjC,OAAL,CAAaoC,aAAb,EAAhD;AACA1E,mBAAS,CAACqC,gBAAV,CAA2BmC,iBAA3B,EAA8C,KAA9C,EAAqD,KAAKlC,OAAL,CAAaE,mBAAb,EAArD;AACAxC,mBAAS,CAACgD,SAAV,CAAoByB,WAApB,EAAiC,KAAKlF,UAAtC;AAEAS,mBAAS,CAAC2E,aAAV,CAAwB3E,SAAS,CAAC4E,QAAlC;AACA5E,mBAAS,CAAC6E,WAAV,CAAsB7E,SAAS,CAAC8E,UAAhC,EAA4C,KAAKlF,cAAjD;AACAI,mBAAS,CAAC+E,SAAV,CAAoBZ,cAApB,EAAoC,CAApC;AAEAnE,mBAAS,CAAC2E,aAAV,CAAwB3E,SAAS,CAACgF,QAAlC;AACAhF,mBAAS,CAAC6E,WAAV,CAAsB7E,SAAS,CAAC8E,UAAhC,EAA4C,KAAKhF,gBAAjD;AACAE,mBAAS,CAAC+E,SAAV,CAAoBX,gBAApB,EAAsC,CAAtC;AAEApE,mBAAS,CAAC2E,aAAV,CAAwB3E,SAAS,CAACiF,QAAlC;AACAjF,mBAAS,CAAC6E,WAAV,CAAsB7E,SAAS,CAAC8E,UAAhC,EAA4C,KAAK/E,UAAjD;AACAC,mBAAS,CAAC+E,SAAV,CAAoBV,UAApB,EAAgC,CAAhC;AAEArE,mBAAS,CAAC2E,aAAV,CAAwB3E,SAAS,CAACkF,QAAlC;AACAlF,mBAAS,CAAC6E,WAAV,CAAsB7E,SAAS,CAAC8E,UAAhC,EAA4C,KAAKjF,aAAjD;AACAG,mBAAS,CAAC+E,SAAV,CAAoBT,aAApB,EAAmC,CAAnC;AAEAtE,mBAAS,CAACmF,UAAV,CAAqBnF,SAAS,CAACoF,cAA/B,EAA+C,CAA/C,EAAkD,CAAlD;AACApF,mBAAS,CAACmC,OAAV,CAAkBnC,SAAS,CAAC+D,KAA5B;AACD;AAED;;;;;;;iCAImB/D,S,EAAmC;AACpD,cAAI,KAAKN,IAAL,IAAa,IAAb,IAAqB,KAAKC,QAAL,IAAiB,IAA1C,EAAgD;AAC9C;AACA,iBAAKD,IAAL,GAAYM,SAAS,CAACqF,iBAAV,EAAZ;AACA,iBAAK1F,QAAL,GAAgBK,SAAS,CAACqF,iBAAV,EAAhB;AACA,iBAAKxF,aAAL,GAAqBG,SAAS,CAACsF,aAAV,EAArB;AACA,iBAAK1F,cAAL,GAAsBI,SAAS,CAACsF,aAAV,EAAtB;AACA,iBAAKxF,gBAAL,GAAwBE,SAAS,CAACsF,aAAV,EAAxB;AACA,iBAAKvF,UAAL,GAAkBC,SAAS,CAACsF,aAAV,EAAlB,CAP8C,CAS9C;;AACA,gBAAMC,GAAG,GAAGvF,SAAS,CAACwF,YAAV,CAAuB,wBAAvB,CAAZ;;AACA,gBAAI,CAACD,GAAL,EAAU;AACR5E,qBAAO,CAAC8E,KAAR,CAAc,yCAAd;AACD;AACF,WAfmD,CAiBpD;;;AACA,cAAMC,QAAQ,GAAG,KAAKpD,OAAL,CAAaqD,qBAAb,EAAjB;;AACA,cAAI,KAAKnG,SAAL,KAAmBkG,QAAQ,CAAC,CAAD,CAA3B,IAAkC,KAAKjG,UAAL,KAAoBiG,QAAQ,CAAC,CAAD,CAAlE,EAAuE;AACrE;AACA,iBAAKlG,SAAL,GAAiBkG,QAAQ,CAAC,CAAD,CAAzB;AACA,iBAAKjG,UAAL,GAAkBiG,QAAQ,CAAC,CAAD,CAA1B,CAHqE,CAKrE;;AACA1F,qBAAS,CAAC6E,WAAV,CAAsB7E,SAAS,CAAC8E,UAAhC,EAA4C,KAAKlF,cAAjD;AACAI,qBAAS,CAAC4F,UAAV,CACE5F,SAAS,CAAC8E,UADZ,EACwB,CADxB,EAC2B9E,SAAS,CAAC6F,OADrC,EAEE,KAAKrG,SAFP,EAEkB,KAAKC,UAFvB,EAEmC,CAFnC,EAEsCO,SAAS,CAAC0B,IAFhD,EAEsD1B,SAAS,CAAC2B,KAFhE,EAEuE,IAFvE;AAIA3B,qBAAS,CAAC8F,aAAV,CAAwB9F,SAAS,CAAC8E,UAAlC,EAA8C9E,SAAS,CAAC+F,kBAAxD,EAA4E/F,SAAS,CAACgG,OAAtF;AACAhG,qBAAS,CAAC8F,aAAV,CAAwB9F,SAAS,CAAC8E,UAAlC,EAA8C9E,SAAS,CAACiG,kBAAxD,EAA4EjG,SAAS,CAACgG,OAAtF;AACAhG,qBAAS,CAAC8F,aAAV,CAAwB9F,SAAS,CAAC8E,UAAlC,EAA8C9E,SAAS,CAACkG,cAAxD,EAAwElG,SAAS,CAACmG,aAAlF;AACAnG,qBAAS,CAAC8F,aAAV,CAAwB9F,SAAS,CAAC8E,UAAlC,EAA8C9E,SAAS,CAACoG,cAAxD,EAAwEpG,SAAS,CAACmG,aAAlF,EAdqE,CAgBrE;;AACAnG,qBAAS,CAAC6E,WAAV,CAAsB7E,SAAS,CAAC8E,UAAhC,EAA4C,KAAKhF,gBAAjD;AACAE,qBAAS,CAAC4F,UAAV,CACE5F,SAAS,CAAC8E,UADZ,EACwB,CADxB,EAC2B9E,SAAS,CAAC6F,OADrC,EAEE,KAAKrG,SAFP,EAEkB,KAAKC,UAFvB,EAEmC,CAFnC,EAEsCO,SAAS,CAAC0B,IAFhD,EAEsD1B,SAAS,CAAC2B,KAFhE,EAEuE,IAFvE;AAIA3B,qBAAS,CAAC8F,aAAV,CAAwB9F,SAAS,CAAC8E,UAAlC,EAA8C9E,SAAS,CAAC+F,kBAAxD,EAA4E/F,SAAS,CAACgG,OAAtF;AACAhG,qBAAS,CAAC8F,aAAV,CAAwB9F,SAAS,CAAC8E,UAAlC,EAA8C9E,SAAS,CAACiG,kBAAxD,EAA4EjG,SAAS,CAACgG,OAAtF;AACAhG,qBAAS,CAAC8F,aAAV,CAAwB9F,SAAS,CAAC8E,UAAlC,EAA8C9E,SAAS,CAACkG,cAAxD,EAAwElG,SAAS,CAACmG,aAAlF;AACAnG,qBAAS,CAAC8F,aAAV,CAAwB9F,SAAS,CAAC8E,UAAlC,EAA8C9E,SAAS,CAACoG,cAAxD,EAAwEpG,SAAS,CAACmG,aAAlF,EAzBqE,CA2BrE;;AACAnG,qBAAS,CAAC6E,WAAV,CAAsB7E,SAAS,CAAC8E,UAAhC,EAA4C,KAAK/E,UAAjD;AACAC,qBAAS,CAAC4F,UAAV,CACE5F,SAAS,CAAC8E,UADZ,EACwB,CADxB,EAC2B9E,SAAS,CAAC6F,OADrC,EAEE,KAAKrG,SAFP,EAEkB,KAAKC,UAFvB,EAEmC,CAFnC,EAEsCO,SAAS,CAAC0B,IAFhD,EAEsD1B,SAAS,CAAC2B,KAFhE,EAEuE,IAFvE;AAIA3B,qBAAS,CAAC8F,aAAV,CAAwB9F,SAAS,CAAC8E,UAAlC,EAA8C9E,SAAS,CAAC+F,kBAAxD,EAA4E/F,SAAS,CAACgG,OAAtF;AACAhG,qBAAS,CAAC8F,aAAV,CAAwB9F,SAAS,CAAC8E,UAAlC,EAA8C9E,SAAS,CAACiG,kBAAxD,EAA4EjG,SAAS,CAACgG,OAAtF;AACAhG,qBAAS,CAAC8F,aAAV,CAAwB9F,SAAS,CAAC8E,UAAlC,EAA8C9E,SAAS,CAACkG,cAAxD,EAAwElG,SAAS,CAACmG,aAAlF;AACAnG,qBAAS,CAAC8F,aAAV,CAAwB9F,SAAS,CAAC8E,UAAlC,EAA8C9E,SAAS,CAACoG,cAAxD,EAAwEpG,SAAS,CAACmG,aAAlF,EApCqE,CAsCrE;;AACAnG,qBAAS,CAAC6E,WAAV,CAAsB7E,SAAS,CAAC8E,UAAhC,EAA4C,KAAKjF,aAAjD;AACAG,qBAAS,CAAC4F,UAAV,CACE5F,SAAS,CAAC8E,UADZ,EACwB,CADxB,EAC2B9E,SAAS,CAACqG,kBADrC,EAEE,KAAK7G,SAFP,EAEkB,KAAKC,UAFvB,EAEmC,CAFnC,EAEsCO,SAAS,CAACsG,eAFhD,EAEiEtG,SAAS,CAAC2B,KAF3E,EAEkF,IAFlF;AAIA3B,qBAAS,CAAC8F,aAAV,CAAwB9F,SAAS,CAAC8E,UAAlC,EAA8C9E,SAAS,CAAC+F,kBAAxD,EAA4E/F,SAAS,CAACgG,OAAtF;AACAhG,qBAAS,CAAC8F,aAAV,CAAwB9F,SAAS,CAAC8E,UAAlC,EAA8C9E,SAAS,CAACiG,kBAAxD,EAA4EjG,SAAS,CAACgG,OAAtF;AACAhG,qBAAS,CAAC8F,aAAV,CAAwB9F,SAAS,CAAC8E,UAAlC,EAA8C9E,SAAS,CAACkG,cAAxD,EAAwElG,SAAS,CAACmG,aAAlF;AACAnG,qBAAS,CAAC8F,aAAV,CAAwB9F,SAAS,CAAC8E,UAAlC,EAA8C9E,SAAS,CAACoG,cAAxD,EAAwEpG,SAAS,CAACmG,aAAlF,EA/CqE,CAiDrE;;AACAnG,qBAAS,CAACqB,eAAV,CAA0BrB,SAAS,CAACsB,WAApC,EAAiD,KAAK5B,IAAtD;AACAM,qBAAS,CAACuG,oBAAV,CAA+BvG,SAAS,CAACsB,WAAzC,EAAsDtB,SAAS,CAACwG,gBAAhE,EAAkFxG,SAAS,CAAC8E,UAA5F,EAAwG,KAAKjF,aAA7G,EAA4H,CAA5H;AACAG,qBAAS,CAACuG,oBAAV,CAA+BvG,SAAS,CAACsB,WAAzC,EAAsDtB,SAAS,CAACyG,iBAAhE,EAAmFzG,SAAS,CAAC8E,UAA7F,EAAyG,KAAKlF,cAA9G,EAA8H,CAA9H;AACAI,qBAAS,CAACuG,oBAAV,CAA+BvG,SAAS,CAACsB,WAAzC,EAAsDtB,SAAS,CAAC0G,iBAAhE,EAAmF1G,SAAS,CAAC8E,UAA7F,EAAyG,KAAKhF,gBAA9G,EAAgI,CAAhI;AACAE,qBAAS,CAACuG,oBAAV,CAA+BvG,SAAS,CAACsB,WAAzC,EAAsDtB,SAAS,CAAC2G,iBAAhE,EAAmF3G,SAAS,CAAC8E,UAA7F,EAAyG,KAAK/E,UAA9G,EAA0H,CAA1H;AACAC,qBAAS,CAAC4G,WAAV,CAAsB,CAAC5G,SAAS,CAACyG,iBAAX,EAA8BzG,SAAS,CAAC0G,iBAAxC,EAA2D1G,SAAS,CAAC2G,iBAArE,CAAtB,EAvDqE,CAyDrE;;AACA3G,qBAAS,CAACqB,eAAV,CAA0BrB,SAAS,CAACsB,WAApC,EAAiD,KAAK3B,QAAtD;AACAK,qBAAS,CAACuG,oBAAV,CAA+BvG,SAAS,CAACsB,WAAzC,EAAsDtB,SAAS,CAACyG,iBAAhE,EAAmFzG,SAAS,CAAC8E,UAA7F,EAAyG,KAAK/E,UAA9G,EAA0H,CAA1H,EA3DqE,CA6DrE;;AACAC,qBAAS,CAACqB,eAAV,CAA0BrB,SAAS,CAACsB,WAApC,EAAiD,IAAjD;AACD;AACF;AAED;;;;;;;sCAIwBtB,S,EAAmC;AACzD;AACA,eAAKnB,iBAAL,GAAyBmB,SAAS,CAAC6G,YAAV,EAAzB,CAFyD,CAGzD;;AACA7G,mBAAS,CAACkD,UAAV,CAAqBlD,SAAS,CAACmD,YAA/B,EAA6C,KAAKtE,iBAAlD,EAJyD,CAKzD;;AACAmB,mBAAS,CAAC8G,UAAV,CACE9G,SAAS,CAACmD,YADZ,EAC0B,IAAI3B,YAAJ,CAAiB,KAAK5C,SAAL,CAAe,UAAf,CAAjB,CAD1B,EACwEoB,SAAS,CAAC+G,WADlF,EANyD,CAUzD;;AACA,eAAKjI,cAAL,GAAsBkB,SAAS,CAAC6G,YAAV,EAAtB,CAXyD,CAYzD;;AACA7G,mBAAS,CAACkD,UAAV,CAAqBlD,SAAS,CAAC2D,oBAA/B,EAAqD,KAAK7E,cAA1D,EAbyD,CAczD;;AACAkB,mBAAS,CAAC8G,UAAV,CACE9G,SAAS,CAAC2D,oBADZ,EACkC,IAAIqD,WAAJ,CAAgB,KAAKpI,SAAL,CAAe,OAAf,CAAhB,CADlC,EAC4EoB,SAAS,CAAC+G,WADtF,EAfyD,CAmBzD;;AACA,eAAKhI,mBAAL,GAA2BiB,SAAS,CAAC6G,YAAV,EAA3B,CApByD,CAqBzD;;AACA7G,mBAAS,CAACkD,UAAV,CAAqBlD,SAAS,CAACmD,YAA/B,EAA6C,KAAKpE,mBAAlD,EAtByD,CAuBzD;;AACAiB,mBAAS,CAAC8G,UAAV,CACE9G,SAAS,CAACmD,YADZ,EAC0B,IAAI3B,YAAJ,CAAiB,KAAK5C,SAAL,CAAe,KAAf,CAAjB,CAD1B,EACmEoB,SAAS,CAAC+G,WAD7E;AAGD;;;sCAEuB/G,S,EAAmC;AACzDA,mBAAS,CAACoC,UAAV,CAAqB,KAAK3B,cAAL,CAAoB,CAApB,CAArB;AAEA,cAAMwG,cAAc,GAAyBjH,SAAS,CAACQ,kBAAV,CAA6B,KAAKC,cAAL,CAAoB,CAApB,CAA7B,EAAqD,QAArD,CAA7C;AACA,cAAMyG,gBAAgB,GAAyBlH,SAAS,CAACQ,kBAAV,CAA6B,KAAKC,cAAL,CAAoB,CAApB,CAA7B,EAAqD,UAArD,CAA/C;AAEA,cAAM0G,OAAO,GAAG,EAAhB;AACA,cAAMC,QAAQ,GAAG,EAAjB;;AACA,eAAK,IAAIjY,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGiY,QAApB,EAA8BjY,CAAC,EAA/B,EAAmC;AACjC,gBAAMkY,MAAM,GAAG,+CAAKC,UAAL,CACbta,IAAI,CAACua,MAAL,KAAgB,GAAhB,GAAsB,GADT,EAEbva,IAAI,CAACua,MAAL,KAAgB,GAAhB,GAAsB,GAFT,EAGbva,IAAI,CAACua,MAAL,EAHa,CAAf;AAKA,2DAAKC,SAAL,CAAeH,MAAf,EAAuBA,MAAvB,EANiC,CAOjC;;AACA,gBAAMxc,KAAK,GAAGsE,CAAC,GAAGiY,QAAlB;AACA,gBAAMK,EAAE,GAAG5c,KAAK,GAAGA,KAAnB;AACA,2DAAKA,KAAL,CAAWwc,MAAX,EAAmBA,MAAnB,EAA2B,MAAM,MAAMI,EAAvC;AACAN,mBAAO,CAACha,IAAR,CAAaka,MAAM,CAAC,CAAD,CAAnB;AACAF,mBAAO,CAACha,IAAR,CAAaka,MAAM,CAAC,CAAD,CAAnB;AACAF,mBAAO,CAACha,IAAR,CAAaka,MAAM,CAAC,CAAD,CAAnB;AACD;;AACDrH,mBAAS,CAAC0H,UAAV,CAAqBR,gBAArB,EAAuCC,OAAvC,EAAgD,CAAhD,EAAmDC,QAAQ,GAAG,CAA9D;AAEA,cAAMO,KAAK,GAAG,EAAd;AACA,cAAMC,SAAS,GAAG,GAAlB;;AACA,eAAK,IAAIzY,EAAC,GAAG,CAAb,EAAgBA,EAAC,GAAGyY,SAApB,EAA+BzY,EAAC,EAAhC,EAAoC;AAClC,gBAAM0Y,CAAC,GAAG,+CAAKP,UAAL,CACRta,IAAI,CAACua,MAAL,KAAgB,GAAhB,GAAsB,GADd,EAERva,IAAI,CAACua,MAAL,KAAgB,GAAhB,GAAsB,GAFd,EAGR,GAHQ,CAAV;AAKAI,iBAAK,CAACxa,IAAN,CAAW0a,CAAC,CAAC,CAAD,CAAZ;AACAF,iBAAK,CAACxa,IAAN,CAAW0a,CAAC,CAAC,CAAD,CAAZ;AACAF,iBAAK,CAACxa,IAAN,CAAW0a,CAAC,CAAC,CAAD,CAAZ;AACD;;AACD7H,mBAAS,CAAC0H,UAAV,CAAqBT,cAArB,EAAqCU,KAArC,EAA4C,CAA5C,EAA+CC,SAAS,GAAG,CAA3D;AACD;;;;MAlZgC,4C,GACjC;;;AACiB,kBAAAvE,MAAA,GAAS,CAAT,C,CACjB;;AACiB,kBAAApD,QAAA,GAAW,CAAX;;;;;;;;;;;;;;;;ACbnB;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAIA;;;;;QAGa6H,M;;;AA0BX;;;AAGA,sBAAYC,EAAZ,EAAwBC,EAAxB,EAAoCC,EAApC,EAAgD;AAAA;;AA5BhD;AACU,aAAAC,OAAA,GAAgB,+CAAKC,MAAL,EAAhB;AACA,aAAAC,IAAA,GAAa,+CAAKD,MAAL,EAAb;AACA,aAAAE,OAAA,GAAgB,+CAAKF,MAAL,EAAhB;AAEA,aAAAG,OAAA,GAAgB,+CAAKH,MAAL,EAAhB;AACA,aAAAI,GAAA,GAAY,+CAAKJ,MAAL,EAAZ;AAMA,aAAAK,IAAA,GAAO,KAAKxb,IAAI,CAACyb,EAAV,GAAe,KAAtB;AAEA,aAAAC,iBAAA,GAA0B,+CAAKP,MAAL,EAA1B;AACA,aAAAQ,WAAA,GAAoB,+CAAKR,MAAL,EAApB;AACA,aAAAS,YAAA,GAAqB,+CAAKT,MAAL,EAArB;AAaR,aAAKU,SAAL,GAAiB,mDAASC,gBAAT,CAA0Bf,EAA1B,EAA8BC,EAA9B,EAAkC,CAAlC,CAAjB,CAD8C,CAE9C;;AACA,aAAKe,KAAL,GAAa,KAAK,KAAKF,SAAvB;AACA,aAAKG,IAAL,GAAY,MAAM,KAAKH,SAAvB,CAJ8C,CAM9C;;AACA,aAAKX,OAAL,GAAe,+CAAKZ,UAAL,CAAgBS,EAAhB,EAAoBC,EAApB,CAAf;AACA,YAAMiB,eAAe,GAAG,CAAC,CAAD,EAAI,CAAJ,CAAxB;AACA,aAAKX,OAAL,GAAe,+CAAKhB,UAAL,CAAgB2B,eAAe,CAAC,CAAD,CAA/B,EAAoCA,eAAe,CAAC,CAAD,CAAnD,EAAwD,CAAxD,CAAf;AACA,aAAKb,IAAL,GAAY,+CAAKd,UAAL,CAAgB2B,eAAe,CAAC,CAAD,CAA/B,EAAoCA,eAAe,CAAC,CAAD,CAAnD,EAAwD,KAAxD,CAAZ,CAV8C,CAU8B;;AAC5E,aAAKC,QAAL,CAAc,IAAI,KAAKL,SAAvB,EAX8C,CAY9C;;AACA,aAAKN,GAAL,GAAW,+CAAKjB,UAAL,CAAgB,CAAhB,EAAmB,CAAnB,EAAsB,CAAtB,CAAX,CAb8C,CAc9C;;AACA,aAAK6B,MAAL,GAAc,wDAAaC,QAA3B;AACD;;;;0CAEc;AACb,iBAAO,KAAKD,MAAZ;AACD;;;wCAEeA,M,EAAsB;AACpC,eAAKA,MAAL,GAAcA,MAAd;;AACA,cAAI,KAAKA,MAAL,KAAgB,wDAAaE,QAAjC,EAA2C;AACzC;AACA,iBAAKf,OAAL,GAAe,+CAAKhB,UAAL,CAAgB,KAAKc,IAAL,CAAU,CAAV,CAAhB,EAA8B,KAAKA,IAAL,CAAU,CAAV,CAA9B,EAA4C,CAA5C,CAAf,CAFyC,CAGzC;;AACA,iBAAKG,GAAL,GAAW,+CAAKjB,UAAL,CAAgB,CAAhB,EAAmB,CAAnB,EAAsB,CAAtB,CAAX;AACA,iBAAKe,OAAL,GAAe,+CAAKf,UAAL,CAAgB,CAAhB,EAAmB,CAAnB,EAAsB,CAAC,CAAvB,CAAf;AACA,iBAAKgC,UAAL,GAAkB,+CAAKre,MAAL,CAAY,KAAKod,OAAjB,CAAlB;AACD;AACF;;;8CAEkB;AACjB,iBAAO,KAAKK,iBAAZ;AACD;;;wCAEY;AACX,iBAAO,KAAKC,WAAZ;AACD;;;6CAEiB;AAChB,cAAMY,eAAe,GAAG,+CAAKC,GAAL,CAAS,+CAAKrB,MAAL,EAAT,EAAwB,KAAKQ,WAA7B,EAA0C,KAAKC,YAA/C,CAAxB,CADgB,CACsE;;AACtF,iBAAOW,eAAP;AACD;;;yCAEa;AACZ,iBAAO,KAAKrB,OAAZ;AACD;;;iCAEK;AACJ,iBAAO,KAAKE,IAAZ;AACD;;;8CAEkB;AACjB,iBAAO,KAAKS,SAAZ;AACD;;;8CAEqBhb,C,EAAWE,C,EAAW;AAC1C,eAAK0b,aAAL,GAAqB5b,CAArB;AACA,eAAK6b,cAAL,GAAsB3b,CAAtB;AACD;;;gDAEoB;AACnB,iBAAO,CACL,KAAK0b,aADA,EAEL,KAAKC,cAFA,CAAP;AAID;;;6CAEoB;AACnB,yDAAKC,GAAL,CAAS,KAAKtB,OAAd,EAAuB,KAAKC,OAA5B,EAAqC,KAAKF,IAA1C;AACA,eAAKkB,UAAL,GAAkB,+CAAKre,MAAL,CAAY,KAAKod,OAAjB,CAAlB;AACA,yDAAKb,SAAL,CAAe,KAAKa,OAApB,EAA6B,KAAKA,OAAlC;AACD;;;iCAEQxd,K,EAAe;AACtB,eAAKud,IAAL,CAAU,CAAV,IAAe,KAAKA,IAAL,CAAU,CAAV,IAAevd,KAA9B;AACA,eAAKyd,OAAL,CAAa,CAAb,IAAkB,KAAKA,OAAL,CAAa,CAAb,IAAkBzd,KAApC;AAEA,eAAK+e,kBAAL;AACD;;;6BAEIC,K,EAAehc,C,EAAWE,C,EAAW;AACxC8b,eAAK,GAAGA,KAAK,GAAG,CAAR,GAAY,KAAZ,GAAoB,CAAC,KAA7B;AAEA,cAAMC,GAAG,GAAG,KAAKC,qBAAL,CAA2Blc,CAA3B,EAA8BE,CAA9B,CAAZ;AACA,yDAAKic,WAAL,CAAiB,KAAK5B,IAAtB,EAA4B,KAAKA,IAAjC,EAAuC0B,GAAvC,EAA4CD,KAA5C,EAJwC,CAIY;;AACpD,yDAAKG,WAAL,CAAiB,KAAK1B,OAAtB,EAA+B,KAAKF,IAApC,EAA0C,KAAKC,OAA/C,EAAwD,KAAKiB,UAA7D,EALwC,CAKkC;AAC3E;;;kCAESW,E,EAAYC,E,EAAY;AAChC,cAAMrf,KAAK,GAAG,KAAKud,IAAL,CAAU,CAAV,CAAd;AACA,cAAM+B,CAAC,GAAG,+CAAKhC,MAAL,EAAV;AACA,yDAAKX,SAAL,CAAe2C,CAAf,EAAkB,+CAAKC,KAAL,CAAWD,CAAX,EAAc,KAAK9B,OAAnB,EAA4B,KAAKE,GAAjC,CAAlB,EAHgC,CAKhC;;AACA,cAAM8B,CAAC,GAAG,+CAAKC,GAAL,CAAS,+CAAKnC,MAAL,EAAT,EAAwB,+CAAKtd,KAAL,CAAW,+CAAKsd,MAAL,EAAX,EAA0BgC,CAA1B,EAA6BF,EAAE,GAAGpf,KAAlC,CAAxB,EAAkE,+CAAKA,KAAL,CAAW,+CAAKsd,MAAL,EAAX,EAA0B,KAAKI,GAA/B,EAAoC2B,EAAE,GAAGrf,KAAzC,CAAlE,CAAV;AACA,yDAAKyf,GAAL,CAAS,KAAKlC,IAAd,EAAoB,KAAKA,IAAzB,EAA+BiC,CAA/B;AAEA,yDAAKL,WAAL,CAAiB,KAAK1B,OAAtB,EAA+B,KAAKF,IAApC,EAA0C,KAAKC,OAA/C,EAAwD,KAAKiB,UAA7D,EATgC,CAS0C;AAC3E;;;4BAEGO,K,EAAe;AACjB,yDAAKU,OAAL,CAAa,KAAKlC,OAAlB,EAA2B,KAAKA,OAAhC,EAAyC,+CAAKf,UAAL,CAAgB,CAAhB,EAAmB,CAAnB,EAAsB,CAAtB,CAAzC,EAAmEuC,KAAnE;AACA,yDAAKU,OAAL,CAAa,KAAKhC,GAAlB,EAAuB,KAAKA,GAA5B,EAAiC,+CAAKjB,UAAL,CAAgB,CAAhB,EAAmB,CAAnB,EAAsB,CAAtB,CAAjC,EAA2DuC,KAA3D;AAEA,yDAAKG,WAAL,CAAiB,KAAK1B,OAAtB,EAA+B,KAAKF,IAApC,EAA0C,KAAKC,OAA/C,EAAwD,KAAKiB,UAA7D,EAJiB,CAIyD;AAC3E;;;8BAEKO,K,EAAe;AACnBA,eAAK,GAAG,CAACA,KAAT,CADmB,CAEnB;;AACA,yDAAKS,GAAL,CAAS,KAAKjC,OAAd,EAAuB,+CAAKxd,KAAL,CAAW,+CAAKsd,MAAL,EAAX,EAA0B,KAAKI,GAA/B,EAAoCvb,IAAI,CAACwd,GAAL,CAASX,KAAT,CAApC,CAAvB,EAA6E,+CAAKhf,KAAL,CAAW,+CAAKsd,MAAL,EAAX,EAA0B,KAAKE,OAA/B,EAAwCrb,IAAI,CAACyd,GAAL,CAASZ,KAAT,CAAxC,CAA7E;AACA,yDAAKrC,SAAL,CAAe,KAAKa,OAApB,EAA6B,KAAKA,OAAlC;AAEA,yDAAK2B,WAAL,CAAiB,KAAK1B,OAAtB,EAA+B,KAAKF,IAApC,EAA0C,KAAKC,OAA/C,EAAwD,KAAKiB,UAA7D,EANmB,CAMuD;;AAE1E,yDAAKc,KAAL,CAAW,KAAK7B,GAAhB,EAAqB,+CAAK6B,KAAL,CAAW,+CAAKjC,MAAL,EAAX,EAA0B,KAAKE,OAA/B,EAAwC,KAAKE,GAA7C,CAArB,EAAwE,KAAKF,OAA7E;AACA,yDAAKb,SAAL,CAAe,KAAKe,GAApB,EAAyB,KAAKA,GAA9B;AACD;;;iCAEQ;AACP,eAAKK,YAAL,GAAoB,+CAAK8B,WAAL,CAAiB,+CAAKvC,MAAL,EAAjB,EAAgC,+CAAKb,UAAL,CAAgB,CAAhB,EAAmB,CAAnB,EAAsB,IAAI,KAAKuB,SAA/B,CAAhC,CAApB,CADO,CACyF;;AAChG,yDAAK8B,MAAL,CAAY,KAAKhC,WAAjB,EAA8B,KAAKP,IAAnC,EAAyC,KAAKE,OAA9C,EAAuD,KAAKC,GAA5D,EAFO,CAE2D;;AAClE,yDAAKqC,WAAL,CAAiB,KAAKlC,iBAAtB,EAAyC,KAAKF,IAA9C,EAAoD,CAApD,EAAuD,KAAKO,KAA5D,EAAmE,KAAKC,IAAxE,EAHO,CAGwE;AAChF;;;8CAEqBnb,C,EAAWE,C,EAAW;AAC1C,cAAM8c,MAAM,GAAG,+CAAK1C,MAAL,EAAf;AACA,yDAAKX,SAAL,CAAeqD,MAAf,EAAuB,+CAAKT,KAAL,CAAWS,MAAX,EAAmB,KAAKxC,OAAxB,EAAiC,KAAKE,GAAtC,CAAvB;AAEA,cAAMuC,QAAQ,GAAG,+CAAKjgB,KAAL,CAAW,+CAAKsd,MAAL,EAAX,EAA0B,KAAKI,GAA/B,EAAoCvb,IAAI,CAAC+d,GAAL,CAAS,KAAKvC,IAAL,GAAY,CAArB,KAA2Bza,CAAC,GAAG,GAA/B,IAAsC,CAA1E,CAAjB;AACA,cAAMid,WAAW,GAAG,+CAAKngB,KAAL,CAAW,+CAAKsd,MAAL,EAAX,EAA0B0C,MAA1B,EAAkC7d,IAAI,CAAC+d,GAAL,CAAS,KAAKvC,IAAL,GAAY,CAArB,KAA2B3a,CAAC,GAAG,GAA/B,IAAsC,CAAxE,CAApB;AACA,cAAMod,MAAM,GAAG,+CAAKX,GAAL,CAAS,+CAAKnC,MAAL,EAAT,EAAwB2C,QAAxB,EAAkCE,WAAlC,CAAf;AACA,cAAMlB,GAAG,GAAG,+CAAKQ,GAAL,CAAS,+CAAKnC,MAAL,EAAT,EAAwB,KAAKE,OAA7B,EAAsC4C,MAAtC,CAAZ;AACA,yDAAKzD,SAAL,CAAesC,GAAf,EAAoBA,GAApB;AAEA,iBAAOA,GAAP;AACD;;;4CAEmBjc,C,EAAWE,C,EAAW;AACxC,cAAM+b,GAAG,GAAG,KAAKC,qBAAL,CAA2Blc,CAA3B,EAA8BE,CAA9B,CAAZ;AAEA,cAAMmd,CAAC,GAAG,CAAC,KAAK9C,IAAL,CAAU,CAAV,CAAD,GAAgB0B,GAAG,CAAC,CAAD,CAA7B;;AACA,cAAIoB,CAAC,GAAG,CAAR,EAAW;AACT,gBAAMC,cAAc,GAAG,+CAAKnB,WAAL,CAAiB,+CAAK7B,MAAL,EAAjB,EAAgC,KAAKC,IAArC,EAA2C0B,GAA3C,EAAgDoB,CAAhD,CAAvB;;AACA,gBAAME,WAAW,GAAG,mDAASC,YAAT,CAAsB,KAAKnD,OAAL,CAAa,CAAb,CAAtB,EAAuC,KAAKA,OAAL,CAAa,CAAb,CAAvC,CAApB;;AACA,gBAAMoD,MAAM,GAAG,mDAASC,YAAT,CAAsBJ,cAAc,CAAC,CAAD,CAAd,GAAoBC,WAAW,CAAC,CAAD,CAArD,EAA0DD,cAAc,CAAC,CAAD,CAAd,GAAoBC,WAAW,CAAC,CAAD,CAAzF,CAAf;;AACAzK,mBAAO,CAACC,GAAR,CAAY0K,MAAZ;AACA,mBAAOA,MAAP;AACD;;AACD,iBAAO,IAAP;AACD;;;;;;;;;;;;;;;;;;;;;AC9LH;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;;QAGsBE,Q;;;;;;;;;;AACrB;;;wCAGiE;AAAA,cAApCC,OAAoC,uEAAjB,KAAiB;AAAA,cAAVhc,IAAU,uEAAH,GAAG;AAC9D,cAAMic,MAAM,GAAG,kDAAkB,kDAAlB,EAAsC9gB,MAAtC,CAA6C,CAAC,CAAC,CAAF,EAAK,CAAL,EAAQ,CAAR,CAA7C,CAAf;AAEA,cAAM+gB,MAAM,GAAG,EAAf;;AAEA,eAAK,IAAI1lB,EAAE,GAAG,CAAd,EAAkBA,EAAE,GAAGwJ,IAAvB,EAA6BxJ,EAAE,EAA/B,EAAmC;AAC/B,gBAAM2G,GAAG,GAAI,CAAC,CAAD,GAAK3G,EAAE,GAAG,CAAL,IAAUwJ,IAAI,GAAG,CAAjB,CAAlB;AACA,gBAAMmc,KAAK,GAAGF,MAAM,CAAC9e,GAAD,CAAN,CAAYif,KAAZ,CAAkB,MAAlB,EAA0BnjB,GAA1B,CAA8B,UAAA0C,CAAC;AAAA,qBAAI,CAACA,CAAL;AAAA,aAA/B,CAAd;AAEAugB,kBAAM,CAACxe,IAAP,OAAAwe,MAAM,qBAASC,KAAT,EAAN;AACAD,kBAAM,CAACxe,IAAP,CAAY,GAAZ;AACH;;AAED,cAAIse,OAAJ,EAAa;AACX,mBAAOE,MAAM,CAACF,OAAP,EAAP;AACD,WAFD,MAEO;AACL,mBAAOE,MAAP;AACD;AACF;AAED;;;;;;yCAGiE;AAAA,cAApCF,OAAoC,uEAAjB,KAAiB;AAAA,cAAVhc,IAAU,uEAAH,GAAG;AAC/D,cAAMic,MAAM,GAAG,kDAAkB,mDAAlB,EAAuC9gB,MAAvC,CAA8C,CAAC,CAAC,CAAF,EAAK,CAAL,EAAQ,CAAR,CAA9C,CAAf;AAEA,cAAM+gB,MAAM,GAAG,EAAf;;AAEA,eAAK,IAAI1lB,EAAE,GAAG,CAAd,EAAkBA,EAAE,GAAGwJ,IAAvB,EAA6BxJ,EAAE,EAA/B,EAAmC;AAC/B,gBAAM2G,GAAG,GAAI,CAAC,CAAD,GAAK3G,EAAE,GAAG,CAAL,IAAUwJ,IAAI,GAAG,CAAjB,CAAlB;AACA,gBAAMmc,KAAK,GAAGF,MAAM,CAAC9e,GAAD,CAAN,CAAYif,KAAZ,CAAkB,MAAlB,EAA0BnjB,GAA1B,CAA8B,UAAA0C,CAAC;AAAA,qBAAI,CAACA,CAAL;AAAA,aAA/B,CAAd;AAEAugB,kBAAM,CAACxe,IAAP,OAAAwe,MAAM,qBAASC,KAAT,EAAN;AACAD,kBAAM,CAACxe,IAAP,CAAY,GAAZ;AACH;;AAGD,cAAIse,OAAJ,EAAa;AACX,mBAAOE,MAAM,CAACF,OAAP,EAAP;AACD,WAFD,MAEO;AACL,mBAAOE,MAAP;AACD;AACF;AAED;;;;;;8CAGsE;AAAA,cAApCF,OAAoC,uEAAjB,KAAiB;AAAA,cAAVhc,IAAU,uEAAH,GAAG;AACpE,cAAMic,MAAM,GAAG,kDAAkB,oDAAlB,EAAwC9gB,MAAxC,CAA+C,CAAC,CAAC,CAAF,EAAK,CAAL,EAAQ,CAAR,CAA/C,CAAf;AAEA,cAAM+gB,MAAM,GAAG,EAAf;;AAEA,eAAK,IAAI1lB,EAAE,GAAG,CAAd,EAAkBA,EAAE,GAAGwJ,IAAvB,EAA6BxJ,EAAE,EAA/B,EAAmC;AAC/B,gBAAM2G,GAAG,GAAI,CAAC,CAAD,GAAK3G,EAAE,GAAG,CAAL,IAAUwJ,IAAI,GAAG,CAAjB,CAAlB;AACA,gBAAMmc,KAAK,GAAGF,MAAM,CAAC9e,GAAD,CAAN,CAAYif,KAAZ,CAAkB,MAAlB,EAA0BnjB,GAA1B,CAA8B,UAAA0C,CAAC;AAAA,qBAAI,CAACA,CAAL;AAAA,aAA/B,CAAd;AAEAugB,kBAAM,CAACxe,IAAP,OAAAwe,MAAM,qBAASC,KAAT,EAAN;AACAD,kBAAM,CAACxe,IAAP,CAAY,GAAZ;AACH;;AAED,cAAIse,OAAJ,EAAa;AACX,mBAAOE,MAAM,CAACF,OAAP,EAAP;AACD,WAFD,MAEO;AACL,mBAAOE,MAAP;AACD;AACF;AAGD;;;;;;2CAGmE;AAAA,cAApCF,OAAoC,uEAAjB,KAAiB;AAAA,cAAVhc,IAAU,uEAAH,GAAG;AACjE,cAAMic,MAAM,GAAG,kDAAkB,kDAAlB,EAAsC9gB,MAAtC,CAA6C,CAAC,CAAC,CAAF,EAAK,CAAL,EAAQ,CAAR,CAA7C,CAAf;AAEA,cAAM+gB,MAAM,GAAG,EAAf;;AAEA,eAAK,IAAI1lB,EAAE,GAAG,CAAd,EAAkBA,EAAE,GAAGwJ,IAAvB,EAA6BxJ,EAAE,EAA/B,EAAmC;AAC/B,gBAAM2G,GAAG,GAAI,CAAC,CAAD,GAAK3G,EAAE,GAAG,CAAL,IAAUwJ,IAAI,GAAG,CAAjB,CAAlB;AACA,gBAAMmc,KAAK,GAAGF,MAAM,CAAC9e,GAAD,CAAN,CAAYif,KAAZ,CAAkB,MAAlB,EAA0BnjB,GAA1B,CAA8B,UAAA0C,CAAC;AAAA,qBAAI,CAACA,CAAL;AAAA,aAA/B,CAAd;AAEAugB,kBAAM,CAACxe,IAAP,OAAAwe,MAAM,qBAASC,KAAT,EAAN;AACAD,kBAAM,CAACxe,IAAP,CAAY,GAAZ;AACH;;AAGD,cAAIse,OAAJ,EAAa;AACX,mBAAOE,MAAM,CAACF,OAAP,EAAP;AACD,WAFD,MAEO;AACL,mBAAOE,MAAP;AACD;AACF;AAED;;;;;;8CAGsE;AAAA,cAApCF,OAAoC,uEAAjB,KAAiB;AAAA,cAAVhc,IAAU,uEAAH,GAAG;AACpE,cAAMic,MAAM,GAAG,kDAAkB,kDAAlB,EAAsC9gB,MAAtC,CAA6C,CAAC,CAAC,CAAF,EAAK,CAAL,EAAQ,CAAR,CAA7C,CAAf;AAEA,cAAM+gB,MAAM,GAAG,EAAf;;AAEA,eAAK,IAAI1lB,EAAE,GAAG,CAAd,EAAkBA,EAAE,GAAGwJ,IAAvB,EAA6BxJ,EAAE,EAA/B,EAAmC;AAC/B,gBAAM2G,GAAG,GAAI,CAAC,CAAD,GAAK3G,EAAE,GAAG,CAAL,IAAUwJ,IAAI,GAAG,CAAjB,CAAlB;AACA,gBAAMmc,KAAK,GAAGF,MAAM,CAAC9e,GAAD,CAAN,CAAYif,KAAZ,CAAkB,MAAlB,EAA0BnjB,GAA1B,CAA8B,UAAA0C,CAAC;AAAA,qBAAI,CAACA,CAAL;AAAA,aAA/B,CAAd;AAEAugB,kBAAM,CAACxe,IAAP,OAAAwe,MAAM,qBAASC,KAAT,EAAN;AACAD,kBAAM,CAACxe,IAAP,CAAY,GAAZ;AACH;;AAED,cAAIse,OAAJ,EAAa;AACX,mBAAOE,MAAM,CAACF,OAAP,EAAP;AACD,WAFD,MAEO;AACL,mBAAOE,MAAP;AACD;AACF;AAED;;;;;;sCAGkD;AAAA,cAAxBF,OAAwB,uEAAL,KAAK;AAChD;AAEA,cAAME,MAAM,GAAG,CACb,GADa,EACR,GADQ,EACH,GADG,EACE,GADF,EAEb,GAFa,EAER,GAFQ,EAEH,GAFG,EAEE,GAFF,EAGb,GAHa,EAGR,GAHQ,EAGH,GAHG,EAGE,GAHF,EAIb,GAJa,EAIR,GAJQ,EAIH,GAJG,EAIE,GAJF,EAKb,GALa,EAKR,GALQ,EAKH,GALG,EAKE,GALF,EAMZ,EANY,EAMR,GANQ,EAMH,GANG,EAME,GANF,EAOZ,EAPY,EAOR,GAPQ,EAOF,EAPE,EAOE,GAPF,EAQb,GARa,EAQP,EARO,EAQF,EARE,EAQE,GARF,EASb,GATa,EASR,GATQ,EASD,CATC,EASE,GATF,CAAf;;AAYA,cAAIF,OAAJ,EAAa;AACX,mBAAOE,MAAM,CAACF,OAAP,EAAP;AACD,WAFD,MAEO;AACL,mBAAOE,MAAP;AACD;AACF;;;oCAEyBC,K,EAA6C;AAAA,cAAxBH,OAAwB,uEAAL,KAAK;;AACrE,kBAAQG,KAAR;AACE,iBAAK,wDAAaE,kBAAlB;AACA,qBAAON,QAAQ,CAACO,aAAT,CAAuBN,OAAvB,CAAP;;AAEA,iBAAK,wDAAaO,mBAAlB;AACA,qBAAOR,QAAQ,CAACS,cAAT,CAAwBR,OAAxB,CAAP;;AAEA,iBAAK,wDAAaS,sBAAlB;AACA,qBAAOV,QAAQ,CAACW,gBAAT,CAA0BV,OAA1B,CAAP;;AAEA,iBAAK,wDAAaW,0BAAlB;AACA,qBAAOZ,QAAQ,CAACa,mBAAT,CAA6BZ,OAA7B,CAAP;;AAEA,iBAAK,wDAAaa,yBAAlB;AACA,qBAAOd,QAAQ,CAACe,mBAAT,CAA6Bd,OAA7B,CAAP;;AAEA,iBAAK,wDAAae,eAAlB;AACA,qBAAOhB,QAAQ,CAACiB,WAAT,CAAqBhB,OAArB,CAAP;;AAEA;AACA,qBAAOD,QAAQ,CAACO,aAAT,CAAuBN,OAAvB,CAAP;AApBF;AAsBD;;;2CAEyB7e,G,EAAKkC,G,EAAKC,G,EAAkB;AAAA,cAAb2d,OAAa,uEAAH,CAAG;AACpD,cAAIC,MAAM,GAAG,IAAb;;AAEA,cAAK7d,GAAG,GAAG4d,OAAN,IAAiB3d,GAAG,GAAG2d,OAAxB,IAAqC5d,GAAG,GAAG4d,OAAN,IAAiB3d,GAAG,GAAG2d,OAAhE,EAA0E;AACxEA,mBAAO,GAAG,CAAC5d,GAAG,GAAGC,GAAP,IAAc,GAAxB;AACD;;AAED,cAAInC,GAAG,GAAG8f,OAAV,EAAmB;AACjBC,kBAAM,GAAG,CAAC/f,GAAG,GAAGkC,GAAP,KAAe4d,OAAO,GAAG5d,GAAzB,IAAgC,GAAzC;AACD,WAFD,MAEO;AACL6d,kBAAM,GAAG,MAAM,CAAC/f,GAAG,GAAG8f,OAAP,KAAmB3d,GAAG,GAAG2d,OAAzB,IAAoC,GAAnD;AACD;;AAED,cAAI9f,GAAG,KAAK8f,OAAR,IAAmBA,OAAO,KAAK5d,GAA/B,IAAsCA,GAAG,KAAKC,GAAlD,EAAuD;AACrD,mBAAO,GAAP;AACD;;AAED,iBAAO4d,MAAP;AACD;;;;;;;;;;;;;;;;;;;;;AC9LH;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;;;QAGaC,U;;;;AACG,eAAAC,cAAA,GAAiB,UAAjB;AACA,eAAAC,cAAA,GAAiB,UAAjB;AACA,eAAAC,aAAA,GAAgB,SAAhB;AACA,eAAAC,aAAA,GAAgB,SAAhB;AACA,eAAAC,WAAA,GAAc,OAAd;AACA,eAAAC,UAAA,GAAa,MAAb;AAGhB;;;;QAGaC,Y;;;;AACG,iBAAArB,kBAAA,GAAqB,gBAArB;AACA,iBAAAE,mBAAA,GAAsB,iBAAtB;AACA,iBAAAE,sBAAA,GAAyB,oBAAzB;AACA,iBAAAE,0BAAA,GAA6B,2BAA7B;AACA,iBAAAE,yBAAA,GAA4B,uBAA5B;AACA,iBAAAE,eAAA,GAAkB,aAAlB;AAGhB;;;;QAGaY,a;;;;AACG,kBAAAC,IAAA,GAAO,CAAP;AACA,kBAAAC,IAAA,GAAO,CAAP;AAGhB;;;;QAGaC,Y;;;;AACG,iBAAAlE,QAAA,GAAW,CAAX;AACA,iBAAAD,QAAA,GAAW,CAAX;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;QClCMoE,O;;;;;;;;;;AACpB;;;;oCAIyBC,K,EAAK;;;;;;;;;AACtBC,uB,aAAS,sEAAYC,O,qBAAkB,sEAAYC,M,cAAUH,K;AACnE9M,2BAAO,CAACC,GAAR,CAAY8M,GAAZ;;AAEiB,2BAAM,wDAAWG,WAAX,CAAuBH,GAAvB,CAAN;;;AAAXI,4B;sDACCA,Q;;;;;;;;;AACR;AAED;;;;;;;4CAIiCC,M,EAAM;;;;;;;;;AAC/BL,uB,aAAS,sEAAYC,O,qBAAkB,sEAAYC,M,cAAUG,M;AACnEpN,2BAAO,CAACC,GAAR,CAAY8M,GAAZ;;AAEe,2BAAM,wDAAWG,WAAX,CAAuBH,GAAvB,CAAN;;;AAAThY,0B;sDACCA,M;;;;;;;;;AACR;AAED;;;;;;;wCAI6BsY,O,EAAe;;;;;;;;;AACpCN,uB,aAAS,sEAAYC,O,qBAAkB,sEAAYC,M,cAAUI,O;AACnErN,2BAAO,CAACC,GAAR,CAAY8M,GAAZ;;AAEgB,2BAAM,wDAAWG,WAAX,CAAuBH,GAAvB,CAAN;;;AAAV3M,2B;uDACCA,O;;;;;;;;;AACR;AAED;;;;;;;yCAI8BiN,O,EAAe;;;;;;;;;AAC3C;AACMN,uB,aAAS,sEAAYC,O,qBAAkB,sEAAYC,M,cAAUI,O;AACnErN,2BAAO,CAACC,GAAR,CAAY8M,GAAZ;;AAEgB,2BAAM,wDAAWG,WAAX,CAAuBH,GAAvB,CAAN;;;AAAV3M,2B;uDACCA,O;;;;;;;;;AACR;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;QCnDmBkN,U;;;;;;;;;;AACpB;;;;;oCAKyBP,G,EAAW;;;;;;;;;;AAEjB,2BAAMQ,KAAK,CAACR,GAAD,CAAX;;;AAAXS,4B;;AACO,2BAAMA,QAAQ,CAACC,IAAT,EAAN;;;AAAPA,wB;uDAECA,I;;;;;;;;;AACR;AAED;;;;;;;;oCAKyBV,G,EAAW;;;;;;;;;;AAEjB,2BAAMQ,KAAK,CAACR,GAAD,CAAX;;;AAAXS,4B;;AACM,2BAAMA,QAAQ,CAACrkB,IAAT,EAAN;;;AAANukB,uB;uDAECA,G;;;;;;;;;AACR;;;;;;;;;;;;;;;;;;;;;ACxBH;AAAA;;;AAAA;AAAA;AAAA;;QAAsBC,Q;;;;;;;;;;AACpB;;;;;;qCAM2BC,Q,EAAkBC,S,EAAmB;AAC9D,cAAMC,IAAI,GAAG,2DAAb;AACA,cAAMC,MAAM,GAAG,2DAAf;AAEA,cAAMC,WAAW,GAAG3hB,IAAI,CAACwd,GAAL,CAAS+D,QAAQ,GAAGG,MAApB,CAApB;AACA,cAAME,MAAM,GAAG,QAAS,CAAC,MAAM5hB,IAAI,CAAC4T,GAAL,CAAS,CAAC,MAAM+N,WAAP,KAAuB,MAAMA,WAA7B,CAAT,IAAuDF,IAA9D,IAAuE,KAA/F;AACA,cAAMI,MAAM,GAAI,CAACL,SAAS,GAAG,KAAb,IAAsB,KAAvB,GAAgC,KAA/C;AACA,iBAAO,CAACK,MAAD,EAASD,MAAT,CAAP;AACD;AAED;;;;;;;;;qCAM2B/gB,C,EAAWE,C,EAAW;AAC/C,cAAM0gB,IAAI,GAAG,2DAAb;AACA,cAAMC,MAAM,GAAG,2DAAf;AAEA,cAAMF,SAAS,GAAK3gB,CAAC,GAAG,KAAL,GAAc,KAAf,GAAwB,KAA1C;AACA,cAAI0gB,QAAQ,GAAG,CAAC,QAAQxgB,CAAT,IAAc,KAA7B;AACAwgB,kBAAQ,GAAGvhB,IAAI,CAAC8hB,GAAL,CAAS,CAAC,MAAMP,QAAP,IAAmBE,IAA5B,CAAX;AACAF,kBAAQ,GAAG,CAACA,QAAQ,GAAG,GAAZ,KAAoB,MAAMA,QAA1B,CAAX;AACAA,kBAAQ,GAAGvhB,IAAI,CAAC+hB,IAAL,CAAUR,QAAV,IAAsBG,MAAjC;AACA,iBAAO,CAACH,QAAD,EAAWC,SAAX,CAAP;AACD;AAED;;;;;;;;;yCAM+BQ,G,EAAKC,G,EAAKC,I,EAAM;AAC7C,iBAAOliB,IAAI,CAACyd,GAAL,CAASuE,GAAG,GAAGhiB,IAAI,CAACyb,EAAX,GAAgB,GAAzB,IAAgC,OAAhC,GAA0C,CAA1C,GAA8Czb,IAAI,CAACyb,EAAnD,GAAwDzb,IAAI,CAACmiB,GAAL,CAAS,CAAT,EAAY,IAAID,IAAhB,CAA/D;AACD;;;;;;;;;;;;;;;;;;;;;AC5CH;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA,mE,CAAA;;;QAUaE,Y;;;;;AAkCX;;;;AAIA,4BAAYnpB,EAAZ,EAAwB;AAAA;;AAAA;;AACtB,4FAAMA,EAAN,GADsB,CAhCxB;;AACU,gBAAA2Y,SAAA,GAAiB,EAAjB,CA+Bc,CA7BxB;;AACU,gBAAAC,iBAAA,GAAiC,IAAjC;AACA,gBAAAwQ,kBAAA,GAAkC,IAAlC;AACA,gBAAAvQ,cAAA,GAA8B,IAA9B;AAEA,gBAAAwQ,cAAA,GAA+B,IAA/B;AACA,gBAAAC,cAAA,GAA+B,IAA/B,CAuBc,CArBxB;;AACU,gBAAAC,aAAA,GAAgB,CAAhB;AACA,gBAAAC,aAAA,GAAgB,CAAhB,CAmBc,CAjBxB;;AACU,gBAAAzQ,WAAA,GAAc,CAAC,CAAf;AACA,gBAAA0Q,YAAA,GAAe,CAAC,CAAhB,CAec,CAbxB;;AACU,gBAAAxQ,mBAAA,GAA4C,CAAC,CAA7C;AACA,gBAAAC,oBAAA,GAA6C,CAAC,CAA9C;AACA,gBAAAwQ,eAAA,GAAwC,CAAC,CAAzC,CAUc,CARxB;;AACU,gBAAAC,YAAA,GAAqC,CAAC,CAAtC;AACA,gBAAAC,YAAA,GAAqC,CAAC,CAAtC;AAQR,gBAAKC,QAAL,GAAgB,KAAhB;AAFsB;AAGvB;AAED;;;;;;;;oCAIkB9P,S,EAAmC;;;;;;;;;AAE1C/Z,sB,GAAK,C;;;0BAAGA,EAAE,GAAGmpB,YAAY,CAACnP,Q;;;;;AACjC;AACMC,2B,oCAAoCja,E;AACpCka,2B,oCAAoCla,E,aAE1C;;;AACiB,2BAAM,wDAAWma,WAAX,CAAuBF,OAAvB,CAAN;;;AAAXG,4B;;AAEW,2BAAM,wDAAWD,WAAX,CAAuBD,OAAvB,CAAN;;;AAAXG,4B;AAEN;AACA,yBAAKC,iBAAL,CAAuBF,QAAvB,EAAiCC,QAAjC,EAA2CN,SAA3C;;;AAX2C/Z,sBAAE,E;;;;;AAc/C;AACA,yBAAK+Y,WAAL,GAAmBgB,SAAS,CAACU,iBAAV,CAA4B,KAAKD,cAAL,CAAoB,CAApB,CAA5B,EAAoD,SAApD,CAAnB;AACA,yBAAKiP,YAAL,GAAoB1P,SAAS,CAACU,iBAAV,CAA4B,KAAKD,cAAL,CAAoB,CAApB,CAA5B,EAAoD,eAApD,CAApB,C,CAEA;;AACA,yBAAKvB,mBAAL,GAA2Bc,SAAS,CAACQ,kBAAV,CAA6B,KAAKC,cAAL,CAAoB,CAApB,CAA7B,EAAqD,kBAArD,CAA3B;AACA,yBAAKtB,oBAAL,GAA4Ba,SAAS,CAACQ,kBAAV,CAA6B,KAAKC,cAAL,CAAoB,CAApB,CAA7B,EAAqD,mBAArD,CAA5B;AACA,yBAAKkP,eAAL,GAAuB3P,SAAS,CAACQ,kBAAV,CAA6B,KAAKC,cAAL,CAAoB,CAApB,CAA7B,EAAqD,cAArD,CAAvB,C,CAEA;;AACA,yBAAKmP,YAAL,GAAoB5P,SAAS,CAACQ,kBAAV,CAA6B,KAAKC,cAAL,CAAoB,CAApB,CAA7B,EAAqD,WAArD,CAApB;AACA,yBAAKoP,YAAL,GAAoB7P,SAAS,CAACQ,kBAAV,CAA6B,KAAKC,cAAL,CAAoB,CAApB,CAA7B,EAAqD,WAArD,CAApB,C,CAEA;;AACAE,2BAAO,CAACC,GAAR,YAAgBwO,YAAY,CAACnP,QAA7B,oDAA+E,KAAKY,QAApF;;;;;;;;;AACD;AAED;;;;;;;uCAIqBb,S,EAAqD;AAAA,cAAlBhX,IAAkB,uEAAN,IAAM;;;;;;;;;0BACpEA,IAAI,KAAK,I;;;;;;AAEJ,2BAAM,kDAAQ8X,eAAR,CAAwB,KAAKD,QAA7B,CAAN;;;AAAP7X,wB;;;AAGF;AACA,yBAAK4V,SAAL,GAAiB;AAAC,kCAAY,EAAb;AAAiB,mCAAa,EAA9B;AAAkC,gCAAU,EAA5C;AAAgD,+BAAS;AAAzD,qBAAjB,C,CAEA;;AACMmR,2B,GAAU/mB,IAAI,CAACgY,W,EACrB;;AACMgP,4B,GAAW,CACfD,OAAO,CAAC,CAAD,CAAP,CAAW,CAAX,CADe,EACAA,OAAO,CAAC,CAAD,CAAP,CAAW,CAAX,CADA,EAEfA,OAAO,CAAC,CAAD,CAAP,CAAW,CAAX,CAFe,EAEAA,OAAO,CAAC,CAAD,CAAP,CAAW,CAAX,CAFA,EAGfA,OAAO,CAAC,CAAD,CAAP,CAAW,CAAX,CAHe,EAGAA,OAAO,CAAC,CAAD,CAAP,CAAW,CAAX,CAHA,EAIfA,OAAO,CAAC,CAAD,CAAP,CAAW,CAAX,CAJe,EAIAA,OAAO,CAAC,CAAD,CAAP,CAAW,CAAX,CAJA,C,EAMjB;;AACM7O,2B,GAAU,CAAC,CAAD,EAAI,CAAJ,EAAO,CAAP,EAAU,CAAV,EAAa,CAAb,EAAgB,CAAhB,C,EAChB;;AACM+O,6B,GAAY,CAChB,CADgB,EACb,CADa,EACV,CADU,EACP,CADO,EAEhB,CAFgB,EAEb,CAFa,EAEV,CAFU,EAEP,CAFO,C,EAKlB;;AACA,yBAAKT,aAAL,GAAqBxmB,IAAI,CAACknB,IAA1B;AACA,yBAAKT,aAAL,GAAqBzmB,IAAI,CAACmnB,IAA1B,C,CAEA;;AACA,yBAAKvR,SAAL,CAAe,UAAf,IAA6BoR,QAA7B;AACA,yBAAKpR,SAAL,CAAe,WAAf,IAA8BqR,SAA9B,C,CAEA;;AACMG,0B,GAASpnB,IAAI,CAACqnB,I;AACdC,0B,GAASF,MAAM,CAACze,MAAP,CAAc,UAAAvG,CAAC;AAAA,6BAAIA,CAAC,GAAG,CAAR;AAAA,qBAAf,C;AAET0D,uB,GAAM,8DAAWwhB,MAAX,EAAmB,IAAnB,C;AACNvhB,uB,GAAM,8DAAWuhB,MAAX,EAAmB,IAAnB,C,EAEZ;;AACA,yBAAK1R,SAAL,CAAe,QAAf,IAA2BwR,MAAM,CAAC1nB,GAAP,CAAW,UAAAkE,GAAG,EAAI;AAC3C,6BAAOA,GAAG,GAAGI,IAAI,CAAC+B,GAAL,CAAS,CAAT,EAAY/B,IAAI,CAAC8B,GAAL,CAAS,CAAClC,GAAG,GAAGkC,GAAP,KAAeC,GAAG,GAAGD,GAArB,CAAT,EAAoC,CAApC,CAAZ,CAAH,GAAyD,CAAC,CAApE;AACD,qBAF0B,CAA3B;AAIA,yBAAK8P,SAAL,CAAe,OAAf,IAA0BsC,OAA1B,C,CAEA;;AACA,yBAAKC,aAAL,CAAmBnB,SAAnB,E,CACA;;AACA,yBAAKuQ,qBAAL,CAA2BvQ,SAA3B,E,CACA;;AACA,yBAAKwQ,qBAAL,CAA2BxQ,SAA3B,EAAsC,wDAAa8L,kBAAnD,EAAuE,KAAvE;;;;;;;;;AACD;AAED;;;;;;;uCAIqB9L,S,EAAmChX,I,EAAW;;;;;;;;;AACjE;AACA,yBAAKwmB,aAAL,GAAqBxmB,IAAI,CAACknB,IAA1B;AACA,yBAAKT,aAAL,GAAqBzmB,IAAI,CAACmnB,IAA1B,C,CAEA;;AACMC,0B,GAASpnB,IAAI,CAACqnB,I;AACdC,0B,GAASF,MAAM,CAACze,MAAP,CAAc,UAAAvG,CAAC;AAAA,6BAAIA,CAAC,GAAG,CAAR;AAAA,qBAAf,C;AAET0D,uB,GAAM,8DAAWwhB,MAAX,EAAmB,IAAnB,C;AACNvhB,uB,GAAM,8DAAWuhB,MAAX,EAAmB,IAAnB,C,EAEZ;;AACA,yBAAK1R,SAAL,CAAe,QAAf,IAA2BwR,MAAM,CAAC1nB,GAAP,CAAW,UAAAkE,GAAG,EAAI;AAC3C,6BAAOA,GAAG,GAAGI,IAAI,CAAC+B,GAAL,CAAS,CAAT,EAAY/B,IAAI,CAAC8B,GAAL,CAAS,CAAClC,GAAG,GAAGkC,GAAP,KAAeC,GAAG,GAAGD,GAArB,CAAT,EAAoC,CAApC,CAAZ,CAAH,GAAyD,CAAC,CAApE;AACD,qBAF0B,CAA3B,C,CAIA;;AACA,yBAAKyhB,qBAAL,CAA2BvQ,SAA3B;;;;;;;;;AACD;AAED;;;;;;;;uCAKeA,S,EAAmCyQ,I,EAAoB;AACpE;AACA,eAAKD,qBAAL,CAA2BxQ,SAA3B,EAAsCyQ,IAAtC,EAA4C,KAA5C;AACD;AAED;;;;;;;+BAIOzQ,S,EAAmC;AACxC;AACA,cACE,KAAKS,cAAL,CAAoBxV,MAApB,KAA+B,CAA/B,IACA,KAAKwV,cAAL,CAAoB,CAApB,MAA2B,IAD3B,IAEA,KAAK5B,iBAAL,KAA2B,IAF3B,IAGA,KAAKwQ,kBAAL,KAA4B,IAH5B,IAIA,KAAKvQ,cAAL,KAAwB,IAJxB,IAKA,KAAKwQ,cAAL,KAAwB,IALxB,IAMA,KAAKC,cAAL,KAAwB,IANxB,IAOA,KAAKvQ,WAAL,GAAmB,CAPnB,IAQA,KAAK0Q,YAAL,GAAoB,CATtB,EAUE;AACA;AACD,WAduC,CAgBxC;;;AACA,eAAKgB,WAAL,CAAiB1Q,SAAjB,EAjBwC,CAmBxC;;AACAA,mBAAS,CAAC6B,MAAV,CAAiB7B,SAAS,CAAC+D,KAA3B;AACA/D,mBAAS,CAACgE,SAAV,CAAoBhE,SAAS,CAACiE,SAA9B,EAAyCjE,SAAS,CAACkE,mBAAnD,EArBwC,CAuBxC;;AACAlE,mBAAS,CAACkD,UAAV,CAAqBlD,SAAS,CAACmD,YAA/B,EAA6C,KAAKtE,iBAAlD;AACAmB,mBAAS,CAACoD,mBAAV,CAA8B,KAAKpE,WAAnC,EAAgDoQ,YAAY,CAAC/L,MAA7D,EAAqErD,SAAS,CAAC2B,KAA/E,EAAsF,KAAtF,EAA6F,CAA7F,EAAgG,CAAhG;AACA3B,mBAAS,CAACsD,uBAAV,CAAkC,KAAKtE,WAAvC,EA1BwC,CA4BxC;;AACAgB,mBAAS,CAACkD,UAAV,CAAqBlD,SAAS,CAACmD,YAA/B,EAA6C,KAAKkM,kBAAlD;AACArP,mBAAS,CAACoD,mBAAV,CAA8B,KAAKsM,YAAnC,EAAiDN,YAAY,CAAC/L,MAA9D,EAAsErD,SAAS,CAAC2B,KAAhF,EAAuF,KAAvF,EAA8F,CAA9F,EAAiG,CAAjG;AACA3B,mBAAS,CAACsD,uBAAV,CAAkC,KAAKoM,YAAvC,EA/BwC,CAiCxC;;AACA1P,mBAAS,CAACkD,UAAV,CAAqBlD,SAAS,CAAC2D,oBAA/B,EAAqD,KAAK7E,cAA1D,EAlCwC,CAoCxC;;AACAkB,mBAAS,CAAC2E,aAAV,CAAwB3E,SAAS,CAAC4E,QAAlC,EArCwC,CAsCxC;;AACA5E,mBAAS,CAAC6E,WAAV,CAAsB7E,SAAS,CAAC8E,UAAhC,EAA4C,KAAKyK,cAAjD,EAvCwC,CAyCxC;;AACAvP,mBAAS,CAAC2E,aAAV,CAAwB3E,SAAS,CAACgF,QAAlC,EA1CwC,CA2CxC;;AACAhF,mBAAS,CAAC6E,WAAV,CAAsB7E,SAAS,CAAC8E,UAAhC,EAA4C,KAAKwK,cAAjD,EA5CwC,CA8CxC;;AACAtP,mBAAS,CAACoC,UAAV,CAAqB,KAAK3B,cAAL,CAAoB,CAApB,CAArB,EA/CwC,CAiDxC;;AACAT,mBAAS,CAAC4D,YAAV,CAAuB5D,SAAS,CAAC6D,SAAjC,EAA4C,KAAKjF,SAAL,CAAe,OAAf,EAAwB3T,MAApE,EAA4E+U,SAAS,CAAC8D,YAAtF,EAAoG,CAApG,EAlDwC,CAoDxC;;AACA9D,mBAAS,CAACmC,OAAV,CAAkBnC,SAAS,CAAC+D,KAA5B;AACD;AAED;;;;;;;oCAIsB/D,S,EAAmC;AACvD,cAAI,CAAC,KAAKS,cAAL,CAAoBxV,MAArB,IAA+B,KAAKwV,cAAL,CAAoB,CAApB,MAA2B,IAA9D,EAAoE;AAClE;AACD,WAHsD,CAIvD;;;AACAT,mBAAS,CAACoC,UAAV,CAAqB,KAAK3B,cAAL,CAAoB,CAApB,CAArB,EALuD,CAOvD;;AACAT,mBAAS,CAACqC,gBAAV,CAA2B,KAAKnD,mBAAhC,EAAqD,KAArD,EAA4D,KAAKoD,OAAL,CAAaC,kBAAb,EAA5D;AACAvC,mBAAS,CAACqC,gBAAV,CAA2B,KAAKlD,oBAAhC,EAAsD,KAAtD,EAA6D,KAAKmD,OAAL,CAAaE,mBAAb,EAA7D,EATuD,CAUvD;;AACA,cAAMC,WAAW,GAAG,KAAKH,OAAL,CAAaI,cAAb,EAApB;;AACA1C,mBAAS,CAAC2C,SAAV,CAAoB,KAAKgN,eAAzB,EAA0ClN,WAAW,CAAC,CAAD,CAArD,EAA0DA,WAAW,CAAC,CAAD,CAArE,EAZuD,CAcvD;;AACAzC,mBAAS,CAAC+E,SAAV,CAAoB,KAAK8K,YAAzB,EAAuC,CAAvC,EAfuD,CAgBvD;;AACA7P,mBAAS,CAAC+E,SAAV,CAAoB,KAAK6K,YAAzB,EAAuC,CAAvC;AACD;AAED;;;;;;;sCAIwB5P,S,EAAmC;AACzD;AACA,eAAKnB,iBAAL,GAAyBmB,SAAS,CAAC6G,YAAV,EAAzB,CAFyD,CAGzD;;AACA7G,mBAAS,CAACkD,UAAV,CAAqBlD,SAAS,CAACmD,YAA/B,EAA6C,KAAKtE,iBAAlD,EAJyD,CAKzD;;AACAmB,mBAAS,CAAC8G,UAAV,CACE9G,SAAS,CAACmD,YADZ,EAC0B,IAAI3B,YAAJ,CAAiB,KAAK5C,SAAL,CAAe,UAAf,CAAjB,CAD1B,EACwEoB,SAAS,CAAC+G,WADlF,EANyD,CAUzD;;AACA,eAAKsI,kBAAL,GAA0BrP,SAAS,CAAC6G,YAAV,EAA1B,CAXyD,CAYzD;;AACA7G,mBAAS,CAACkD,UAAV,CAAqBlD,SAAS,CAACmD,YAA/B,EAA6C,KAAKkM,kBAAlD,EAbyD,CAczD;;AACArP,mBAAS,CAAC8G,UAAV,CACE9G,SAAS,CAACmD,YADZ,EAC0B,IAAI3B,YAAJ,CAAiB,KAAK5C,SAAL,CAAe,WAAf,CAAjB,CAD1B,EACyEoB,SAAS,CAAC+G,WADnF,EAfyD,CAmBzD;;AACA,eAAKjI,cAAL,GAAsBkB,SAAS,CAAC6G,YAAV,EAAtB,CApByD,CAqBzD;;AACA7G,mBAAS,CAACkD,UAAV,CAAqBlD,SAAS,CAAC2D,oBAA/B,EAAqD,KAAK7E,cAA1D,EAtByD,CAuBzD;;AACAkB,mBAAS,CAAC8G,UAAV,CACE9G,SAAS,CAAC2D,oBADZ,EACkC,IAAIqD,WAAJ,CAAgB,KAAKpI,SAAL,CAAe,OAAf,CAAhB,CADlC,EAC4EoB,SAAS,CAAC+G,WADtF;AAED;AAED;;;;;;;8CAIgC/G,S,EAAmC;AACjE;AACA,cAAI,KAAKuP,cAAL,KAAwB,IAA5B,EAAkC;AAChC,iBAAKA,cAAL,GAAsBvP,SAAS,CAACsF,aAAV,EAAtB;AACD,WAJgE,CAKjE;;;AACAtF,mBAAS,CAAC6E,WAAV,CAAsB7E,SAAS,CAAC8E,UAAhC,EAA4C,KAAKyK,cAAjD;AACAvP,mBAAS,CAAC4F,UAAV,CACE5F,SAAS,CAAC8E,UADZ,EACwB,CADxB,EAC2B9E,SAAS,CAAC2Q,IADrC,EAC2C,KAAKnB,aADhD,EAC+D,KAAKC,aADpE,EACmF,CADnF,EAEEzP,SAAS,CAAC4Q,GAFZ,EAEiB5Q,SAAS,CAAC2B,KAF3B,EAEkC,IAAIH,YAAJ,CAAiB,KAAK5C,SAAL,CAAe,QAAf,CAAjB,CAFlC,EAPiE,CAWjE;;AACAoB,mBAAS,CAAC8F,aAAV,CAAwB9F,SAAS,CAAC8E,UAAlC,EAA8C9E,SAAS,CAAC+F,kBAAxD,EAA4E/F,SAAS,CAAC6Q,MAAtF;AACA7Q,mBAAS,CAAC8F,aAAV,CAAwB9F,SAAS,CAAC8E,UAAlC,EAA8C9E,SAAS,CAACiG,kBAAxD,EAA4EjG,SAAS,CAAC6Q,MAAtF,EAbiE,CAcjE;;AACA7Q,mBAAS,CAAC8F,aAAV,CAAwB9F,SAAS,CAAC8E,UAAlC,EAA8C9E,SAAS,CAACkG,cAAxD,EAAwElG,SAAS,CAACmG,aAAlF,EAfiE,CAgBjE;;AACAnG,mBAAS,CAAC8F,aAAV,CAAwB9F,SAAS,CAAC8E,UAAlC,EAA8C9E,SAAS,CAACoG,cAAxD,EAAwEpG,SAAS,CAACmG,aAAlF;AACD;AAEC;;;;;;;;;8CAM8BnG,S,EAAmC4L,K,EAA+C;AAAA,cAA1BH,OAA0B,uEAAP,KAAO;;AAChH;AACA,cAAMje,IAAI,GAAG,mDAASsjB,WAAT,CAAqBlF,KAArB,EAA4BH,OAA5B,CAAb,CAFgH,CAGhH;;;AACA,cAAI,KAAK6D,cAAL,KAAwB,IAA5B,EAAkC;AAChC,iBAAKA,cAAL,GAAsBtP,SAAS,CAACsF,aAAV,EAAtB;AACD,WAN+G,CAQhH;;;AACAtF,mBAAS,CAAC6E,WAAV,CAAsB7E,SAAS,CAAC8E,UAAhC,EAA4C,KAAKwK,cAAjD;AACAtP,mBAAS,CAAC4F,UAAV,CACE5F,SAAS,CAAC8E,UADZ,EACwB,CADxB,EAC2B9E,SAAS,CAAC0B,IADrC,EAC2ClU,IAAI,CAACvC,MAAL,GAAc,CADzD,EAC4D,CAD5D,EAC+D,CAD/D,EAEE+U,SAAS,CAAC0B,IAFZ,EAEkB1B,SAAS,CAAC+Q,aAF5B,EAE2C,IAAIC,UAAJ,CAAexjB,IAAf,CAF3C,EAVgH,CAchH;;AACAwS,mBAAS,CAAC8F,aAAV,CAAwB9F,SAAS,CAAC8E,UAAlC,EAA8C9E,SAAS,CAAC+F,kBAAxD,EAA4E/F,SAAS,CAAC6Q,MAAtF;AACA7Q,mBAAS,CAAC8F,aAAV,CAAwB9F,SAAS,CAAC8E,UAAlC,EAA8C9E,SAAS,CAACiG,kBAAxD,EAA4EjG,SAAS,CAAC6Q,MAAtF,EAhBgH,CAiBhH;;AACA7Q,mBAAS,CAAC8F,aAAV,CAAwB9F,SAAS,CAAC8E,UAAlC,EAA8C9E,SAAS,CAACkG,cAAxD,EAAwElG,SAAS,CAACmG,aAAlF,EAlBgH,CAmBhH;;AACAnG,mBAAS,CAAC8F,aAAV,CAAwB9F,SAAS,CAAC8E,UAAlC,EAA8C9E,SAAS,CAACoG,cAAxD,EAAwEpG,SAAS,CAACmG,aAAlF;AACD;;;;MAtV+B,4C,GAChC;;;AACiB,iBAAA9C,MAAA,GAAS,CAAT,C,CACjB;;AACiB,iBAAApD,QAAA,GAAW,CAAX;;;;;;;;;;;;;;;;ACZnB;AAAA;;;AAAA;AAAA;AAAA;;QAAagR,S;;;AAMX;;;;AAIA,yBAAYvoB,GAAZ,EAAmC;AAAA,YAAlBzB,SAAkB,uEAAN,IAAM;;AAAA;;AACjC,aAAKiqB,IAAL,GAAYxoB,GAAZ;AACA,aAAKR,UAAL,GAAkBjB,SAAlB;AACD;;;;qCAEY;AACX;AACAkD,gBAAM,CAACC,gBAAP,CAAwB,SAAxB,EAAmC,KAAK+mB,OAAL,CAAa7mB,IAAb,CAAkB,IAAlB,CAAnC,EAA4D,KAA5D;AACD;AAED;;;;;;gCAGQ2B,K,EAAsB;AAC5B;AACA,cAAM/E,GAAG,GAAG,CAAC+E,KAAK,CAAC/E,GAAnB;AACA,cAAMyP,MAAM,GAAG,KAAKua,IAAL,CAAUE,YAAV,CAAuBza,MAAtC,CAH4B,CAK5B;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AAEA;;AACA,cAAI1K,KAAK,CAAC/E,GAAN,KAAc,GAAlB,EAAuB;AACrB,iBAAKgqB,IAAL,CAAUG,gBAAV;AACD;AACF;;;;;;;;;;;;;;;;;;;;;AC5CH;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA,wC,CAAA;AAMA;;;QAOaC,Y;;;AAMX;;;;AAIA,4BAAYC,QAAZ,EAA8B;AAAA;;AAP9B;AACU,aAAAC,OAAA,GAAmB,EAAnB;AAOR,aAAKC,MAAL,GAAcF,QAAd;AACD;AAED;;;;;;;;;AAQA;;;;oCAIS;AACP,iBAAO,wDAAW1D,WAAX,CAAuB,KAAK4D,MAA5B,EAAoC/rB,IAApC,CAA0C,UAACiR,MAAD,EAAY;AAC3D,mBAAOA,MAAP;AACD,WAFM,CAAP;AAGD;AAEA;;;;;;;;;oCAMW+a,S,EAAmB1D,O,EAAiB;AAC9C;AACA,cAAIxX,KAAK,GAAG,IAAZ,CAF8C,CAI9C;;AACA,kBAAQkb,SAAR;AACE,iBAAK,sDAAW7E,cAAhB;AACErW,mBAAK,GAAG,IAAI,6DAAJ,CAAkBwX,OAAlB,CAAR;AACF;;AACA,iBAAK,sDAAWlB,cAAhB;AACEtW,mBAAK,GAAG,IAAI,6DAAJ,CAAkBwX,OAAlB,CAAR;AACF;;AACA,iBAAK,sDAAWjB,aAAhB;AACEvW,mBAAK,GAAG,IAAI,2DAAJ,CAAiBwX,OAAjB,CAAR;AACF;;AACA,iBAAK,sDAAWhB,aAAhB;AACExW,mBAAK,GAAG,IAAI,2DAAJ,CAAiBwX,OAAjB,CAAR;AACF;;AACA,iBAAK,sDAAWf,WAAhB;AACEzW,mBAAK,GAAG,IAAI,uDAAJ,CAAewX,OAAf,CAAR;AACF;;AACA;AACErN,qBAAO,CAAC8E,KAAR,gBAAsBuI,OAAtB;AACF;AAlBF,WAL8C,CA0B9C;;;AACA,eAAKwD,OAAL,CAAarkB,IAAb,CAAkBqJ,KAAlB,EA3B8C,CA6B9C;;;AACA,iBAAOA,KAAP;AACD;;;iCAEQwX,O,EAAiB;AAAA;AAAA;AAAA;;AAAA;AACxB,kCAAmB,KAAKwD,OAAxB,mIAAiC;AAAA,kBAAvBhb,KAAuB;;AAC/B,kBAAIwX,OAAO,KAAKxX,KAAK,CAACwX,OAAtB,EAA+B;AAC7B,uBAAOxX,KAAP;AACD;AACF;AALuB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAOxB,iBAAO,IAAP;AACD;;;4BA7DS;AACR,iBAAO,KAAKgb,OAAZ;AACD;;;;;;;;;;;;;;;;;;;;;ACjCH;AAAA;;;AAAA;AAAA;AAAA,O,CAAA;;;QAKaG,K;;;AAaX;;;;AAIA,qBAAY1rB,EAAZ,EAAwB;AAAA;;AATxB;AACU,aAAAwa,cAAA,GAAgC,EAAhC;AASR,aAAKI,QAAL,GAAgB5a,EAAhB;AACA,aAAK6pB,QAAL,GAAgB,IAAhB;AACA,aAAK8B,WAAL,GAAmB,KAAnB;AACD;AAED;;;;;;;;AA0CA;;;;oCAIY5R,S,EAAmC;AAC7C,gBAAM,IAAIpa,KAAJ,CAAU,iCAAV,CAAN;AACD;AAED;;;;;;;;uCAKeoa,S,EAAqD;AAAA,cAAlBhX,IAAkB,uEAAN,IAAM;AAClE,gBAAM,IAAIpD,KAAJ,CAAU,iCAAV,CAAN;AACD;AAED;;;;;;;;uCAKeoa,S,EAAmChX,I,EAAW;AAC3D,gBAAM,IAAIpD,KAAJ,CAAU,iCAAV,CAAN;AACD;AAED;;;;;;;;sCAKcoa,S,EAAmC;AAC/C,gBAAM,IAAIpa,KAAJ,CAAU,iCAAV,CAAN;AACD;AAED;;;;;;;;uCAKeoa,S,EAAmCyQ,I,EAAoB,CAAE;AAGxE;;;;;;;+BAIOzQ,S,EAAmC;AACxC,gBAAM,IAAIpa,KAAJ,CAAU,iCAAV,CAAN;AACD;AAED;;;;;;;6BAIKoa,S,EAAoCnS,C,EAAWE,C,EAAW;AAC7D,gBAAM,IAAInI,KAAJ,CAAU,iCAAV,CAAN;AACD;AACD;;;;;;;iCAIS;AACP,gBAAM,IAAIA,KAAJ,CAAU,iCAAV,CAAN;AACD;AACD;;;;;;;oCAI6B;AAAA,cAAnBK,EAAmB,uEAAN,IAAM;AAC3B,gBAAM,IAAIL,KAAJ,CAAU,iCAAV,CAAN;AACD;AAED;;;;;;;;;0CAM4BisB,Q,EAAkBC,Q,EAAkB9R,S,EAAmC;AACjG;AACA,cAAM+R,YAAY,GAAG,KAAKC,WAAL,CAAiBhS,SAAS,CAACiS,aAA3B,EAA0CJ,QAA1C,EAAoD7R,SAApD,CAArB;AACA,cAAMkS,cAAc,GAAG,KAAKF,WAAL,CAAiBhS,SAAS,CAACmS,eAA3B,EAA4CL,QAA5C,EAAsD9R,SAAtD,CAAvB,CAHiG,CAKjG;;AACA,cAAMoS,MAAM,GAAGpS,SAAS,CAACqS,aAAV,EAAf;AACArS,mBAAS,CAACsS,YAAV,CAAuBF,MAAvB,EAA+BL,YAA/B;AACA/R,mBAAS,CAACsS,YAAV,CAAuBF,MAAvB,EAA+BF,cAA/B;AACAlS,mBAAS,CAACuS,WAAV,CAAsBH,MAAtB,EATiG,CAWjG;;AACA,cAAI,CAACpS,SAAS,CAACwS,mBAAV,CAA8BJ,MAA9B,EAAsCpS,SAAS,CAACyS,WAAhD,CAAL,EAAmE;AACjE,kBAAM,IAAI7sB,KAAJ,CAAU,8CAA8Coa,SAAS,CAAC0S,iBAAV,CAA4BN,MAA5B,CAAxD,CAAN;AACD,WAdgG,CAgBjG;;;AACA,eAAK3R,cAAL,CAAoBtT,IAApB,CAAyBilB,MAAzB;AACD;AAED;;;;;;;;;;oCAOsB9f,I,EAAMqgB,M,EAAQ3S,S,EAAS;AAC3C;AACA,cAAMoS,MAAM,GAAGpS,SAAS,CAAC4S,YAAV,CAAuBtgB,IAAvB,CAAf,CAF2C,CAI3C;;AACA0N,mBAAS,CAAC6S,YAAV,CAAuBT,MAAvB,EAA+BO,MAA/B,EAL2C,CAM3C;;AACA3S,mBAAS,CAAC8S,aAAV,CAAwBV,MAAxB,EAP2C,CAS3C;;AACA,cAAI,CAACpS,SAAS,CAAC+S,kBAAV,CAA6BX,MAA7B,EAAqCpS,SAAS,CAACgT,cAA/C,CAAL,EAAqE;AACnErS,mBAAO,CAAC8E,KAAR,CAAc,2CAAd;AACA9E,mBAAO,CAAC8E,KAAR,CAAckN,MAAd;AACAhS,mBAAO,CAAC8E,KAAR,CAAczF,SAAS,CAACiT,gBAAV,CAA2Bb,MAA3B,CAAd;AAEApS,qBAAS,CAACkT,YAAV,CAAuBd,MAAvB;AACA,kBAAM,IAAIxsB,KAAJ,CAAU,2BAAV,CAAN;AACD;;AAED,iBAAOwsB,MAAP;AACD;;;4BArKa;AACZ,iBAAO,KAAKvR,QAAZ;AACD;AAED;;;;;;4BAGW;AACT,iBAAO,KAAKiP,QAAZ;AACD;AAED;;;;0BAGYjX,O,EAAkB;AAC5B,eAAKiX,QAAL,GAAgBjX,OAAhB;AACD;AAED;;;;;;4BAGc;AACZ,iBAAO,KAAK+Y,WAAZ;AACD;AAED;;;;0BAGehZ,U,EAAqB;AAClC,eAAKgZ,WAAL,GAAmBhZ,UAAnB;AACD;AAED;;;;;;0BAGWmV,M,EAAgB;AACzB,eAAKzL,OAAL,GAAeyL,MAAf;AACD;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;uCCpEH;;;QAWaoF,O;;;AAuBX;;;;AAIA,uBAAYC,MAAZ,EAAmD;AAAA;;AAAA,YAAlBnsB,SAAkB,uEAAN,IAAM;;AAAA;;AA1BnD;AACU,aAAAiR,OAAA,GAAuB,IAAvB,CAyByC,CAxBnD;;AACU,aAAAmb,OAAA,GAA6B,IAA7B,CAuByC,CAtBnD;;AACO,aAAAC,UAAA,GAAqC,IAArC,CAqB4C,CAnBnD;;AACU,aAAAC,aAAA,GAA8B,IAA9B,CAkByC,CACjD;;AACA,aAAKrb,OAAL,GAAekb,MAAf,CAFiD,CAGjD;;AACA,aAAKC,OAAL,GAAeG,QAAQ,CAACC,aAAT,CAAuB,QAAvB,CAAf,CAJiD,CAKjD;;AACA,aAAKH,UAAL,GAAkB,KAAKD,OAAL,CAAaK,UAAb,CAAwB,QAAxB,CAAlB,CANiD,CAOjD;;AACA,aAAKxb,OAAL,CAAayb,WAAb,CAAyB,KAAKN,OAA9B,EARiD,CASjD;;;AACA,aAAKnrB,UAAL,GAAkBjB,SAAlB,CAViD,CAYjD;;AACA,aAAK2sB,UAAL,CAAgB,aAAhB,EAA+BluB,IAA/B,CAAoC,YAAM;AACxC;AACA,iBAAI,CAAC2E,MAAL;AACD,SAHD,EAbiD,CAkBjD;;AACA,aAAKwpB,eAAL,GAnBiD,CAoBjD;;AACA,aAAKC,kBAAL,GArBiD,CAsBjD;;AACA,aAAKhrB,gBAAL;AACD;AAED;;;;;;;;AAmCA;;;2CAGmB;AACjB,cAAMirB,mBAAmB,GAAiB,KAAKzR,OAAL,CAAa0R,eAAb,EAA1C;;AACA,cAAID,mBAAmB,KAAK,wDAAa1K,QAAzC,EAAmD;AACjD,iBAAK/G,OAAL,CAAa2R,eAAb,CAA6B,wDAAa7K,QAA1C;AACD,WAFD,MAEO;AACL,iBAAK9G,OAAL,CAAa2R,eAAb,CAA6B,wDAAa5K,QAA1C;AACD;;AAED,eAAK/f,MAAL;AACD;;;mCAEgBykB,M,EAAgB;;;;;;;;;;AAEhB,2BAAM,kDAAQmG,WAAR,CAAoBnG,MAApB,CAAN;;;AAATrY,0B;AACN;AACA,yBAAK4M,OAAL,GAAe,IAAI,8CAAJ,CAAW5M,MAAM,CAACsL,WAAP,CAAmB,CAAnB,EAAsB,CAAtB,CAAX,EAAqCtL,MAAM,CAACsL,WAAP,CAAmB,CAAnB,EAAsB,CAAtB,CAArC,EAA+DtL,MAAM,CAAC4D,UAAP,CAAkB4V,IAAjF,CAAf,C,CACA;;AACA,yBAAK5lB,MAAL;;;;;;;;;AACD;AAED;;;;;;mCAGiBmkB,K,EAAe;;;;;;;;;;AAC9B;AACA,yBAAK8F,aAAL,GAAqB,IAAI,2DAAJ,CAAiB9F,KAAjB,CAArB,C,CAEA;;;AACa,2BAAM,kDAAQyG,WAAR,CAAoBzG,KAApB,CAAN;;;AAAPzkB,wB;AAEN;;;;;iCACsBA,I;;;;;;;;AAAXmrB,2B;;0BAEL,UAAUA,OAAV,IAAqBA,OAAO,CAAC,MAAD,C;;;;;;;;AAIhC;AACM3d,yB,GAAQ,KAAK+c,aAAL,CAAmBa,WAAnB,CACZD,OAAO,CAAC,MAAD,CADK,EACKA,OAAO,CAAC,IAAD,CADZ,C,EAGd;;AACA,yBAAKE,WAAL,CAAiB7d,KAAjB,EAAwB2d,OAAxB,E,CAEA;;;AACA,2BAAM3d,KAAK,CAAC8d,WAAN,CAAkB,KAAKhB,UAAvB,CAAN;;;;AAGA,2BAAM9c,KAAK,CAAC+d,cAAN,CAAqB,KAAKjB,UAA1B,CAAN;;;AACA,yBAAKhqB,MAAL;;AAEA,wBAAI6qB,OAAO,CAAC,MAAD,CAAP,KAAoB,UAAxB,EAAoC;AAClC,2BAAKK,cAAL,GAAsBhe,KAAtB;AACD;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAEJ;AAED;;;;;;oCAGYA,K,EAAczC,M,EAAa;AACrC;AACA,cAAIA,MAAM,CAAC,OAAD,CAAN,KAAoBR,SAAxB,EAAmC;AACjCiD,iBAAK,CAACie,cAAN,CAAqB,KAAKnB,UAA1B,EAAsCvf,MAAM,CAAC,OAAD,CAA5C;AACD,WAFD,MAEO;AACLyC,iBAAK,CAACie,cAAN,CAAqB,KAAKnB,UAA1B,EAAsC,wDAAaxH,kBAAnD;AACD,WANoC,CAQrC;;;AACA,cAAI/X,MAAM,CAAC,YAAD,CAAN,KAAyBR,SAA7B,EAAwC;AACtCiD,iBAAK,CAACoC,UAAN,GAAmB7E,MAAM,CAAC,YAAD,CAAzB;AACD,WAFD,MAEO;AACLyC,iBAAK,CAACoC,UAAN,GAAmB,KAAnB;AACD,WAboC,CAerC;;;AACA,cAAI7E,MAAM,CAAC,SAAD,CAAN,KAAsBR,SAA1B,EAAqC;AACnCiD,iBAAK,CAACqC,OAAN,GAAgB9E,MAAM,CAAC,SAAD,CAAtB;AACD,WAFD,MAEO;AACLyC,iBAAK,CAACqC,OAAN,GAAgB,IAAhB;AACD;AACF;AAED;;;;;;iCAGe6Y,S,EAAmB1D,O,EAAiBhlB,I,EAA6D;AAAA,cAAlD+K,MAAkD,uEAApC;AAAC8E,mBAAO,EAAE,IAAV;AAAgBD,sBAAU,EAAE;AAA5B,WAAoC;;;;;;;;;AAC9G;AACMpC,yB,GAAQ,KAAK+c,aAAL,CAAmBa,WAAnB,CACZ1C,SADY,EACD1D,OADC,C,EAId;;;AACA,2BAAMxX,KAAK,CAAC8d,WAAN,CAAkB,KAAKhB,UAAvB,CAAN;;;;AAEA,2BAAM9c,KAAK,CAAC+d,cAAN,CAAqB,KAAKjB,UAA1B,EAAsCtqB,IAAtC,CAAN;;;AAEA;AACAwN,yBAAK,CAACqC,OAAN,GAAgB9E,MAAM,CAAC8E,OAAvB;AACArC,yBAAK,CAACoC,UAAN,GAAmB7E,MAAM,CAAC6E,UAA1B,C,CAEA;;AACA,yBAAKtP,MAAL;;;;;;;;;AACD;AAED;;;;;;iCAGS0kB,O,EAAiB;AACxB,cAAIzU,GAAG,GAAG,CAAC,CAAX;;AACA,eAAI,IAAImb,GAAG,GAAG,CAAd,EAAiBA,GAAG,GAAG,KAAKnB,aAAL,CAAmB5c,MAAnB,CAA0B1L,MAAjD,EAAyDypB,GAAG,EAA5D,EAAgE;AAC9D;AACA,gBAAMle,KAAK,GAAG,KAAK+c,aAAL,CAAmB5c,MAAnB,CAA0B+d,GAA1B,CAAd,CAF8D,CAI9D;;AACA,gBAAIle,KAAK,CAACwX,OAAN,KAAkBA,OAAtB,EAA+B;AAAE;AAAW,aALkB,CAO9D;;;AACAzU,eAAG,GAAGmb,GAAN;AACA;AACD;;AAED,cAAInb,GAAG,GAAG,CAAC,CAAX,EAAc;AACZ;AACA,iBAAKga,aAAL,CAAmB5c,MAAnB,CAA0BlE,MAA1B,CAAiC8G,GAAjC,EAAsC,CAAtC;AACD;AACF;AAED;;;;;;4CAG0ByU,O,EAAiBhlB,I,EAAW;;;;;;;;;;AACpD;AACIwN,yB,GAAQ,I;;;;;iCACM,KAAK+c,aAAL,CAAmB5c,M;;;;;;;;AAA1Bge,uB;;0BACLA,GAAG,CAAC3G,OAAJ,KAAgBA,O;;;;;AAClBxX,yBAAK,GAAGme,GAAR;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;0BAMAne,KAAK,KAAK,I;;;;;;;;;AAEd,2BAAMA,KAAK,CAACoe,cAAN,CAAqB,KAAKtB,UAA1B,EAAsCtqB,IAAtC,CAAN;;;AAEA;AACAwN,yBAAK,CAACqC,OAAN,GAAgB,IAAhB,C,CAEA;;AACA,yBAAKvP,MAAL;;;;;;;;;AACD;AAED;;;;;;2CAGmB0kB,O,EAAiB;AAClC;AACA,cAAIxX,KAAK,GAAG,IAAZ;AAFkC;AAAA;AAAA;;AAAA;AAGlC,kCAAkB,KAAK+c,aAAL,CAAmB5c,MAArC,mIAA6C;AAAA,kBAAlCge,GAAkC;;AAC3C,kBAAIA,GAAG,CAAC3G,OAAJ,KAAgBA,OAApB,EAA6B;AAC3BxX,qBAAK,GAAGme,GAAR;AACA;AACD;AACF,aARiC,CAUlC;;AAVkC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAWlC,cAAIne,KAAK,KAAK,IAAd,EAAoB;AAAE;AAAS,WAXG,CAYlC;;;AACAA,eAAK,CAACqe,aAAN,CAAoB,KAAKvB,UAAzB,EAbkC,CAelC;;AACA9c,eAAK,CAACqC,OAAN,GAAgB,IAAhB,CAhBkC,CAkBlC;;AACA,eAAKvP,MAAL;AACD;AAED;;;;;;0CAGkB;AAChB;AACA,eAAKwrB,MAAL,GAAc,IAAI,yDAAJ,CAAgB,IAAhB,EAAsB,KAAK5sB,UAA3B,CAAd,CAFgB,CAGhB;;AACA,eAAK4sB,MAAL,CAAYC,UAAZ;AACD;AAED;;;;;;6CAGqB;AACnB;AACA,eAAKC,SAAL,GAAiB,IAAI,qDAAJ,CAAc,IAAd,EAAoB,KAAK9sB,UAAzB,CAAjB,CAFmB,CAGnB;;AACA,eAAK8sB,SAAL,CAAeD,UAAf;AACD;AAED;;;;;;2CAGmB;AAAA;;AACjB;AACA5qB,gBAAM,CAACC,gBAAP,CAAwB,QAAxB,EAAkC,YAAM;AACtC;AACA,mBAAI,CAACC,MAAL;;AACA,mBAAI,CAACf,MAAL;AACD,WAJD;AAKD;;;6BAEI0kB,O,EAAiBiH,S,EAAmB;AACvC,cAAMze,KAAK,GAAG,KAAK+c,aAAL,CAAmB2B,QAAnB,CAA4BlH,OAA5B,CAAd;;AAEA,cAAIxX,KAAJ,EAAW;AACTA,iBAAK,CAAC2e,SAAN,CAAgBF,SAAhB;AACA,iBAAK3rB,MAAL;AACD;AACF;AAED;;;;;;iCAGS;AACP,cAAI,CAAC,KAAKgZ,OAAV,EAAmB;AACjB;AACD,WAHM,CAIP;;;AACA,eAAKgR,UAAL,CAAgB/P,UAAhB,CAA2B,MAA3B,EAAmC,MAAnC,EAA2C,MAA3C,EAAmD,GAAnD,EALO,CAMP;;;AACA,eAAK+P,UAAL,CAAgB9P,KAAhB,CAAsB,KAAK8P,UAAL,CAAgB7P,gBAAhB,GAAmC,KAAK6P,UAAL,CAAgB5P,gBAAzE,EAPO,CASP;;;AACA,eAAKpB,OAAL,CAAa8S,MAAb,GAVO,CAYP;;;AAZO;AAAA;AAAA;;AAAA;AAaP,kCAAoB,KAAK7B,aAAL,CAAmB5c,MAAvC,mIAA+C;AAAA,kBAApCH,KAAoC;;AAC7C;AACA,kBAAI,CAACA,KAAK,CAACqC,OAAX,EAAoB;AAAE;AAAW,eAFY,CAI7C;;;AACArC,mBAAK,CAACuX,MAAN,GAAe,KAAKA,MAApB,CAL6C,CAM7C;;AACAvX,mBAAK,CAAClN,MAAN,CAAa,KAAKgqB,UAAlB;AACD;AArBM;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAsBR;AAED;;;;;;iCAGS;AACP,cAAM+B,WAAW,GAAG,KAAKnd,OAAL,CAAa1O,WAAjC;AACA,cAAM8rB,YAAY,GAAG,KAAKpd,OAAL,CAAaxO,YAAlC;AAEA,cAAMwC,KAAK,GAAGc,IAAI,CAAC+B,GAAL,CAASsmB,WAAT,EAAsBC,YAAtB,CAAd;;AACA,eAAKhC,UAAL,CAAgBiC,QAAhB,CAAyB,CAAzB,EAA4B,CAA5B,EAA+BrpB,KAA/B,EAAsCA,KAAtC,EALO,CAMP;;;AACA,eAAKmnB,OAAL,CAAa/jB,KAAb,GAAqB+lB,WAArB;AACA,eAAKhC,OAAL,CAAamC,MAAb,GAAsBF,YAAtB,CARO,CAUP;;AACA,eAAKhT,OAAL,CAAamT,qBAAb,CAAmCJ,WAAnC,EAAgDC,YAAhD;AACD;;;4BAxSS;AACR,iBAAO,KAAKjC,OAAZ;AACD;AAED;;;;;;4BAGO;AACL,iBAAO,KAAKnb,OAAZ;AACD;AAED;;;;;;4BAGa;AACX,iBAAO,KAAKob,UAAZ;AACD;AAED;;;;;;4BAGU;AACR,iBAAO,KAAKhR,OAAZ;AACD;AAED;;;;;;4BAGgB;AACd,iBAAO,KAAKiR,aAAZ;AACD;;;;;;;;;;;;;;;;;;;;;AChGH;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;;QAEamC,W;;;AAUX;;;;AAIA,2BAAYhtB,GAAZ,EAAmC;AAAA,YAAlBzB,SAAkB,uEAAN,IAAM;;AAAA;;AACjC,aAAKiqB,IAAL,GAAYxoB,GAAZ;AACA,aAAKR,UAAL,GAAkBjB,SAAlB,CAFiC,CAIjC;;AACA,aAAK0uB,OAAL,GAAe,yDAActI,IAA7B;AACA,aAAKuI,UAAL,GAAkB,CAAC,CAAD,EAAI,CAAJ,CAAlB;AACD;;;;qCAEY;AACX;AACA,eAAK1E,IAAL,CAAU2E,MAAV,CAAiBzrB,gBAAjB,CAAkC,OAAlC,EAA2C,KAAK0rB,UAAL,CAAgBxrB,IAAhB,CAAqB,IAArB,CAA3C,EAAuE,KAAvE;;AACA,eAAK4mB,IAAL,CAAU2E,MAAV,CAAiBzrB,gBAAjB,CAAkC,WAAlC,EAA+C,KAAK4N,SAAL,CAAe1N,IAAf,CAAoB,IAApB,CAA/C,EAA0E,KAA1E;;AACAkpB,kBAAQ,CAACppB,gBAAT,CAA0B,WAA1B,EAAuC,KAAK2rB,SAAL,CAAezrB,IAAf,CAAoB,IAApB,CAAvC,EAAkE,KAAlE;AACAkpB,kBAAQ,CAACppB,gBAAT,CAA0B,SAA1B,EAAqC,KAAK4rB,OAAL,CAAa1rB,IAAb,CAAkB,IAAlB,CAArC,EAA8D,KAA9D;AACD;AAED;;;;;;kCAGU2B,K,EAAmB;AAC3B,eAAK2pB,UAAL,GAAkB,CAAC3pB,KAAK,CAAC4B,CAAP,EAAU5B,KAAK,CAAC8B,CAAhB,CAAlB;;AAEA,cAAI9B,KAAK,CAACgqB,OAAV,EAAmB;AACjB,gBAAMpoB,CAAC,GAAG5B,KAAK,CAAC4B,CAAhB;AACA,gBAAME,CAAC,GAAI,KAAKmjB,IAAL,CAAU2E,MAAV,CAAiBL,MAAjB,GAA0BvpB,KAAK,CAAC8B,CAA3C;AAEA,gBAAMmoB,KAAK,GAAG,EAAd;AAJiB;AAAA;AAAA;;AAAA;AAKjB,qCAAoB,KAAKhF,IAAL,CAAUE,YAAV,CAAuBza,MAA3C,wIAAmD;AAAA,oBAAxCH,KAAwC;;AACjD,oBAAI,CAACA,KAAK,CAACoC,UAAX,EAAuB;AAAE;AAAW;;AAEpCpC,qBAAK,CAACwD,IAAN,CAAW,KAAKkX,IAAL,CAAUlR,SAArB,EAAgCnS,CAAhC,EAAmCE,CAAnC;AACAmoB,qBAAK,CAAC/oB,IAAN,CAAWqJ,KAAK,CAAC2f,MAAN,EAAX;;AAEA,qBAAKjuB,UAAL,CAAgByH,KAAhB,CAAsBqI,SAAtB,CAAgCke,KAAhC;AACD;AAZgB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAalB,WAbD,MAaO;AACL,iBAAKP,OAAL,GAAe,yDAAcrI,IAA7B;AACD;;AAED,eAAK4D,IAAL,CAAU5nB,MAAV;AACD;AAED;;;;;;kCAGU2C,K,EAAmB;AAC3B;AACA,cAAI,KAAK0pB,OAAL,KAAiB,yDAAcrI,IAAnC,EAAyC;AACvC,gBAAMrD,EAAE,GAAI,CAAChe,KAAK,CAAC4B,CAAP,GAAW,KAAK+nB,UAAL,CAAgB,CAAhB,CAAvB;AACA,gBAAM1L,EAAE,GAAGje,KAAK,CAAC8B,CAAN,GAAU,KAAK6nB,UAAL,CAAgB,CAAhB,CAArB;;AAEA,gBAAI3pB,KAAK,CAACmqB,OAAN,KAAkB,CAAlB,IAAuBnqB,KAAK,CAACoqB,QAA7B,IAAyC,KAAKnF,IAAL,CAAUnD,MAAV,CAAiBiG,eAAjB,OAAuC,wDAAa5K,QAAjG,EAA2G;AAAE;AAC3G,mBAAK8H,IAAL,CAAUnD,MAAV,CAAiBuI,GAAjB,CAAqBrM,EAAE,GAAG,KAAKiH,IAAL,CAAU2E,MAAV,CAAiBrsB,WAA3C;;AACA,mBAAK0nB,IAAL,CAAUnD,MAAV,CAAiBwI,KAAjB,CAAuBrM,EAAE,GAAG,KAAKgH,IAAL,CAAU2E,MAAV,CAAiBnsB,YAA7C;AACD,aAHD,MAGO;AACL,mBAAKwnB,IAAL,CAAUnD,MAAV,CAAiByI,SAAjB,CAA2BvM,EAAE,GAAG,KAAKiH,IAAL,CAAU2E,MAAV,CAAiBrsB,WAAjD,EAA8D0gB,EAAE,GAAG,KAAKgH,IAAL,CAAU2E,MAAV,CAAiBnsB,YAApF;AACD;;AAED,iBAAKksB,UAAL,GAAkB,CAAC3pB,KAAK,CAAC4B,CAAP,EAAU5B,KAAK,CAAC8B,CAAhB,CAAlB;;AACA,iBAAKmjB,IAAL,CAAU5nB,MAAV;AACD;AACF;AAED;;;;;;gCAGQ2C,K,EAAmB;AACzB;AACA,eAAK0pB,OAAL,GAAe,yDAActI,IAA7B;;AACA,eAAK6D,IAAL,CAAU5nB,MAAV;AACD;AAED;;;;;;mCAGW2C,K,EAAmB;AAC5B;AACA,cAAMwqB,aAAa,GAAGzpB,IAAI,CAAC+B,GAAL,CAAS,KAAKmiB,IAAL,CAAU2E,MAAV,CAAiBvmB,KAA1B,EAAiC,KAAK4hB,IAAL,CAAU2E,MAAV,CAAiBL,MAAlD,CAAtB;AACA,cAAM3nB,CAAC,GAAG5B,KAAK,CAAC4B,CAAN,GAAU4oB,aAApB;AACA,cAAM1oB,CAAC,GAAG,CAAC,KAAKmjB,IAAL,CAAU2E,MAAV,CAAiBL,MAAjB,GAA0BvpB,KAAK,CAAC8B,CAAjC,IAAsC0oB,aAAhD;;AACA,eAAKvF,IAAL,CAAUnD,MAAV,CAAiBmB,IAAjB,CAAsBjjB,KAAK,CAACyqB,MAA5B,EAAoC7oB,CAApC,EAAuCE,CAAvC;;AACA,eAAKmjB,IAAL,CAAU5nB,MAAV;AACD;AAED;;;;;;kCAGU2C,K,EAAmB;AAC3B0U,iBAAO,CAACC,GAAR,CAAY,QAAZ,EAAsB3U,KAAK,CAACgqB,OAA5B;AAED;;;;;;;;;;;;;;;;;;;;;AC5GH;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA,qC,CAAA;;;QAMaU,a;;;;;AA4BX;;;;AAIA,6BAAY1wB,EAAZ,EAAwB;AAAA;;AAAA;;AACtB,6FAAMA,EAAN,GADsB,CA1BxB;;AACU,gBAAA2Y,SAAA,GAAiB,EAAjB,CAyBc,CAvBxB;;AACU,gBAAAC,iBAAA,GAAiC,IAAjC;AACA,gBAAA+X,cAAA,GAA8B,IAA9B;AACA,gBAAA9X,cAAA,GAA8B,IAA9B,CAoBc,CAlBxB;;AACU,gBAAA+X,eAAA,GAA4B,EAA5B;AACA,gBAAAC,YAAA,GAAyB,EAAzB;AACA,gBAAAC,YAAA,GAAyB,EAAzB,CAec,CAbxB;;AACU,gBAAA/X,WAAA,GAAc,CAAC,CAAf;AACA,gBAAAgY,QAAA,GAAW,CAAC,CAAZ,CAWc,CATxB;;AACU,gBAAA9X,mBAAA,GAA4C,CAAC,CAA7C;AACA,gBAAAC,oBAAA,GAA6C,CAAC,CAA9C;AACA,gBAAAC,aAAA,GAAsC,CAAC,CAAvC;AAMc;AAEvB;AAED;;;;;;;;oCAIkBY,S,EAAmC;;;;;;;;;AAE1C/Z,sB,GAAK,C;;;0BAAGA,EAAE,GAAG0wB,aAAa,CAAC1W,Q;;;;;AAClC;AACMC,2B,qCAAqCja,E;AACrCka,2B,qCAAqCla,E,aAE3C;;;AACiB,2BAAM,wDAAWma,WAAX,CAAuBF,OAAvB,CAAN;;;AAAXG,4B;;AAEW,2BAAM,wDAAWD,WAAX,CAAuBD,OAAvB,CAAN;;;AAAXG,4B;AAEN;AACA,yBAAKC,iBAAL,CAAuBF,QAAvB,EAAiCC,QAAjC,EAA2CN,SAA3C;;;AAX4C/Z,sBAAE,E;;;;;AAchD;AACA,yBAAK+Y,WAAL,GAAmBgB,SAAS,CAACU,iBAAV,CAA4B,KAAKD,cAAL,CAAoB,CAApB,CAA5B,EAAoD,SAApD,CAAnB;AACA,yBAAKuW,QAAL,GAAgBhX,SAAS,CAACU,iBAAV,CAA4B,KAAKD,cAAL,CAAoB,CAApB,CAA5B,EAAoD,SAApD,CAAhB;AACA,yBAAKvB,mBAAL,GAA2Bc,SAAS,CAACQ,kBAAV,CAA6B,KAAKC,cAAL,CAAoB,CAApB,CAA7B,EAAqD,kBAArD,CAA3B;AACA,yBAAKtB,oBAAL,GAA4Ba,SAAS,CAACQ,kBAAV,CAA6B,KAAKC,cAAL,CAAoB,CAApB,CAA7B,EAAqD,mBAArD,CAA5B;AACA,yBAAKrB,aAAL,GAAqBY,SAAS,CAACQ,kBAAV,CAA6B,KAAKC,cAAL,CAAoB,CAApB,CAA7B,EAAqD,cAArD,CAArB,C,CAEA;;AACAE,2BAAO,CAACC,GAAR,iDAAqD,KAAKC,QAA1D;;;;;;;;;AACD;AAED;;;;;;;uCAIqBb,S,EAAqD;AAAA,cAAlBhX,IAAkB,uEAAN,IAAM;;;;;;;;;;;;;AAEjE,2BAAM,kDAAQ8X,eAAR,CAAwB,KAAKD,QAA7B,CAAN;;;AAAP7X,wB;AAEA;AACA,yBAAK4V,SAAL,GAAiB;AACf,kCAAY,EADG;AACC,+BAAS,EADV;AACc,+BAAS,EADvB;AAC2B,kCAAY,EADvC;AAC2C,8BAAQ;AADnD,qBAAjB,C,CAIA;;AACIqY,0B,GAAS,C,EAEb;;;;;;;;0BACWlW,O;AACT;AACA,0BAAMmW,GAAG,GAAGnW,OAAO,CAACzH,UAAR,CAAmBsS,KAAnB,CAAyB7f,KAAzB,CAA+B,CAA/B,EAAkC,CAAlC,CAAZ;AACA,0BAAMorB,GAAG,GAAG,CAAC,CAAD,EAAI,CAAJ,EAAO,CAAP,EAAUzuB,GAAV,CAAc,UAAC0uB,KAAD,EAAW;AACnC,+BAAOC,QAAQ,CAACH,GAAG,CAACnrB,KAAJ,CAAUqrB,KAAV,EAAiBA,KAAK,GAAG,CAAzB,CAAD,EAA8B,EAA9B,CAAR,GAA4C,GAAnD;AACD,uBAFW,CAAZ,C,CAIA;;AACA,0BAAMpH,QAAQ,GAAGjP,OAAO,CAAChI,QAAR,CAAiBiI,WAAlC,C,CACA;;AACA,0BAAM2K,MAAM,GAAG,EAAf;;AACA,2BAAK,IAAI1lB,EAAE,GAAG,CAAd,EAAiBA,EAAE,GAAG+pB,QAAQ,CAAC/kB,MAAT,GAAkB0rB,aAAa,CAACtT,MAAtD,EAA8Dpd,EAAE,EAAhE,EAAoE;AAClE0lB,8BAAM,CAACxe,IAAP,OAAAwe,MAAM,qBAASwL,GAAT,EAAN;AACD,uB,CAED;;;AACA,0BAAMjW,OAAO,GAAGH,OAAO,CAAChI,QAAR,CAAiBmI,OAAjC;;AACA,2BAAK,IAAIjb,IAAE,GAAG,CAAd,EAAiBA,IAAE,GAAGib,OAAO,CAACjW,MAA9B,EAAsChF,IAAE,EAAxC,EAA4C;AAC1Cib,+BAAO,CAACjb,IAAD,CAAP,IAAegxB,MAAf;AACD,uB,CAED;;;AACA,6BAAI,CAACrY,SAAL,CAAe,UAAf,EAA2BzR,IAA3B,CAAgCmqB,KAAhC,CAAsC,OAAI,CAAC1Y,SAAL,CAAe,UAAf,CAAtC,EAAkEoR,QAAlE;;AACA,6BAAI,CAACpR,SAAL,CAAe,OAAf,EAAwBzR,IAAxB,CAA6BmqB,KAA7B,CAAmC,OAAI,CAAC1Y,SAAL,CAAe,OAAf,CAAnC,EAA4D+M,MAA5D;;AACA,6BAAI,CAAC/M,SAAL,CAAe,OAAf,EAAwBzR,IAAxB,CAA6BmqB,KAA7B,CAAmC,OAAI,CAAC1Y,SAAL,CAAe,OAAf,CAAnC,EAA4DsC,OAA5D,E,CAEA;;;AACA+V,4BAAM,IAAIjH,QAAQ,CAAC/kB,MAAT,GAAkB0rB,aAAa,CAACtT,MAA1C;;;AA3BF,uCAAsBra,IAAI,CAACiQ,QAA3B,+HAAqC;AAAA;AA4BpC,qB,CACD;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AACA,yBAAK4d,eAAL,GAAuB,KAAKjY,SAAL,CAAe,UAAf,CAAvB,C,CACA;;AACA,yBAAKkY,YAAL,GAAoB,KAAKlY,SAAL,CAAe,OAAf,CAApB,C,CACA;;AACA,yBAAKmY,YAAL,GAAoB,KAAKnY,SAAL,CAAe,OAAf,CAApB,C,CAEA;;AACA,yBAAKuC,aAAL,CAAmBnB,SAAnB;;;;;;;;;AACD;AAED;;;;;;;+BAIOA,S,EAAmC;AACxC;AACA,cACE,KAAKS,cAAL,CAAoBxV,MAApB,KAA+B,CAA/B,IACA,KAAKwV,cAAL,CAAoB,CAApB,MAA2B,IAD3B,IAEA,KAAK5B,iBAAL,KAA2B,IAF3B,IAGA,KAAK+X,cAAL,KAAwB,IAHxB,IAIA,KAAK9X,cAAL,KAAwB,IAJxB,IAKA,KAAKE,WAAL,GAAmB,CALnB,IAMA,KAAKgY,QAAL,GAAgB,CAPlB,EAQE;AACA;AACD,WAZuC,CAcxC;;;AACA,eAAKtG,WAAL,CAAiB1Q,SAAjB,EAfwC,CAiBxC;;AACAA,mBAAS,CAACkD,UAAV,CAAqBlD,SAAS,CAACmD,YAA/B,EAA6C,KAAKtE,iBAAlD;AACAmB,mBAAS,CAACoD,mBAAV,CAA8B,KAAKpE,WAAnC,EAAgD2X,aAAa,CAACtT,MAA9D,EAAsErD,SAAS,CAAC2B,KAAhF,EAAuF,KAAvF,EAA8F,CAA9F,EAAiG,CAAjG;AACA3B,mBAAS,CAACsD,uBAAV,CAAkC,KAAKtE,WAAvC,EApBwC,CAsBxC;;AACAgB,mBAAS,CAACkD,UAAV,CAAqBlD,SAAS,CAACmD,YAA/B,EAA6C,KAAKyT,cAAlD;AACA5W,mBAAS,CAACoD,mBAAV,CAA8B,KAAK4T,QAAnC,EAA6C,CAA7C,EAAgDhX,SAAS,CAAC2B,KAA1D,EAAiE,KAAjE,EAAwE,CAAxE,EAA2E,CAA3E;AACA3B,mBAAS,CAACsD,uBAAV,CAAkC,KAAK0T,QAAvC,EAzBwC,CA2BxC;;AACAhX,mBAAS,CAACkD,UAAV,CAAqBlD,SAAS,CAAC2D,oBAA/B,EAAqD,KAAK7E,cAA1D,EA5BwC,CA6BxC;;AACAkB,mBAAS,CAACoC,UAAV,CAAqB,KAAK3B,cAAL,CAAoB,CAApB,CAArB,EA9BwC,CA+BxC;;AACAT,mBAAS,CAAC4D,YAAV,CAAuB5D,SAAS,CAAC6D,SAAjC,EAA4C,KAAKkT,YAAL,CAAkB9rB,MAA9D,EAAsE+U,SAAS,CAAC8D,YAAhF,EAA8F,CAA9F;AACD;AAED;;;;;;;oCAIsB9D,S,EAAmC;AACvD,cAAI,CAAC,KAAKS,cAAL,CAAoBxV,MAArB,IAA+B,KAAKwV,cAAL,CAAoB,CAApB,MAA2B,IAA9D,EAAoE;AAClE;AACD;;AACDT,mBAAS,CAACoC,UAAV,CAAqB,KAAK3B,cAAL,CAAoB,CAApB,CAArB,EAJuD,CAKvD;;AACAT,mBAAS,CAACqC,gBAAV,CAA2B,KAAKnD,mBAAhC,EAAqD,KAArD,EAA4D,KAAKoD,OAAL,CAAaC,kBAAb,EAA5D;AACAvC,mBAAS,CAACqC,gBAAV,CAA2B,KAAKlD,oBAAhC,EAAsD,KAAtD,EAA6D,KAAKmD,OAAL,CAAaE,mBAAb,EAA7D,EAPuD,CAQvD;;AACA,cAAMC,WAAW,GAAG,KAAKH,OAAL,CAAaI,cAAb,EAApB;;AACA1C,mBAAS,CAAC2C,SAAV,CAAoB,KAAKvD,aAAzB,EAAwCqD,WAAW,CAAC,CAAD,CAAnD,EAAwDA,WAAW,CAAC,CAAD,CAAnE;AACD;AAED;;;;;;;sCAIwBzC,S,EAAmC;AACzD;AACA,eAAKnB,iBAAL,GAAyBmB,SAAS,CAAC6G,YAAV,EAAzB,CAFyD,CAGzD;;AACA7G,mBAAS,CAACkD,UAAV,CAAqBlD,SAAS,CAACmD,YAA/B,EAA6C,KAAKtE,iBAAlD,EAJyD,CAKzD;;AACAmB,mBAAS,CAAC8G,UAAV,CACE9G,SAAS,CAACmD,YADZ,EAC0B,IAAI3B,YAAJ,CAAiB,KAAKqV,eAAtB,CAD1B,EACkE7W,SAAS,CAAC+G,WAD5E,EANyD,CAUzD;;AACA,eAAK6P,cAAL,GAAsB5W,SAAS,CAAC6G,YAAV,EAAtB,CAXyD,CAYzD;;AACA7G,mBAAS,CAACkD,UAAV,CAAqBlD,SAAS,CAACmD,YAA/B,EAA6C,KAAKyT,cAAlD,EAbyD,CAczD;;AACA5W,mBAAS,CAAC8G,UAAV,CACE9G,SAAS,CAACmD,YADZ,EAC0B,IAAI3B,YAAJ,CAAiB,KAAKsV,YAAtB,CAD1B,EAC+D9W,SAAS,CAAC+G,WADzE,EAfyD,CAmBzD;;AACA,eAAKjI,cAAL,GAAsBkB,SAAS,CAAC6G,YAAV,EAAtB,CApByD,CAqBzD;;AACA7G,mBAAS,CAACkD,UAAV,CAAqBlD,SAAS,CAAC2D,oBAA/B,EAAqD,KAAK7E,cAA1D,EAtByD,CAuBzD;;AACAkB,mBAAS,CAAC8G,UAAV,CACE9G,SAAS,CAAC2D,oBADZ,EACkC,IAAIqD,WAAJ,CAAgB,KAAK+P,YAArB,CADlC,EACsE/W,SAAS,CAAC+G,WADhF;AAED;;;;MAlNgC,4C,GACjC;;;AACiB,kBAAA1D,MAAA,GAAS,CAAT,C,CACjB;;AACiB,kBAAApD,QAAA,GAAW,CAAX;;;;;;;;;;;;;;;;ACVnB;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA,qC,CAAA;;;QAQasX,U;;;;;AA0BX;;;;AAIA,0BAAYtxB,EAAZ,EAAwB;AAAA;;AAAA;;AACtB,0FAAMA,EAAN,GADsB,CAxBxB;;AACU,gBAAA2Y,SAAA,GAAiB,EAAjB,CAuBc,CArBxB;;AACU,gBAAAC,iBAAA,GAAiC,IAAjC;AACA,gBAAA2Y,eAAA,GAA+B,IAA/B;AACA,gBAAAlI,cAAA,GAA+B,IAA/B,CAkBc,CAhBxB;;AACU,gBAAAtQ,WAAA,GAAc,CAAC,CAAf;AACA,gBAAAyY,SAAA,GAAY,CAAC,CAAb,CAcc,CAZxB;;AACU,gBAAAvY,mBAAA,GAA4C,CAAC,CAA7C;AACA,gBAAAC,oBAAA,GAA6C,CAAC,CAA9C;AACA,gBAAAwQ,eAAA,GAAwC,CAAC,CAAzC,CASc,CAPxB;;AACU,gBAAAC,YAAA,GAAqC,CAAC,CAAtC;AAQR,gBAAKE,QAAL,GAAgB,KAAhB;AAFsB;AAGvB;AAED;;;;;;;;oCAIkB9P,S,EAAmC;;;;;;;;;AAE1C/Z,sB,GAAK,C;;;0BAAGA,EAAE,GAAGsxB,UAAU,CAACtX,Q;;;;;AAC/B;AACMC,2B,kCAAkCja,E;AAClCka,2B,kCAAkCla,E,aAExC;;;AACiB,2BAAM,wDAAWma,WAAX,CAAuBF,OAAvB,CAAN;;;AAAXG,4B;;AAEW,2BAAM,wDAAWD,WAAX,CAAuBD,OAAvB,CAAN;;;AAAXG,4B;AAEN;AACA,yBAAKC,iBAAL,CAAuBF,QAAvB,EAAiCC,QAAjC,EAA2CN,SAA3C;;;AAXyC/Z,sBAAE,E;;;;;AAc7C;AACA,yBAAK+Y,WAAL,GAAmBgB,SAAS,CAACU,iBAAV,CAA4B,KAAKD,cAAL,CAAoB,CAApB,CAA5B,EAAoD,SAApD,CAAnB;AACA,yBAAKgX,SAAL,GAAiBzX,SAAS,CAACU,iBAAV,CAA4B,KAAKD,cAAL,CAAoB,CAApB,CAA5B,EAAoD,YAApD,CAAjB,C,CAEA;;AACA,yBAAKvB,mBAAL,GAA2Bc,SAAS,CAACQ,kBAAV,CAA6B,KAAKC,cAAL,CAAoB,CAApB,CAA7B,EAAqD,kBAArD,CAA3B;AACA,yBAAKtB,oBAAL,GAA4Ba,SAAS,CAACQ,kBAAV,CAA6B,KAAKC,cAAL,CAAoB,CAApB,CAA7B,EAAqD,mBAArD,CAA5B;AACA,yBAAKkP,eAAL,GAAuB3P,SAAS,CAACQ,kBAAV,CAA6B,KAAKC,cAAL,CAAoB,CAApB,CAA7B,EAAqD,cAArD,CAAvB,C,CAEA;;AACA,yBAAKmP,YAAL,GAAoB5P,SAAS,CAACQ,kBAAV,CAA6B,KAAKC,cAAL,CAAoB,CAApB,CAA7B,EAAqD,WAArD,CAApB,C,CACA;;AACAE,2BAAO,CAACC,GAAR,iDAAqD,KAAKC,QAA1D;;;;;;;;;AACD;AAED;;;;;;;uCAIqBb,S,EAAqD;AAAA,cAAlBhX,IAAkB,uEAAN,IAAM;;;;;;;;;;0BAEpEA,IAAI,KAAK,I;;;;;;AACJ,2BAAM,kDAAQ8X,eAAR,CAAwB,KAAKD,QAA7B,CAAN;;;AAAP7X,wB;;;AAGF;AACA,yBAAK4V,SAAL,GAAiB;AAAC,kCAAY,EAAb;AAAiB,gCAAU;AAA3B,qBAAjB,C,CAEA;;;;;;;AACA,uCAAsB5V,IAAI,CAACiQ,QAA3B,+HAAqC;AAA1B8H,6BAA0B;AACnC;AACMiP,8BAF6B,GAElBjP,OAAO,CAAChI,QAAR,CAAiBiI,WAFC;AAI7BoP,4BAJ6B,GAIpB,EAJoB;;AAKnC,2BAASnqB,EAAT,GAAc,CAAd,EAAiBA,EAAE,GAAG+pB,QAAQ,CAAC/kB,MAAT,GAAkBssB,UAAU,CAAClU,MAAnD,EAA2Dpd,EAAE,EAA7D,EAAiE;AACzD2G,2BADyD,GACnDmU,OAAO,CAACzH,UAAR,IAAsByH,OAAO,CAACzH,UAAR,CAAmB8W,MAAzC,GAAkDrP,OAAO,CAACzH,UAAR,CAAmB8W,MAArE,GAA8E,CAAC,CAD5B;AAE/DA,8BAAM,CAACjjB,IAAP,CAAYP,GAAZ;AACD,uBARkC,CAUnC;;;AACA,2BAAKgS,SAAL,CAAe,UAAf,EAA2BzR,IAA3B,CAAgCmqB,KAAhC,CAAsC,KAAK1Y,SAAL,CAAe,UAAf,CAAtC,EAAkEoR,QAAlE;;AACA,2BAAKpR,SAAL,CAAe,QAAf,EAAyBzR,IAAzB,CAA8BmqB,KAA9B,CAAoC,KAAK1Y,SAAL,CAAe,QAAf,CAApC,EAA8DwR,MAA9D;AACD,qB,CAED;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AACA,yBAAKjP,aAAL,CAAmBnB,SAAnB,E,CACA;;AACA,yBAAK0X,kBAAL,CAAwB1X,SAAxB,E,CACA;;AACA,yBAAKwQ,qBAAL,CAA2BxQ,SAA3B,EAAsC,wDAAakM,sBAAnD,EAA2E,KAA3E;;;;;;;;;AACD;AAED;;;;;;;uCAIqBlM,S,EAAmC;;;;;;;;;;AAEzC,2BAAM,kDAAQ2X,gBAAR,CAAyB,KAAK9W,QAA9B,CAAN;;;AAAP7X,wB;AAEN;AACA,yBAAK4V,SAAL,GAAiB;AAAC,gCAAU;AAAX,qBAAjB,C,CAEA;;AACA,yBAAKA,SAAL,CAAe,QAAf,IAA2B5V,IAAI,CAACsQ,UAAL,CAAgB8W,MAA3C,C,CAEA;;AACA,yBAAKsH,kBAAL,CAAwB1X,SAAxB;;;;;;;;;AACD;AAED;;;;;;;;uCAKeA,S,EAAmCyQ,I,EAAoB;AACpE;AACA,eAAKD,qBAAL,CAA2BxQ,SAA3B,EAAsCyQ,IAAtC,EAA4C,KAA5C;AACD;AAED;;;;;;;+BAIOzQ,S,EAAmC;AACxC;AACA,cACE,KAAKS,cAAL,CAAoBxV,MAApB,KAA+B,CAA/B,IACA,KAAKwV,cAAL,CAAoB,CAApB,MAA2B,IAD3B,IAEA,KAAK5B,iBAAL,KAA2B,IAF3B,IAGA,KAAK2Y,eAAL,KAAyB,IAHzB,IAIA,KAAKxY,WAAL,GAAmB,CAJnB,IAKA,KAAKyY,SAAL,GAAiB,CANnB,EAOE;AACA;AACD,WAXuC,CAaxC;;;AACA,eAAK/G,WAAL,CAAiB1Q,SAAjB,EAdwC,CAgBxC;;AACAA,mBAAS,CAAC6B,MAAV,CAAiB7B,SAAS,CAAC+D,KAA3B;AACA/D,mBAAS,CAACgE,SAAV,CAAoBhE,SAAS,CAACiE,SAA9B,EAAyCjE,SAAS,CAACkE,mBAAnD,EAlBwC,CAoBxC;;AACAlE,mBAAS,CAACkD,UAAV,CAAqBlD,SAAS,CAACmD,YAA/B,EAA6C,KAAKtE,iBAAlD;AACAmB,mBAAS,CAACoD,mBAAV,CAA8B,KAAKpE,WAAnC,EAAgDuY,UAAU,CAAClU,MAA3D,EAAmErD,SAAS,CAAC2B,KAA7E,EAAoF,KAApF,EAA2F,CAA3F,EAA8F,CAA9F;AACA3B,mBAAS,CAACsD,uBAAV,CAAkC,KAAKtE,WAAvC,EAvBwC,CAyBxC;;AACAgB,mBAAS,CAACkD,UAAV,CAAqBlD,SAAS,CAACmD,YAA/B,EAA6C,KAAKqU,eAAlD;AACAxX,mBAAS,CAACoD,mBAAV,CAA8B,KAAKqU,SAAnC,EAA8C,CAA9C,EAAiDzX,SAAS,CAAC2B,KAA3D,EAAkE,KAAlE,EAAyE,CAAzE,EAA4E,CAA5E;AACA3B,mBAAS,CAACsD,uBAAV,CAAkC,KAAKmU,SAAvC,EA5BwC,CA8BxC;;AACAzX,mBAAS,CAAC2E,aAAV,CAAwB3E,SAAS,CAAC4E,QAAlC,EA/BwC,CAgCxC;;AACA5E,mBAAS,CAAC6E,WAAV,CAAsB7E,SAAS,CAAC8E,UAAhC,EAA4C,KAAKwK,cAAjD,EAjCwC,CAmCxC;;AACAtP,mBAAS,CAACoC,UAAV,CAAqB,KAAK3B,cAAL,CAAoB,CAApB,CAArB,EApCwC,CAsCxC;;AACAT,mBAAS,CAACmF,UAAV,CAAqBnF,SAAS,CAAC4X,MAA/B,EAAuC,CAAvC,EAA0C,KAAKhZ,SAAL,CAAe,UAAf,EAA2B3T,MAA3B,GAAoCssB,UAAU,CAAClU,MAAzF,EAvCwC,CAyCxC;;AACArD,mBAAS,CAACmC,OAAV,CAAkBnC,SAAS,CAAC+D,KAA5B;AACD;AAED;;;;;;;oCAIsB/D,S,EAAmC;AACvD,cAAI,CAAC,KAAKS,cAAL,CAAoBxV,MAArB,IAA+B,KAAKwV,cAAL,CAAoB,CAApB,MAA2B,IAA9D,EAAoE;AAClE;AACD;;AACDT,mBAAS,CAACoC,UAAV,CAAqB,KAAK3B,cAAL,CAAoB,CAApB,CAArB,EAJuD,CAKvD;;AACAT,mBAAS,CAACqC,gBAAV,CAA2B,KAAKnD,mBAAhC,EAAqD,KAArD,EAA4D,KAAKoD,OAAL,CAAaC,kBAAb,EAA5D;AACAvC,mBAAS,CAACqC,gBAAV,CAA2B,KAAKlD,oBAAhC,EAAsD,KAAtD,EAA6D,KAAKmD,OAAL,CAAaE,mBAAb,EAA7D,EAPuD,CAQvD;;AACA,cAAMC,WAAW,GAAG,KAAKH,OAAL,CAAaI,cAAb,EAApB;;AACA1C,mBAAS,CAAC2C,SAAV,CAAoB,KAAKgN,eAAzB,EAA0ClN,WAAW,CAAC,CAAD,CAArD,EAA0DA,WAAW,CAAC,CAAD,CAArE,EAVuD,CAYvD;;AACAzC,mBAAS,CAAC+E,SAAV,CAAoB,KAAK6K,YAAzB,EAAuC,CAAvC;AACD;AAED;;;;;;;sCAIwB5P,S,EAAmC;AACzD;AACA,eAAKnB,iBAAL,GAAyBmB,SAAS,CAAC6G,YAAV,EAAzB,CAFyD,CAGzD;;AACA7G,mBAAS,CAACkD,UAAV,CAAqBlD,SAAS,CAACmD,YAA/B,EAA6C,KAAKtE,iBAAlD,EAJyD,CAKzD;;AACAmB,mBAAS,CAAC8G,UAAV,CACE9G,SAAS,CAACmD,YADZ,EAC0B,IAAI3B,YAAJ,CAAiB,KAAK5C,SAAL,CAAe,UAAf,CAAjB,CAD1B,EACwEoB,SAAS,CAAC+G,WADlF;AAGD;AAED;;;;;;;2CAI6B/G,S,EAAmC;AAC9D;AACA,cAAI,KAAKwX,eAAL,KAAyB,IAA7B,EAAmC;AACjC,iBAAKA,eAAL,GAAuBxX,SAAS,CAAC6G,YAAV,EAAvB;AACD,WAJ6D,CAK9D;;;AACA7G,mBAAS,CAACkD,UAAV,CAAqBlD,SAAS,CAACmD,YAA/B,EAA6C,KAAKqU,eAAlD,EAN8D,CAO9D;;AACAxX,mBAAS,CAAC8G,UAAV,CACE9G,SAAS,CAACmD,YADZ,EAC0B,IAAI3B,YAAJ,CAAiB,KAAK5C,SAAL,CAAe,QAAf,CAAjB,CAD1B,EACsEoB,SAAS,CAAC+G,WADhF;AAGD;AAEC;;;;;;;;;8CAM8B/G,S,EAAmC4L,K,EAA+C;AAAA,cAA1BH,OAA0B,uEAAP,KAAO;;AAChH;AACA,cAAMje,IAAI,GAAG,mDAASsjB,WAAT,CAAqBlF,KAArB,EAA4BH,OAA5B,CAAb,CAFgH,CAGhH;;;AACA,cAAI,KAAK6D,cAAL,KAAwB,IAA5B,EAAkC;AAChC,iBAAKA,cAAL,GAAsBtP,SAAS,CAACsF,aAAV,EAAtB;AACD,WAN+G,CAQhH;;;AACAtF,mBAAS,CAAC6E,WAAV,CAAsB7E,SAAS,CAAC8E,UAAhC,EAA4C,KAAKwK,cAAjD;AACAtP,mBAAS,CAAC4F,UAAV,CACE5F,SAAS,CAAC8E,UADZ,EACwB,CADxB,EAC2B9E,SAAS,CAAC0B,IADrC,EAC2ClU,IAAI,CAACvC,MAAL,GAAc,CADzD,EAC4D,CAD5D,EAC+D,CAD/D,EAEE+U,SAAS,CAAC0B,IAFZ,EAEkB1B,SAAS,CAAC+Q,aAF5B,EAE2C,IAAIC,UAAJ,CAAexjB,IAAf,CAF3C,EAVgH,CAchH;;AACAwS,mBAAS,CAAC8F,aAAV,CAAwB9F,SAAS,CAAC8E,UAAlC,EAA8C9E,SAAS,CAAC+F,kBAAxD,EAA4E/F,SAAS,CAAC6Q,MAAtF,EAfgH,CAgBhH;;AACA7Q,mBAAS,CAAC8F,aAAV,CAAwB9F,SAAS,CAAC8E,UAAlC,EAA8C9E,SAAS,CAACkG,cAAxD,EAAwElG,SAAS,CAACmG,aAAlF,EAjBgH,CAkBhH;;AACAnG,mBAAS,CAAC8F,aAAV,CAAwB9F,SAAS,CAAC8E,UAAlC,EAA8C9E,SAAS,CAACoG,cAAxD,EAAwEpG,SAAS,CAACmG,aAAlF;AACD;;;;MAtQ6B,4C,GAC9B;;;AACiB,eAAA9C,MAAA,GAAS,CAAT,C,CACjB;;AACiB,eAAApD,QAAA,GAAW,CAAX;;;;;;;;;;;;;;;;ACZnB;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA,qC,CAAA;;;QAQa4X,Y;;;;;AA4CT;;;;AAIA,4BAAY5xB,EAAZ,EAAwB;AAAA;;AAAA;;AACpB,4FAAMA,EAAN,GADoB,CA1CxB;;AACU,gBAAA2Y,SAAA,GAAiB,EAAjB,CAyCc,CAvCxB;;AACU,gBAAAC,iBAAA,GAAiC,IAAjC;AACA,gBAAAC,cAAA,GAA8B,IAA9B;AACA,gBAAAgZ,kBAAA,GAAkC,IAAlC;AACA,gBAAAN,eAAA,GAA+B,IAA/B,CAmCc,CAjCxB;;AACU,gBAAAxY,WAAA,GAAc,CAAC,CAAf;AACA,gBAAA+Y,UAAA,GAAa,CAAC,CAAd;AACA,gBAAAN,SAAA,GAAY,CAAC,CAAb,CA8Bc,CA5BxB;;AACU,gBAAAvY,mBAAA,GAA4C,CAAC,CAA7C;AACA,gBAAAC,oBAAA,GAA6C,CAAC,CAA9C;AACA,gBAAAwQ,eAAA,GAAwC,CAAC,CAAzC;AACA,gBAAAqI,iBAAA,GAA0C,CAAC,CAA3C,CAwBc,CAtBxB;;AACU,gBAAAzY,UAAA,GAAa,CAAC,CAAd;AACA,gBAAA0Y,aAAA,GAAsC,CAAC,CAAvC,CAoBc,CAlBxB;;AACU,gBAAAzY,SAAA,GAAY,CAAC,CAAb;AACA,gBAAAC,UAAA,GAAa,CAAC,CAAd;AACA,gBAAAC,IAAA,GAAyB,IAAzB;AACA,gBAAAwY,QAAA,GAA6B,IAA7B,CAcc,CAZxB;;AACU,gBAAAC,cAAA,GAA+B,IAA/B;AACA,gBAAAC,iBAAA,GAAkC,IAAlC,CAUc,CARxB;;AACU,gBAAAxI,YAAA,GAAqC,CAAC,CAAtC;AACA,gBAAAyI,gBAAA,GAAiC,IAAjC;AAMc;AAEvB;AAED;;;;;;;;oCAIkBrY,S,EAAmC;;;;;;;;;AAExC/Z,sB,GAAK,C;;;0BAAGA,EAAE,GAAG4xB,YAAY,CAAC5X,Q;;;;;AAC/B;AACMC,2B,oCAAoCja,E;AACpCka,2B,oCAAoCla,E,aAE1C;;;AACiB,2BAAM,wDAAWma,WAAX,CAAuBF,OAAvB,CAAN;;;AAAXG,4B;;AAEW,2BAAM,wDAAWD,WAAX,CAAuBD,OAAvB,CAAN;;;AAAXG,4B;AAEN;AACA,yBAAKC,iBAAL,CAAuBF,QAAvB,EAAiCC,QAAjC,EAA2CN,SAA3C;;;AAXyC/Z,sBAAE,E;;;;;AAa/C;AACA0a,2BAAO,CAACC,GAAR,YAAgBiX,YAAY,CAAC5X,QAA7B,oDAA+E,KAAKY,QAApF;;;;;;;;;AACH;AAED;;;;;;;uCAIqBb,S,EAAqD;AAAA,cAAlBhX,IAAkB,uEAAN,IAAM;;;;;;;;;;0BAElEA,IAAI,KAAK,I;;;;;;AACF,2BAAM,kDAAQ8X,eAAR,CAAwB,KAAKD,QAA7B,CAAN;;;AAAP7X,wB;;;AAGJ;AACA,yBAAK4V,SAAL,GAAiB;AAAE,kCAAY,EAAd;AAAkB,gCAAU,EAA5B;AAAgC,mCAAa,EAA7C;AAAiD,+BAAS,EAA1D;AAA8D,gCAAU;AAAxE,qBAAjB,C,CAEA;;AACIqY,0B,GAAS,C,EACb;;AACIqB,6B,GAAY,C,EAEhB;;;;;;kCACsBtvB,IAAI,CAACiQ,Q;;;;;;;;AAAhB8H,2B;AACP;;;;;;AACA,uCAAmBA,OAAO,CAAChI,QAA3B,+HAAqC;AAA1Bwf,0BAA0B;AACjC;AACMvI,8BAF2B,GAEhBuI,IAAI,CAACvX,WAFW,EAIjC;;AACMC,yBAL2B,GAKrB,EALqB;AAM3BmP,4BAN2B,GAMlB,EANkB;;AAOjC,2BAASnqB,EAAT,GAAc,CAAd,EAAiBA,EAAE,GAAG+pB,QAAQ,CAAC/kB,MAAT,GAAkB4sB,YAAY,CAACxU,MAArD,EAA6Dpd,EAAE,EAA/D,EAAmE;AACzD2G,2BADyD,GACnDmU,OAAO,CAACzH,UAAR,IAAsByH,OAAO,CAACzH,UAAR,CAAmB8W,MAAzC,GAAkDrP,OAAO,CAACzH,UAAR,CAAmB8W,MAArE,GAA8E,CAAC,CAD5B;AAE/DA,8BAAM,CAACjjB,IAAP,CAAYP,GAAZ;AACAqU,2BAAG,CAAC9T,IAAJ,CAASmrB,SAAS,GAAGtvB,IAAI,CAACiQ,QAAL,CAAchO,MAAnC;AACH,uBAXgC,CAajC;;;AACMwiB,2BAd2B,GAcnB8K,IAAI,CAACrX,OAdc;;AAejC,2BAASjb,IAAT,GAAc,CAAd,EAAiBA,IAAE,GAAGwnB,KAAK,CAACxiB,MAA5B,EAAoChF,IAAE,EAAtC,EAA0C;AACtCwnB,6BAAK,CAACxnB,IAAD,CAAL,IAAagxB,MAAb;AACH,uBAjBgC,CAmBjC;;;AACAA,4BAAM,IAAIjH,QAAQ,CAAC/kB,MAAT,GAAkB4sB,YAAY,CAACxU,MAAzC,CApBiC,CAsBjC;;AACA,2BAAKzE,SAAL,CAAe,UAAf,EAA2BzR,IAA3B,CAAgCmqB,KAAhC,CAAsC,KAAK1Y,SAAL,CAAe,UAAf,CAAtC,EAAkEoR,QAAlE;;AACA,2BAAKpR,SAAL,CAAe,QAAf,EAAyBzR,IAAzB,CAA8BmqB,KAA9B,CAAoC,KAAK1Y,SAAL,CAAe,QAAf,CAApC,EAA8DwR,MAA9D;;AACA,2BAAKxR,SAAL,CAAe,WAAf,EAA4BzR,IAA5B,CAAiCmqB,KAAjC,CAAuC,KAAK1Y,SAAL,CAAe,WAAf,CAAvC,EAAoEqC,GAApE;;AACA,2BAAKrC,SAAL,CAAe,OAAf,EAAwBzR,IAAxB,CAA6BmqB,KAA7B,CAAmC,KAAK1Y,SAAL,CAAe,OAAf,CAAnC,EAA4D6O,KAA5D;;AACA,2BAAK7O,SAAL,CAAe,QAAf,EAAyBzR,IAAzB,CAA8B6iB,QAAQ,CAAC/kB,MAAT,GAAkB4sB,YAAY,CAACxU,MAA7D;AACH;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAEDiV,6BAAS,IAAI,CAAb;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAGJ;AACA,yBAAKnX,aAAL,CAAmBnB,SAAnB,E,CACA;;AACA,yBAAK0X,kBAAL,CAAwB1X,SAAxB,E,CACA;;AACA,yBAAKwQ,qBAAL,CAA2BxQ,SAA3B,EAAsC,wDAAakM,sBAAnD,EAA2E,KAA3E;;;;;;;;;AACH;AAED;;;;;;;uCAIqBlM,S,EAAmChX,I,EAAW;;;;;;;;;AAC/D;AACMonB,0B,GAASpnB,IAAI,CAACoQ,I,EAEpB;;0BACIgX,MAAM,CAACnlB,MAAP,KAAkB,KAAK2T,SAAL,CAAe,QAAf,EAAyB3T,M;;;;;;;;AAI/C;AACA,yBAAK2T,SAAL,CAAe,QAAf,IAA2B,EAA3B;AAEI9R,wB,GAAO,C;;AACX,wBAAI9D,IAAI,CAAC0Q,IAAL,GAAY,CAAZ,IAAiB1Q,IAAI,CAAC2Q,IAAL,GAAY,CAAjC,EAAoC;AAChC7M,0BAAI,GAAG,CAAP;AACH,qBAFD,MAEO,IAAI9D,IAAI,CAAC0Q,IAAL,IAAa,CAAb,IAAkB1Q,IAAI,CAAC2Q,IAAL,GAAY,CAAlC,EAAqC;AACxC7M,0BAAI,GAAG9D,IAAI,CAAC0Q,IAAZ;AACH,qBAFM,MAEA,IAAI1Q,IAAI,CAAC0Q,IAAL,GAAY,CAAZ,IAAiB1Q,IAAI,CAAC2Q,IAAL,IAAa,CAAlC,EAAqC;AACxC7M,0BAAI,GAAG9D,IAAI,CAAC2Q,IAAZ;AACH,qB,CAED;;;AACA,yBAAS6e,GAAT,GAAe,CAAf,EAAkBA,GAAG,GAAGpI,MAAM,CAACnlB,MAA/B,EAAuCutB,GAAG,EAA1C,EAA8C;AAC1C;AACMC,4BAFoC,GAE3B,KAAK7Z,SAAL,CAAe,QAAf,EAAyB4Z,GAAzB,CAF2B;AAItC7L,4BAJsC,GAI7B,IAJ6B;;AAK1C,0BAAIyD,MAAM,CAACoI,GAAD,CAAN,KAAgB,UAApB,EAAgC;AAC5B7L,8BAAM,GAAG,CAAC,CAAV;AACH,uBAFD,MAGK,IAAIyD,MAAM,CAACoI,GAAD,CAAN,KAAgB,WAApB,EAAiC;AAClC7L,8BAAM,GAAG,CAAC,CAAV;AACH,uBAFI,MAGA,IAAIyD,MAAM,CAACoI,GAAD,CAAN,KAAgB,UAApB,EAAgC;AACjC7L,8BAAM,GAAG,CAAC,CAAV;AACH,uBAFI,MAGA,IAAIyD,MAAM,CAACoI,GAAD,CAAN,KAAgB,WAApB,EAAiC;AAClC7L,8BAAM,GAAG,CAAC,CAAV;AACH,uBAFI,MAGA;AACDA,8BAAM,GAAG,mDAAS+L,kBAAT,CAA4BtI,MAAM,CAACoI,GAAD,CAAlC,EAAyCxvB,IAAI,CAAC0Q,IAA9C,EAAoD1Q,IAAI,CAAC2Q,IAAzD,EAA+D7M,IAA/D,CAAT;AACH,uBAnByC,CAqB1C;;;AACM+B,0BAtBoC,GAsB7B,IAAI2K,KAAJ,CAAUif,MAAV,EAAkBhf,IAAlB,CAAuBkT,MAAvB,CAtB6B,EAuB1C;;AACA,2BAAK/N,SAAL,CAAe,QAAf,EAAyBzR,IAAzB,CAA8BmqB,KAA9B,CAAoC,KAAK1Y,SAAL,CAAe,QAAf,CAApC,EAA8D/P,IAA9D;AACH,qB,CAED;;;AACA,yBAAK6oB,kBAAL,CAAwB1X,SAAxB;;;;;;;;;AACH;AAED;;;;;;;;sCAKcA,S,EAAmC;AAC7C,eAAK,IAAI/Z,EAAE,GAAG,CAAd,EAAiBA,EAAE,GAAG,KAAK2Y,SAAL,CAAe,QAAf,EAAyB3T,MAA/C,EAAuDhF,EAAE,EAAzD,EAA6D;AACzD,iBAAK2Y,SAAL,CAAe,QAAf,EAAyB3Y,EAAzB,IAA+B,CAAC,CAAhC;AACH,WAH4C,CAK7C;;;AACA,eAAKyxB,kBAAL,CAAwB1X,SAAxB;AACH;AAED;;;;;;;;uCAKeA,S,EAAmCyQ,I,EAAoB;AAClE;AACA,eAAKD,qBAAL,CAA2BxQ,SAA3B,EAAsCyQ,IAAtC,EAA4C,KAA5C;AACH;AAED;;;;;;;;;6BAMKzQ,S,EAAmCnS,C,EAAWE,C,EAAW;AAC1DiS,mBAAS,CAACqB,eAAV,CAA0BrB,SAAS,CAACsB,WAApC,EAAiD,KAAK4W,QAAtD;AAEA,cAAM3W,MAAM,GAAG,IAAIC,YAAJ,CAAiB,CAAjB,CAAf;AACAxB,mBAAS,CAACyB,UAAV,CAAqB5T,CAArB,EAAwBE,CAAxB,EAA2B,CAA3B,EAA8B,CAA9B,EAAiCiS,SAAS,CAAC0B,IAA3C,EAAiD1B,SAAS,CAAC2B,KAA3D,EAAkEJ,MAAlE;;AAEA,cAAIA,MAAM,CAAC,CAAD,CAAN,IAAa,CAAjB,EAAoB;AAChB,iBAAKhC,UAAL,GAAkBgC,MAAM,CAAC,CAAD,CAAN,KAAc,KAAKhC,UAAnB,GAAgC,CAAC,CAAjC,GAAqCgC,MAAM,CAAC,CAAD,CAA7D;AACH;;AAEDvB,mBAAS,CAACqB,eAAV,CAA0BrB,SAAS,CAACsB,WAApC,EAAiD,IAAjD;AAEA,eAAKhY,MAAL,CAAY0W,SAAZ;AACH;AAED;;;;;;;iCAIS;AACL,cAAI,KAAKT,UAAL,KAAoB,CAAC,CAAzB,EAA4B;AACxB,mBAAO,KAAKA,UAAZ;AACH;;AAED,cAAI,CAAC,KAAKX,SAAL,CAAe,WAAf,CAAL,EAAkC;AAC9B,mBAAO,KAAKW,UAAZ;AACH;;AAED,cAAI/L,QAAQ,GAAG,CAAC,CAAhB;AACA,cAAImlB,MAAM,GAAG,CAAC,CAAd;;AAEA,eAAK,IAAIC,GAAG,GAAG,CAAf,EAAkBA,GAAG,GAAG,KAAKha,SAAL,CAAe,WAAf,EAA4B3T,MAApD,EAA4D2tB,GAAG,EAA/D,EAAmE;AAC/D,gBAAMlnB,OAAO,GAAG,KAAKkN,SAAL,CAAe,WAAf,EAA4Bga,GAA5B,CAAhB;;AAEA,gBAAIplB,QAAQ,KAAK9B,OAAjB,EAA0B;AACtB;AACH,aAFD,MAGK;AACDinB,oBAAM,IAAI,CAAV;AACAnlB,sBAAQ,GAAG9B,OAAX;;AACA,kBAAI1E,IAAI,CAAC6rB,GAAL,CAASnnB,OAAO,GAAG,KAAK6N,UAAxB,IAAsC,IAA1C,EAAgD;AAC5C,uBAAOoZ,MAAP;AACH;AACJ;AACJ;;AAED,iBAAOA,MAAP;AACH;;;kCAES1yB,E,EAAY;AAClB,cAAIuN,QAAQ,GAAG,CAAC,CAAhB;AACA,cAAImlB,MAAM,GAAG,CAAC,CAAd;;AAEA,cAAI,CAAC,KAAK/Z,SAAL,CAAe,WAAf,CAAL,EAAkC;AAC9B,iBAAKW,UAAL,GAAkB,CAAC,CAAnB;AACA;AACH;;AAED,eAAK,IAAIqZ,GAAG,GAAG,CAAf,EAAkBA,GAAG,GAAG,KAAKha,SAAL,CAAe,WAAf,EAA4B3T,MAApD,EAA4D2tB,GAAG,EAA/D,EAAmE;AAC/D,gBAAMlnB,OAAO,GAAG,KAAKkN,SAAL,CAAe,WAAf,EAA4Bga,GAA5B,CAAhB;;AAEA,gBAAIplB,QAAQ,KAAK9B,OAAjB,EAA0B;AACtB;AACH,aAFD,MAGK;AACDinB,oBAAM,IAAI,CAAV;AACAnlB,sBAAQ,GAAG9B,OAAX;;AACA,kBAAIinB,MAAM,KAAK1yB,EAAf,EAAmB;AACf,qBAAKsZ,UAAL,GAAkB7N,OAAlB;AACA;AACH;AACJ;AACJ;AACJ;AAED;;;;;;;+BAIOsO,S,EAAmC;AACtC;AACA,cACI,KAAKS,cAAL,CAAoBxV,MAApB,KAA+B4sB,YAAY,CAAC5X,QAA5C,IACA,KAAKpB,iBAAL,KAA2B,IAD3B,IAEA,KAAKiZ,kBAAL,KAA4B,IAF5B,IAGA,KAAKN,eAAL,KAAyB,IAHzB,IAIA,KAAK1Y,cAAL,KAAwB,IAL5B,EAME;AACE;AACH,WAVqC,CAWtC;;;AACA,eAAK8C,QAAL,CAAc5B,SAAd,EAZsC,CActC;;AACAA,mBAAS,CAACqB,eAAV,CAA0BrB,SAAS,CAACsB,WAApC,EAAiD,KAAK5B,IAAtD;AACA,eAAKoZ,eAAL,CAAqB9Y,SAArB;AACAA,mBAAS,CAACqB,eAAV,CAA0BrB,SAAS,CAACsB,WAApC,EAAiD,IAAjD,EAjBsC,CAmBtC;;AACA,eAAKyX,aAAL,CAAmB/Y,SAAnB,EApBsC,CAsBtC;;AACA,eAAKgZ,eAAL,CAAqBhZ,SAArB;AACH;;;wCAEyBA,S,EAAmC;AAAA;;AACzD;AACA,eAAKd,mBAAL,GAA2Bc,SAAS,CAACQ,kBAAV,CAA6B,KAAKC,cAAL,CAAoB,CAApB,CAA7B,EAAqD,kBAArD,CAA3B;AACA,eAAKtB,oBAAL,GAA4Ba,SAAS,CAACQ,kBAAV,CAA6B,KAAKC,cAAL,CAAoB,CAApB,CAA7B,EAAqD,mBAArD,CAA5B;AACA,eAAKkP,eAAL,GAAuB3P,SAAS,CAACQ,kBAAV,CAA6B,KAAKC,cAAL,CAAoB,CAApB,CAA7B,EAAqD,cAArD,CAAvB;AACA,eAAKzB,WAAL,GAAmBgB,SAAS,CAACU,iBAAV,CAA4B,KAAKD,cAAL,CAAoB,CAApB,CAA5B,EAAoD,SAApD,CAAnB;AACA,eAAKsX,UAAL,GAAkB/X,SAAS,CAACU,iBAAV,CAA4B,KAAKD,cAAL,CAAoB,CAApB,CAA5B,EAAoD,YAApD,CAAlB;AACA,eAAKwX,aAAL,GAAqBjY,SAAS,CAACQ,kBAAV,CAA6B,KAAKC,cAAL,CAAoB,CAApB,CAA7B,EAAqD,cAArD,CAArB,CAPyD,CASzD;;AACAT,mBAAS,CAACoC,UAAV,CAAqB,KAAK3B,cAAL,CAAoB,CAApB,CAArB,EAVyD,CAYzD;;AACAT,mBAAS,CAACqC,gBAAV,CAA2B,KAAKnD,mBAAhC,EAAqD,KAArD,EAA4D,KAAKoD,OAAL,CAAaC,kBAAb,EAA5D;AACAvC,mBAAS,CAACqC,gBAAV,CAA2B,KAAKlD,oBAAhC,EAAsD,KAAtD,EAA6D,KAAKmD,OAAL,CAAaE,mBAAb,EAA7D,EAdyD,CAgBzD;;AACA,cAAMC,WAAW,GAAG,KAAKH,OAAL,CAAaI,cAAb,EAApB;;AACA1C,mBAAS,CAAC2C,SAAV,CAAoB,KAAKgN,eAAzB,EAA0ClN,WAAW,CAAC,CAAD,CAArD,EAA0DA,WAAW,CAAC,CAAD,CAArE,EAlByD,CAoBzD;;AACAzC,mBAAS,CAACgD,SAAV,CAAoB,KAAKiV,aAAzB,EAAwC,KAAK1Y,UAA7C,EArByD,CAuBzD;;AACAS,mBAAS,CAACkD,UAAV,CAAqBlD,SAAS,CAACmD,YAA/B,EAA6C,KAAKtE,iBAAlD;AACAmB,mBAAS,CAACoD,mBAAV,CAA8B,KAAKpE,WAAnC,EAAgD6Y,YAAY,CAACxU,MAA7D,EAAqErD,SAAS,CAAC2B,KAA/E,EAAsF,KAAtF,EAA6F,CAA7F,EAAgG,CAAhG;AACA3B,mBAAS,CAACsD,uBAAV,CAAkC,KAAKtE,WAAvC,EA1ByD,CA4BzD;;AACAgB,mBAAS,CAACkD,UAAV,CAAqBlD,SAAS,CAACmD,YAA/B,EAA6C,KAAK2U,kBAAlD;AACA9X,mBAAS,CAACoD,mBAAV,CAA8B,KAAK2U,UAAnC,EAA+C,CAA/C,EAAkD/X,SAAS,CAAC2B,KAA5D,EAAmE,KAAnE,EAA0E,CAA1E,EAA6E,CAA7E;AACA3B,mBAAS,CAACsD,uBAAV,CAAkC,KAAKyU,UAAvC;AAEA,cAAIvsB,KAAK,GAAG,CAAZ;AAEA,cAAMytB,IAAI,GAAG,EAAb;;AACA,eAAKra,SAAL,CAAe,QAAf,EAAyBjQ,OAAzB,CAAiC,UAAAuqB,UAAU,EAAI;AAC3C;AACA,gBAAIlsB,IAAI,CAAC6rB,GAAL,CAAS,OAAI,CAACja,SAAL,CAAe,WAAf,EAA4BpT,KAA5B,IAAqC,OAAI,CAAC+T,UAAnD,IAAiE,IAArE,EAA2E;AACvE,kBAAM4Z,IAAI,GAAG;AAAE3tB,qBAAK,EAALA,KAAF;AAAS0tB,0BAAU,EAAVA;AAAT,eAAb;AACAD,kBAAI,CAAC9rB,IAAL,CAAUgsB,IAAV;AACH,aAHD,MAGO;AACHnZ,uBAAS,CAACmF,UAAV,CAAqBnF,SAAS,CAACoZ,UAA/B,EAA2C5tB,KAA3C,EAAkD0tB,UAAlD;AACH;;AACD1tB,iBAAK,IAAI0tB,UAAT;AACH,WATD;;AAWAD,cAAI,CAACtqB,OAAL,CAAa,UAAA0qB,KAAK,EAAI;AAClBrZ,qBAAS,CAACmF,UAAV,CAAqBnF,SAAS,CAACoZ,UAA/B,EAA2CC,KAAK,CAAC7tB,KAAjD,EAAwD6tB,KAAK,CAACH,UAA9D;AACH,WAFD;AAGH;AAED;;;;;;;sCAIwBlZ,S,EAAmC;AACvD;AACA,eAAKgY,iBAAL,GAAyBhY,SAAS,CAACQ,kBAAV,CAA6B,KAAKC,cAAL,CAAoB,CAApB,CAA7B,EAAqD,YAArD,CAAzB;AAEAT,mBAAS,CAAC6B,MAAV,CAAiB7B,SAAS,CAAC+D,KAA3B;AACA/D,mBAAS,CAACgE,SAAV,CAAoBhE,SAAS,CAACiE,SAA9B,EAAyCjE,SAAS,CAACkE,mBAAnD;AAEAlE,mBAAS,CAACoC,UAAV,CAAqB,KAAK3B,cAAL,CAAoB,CAApB,CAArB;AAEAT,mBAAS,CAAC2E,aAAV,CAAwB3E,SAAS,CAAC4E,QAAlC;AACA5E,mBAAS,CAAC6E,WAAV,CAAsB7E,SAAS,CAAC8E,UAAhC,EAA4C,KAAKqT,cAAjD;AACAnY,mBAAS,CAAC+E,SAAV,CAAoB,KAAKiT,iBAAzB,EAA4C,CAA5C;AAEAhY,mBAAS,CAACmF,UAAV,CAAqBnF,SAAS,CAACoF,cAA/B,EAA+C,CAA/C,EAAkD,CAAlD;AACApF,mBAAS,CAACmC,OAAV,CAAkBnC,SAAS,CAAC+D,KAA5B;AACH;AAED;;;;;;;wCAI0B/D,S,EAAmC;AACzD;AACA,eAAKd,mBAAL,GAA2Bc,SAAS,CAACQ,kBAAV,CAA6B,KAAKC,cAAL,CAAoB,CAApB,CAA7B,EAAqD,kBAArD,CAA3B;AACA,eAAKtB,oBAAL,GAA4Ba,SAAS,CAACQ,kBAAV,CAA6B,KAAKC,cAAL,CAAoB,CAApB,CAA7B,EAAqD,mBAArD,CAA5B;AACA,eAAKkP,eAAL,GAAuB3P,SAAS,CAACQ,kBAAV,CAA6B,KAAKC,cAAL,CAAoB,CAApB,CAA7B,EAAqD,cAArD,CAAvB;AACA,eAAKzB,WAAL,GAAmBgB,SAAS,CAACU,iBAAV,CAA4B,KAAKD,cAAL,CAAoB,CAApB,CAA5B,EAAoD,SAApD,CAAnB;AACA,eAAKsX,UAAL,GAAkB/X,SAAS,CAACU,iBAAV,CAA4B,KAAKD,cAAL,CAAoB,CAApB,CAA5B,EAAoD,YAApD,CAAlB;AACA,eAAKgX,SAAL,GAAiBzX,SAAS,CAACU,iBAAV,CAA4B,KAAKD,cAAL,CAAoB,CAApB,CAA5B,EAAoD,YAApD,CAAjB;AACA,eAAKmP,YAAL,GAAoB5P,SAAS,CAACQ,kBAAV,CAA6B,KAAKC,cAAL,CAAoB,CAApB,CAA7B,EAAqD,WAArD,CAApB,CARyD,CAUzD;;AACAT,mBAAS,CAACoC,UAAV,CAAqB,KAAK3B,cAAL,CAAoB,CAApB,CAArB,EAXyD,CAazD;;AACAT,mBAAS,CAACqC,gBAAV,CAA2B,KAAKnD,mBAAhC,EAAqD,KAArD,EAA4D,KAAKoD,OAAL,CAAaC,kBAAb,EAA5D;AACAvC,mBAAS,CAACqC,gBAAV,CAA2B,KAAKlD,oBAAhC,EAAsD,KAAtD,EAA6D,KAAKmD,OAAL,CAAaE,mBAAb,EAA7D,EAfyD,CAiBzD;;AACA,cAAMC,WAAW,GAAG,KAAKH,OAAL,CAAaI,cAAb,EAApB;;AACA1C,mBAAS,CAAC2C,SAAV,CAAoB,KAAKgN,eAAzB,EAA0ClN,WAAW,CAAC,CAAD,CAArD,EAA0DA,WAAW,CAAC,CAAD,CAArE,EAnByD,CAqBzD;;AACAzC,mBAAS,CAAC+E,SAAV,CAAoB,KAAK6K,YAAzB,EAAuC,CAAvC,EAtByD,CAwBzD;;AACA5P,mBAAS,CAACkD,UAAV,CAAqBlD,SAAS,CAACmD,YAA/B,EAA6C,KAAKtE,iBAAlD;AACAmB,mBAAS,CAACoD,mBAAV,CAA8B,KAAKpE,WAAnC,EAAgD6Y,YAAY,CAACxU,MAA7D,EAAqErD,SAAS,CAAC2B,KAA/E,EAAsF,KAAtF,EAA6F,CAA7F,EAAgG,CAAhG;AACA3B,mBAAS,CAACsD,uBAAV,CAAkC,KAAKtE,WAAvC,EA3ByD,CA6BzD;;AACAgB,mBAAS,CAACkD,UAAV,CAAqBlD,SAAS,CAACmD,YAA/B,EAA6C,KAAK2U,kBAAlD;AACA9X,mBAAS,CAACoD,mBAAV,CAA8B,KAAK2U,UAAnC,EAA+C,CAA/C,EAAkD/X,SAAS,CAAC2B,KAA5D,EAAmE,KAAnE,EAA0E,CAA1E,EAA6E,CAA7E;AACA3B,mBAAS,CAACsD,uBAAV,CAAkC,KAAKyU,UAAvC,EAhCyD,CAkCzD;;AACA/X,mBAAS,CAACkD,UAAV,CAAqBlD,SAAS,CAACmD,YAA/B,EAA6C,KAAKqU,eAAlD;AACAxX,mBAAS,CAACoD,mBAAV,CAA8B,KAAKqU,SAAnC,EAA8C,CAA9C,EAAiDzX,SAAS,CAAC2B,KAA3D,EAAkE,KAAlE,EAAyE,CAAzE,EAA4E,CAA5E;AACA3B,mBAAS,CAACsD,uBAAV,CAAkC,KAAKmU,SAAvC,EArCyD,CAuCzD;;AACAzX,mBAAS,CAAC2E,aAAV,CAAwB3E,SAAS,CAAC4E,QAAlC;AACA5E,mBAAS,CAAC6E,WAAV,CAAsB7E,SAAS,CAAC8E,UAAhC,EAA4C,KAAKuT,gBAAjD;AAEArY,mBAAS,CAACuD,UAAV,CAAqB,GAArB,EAA0B,GAA1B,EAA+B,GAA/B,EAAoC,GAApC,EA3CyD,CA4CzD;;AACAvD,mBAAS,CAACwD,KAAV,CAAgBxD,SAAS,CAACyD,gBAAV,GAA6BzD,SAAS,CAAC0D,gBAAvD,EA7CyD,CA+CzD;;AACA1D,mBAAS,CAACkD,UAAV,CAAqBlD,SAAS,CAAC2D,oBAA/B,EAAqD,KAAK7E,cAA1D,EAhDyD,CAiDzD;;AACAkB,mBAAS,CAAC4D,YAAV,CAAuB5D,SAAS,CAAC6D,SAAjC,EAA4C,KAAKjF,SAAL,CAAe,OAAf,EAAwB3T,MAApE,EAA4E+U,SAAS,CAAC8D,YAAtF,EAAoG,CAApG;AACH;AAED;;;;;;;iCAImB9D,S,EAAmC;AAClD,cAAI,KAAKN,IAAL,IAAa,IAAb,IAAqB,KAAKwY,QAAL,IAAiB,IAA1C,EAAgD;AAC5C;AACA,iBAAKxY,IAAL,GAAYM,SAAS,CAACqF,iBAAV,EAAZ;AACA,iBAAK6S,QAAL,GAAgBlY,SAAS,CAACqF,iBAAV,EAAhB;AACA,iBAAK+S,iBAAL,GAAyBpY,SAAS,CAACsF,aAAV,EAAzB;AACA,iBAAK6S,cAAL,GAAsBnY,SAAS,CAACsF,aAAV,EAAtB,CAL4C,CAO5C;;AACA,gBAAMC,GAAG,GAAGvF,SAAS,CAACwF,YAAV,CAAuB,wBAAvB,CAAZ;;AACA,gBAAI,CAACD,GAAL,EAAU;AACN5E,qBAAO,CAAC8E,KAAR,CAAc,yCAAd;AACH;AACJ,WAbiD,CAelD;;;AACA,cAAMC,QAAQ,GAAG,KAAKpD,OAAL,CAAaqD,qBAAb,EAAjB;;AACA,cAAI,KAAKnG,SAAL,KAAmBkG,QAAQ,CAAC,CAAD,CAA3B,IAAkC,KAAKjG,UAAL,KAAoBiG,QAAQ,CAAC,CAAD,CAAlE,EAAuE;AACnE;AACA,iBAAKlG,SAAL,GAAiBkG,QAAQ,CAAC,CAAD,CAAzB;AACA,iBAAKjG,UAAL,GAAkBiG,QAAQ,CAAC,CAAD,CAA1B,CAHmE,CAKnE;;AACA1F,qBAAS,CAAC6E,WAAV,CAAsB7E,SAAS,CAAC8E,UAAhC,EAA4C,KAAKsT,iBAAjD;AACApY,qBAAS,CAAC4F,UAAV,CACI5F,SAAS,CAAC8E,UADd,EAC0B,CAD1B,EAC6B9E,SAAS,CAAC6F,OADvC,EAEI,KAAKrG,SAFT,EAEoB,KAAKC,UAFzB,EAEqC,CAFrC,EAEwCO,SAAS,CAAC0B,IAFlD,EAEwD1B,SAAS,CAAC2B,KAFlE,EAEyE,IAFzE;AAIA3B,qBAAS,CAAC8F,aAAV,CAAwB9F,SAAS,CAAC8E,UAAlC,EAA8C9E,SAAS,CAAC+F,kBAAxD,EAA4E/F,SAAS,CAACgG,OAAtF;AACAhG,qBAAS,CAAC8F,aAAV,CAAwB9F,SAAS,CAAC8E,UAAlC,EAA8C9E,SAAS,CAACiG,kBAAxD,EAA4EjG,SAAS,CAACgG,OAAtF;AACAhG,qBAAS,CAAC8F,aAAV,CAAwB9F,SAAS,CAAC8E,UAAlC,EAA8C9E,SAAS,CAACkG,cAAxD,EAAwElG,SAAS,CAACmG,aAAlF;AACAnG,qBAAS,CAAC8F,aAAV,CAAwB9F,SAAS,CAAC8E,UAAlC,EAA8C9E,SAAS,CAACoG,cAAxD,EAAwEpG,SAAS,CAACmG,aAAlF,EAdmE,CAgBnE;;AACAnG,qBAAS,CAAC6E,WAAV,CAAsB7E,SAAS,CAAC8E,UAAhC,EAA4C,KAAKqT,cAAjD;AACAnY,qBAAS,CAAC4F,UAAV,CACI5F,SAAS,CAAC8E,UADd,EAC0B,CAD1B,EAC6B9E,SAAS,CAAC6F,OADvC,EAEI,KAAKrG,SAFT,EAEoB,KAAKC,UAFzB,EAEqC,CAFrC,EAEwCO,SAAS,CAAC0B,IAFlD,EAEwD1B,SAAS,CAAC2B,KAFlE,EAEyE,IAFzE;AAIA3B,qBAAS,CAAC8F,aAAV,CAAwB9F,SAAS,CAAC8E,UAAlC,EAA8C9E,SAAS,CAAC+F,kBAAxD,EAA4E/F,SAAS,CAACgG,OAAtF;AACAhG,qBAAS,CAAC8F,aAAV,CAAwB9F,SAAS,CAAC8E,UAAlC,EAA8C9E,SAAS,CAACiG,kBAAxD,EAA4EjG,SAAS,CAACgG,OAAtF;AACAhG,qBAAS,CAAC8F,aAAV,CAAwB9F,SAAS,CAAC8E,UAAlC,EAA8C9E,SAAS,CAACkG,cAAxD,EAAwElG,SAAS,CAACmG,aAAlF;AACAnG,qBAAS,CAAC8F,aAAV,CAAwB9F,SAAS,CAAC8E,UAAlC,EAA8C9E,SAAS,CAACoG,cAAxD,EAAwEpG,SAAS,CAACmG,aAAlF,EAzBmE,CA2BnE;;AACAnG,qBAAS,CAACqB,eAAV,CAA0BrB,SAAS,CAACsB,WAApC,EAAiD,KAAK5B,IAAtD;AACAM,qBAAS,CAACuG,oBAAV,CAA+BvG,SAAS,CAACsB,WAAzC,EAAsDtB,SAAS,CAACyG,iBAAhE,EAAmFzG,SAAS,CAAC8E,UAA7F,EAAyG,KAAKqT,cAA9G,EAA8H,CAA9H;AACAnY,qBAAS,CAACuG,oBAAV,CAA+BvG,SAAS,CAACsB,WAAzC,EAAsDtB,SAAS,CAAC0G,iBAAhE,EAAmF1G,SAAS,CAAC8E,UAA7F,EAAyG,KAAKsT,iBAA9G,EAAiI,CAAjI;AACApY,qBAAS,CAAC4G,WAAV,CAAsB,CAAC5G,SAAS,CAACyG,iBAAX,EAA8BzG,SAAS,CAAC0G,iBAAxC,CAAtB,EA/BmE,CAiCnE;;AACA1G,qBAAS,CAACqB,eAAV,CAA0BrB,SAAS,CAACsB,WAApC,EAAiD,KAAK4W,QAAtD;AACAlY,qBAAS,CAACuG,oBAAV,CAA+BvG,SAAS,CAACsB,WAAzC,EAAsDtB,SAAS,CAACyG,iBAAhE,EAAmFzG,SAAS,CAAC8E,UAA7F,EAAyG,KAAKsT,iBAA9G,EAAiI,CAAjI,EAnCmE,CAqCnE;;AACApY,qBAAS,CAACqB,eAAV,CAA0BrB,SAAS,CAACsB,WAApC,EAAiD,IAAjD;AACH;AACJ;AAED;;;;;;;sCAIwBtB,S,EAAmC;AACvD;AACA,eAAKnB,iBAAL,GAAyBmB,SAAS,CAAC6G,YAAV,EAAzB,CAFuD,CAGvD;;AACA7G,mBAAS,CAACkD,UAAV,CAAqBlD,SAAS,CAACmD,YAA/B,EAA6C,KAAKtE,iBAAlD,EAJuD,CAKvD;;AACAmB,mBAAS,CAAC8G,UAAV,CACI9G,SAAS,CAACmD,YADd,EAC4B,IAAI3B,YAAJ,CAAiB,KAAK5C,SAAL,CAAe,UAAf,CAAjB,CAD5B,EAC0EoB,SAAS,CAAC+G,WADpF,EANuD,CAUvD;;AACA,eAAK+Q,kBAAL,GAA0B9X,SAAS,CAAC6G,YAAV,EAA1B,CAXuD,CAYvD;;AACA7G,mBAAS,CAACkD,UAAV,CAAqBlD,SAAS,CAACmD,YAA/B,EAA6C,KAAK2U,kBAAlD,EAbuD,CAcvD;;AACA9X,mBAAS,CAAC8G,UAAV,CACI9G,SAAS,CAACmD,YADd,EAC4B,IAAI3B,YAAJ,CAAiB,KAAK5C,SAAL,CAAe,WAAf,CAAjB,CAD5B,EAC2EoB,SAAS,CAAC+G,WADrF,EAfuD,CAmBvD;;AACA,eAAKjI,cAAL,GAAsBkB,SAAS,CAAC6G,YAAV,EAAtB,CApBuD,CAqBvD;;AACA7G,mBAAS,CAACkD,UAAV,CAAqBlD,SAAS,CAAC2D,oBAA/B,EAAqD,KAAK7E,cAA1D,EAtBuD,CAuBvD;;AACAkB,mBAAS,CAAC8G,UAAV,CACI9G,SAAS,CAAC2D,oBADd,EACoC,IAAIqD,WAAJ,CAAgB,KAAKpI,SAAL,CAAe,OAAf,CAAhB,CADpC,EAC8EoB,SAAS,CAAC+G,WADxF;AAEH;AAED;;;;;;;2CAI6B/G,S,EAAmC;AAC5D;AACA,cAAI,KAAKwX,eAAL,KAAyB,IAA7B,EAAmC;AAC/B,iBAAKA,eAAL,GAAuBxX,SAAS,CAAC6G,YAAV,EAAvB;AACH,WAJ2D,CAK5D;;;AACA7G,mBAAS,CAACkD,UAAV,CAAqBlD,SAAS,CAACmD,YAA/B,EAA6C,KAAKqU,eAAlD,EAN4D,CAO5D;;AACAxX,mBAAS,CAAC8G,UAAV,CACI9G,SAAS,CAACmD,YADd,EAC4B,IAAI3B,YAAJ,CAAiB,KAAK5C,SAAL,CAAe,QAAf,CAAjB,CAD5B,EACwEoB,SAAS,CAAC+G,WADlF;AAGH;AAED;;;;;;;;;8CAMgC/G,S,EAAmC4L,K,EAA+C;AAAA,cAA1BH,OAA0B,uEAAP,KAAO;;AAC9G;AACA,cAAME,MAAM,GAAG,mDAASmF,WAAT,CAAqBlF,KAArB,EAA4BH,OAA5B,CAAf,CAF8G,CAG9G;;;AACA,cAAI,KAAK4M,gBAAL,KAA0B,IAA9B,EAAoC;AAChC,iBAAKA,gBAAL,GAAwBrY,SAAS,CAACsF,aAAV,EAAxB;AACH,WAN6G,CAQ9G;;;AACAtF,mBAAS,CAAC6E,WAAV,CAAsB7E,SAAS,CAAC8E,UAAhC,EAA4C,KAAKuT,gBAAjD;AACArY,mBAAS,CAAC4F,UAAV,CACI5F,SAAS,CAAC8E,UADd,EAC0B,CAD1B,EAC6B9E,SAAS,CAAC0B,IADvC,EAC6CiK,MAAM,CAAC1gB,MAAP,GAAgB,CAD7D,EACgE,CADhE,EACmE,CADnE,EAEI+U,SAAS,CAAC0B,IAFd,EAEoB1B,SAAS,CAAC+Q,aAF9B,EAE6C,IAAIC,UAAJ,CAAerF,MAAf,CAF7C;AAIA3L,mBAAS,CAAC8F,aAAV,CAAwB9F,SAAS,CAAC8E,UAAlC,EAA8C9E,SAAS,CAAC+F,kBAAxD,EAA4E/F,SAAS,CAACgG,OAAtF;AACAhG,mBAAS,CAAC8F,aAAV,CAAwB9F,SAAS,CAAC8E,UAAlC,EAA8C9E,SAAS,CAACiG,kBAAxD,EAA4EjG,SAAS,CAACgG,OAAtF;AACAhG,mBAAS,CAAC8F,aAAV,CAAwB9F,SAAS,CAAC8E,UAAlC,EAA8C9E,SAAS,CAACkG,cAAxD,EAAwElG,SAAS,CAACmG,aAAlF;AACAnG,mBAAS,CAAC8F,aAAV,CAAwB9F,SAAS,CAAC8E,UAAlC,EAA8C9E,SAAS,CAACoG,cAAxD,EAAwEpG,SAAS,CAACmG,aAAlF;AACH;;;;MAnlB6B,4C,GAC9B;;;AACiB,iBAAA9C,MAAA,GAAS,CAAT,C,CACjB;;AACiB,iBAAApD,QAAA,GAAW,CAAX;;;;;;;;;;;;;;;;ACZrB;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA,oE,CAAA;;;AA+BA,QAAMqZ,eAAe,GAAG,CACpB,4EADoB,EAEpB,sEAFoB,EAGpB,wEAHoB,EAIpB,sEAJoB,EAKpB,oEALoB,EAMpB,0EANoB,EAOpB,oEAPoB,EAQpB,6EARoB,EASpB,oEAToB,EAUpB,qEAVoB,EAWpB,yEAXoB,EAYpB,uEAZoB,EAapB,qEAboB,EAcpB,4FAdoB,EAepB,oFAfoB,EAgBpB,yEAhBoB,EAiBpB,2EAjBoB,EAkBpB,8EAlBoB,EAmBpB,oFAnBoB,EAoBpB,uEApBoB,EAqBpB,+EArBoB,EAsBpB,qEAtBoB,EAuBpB,qFAvBoB,EAwBpB,+EAxBoB,EAyBpB,2DAzBoB,EA0BpB,mEA1BoB,CAAxB;;QAmCaC,c;;;;;YAAAA;;;;yBAAAA,c;AAAc,O;AAAA,gBAHdD,eAGc,EAlCvB,4EAkCuB,EAjCvB,sEAiCuB,EAhCvB,wEAgCuB,EA/BvB,sEA+BuB,EA9BvB,oEA8BuB,EA7BvB,0EA6BuB,EA5BvB,oEA4BuB,EA3BvB,6EA2BuB,EA1BvB,oEA0BuB,EAzBvB,qEAyBuB,EAxBvB,yEAwBuB,EAvBvB,uEAuBuB,EAtBvB,qEAsBuB,EArBvB,4FAqBuB,EApBvB,oFAoBuB,EAnBvB,yEAmBuB,EAlBvB,2EAkBuB,EAjBvB,8EAiBuB,EAhBvB,oFAgBuB,EAfvB,uEAeuB,EAdvB,+EAcuB,EAbvB,qEAauB,EAZvB,qFAYuB,EAXvB,+EAWuB,EAVvB,2DAUuB,EATvB,mEASuB;;;;0HAAdC,c,EAAc;AAAA,kBAlCvB,4EAkCuB,EAjCvB,sEAiCuB,EAhCvB,wEAgCuB,EA/BvB,sEA+BuB,EA9BvB,oEA8BuB,EA7BvB,0EA6BuB,EA5BvB,oEA4BuB,EA3BvB,6EA2BuB,EA1BvB,oEA0BuB,EAzBvB,qEAyBuB,EAxBvB,yEAwBuB,EAvBvB,uEAuBuB,EAtBvB,qEAsBuB,EArBvB,4FAqBuB,EApBvB,oFAoBuB,EAnBvB,yEAmBuB,EAlBvB,2EAkBuB,EAjBvB,8EAiBuB,EAhBvB,oFAgBuB,EAfvB,uEAeuB,EAdvB,+EAcuB,EAbvB,qEAauB,EAZvB,qFAYuB,EAXvB,+EAWuB,EAVvB,2DAUuB,EATvB,mEASuB;AATJ,kBAzBnB,4EAyBmB,EAxBnB,sEAwBmB,EAvBnB,wEAuBmB,EAtBnB,sEAsBmB,EArBnB,oEAqBmB,EApBnB,0EAoBmB,EAnBnB,oEAmBmB,EAlBnB,6EAkBmB,EAjBnB,oEAiBmB,EAhBnB,qEAgBmB,EAfnB,yEAemB,EAdnB,uEAcmB,EAbnB,qEAamB,EAZnB,4FAYmB,EAXnB,oFAWmB,EAVnB,yEAUmB,EATnB,2EASmB,EARnB,8EAQmB,EAPnB,oFAOmB,EANnB,uEAMmB,EALnB,+EAKmB,EAJnB,qEAImB,EAHnB,qFAGmB,EAFnB,+EAEmB,EADnB,2DACmB,EAAnB,mEAAmB;AASI,O;AATJ,K;;;;;sEASVA,c,EAAc;cAN1B,sDAM0B;eANjB;AACN5yB,sBAAY,EAAE,EADR;AAGNC,iBAAO,EAAE0yB,eAHH;AAINtzB,iBAAO,EAAEszB;AAJH,S;AAMiB,Q;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;QC5DdE,U;;;AAEX,4BAAc;AAAA;AAAG;;;;oCAGL;AACV,iBAAO,CAAC,OAAD,EAAU,QAAV,CAAP;AACD;;;qCAEY;AACX,iBAAO,CAAC,SAAD,EAAY,cAAZ,EAA4B,OAA5B,EAAqC,KAArC,CAAP;AACD;;;qCAEY;AACX,iBAAO,CAAC,MAAD,EAAS,MAAT,CAAP;AACD;;;uCAEc;AACb,iBAAO,CAAC,GAAD,EAAM,GAAN,EAAW,GAAX,EAAgB,GAAhB,EAAqB,GAArB,EAA0B,GAA1B,CAAP;AACD;;;uCAEc;AACb,iBAAO,CAAC,eAAD,EAAkB,oBAAlB,CAAP;AACD;;;yCAEgB;AACf,iBAAO,CAAC,UAAD,EAAa,aAAb,CAAP;AACD;;;uCAEoB;;;;;;;;;AACb9L,uB,aAAS,sEAAYC,O;AAC3BhN,2BAAO,CAACC,GAAR,CAAY8M,GAAZ,E,CAEA;;;AACiB,2BAAMQ,KAAK,CAACR,GAAD,CAAX;;;AAAXS,4B;;AACC,2BAAMA,QAAQ,CAACC,IAAT,EAAN;;;;;;;;;;;;AACR;;;oCAEiB;;;;;;;;;AACVV,uB,aAAS,sEAAYC,O;AAC3BhN,2BAAO,CAACC,GAAR,CAAY8M,GAAZ,E,CAEA;;;AACiB,2BAAMQ,KAAK,CAACR,GAAD,CAAX;;;AAAXS,4B;;AACE,2BAAMA,QAAQ,CAACC,IAAT,EAAN;;;;;;;;;;;;AACT;;;yCAEsB;;;;;;;;;AACfV,uB,aAAS,sEAAYC,O;AAC3BhN,2BAAO,CAACC,GAAR,CAAY8M,GAAZ,E,CAEA;;;AACiB,2BAAMQ,KAAK,CAACR,GAAD,CAAX;;;AAAXS,4B;AAEA3jB,uB,GAAM,E;;AACA,2BAAM2jB,QAAQ,CAACC,IAAT,EAAN;;;AAANqL,uB;AAENA,uBAAG,CAAC9qB,OAAJ,CAAY,UAAA+qB,GAAG,EAAI;AACjBlvB,yBAAG,CAACkvB,GAAG,CAAC9jB,SAAL,CAAH,GAAqB8jB,GAArB;;AACA,0BAAIA,GAAG,CAACvjB,UAAJ,CAAelL,MAAf,IAAyB,CAA7B,EAAgC;AAC9ByuB,2BAAG,CAACvjB,UAAJ,GAAiB,CAAC,MAAD,CAAjB;AACD;AACF,qBALD;uDAOO3L,G;;;;;;;;;AACR;;;sCAEmB;;;;;;;;;AACZkjB,uB,aAAS,sEAAYC,O;AAC3BhN,2BAAO,CAACC,GAAR,CAAY8M,GAAZ,E,CAEA;;;AACiB,2BAAMQ,KAAK,CAACR,GAAD,CAAX;;;AAAXS,4B;;AACC,2BAAMA,QAAQ,CAACC,IAAT,EAAN;;;;;;;;;;;;AACR;;;yCAEsBta,O,EAAiB;;;;;;;;;AAChC4Z,uB,aAAS,sEAAYC,O;AAC3BhN,2BAAO,CAACC,GAAR,CAAY8M,GAAZ,E,CAEA;;AACMhY,0B,GAAS;AAAE5B,6BAAO,EAAPA;AAAF,qB;AACf6M,2BAAO,CAACC,GAAR,sBAA0B+Y,IAAI,CAACC,SAAL,CAAelkB,MAAf,CAA1B,G,CAEA;;AACMmkB,2B,GAAU;AACd,sCAAgB;AADF,qB,EAIhB;;;AACiB,2BAAM3L,KAAK,CAACR,GAAD,EAAM;AAChCoM,4BAAM,EAAE,MADwB;AAEhCD,6BAAO,EAAPA,OAFgC;AAGhCE,0BAAI,EAAEJ,IAAI,CAACC,SAAL,CAAelkB,MAAf;AAH0B,qBAAN,CAAX;;;AAAXyY,4B;;AAMC,2BAAMA,QAAQ,CAACC,IAAT,EAAN;;;;;;;;;;;;AACR;;;qCAEkBhQ,K,EAAexL,K,EAAY;;;;;;;;0BACxCwL,KAAK,KAAK,S;;;;;;AACL,2BAAM,KAAK4b,yBAAL,CAA+BpnB,KAAK,CAACkB,OAArC,EAA8ClB,KAAK,CAACqB,OAApD,CAAN;;;;;;0BAGLmK,KAAK,KAAK,c;;;;;0BACRxL,KAAK,CAACuB,UAAN,KAAqB,U;;;;;;AAChB,2BAAM,KAAK8lB,kBAAL,CAAwBrnB,KAAK,CAACkB,OAA9B,EAAuClB,KAAK,CAACqB,OAA7C,EAAsDrB,KAAK,CAACmL,YAA5D,EAA0EnL,KAAK,CAAC9E,IAAhF,CAAN;;;;;;;AAEA,2BAAM,KAAKosB,gBAAL,CAAsBtnB,KAAK,CAACkB,OAA5B,EAAqClB,KAAK,CAACqB,OAA3C,EAAoDrB,KAAK,CAACmL,YAA1D,EAAwE,EAAxE,EAA4EnL,KAAK,CAAC9E,IAAlF,CAAN;;;;;;0BAIPsQ,KAAK,KAAK,O;;;;;;AACL,2BAAM,KAAK8b,gBAAL,CAAsBtnB,KAAK,CAACkB,OAA5B,EAAqClB,KAAK,CAACqB,OAA3C,EAAoDrB,KAAK,CAACmL,YAA1D,EAAwEnL,KAAK,CAACqL,KAA9E,EAAqFrL,KAAK,CAAC9E,IAA3F,CAAN;;;;;;;;;;;;AAEV;;;kDAEuCgG,O,EAAiBG,O,EAAiB;;;;;;;;;AAClEyZ,uB,aAAS,sEAAYC,O;AAC3BhN,2BAAO,CAACC,GAAR,CAAY8M,GAAZ,E,CAEA;;AACMhY,0B,GAAS;AAAE5B,6BAAO,EAAPA,OAAF;AAAWG,6BAAO,EAAPA;AAAX,qB;AACf0M,2BAAO,CAACC,GAAR,sBAA0B+Y,IAAI,CAACC,SAAL,CAAelkB,MAAf,CAA1B,G,CAEA;;AACMmkB,2B,GAAU;AACd,sCAAgB;AADF,qB,EAIhB;;;AACiB,2BAAM3L,KAAK,CAACR,GAAD,EAAM;AAChCoM,4BAAM,EAAE,MADwB;AAEhCD,6BAAO,EAAPA,OAFgC;AAGhCE,0BAAI,EAAEJ,IAAI,CAACC,SAAL,CAAelkB,MAAf;AAH0B,qBAAN,CAAX;;;AAAXyY,4B;;AAKC,2BAAMA,QAAQ,CAACC,IAAT,EAAN;;;;;;;;;;;;AACR;;;2CAEgCta,O,EAAiBG,O,EAAiB8J,Y,EAAsBjQ,I,EAAc;;;;;;;;;AAC/F4f,uB,aAAS,sEAAYC,O;AAC3BhN,2BAAO,CAACC,GAAR,CAAY8M,GAAZ,E,CAEA;;AACMhY,0B,GAAS;AAAE5B,6BAAO,EAAPA,OAAF;AAAWG,6BAAO,EAAPA,OAAX;AAAoB8J,kCAAY,EAAZA,YAApB;AAAkCjQ,0BAAI,EAAJA;AAAlC,qB;AACf6S,2BAAO,CAACC,GAAR,sBAA0B+Y,IAAI,CAACC,SAAL,CAAelkB,MAAf,CAA1B,G,CAEA;;AACMmkB,2B,GAAU;AACd,sCAAgB;AADF,qB,EAIhB;;;AACiB,2BAAM3L,KAAK,CAACR,GAAD,EAAM;AAChCoM,4BAAM,EAAE,MADwB;AAEhCD,6BAAO,EAAPA,OAFgC;AAGhCE,0BAAI,EAAEJ,IAAI,CAACC,SAAL,CAAelkB,MAAf;AAH0B,qBAAN,CAAX;;;AAAXyY,4B;;AAKC,2BAAMA,QAAQ,CAACC,IAAT,EAAN;;;;;;;;;;;;AACR;;;yCAE8Bta,O,EAAiBG,O,EAAiB8J,Y,EAAsBE,K,EAAenQ,I,EAAc;;;;;;;;;AAC5G4f,uB,aAAS,sEAAYC,O;AAC3BhN,2BAAO,CAACC,GAAR,CAAY8M,GAAZ,E,CAEA;;AACMhY,0B,GAAS;AAAE5B,6BAAO,EAAPA,OAAF;AAAWG,6BAAO,EAAPA,OAAX;AAAoB8J,kCAAY,EAAZA,YAApB;AAAkCE,2BAAK,EAALA,KAAlC;AAAyCnQ,0BAAI,EAAJA;AAAzC,qB;AACf6S,2BAAO,CAACC,GAAR,sBAA0B+Y,IAAI,CAACC,SAAL,CAAelkB,MAAf,CAA1B,G,CAEA;;AACMmkB,2B,GAAU;AACd,sCAAgB;AADF,qB,EAIhB;;;AACiB,2BAAM3L,KAAK,CAACR,GAAD,EAAM;AAChCoM,4BAAM,EAAE,MADwB;AAEhCD,6BAAO,EAAPA,OAFgC;AAGhCE,0BAAI,EAAEJ,IAAI,CAACC,SAAL,CAAelkB,MAAf;AAH0B,qBAAN,CAAX;;;AAAXyY,4B;;AAKC,2BAAMA,QAAQ,CAACC,IAAT,EAAN;;;;;;;;;;;;AACR;;;oCAGiBhQ,K,EAAexL,K,EAAY;;;;;;;;0BACvCwL,KAAK,KAAK,S;;;;;;AACL,2BAAM,KAAK+b,wBAAL,CAA8BvnB,KAAK,CAACkB,OAApC,EAA6ClB,KAAK,CAACqB,OAAnD,EAA4DrB,KAAK,CAACgD,SAAlE,EAA6EhD,KAAK,CAACiD,QAAnF,EAA6FjD,KAAK,CAAC2K,MAAnG,CAAN;;;;;;0BAGLa,KAAK,KAAK,c;;;;;0BACRxL,KAAK,CAACuB,UAAN,KAAqB,U;;;;;;AAChB,2BAAM,KAAKimB,iBAAL,CAAuBxnB,KAAK,CAACkB,OAA7B,EAAsClB,KAAK,CAACqB,OAA5C,EAAqDrB,KAAK,CAACmL,YAA3D,EAAyEnL,KAAK,CAACgD,SAA/E,EAA0FhD,KAAK,CAACiD,QAAhG,EAA0GjD,KAAK,CAAC2K,MAAhH,CAAN;;;;;;;AAEA,2BAAM,KAAK8c,eAAL,CAAqBznB,KAAK,CAACkB,OAA3B,EAAoClB,KAAK,CAACqB,OAA1C,EAAmDrB,KAAK,CAACmL,YAAzD,EAAuE,EAAvE,EAA2EnL,KAAK,CAACgD,SAAjF,EAA4FhD,KAAK,CAACiD,QAAlG,EAA4GjD,KAAK,CAAC2K,MAAlH,CAAN;;;;;;0BAIPa,KAAK,KAAK,O;;;;;;AACL,2BAAM,KAAKic,eAAL,CAAqBznB,KAAK,CAACkB,OAA3B,EAAoClB,KAAK,CAACqB,OAA1C,EAAmDrB,KAAK,CAACmL,YAAzD,EAAuEnL,KAAK,CAACqL,KAA7E,EAAoFrL,KAAK,CAACgD,SAA1F,EAAqGhD,KAAK,CAACiD,QAA3G,EAAqHjD,KAAK,CAAC2K,MAA3H,CAAN;;;;;;;;;;;;AAEV;;;iDAEsCzJ,O,EAAiBG,O,EAAiB2B,S,EAAmBC,Q,EAAkB0H,M,EAAgB;;;;;;;;;AACtHmQ,uB,aAAS,sEAAYC,O;AAC3BhN,2BAAO,CAACC,GAAR,CAAY8M,GAAZ,E,CAEA;;AACA7X,4BAAQ,GAAGA,QAAQ,KAAK,MAAb,GAAuBD,SAAS,KAAK,MAAd,GAAuB,GAAvB,GAA6B,EAApD,GAA0DC,QAArE;AACIH,0B,GAAS;AAAE5B,6BAAO,EAAPA,OAAF;AAAWG,6BAAO,EAAPA,OAAX;AAAoB2B,+BAAS,EAATA,SAApB;AAA+BC,8BAAQ,EAARA,QAA/B;AAAyC0H,4BAAM,EAANA;AAAzC,qB;AAEboD,2BAAO,CAACC,GAAR,sBAA0B+Y,IAAI,CAACC,SAAL,CAAelkB,MAAf,CAA1B,G,CAEA;;AACMmkB,2B,GAAU;AACd,sCAAgB;AADF,qB,EAIhB;;;AACiB,2BAAM3L,KAAK,CAACR,GAAD,EAAM;AAChCoM,4BAAM,EAAE,MADwB;AAEhCD,6BAAO,EAAPA,OAFgC;AAGhCE,0BAAI,EAAEJ,IAAI,CAACC,SAAL,CAAelkB,MAAf;AAH0B,qBAAN,CAAX;;;AAAXyY,4B;;AAKC,2BAAMA,QAAQ,CAACC,IAAT,EAAN;;;;;;;;;;;;AACR;;;0CAE+Bta,O,EAAiBG,O,EAAiB8J,Y,EAAsBnI,S,EAAmBC,Q,EAAkB0H,M,EAAgB;;;;;;;;;AACrImQ,uB,aAAS,sEAAYC,O;AAC3BhN,2BAAO,CAACC,GAAR,CAAY8M,GAAZ,E,CAEA;;AACA7X,4BAAQ,GAAGA,QAAQ,KAAK,MAAb,GAAuBD,SAAS,KAAK,MAAd,GAAuB,GAAvB,GAA6B,EAApD,GAA0DC,QAArE;AACIH,0B,GAAS;AAAE5B,6BAAO,EAAPA,OAAF;AAAWiK,kCAAY,EAAZA,YAAX;AAAyB9J,6BAAO,EAAPA,OAAzB;AAAkC2B,+BAAS,EAATA,SAAlC;AAA6CC,8BAAQ,EAARA,QAA7C;AAAuD0H,4BAAM,EAANA;AAAvD,qB;AAEboD,2BAAO,CAACC,GAAR,sBAA0B+Y,IAAI,CAACC,SAAL,CAAelkB,MAAf,CAA1B,G,CAEA;;AACMmkB,2B,GAAU;AACd,sCAAgB;AADF,qB,EAIhB;;;AACiB,2BAAM3L,KAAK,CAACR,GAAD,EAAM;AAChCoM,4BAAM,EAAE,MADwB;AAEhCD,6BAAO,EAAPA,OAFgC;AAGhCE,0BAAI,EAAEJ,IAAI,CAACC,SAAL,CAAelkB,MAAf;AAH0B,qBAAN,CAAX;;;AAAXyY,4B;;AAKC,2BAAMA,QAAQ,CAACC,IAAT,EAAN;;;;;;;;;;;;AACR;;;wCAE6Bta,O,EAAiBG,O,EAAiB8J,Y,EAAsBE,K,EAAerI,S,EAAmBC,Q,EAAkB0H,M,EAAgB;;;;;;;;;AAClJmQ,uB,aAAS,sEAAYC,O;AAC3BhN,2BAAO,CAACC,GAAR,CAAY8M,GAAZ,E,CAEA;;AACA7X,4BAAQ,GAAGA,QAAQ,KAAK,MAAb,GAAuBD,SAAS,KAAK,MAAd,GAAuB,GAAvB,GAA6B,EAApD,GAA0DC,QAArE;AACIH,0B,GAAS;AAAE5B,6BAAO,EAAPA,OAAF;AAAWiK,kCAAY,EAAZA,YAAX;AAAyB9J,6BAAO,EAAPA,OAAzB;AAAkCgK,2BAAK,EAALA,KAAlC;AAAyCrI,+BAAS,EAATA,SAAzC;AAAoDC,8BAAQ,EAARA,QAApD;AAA8D0H,4BAAM,EAANA;AAA9D,qB;AAEboD,2BAAO,CAACC,GAAR,sBAA0B+Y,IAAI,CAACC,SAAL,CAAelkB,MAAf,CAA1B,G,CAEA;;AACMmkB,2B,GAAU;AACd,sCAAgB;AADF,qB,EAIhB;;;AACiB,2BAAM3L,KAAK,CAACR,GAAD,EAAM;AAChCoM,4BAAM,EAAE,MADwB;AAEhCD,6BAAO,EAAPA,OAFgC;AAGhCE,0BAAI,EAAEJ,IAAI,CAACC,SAAL,CAAelkB,MAAf;AAH0B,qBAAN,CAAX;;;AAAXyY,4B;;AAKC,2BAAMA,QAAQ,CAACC,IAAT,EAAN;;;;;;;;;;;;AACR;;;mCAGgBta,O,EAAiBG,O,EAAiB2B,S,EAAmBC,Q,EAAqC;AAAA,cAAnBtL,IAAmB,uEAAJ,EAAI;;;;;;;;;AACnGmjB,uB,aAAS,sEAAYC,O;AAC3BhN,2BAAO,CAACC,GAAR,CAAY8M,GAAZ,E,CAEA;;AACA7X,4BAAQ,GAAGA,QAAQ,KAAK,MAAb,GAAuBD,SAAS,KAAK,MAAd,GAAuB,GAAvB,GAA6B,EAApD,GAA0DC,QAArE;AACMH,0B,GAAS;AAAE5B,6BAAO,EAAPA,OAAF;AAAWG,6BAAO,EAAPA,OAAX;AAAoB2B,+BAAS,EAATA,SAApB;AAA+BC,8BAAQ,EAARA,QAA/B;AAAyCtL,0BAAI,EAAJA;AAAzC,qB;AAEfoW,2BAAO,CAACC,GAAR,sBAA0B+Y,IAAI,CAACC,SAAL,CAAelkB,MAAf,CAA1B,G,CAEA;;AACMmkB,2B,GAAU;AACd,sCAAgB;AADF,qB,EAIhB;;;AACiB,2BAAM3L,KAAK,CAACR,GAAD,EAAM;AAChCoM,4BAAM,EAAE,MADwB;AAEhCD,6BAAO,EAAPA,OAFgC;AAGhCE,0BAAI,EAAEJ,IAAI,CAACC,SAAL,CAAelkB,MAAf;AAH0B,qBAAN,CAAX;;;AAAXyY,4B;;AAKC,2BAAMA,QAAQ,CAACC,IAAT,EAAN;;;;;;;;;;;;AACR;;;oCAEiBta,O,EAAiBG,O,EAAiBqmB,M,EAAa9lB,S,EAAmB;;;;;;;;;AAC5EkZ,uB,aAAS,sEAAYC,O;AAC3BhN,2BAAO,CAACC,GAAR,CAAY8M,GAAZ;AAEA4M,0BAAM,CAAC3rB,OAAP,CAAe,UAAAhG,EAAE,EAAI;AACnB,0BAAIA,EAAE,CAACiN,SAAH,KAAiB,SAAjB,IAA8BjN,EAAE,CAACiN,SAAH,KAAiB,SAAnD,EAA8D;AAC5D,+BAAOjN,EAAE,CAACkN,QAAV;AACD;AACF,qBAJD,E,CAMA;;AACMH,0B,GAAS;AAAE5B,6BAAO,EAAPA,OAAF;AAAWG,6BAAO,EAAPA,OAAX;AAAoBqmB,4BAAM,EAANA,MAApB;AAA4B9lB,+BAAS,EAATA;AAA5B,qB;AACfmM,2BAAO,CAACC,GAAR,sBAA0B+Y,IAAI,CAACC,SAAL,CAAelkB,MAAf,CAA1B,G,CAEA;;AACMmkB,2B,GAAU;AACd,sCAAgB;AADF,qB,EAIhB;;;AACiB,2BAAM3L,KAAK,CAACR,GAAD,EAAM;AAChCoM,4BAAM,EAAE,MADwB;AAEhCD,6BAAO,EAAPA,OAFgC;AAGhCE,0BAAI,EAAEJ,IAAI,CAACC,SAAL,CAAelkB,MAAf;AAH0B,qBAAN,CAAX;;;AAAXyY,4B;;AAKC,2BAAMA,QAAQ,CAACrkB,IAAT,EAAN;;;;;;;;;;;;AACR;;;;;;;uBArUU0vB,U;AAAU,K;;;aAAVA,U;AAAU,eAAVA,UAAU,K;AAAA,kBAFT;;;;;sEAEDA,U,EAAU;cAHtB,wDAGsB;eAHX;AACVe,oBAAU,EAAE;AADF,S;AAGW,Q;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;QCMVC,W;;;AAkBT,2BAAmB7nB,GAAnB,EAA2CxM,MAA3C,EAAyEyM,KAAzE,EAA8F;AAAA;;AAA3E,aAAAD,GAAA,GAAAA,GAAA;AAAwB,aAAAxM,MAAA,GAAAA,MAAA;AAA8B,aAAAyM,KAAA,GAAAA,KAAA;AAjBlE,aAAAmG,QAAA,GAAW,IAAX;AACA,aAAAvB,OAAA,GAAU,IAAV;AACA,aAAA3D,OAAA,GAAU,EAAV;AACA,aAAA8C,MAAA,GAAS,EAAT;AAEA,aAAAzD,IAAA,GAAO;AACVunB,eAAK,EAAE,EADG;AAEVrsB,eAAK,EAAE,EAFG;AAGV8H,oBAAU,EAAE,EAHF;AAIVwkB,kBAAQ,EAAE,EAJA;AAKVC,kBAAQ,EAAE,EALA;AAMV1nB,gBAAM,EAAE,EANE;AAOVkB,oBAAU,EAAE,EAPF;AAQV+H,gBAAM,EAAE,EARE;AASVmB,kBAAQ,EAAE;AATA,SAAP;AAaH,aAAKud,mBAAL;AACA,aAAKC,kBAAL;AACA,aAAKziB,oBAAL;AACA,aAAK0iB,qBAAL;AACH,O,CAED;;;;;8CAEsB;AAClB,eAAK30B,MAAL,CAAYE,IAAZ,CAAiBC,WAAjB,CAA6BuO,SAA7B,CAAuC,KAAKkmB,cAAL,CAAoBzwB,IAApB,CAAyB,IAAzB,CAAvC;AACH;;;yCAEsB;;;;;;;;AACnB,yBAAK4I,IAAL,CAAUunB,KAAV,GAAkB,KAAK9nB,GAAL,CAASqoB,SAAT,EAAlB;;AACkB,2BAAM,KAAKroB,GAAL,CAASsoB,SAAT,EAAN;;;AAAlB,yBAAK/nB,IAAL,CAAU9E,K;;AACa,2BAAM,KAAKuE,GAAL,CAASuoB,cAAT,EAAN;;;AAAvB,yBAAKhoB,IAAL,CAAUgD,U;;AACW,2BAAM,KAAKvD,GAAL,CAASwoB,YAAT,EAAN;;;AAArB,yBAAKjoB,IAAL,CAAUwnB,Q;;AACW,2BAAM,KAAK/nB,GAAL,CAASyoB,YAAT,EAAN;;;AAArB,yBAAKloB,IAAL,CAAUynB,Q;;AACa,2BAAM,KAAKhoB,GAAL,CAAS0oB,cAAT,EAAN;;;AAAvB,yBAAKnoB,IAAL,CAAUiB,U;AACV,yBAAKjB,IAAL,CAAUD,MAAV,GAAmB,KAAKN,GAAL,CAAS2oB,UAAT,EAAnB;AACA,yBAAKpoB,IAAL,CAAUgJ,MAAV,GAAmB,KAAKvJ,GAAL,CAAS4oB,UAAT,EAAnB;AACA,yBAAKroB,IAAL,CAAUmK,QAAV,GAAqB,KAAK1K,GAAL,CAAS6oB,YAAT,EAArB;;;;;;;;;AACH,S,CAED;;;;6CAEqB;AACjB,eAAKr1B,MAAL,CAAYuC,GAAZ,CAAgBpC,WAAhB,CAA4BuO,SAA5B,CAAsC,KAAK4mB,kCAAL,CAAwCnxB,IAAxC,CAA6C,IAA7C,CAAtC;AACH,S,CAED;;;;+CAEuB;AACnB,eAAKnE,MAAL,CAAYyM,KAAZ,CAAkB8oB,oBAAlB,CAAuC7mB,SAAvC,CAAiD,KAAK4mB,kCAAL,CAAwCnxB,IAAxC,CAA6C,IAA7C,CAAjD;AACA,eAAKnE,MAAL,CAAYyM,KAAZ,CAAkB8oB,oBAAlB,CAAuC7mB,SAAvC,CAAiD,KAAK8mB,cAAL,CAAoBrxB,IAApB,CAAyB,IAAzB,CAAjD;AAEA,eAAKnE,MAAL,CAAYyM,KAAZ,CAAkBgpB,oBAAlB,CAAuC/mB,SAAvC,CAAiD,KAAK4mB,kCAAL,CAAwCnxB,IAAxC,CAA6C,IAA7C,CAAjD;AACA,eAAKnE,MAAL,CAAYyM,KAAZ,CAAkBgpB,oBAAlB,CAAuC/mB,SAAvC,CAAiD,KAAK8mB,cAAL,CAAoBrxB,IAApB,CAAyB,IAAzB,CAAjD;AAEA,eAAKnE,MAAL,CAAYyM,KAAZ,CAAkBipB,uBAAlB,CAA0ChnB,SAA1C,CAAoD,KAAK4mB,kCAAL,CAAwCnxB,IAAxC,CAA6C,IAA7C,CAApD;AACA,eAAKnE,MAAL,CAAYyM,KAAZ,CAAkBipB,uBAAlB,CAA0ChnB,SAA1C,CAAoD,KAAK8mB,cAAL,CAAoBrxB,IAApB,CAAyB,IAAzB,CAApD;AAEA,eAAKnE,MAAL,CAAYyM,KAAZ,CAAkBkpB,iBAAlB,CAAoCjnB,SAApC,CAA8C,KAAKknB,YAAL,CAAkBzxB,IAAlB,CAAuB,IAAvB,CAA9C;AACA,eAAKnE,MAAL,CAAYyM,KAAZ,CAAkBgF,iBAAlB,CAAoC/C,SAApC,CAA8C,KAAK4mB,kCAAL,CAAwCnxB,IAAxC,CAA6C,IAA7C,CAA9C;AAEA,eAAKnE,MAAL,CAAYyM,KAAZ,CAAkBopB,uBAAlB,CAA0CnnB,SAA1C,CAAoD,KAAKonB,UAAL,CAAgB3xB,IAAhB,CAAqB,IAArB,CAApD;AAEA,eAAKnE,MAAL,CAAYyM,KAAZ,CAAkBspB,yBAAlB,CAA4CrnB,SAA5C,CAAsD,KAAK4mB,kCAAL,CAAwCnxB,IAAxC,CAA6C,IAA7C,CAAtD;AACA,eAAKnE,MAAL,CAAYyM,KAAZ,CAAkBupB,wBAAlB,CAA2CtnB,SAA3C,CAAqD,KAAKunB,uBAAL,CAA6B9xB,IAA7B,CAAkC,IAAlC,CAArD;AACH;;;2DAEwC+xB,M,EAAiB;;;;;;;;;;AACtD,2BAAM,KAAKC,WAAL,EAAN;;;;AACA,2BAAM,KAAKC,WAAL,EAAN;;;;AACA,2BAAM,KAAKC,YAAL,EAAN;;;;AAEA,2BAAM,KAAKC,gBAAL,EAAN;;;AAEA;AACMxxB,0B,GAAS,KAAKuM,OAAL,CAAa,KAAK5E,KAAL,CAAWa,wBAAX,CAAoC3F,IAAjD,EAAuD7C,M,EAEtE;;AACA,wBAAI,CAACoxB,MAAL,EAAa;AACT,2BAAKl2B,MAAL,CAAY6C,IAAZ,CAAiB0zB,oBAAjB,CAAsCn2B,IAAtC,CAA2C0E,MAA3C;AACA,2BAAK9E,MAAL,CAAY6C,IAAZ,CAAiBkO,eAAjB,CAAiC3Q,IAAjC;AACH;;AACD,yBAAKJ,MAAL,CAAY6C,IAAZ,CAAiBoO,4BAAjB,CAA8C7Q,IAA9C;;;;;;;;;AACH;;;kDAE+B;;;;;;;;;;AAC5B,2BAAM,KAAK+1B,WAAL,EAAN;;;;AACA,2BAAM,KAAKC,WAAL,EAAN;;;AAEA;AACMtxB,0B,GAAS,KAAKuM,OAAL,CAAa,KAAK5E,KAAL,CAAWa,wBAAX,CAAoC3F,IAAjD,EAAuD7C,M,EAEtE;;AACA,yBAAK9E,MAAL,CAAY6C,IAAZ,CAAiB0zB,oBAAjB,CAAsCn2B,IAAtC,CAA2C0E,MAA3C;AACA,yBAAK9E,MAAL,CAAY6C,IAAZ,CAAiBkO,eAAjB,CAAiC3Q,IAAjC;AACA,yBAAKJ,MAAL,CAAY6C,IAAZ,CAAiBqO,iBAAjB,CAAmC9Q,IAAnC;;;;;;;;;AACH;;;uCAEoB;;;;;;;;AACjB,yBAAKJ,MAAL,CAAY6C,IAAZ,CAAiBqO,iBAAjB,CAAmC9Q,IAAnC;;;;;;;;;AACH;;;2CAEwB;;;;;;;;;AACrB;AACMuN,2B,GAAU,KAAKlB,KAAL,CAAW+C,sBAAX,CAAkC7B,O,EAElD;;;AACsB,2BAAM,KAAKnB,GAAL,CAAS8pB,gBAAT,CAA0B3oB,OAA1B,CAAN;;;AAAtB,yBAAK6C,MAAL,CAAY,MAAZ,C;;;;;;;;;AACH;;;uCAEoB;;;;;;;;;AACjB;AACM7C,2B,GAAU,KAAKlB,KAAL,CAAW+C,sB,EAC3B;;AACMgnB,2B,GAAU,KAAK/pB,KAAL,CAAWa,wB,EAC3B;;AACMmpB,8B,GAAa,KAAKhqB,KAAL,CAAW2E,uB,EAE9B;;AACI3E,yB,GAAQ,E;AACZc,0BAAM,CAACC,MAAP,CAAcf,KAAd,EAAqBkB,OAArB;AACAJ,0BAAM,CAACC,MAAP,CAAcf,KAAd,EAAqB+pB,OAArB;AACAjpB,0BAAM,CAACC,MAAP,CAAcf,KAAd,EAAqBgqB,UAArB,E,CAEA;;AACMxe,yB,GAAQ,KAAKxL,KAAL,CAAWiK,W,EAEzB;;;AACgB,2BAAM,KAAKlK,GAAL,CAAS6pB,YAAT,CAAsBpe,KAAtB,EAA6BxL,KAA7B,CAAN;;;AAAhB,yBAAKmG,Q;AACL,yBAAKA,QAAL,CAAcE,QAAd,CAAuBpI,IAAvB,CAA4B,UAACqI,CAAD,EAAIC,CAAJ;AAAA,6BAAUD,CAAC,CAACI,UAAF,CAAarK,IAAb,GAAoBkK,CAAC,CAACG,UAAF,CAAarK,IAAjC,GAAwC,CAAxC,GAA4C,CAAC,CAAvD;AAAA,qBAA5B;;;;;;;;;AACH;;;sCAEmB;;;;;;;;;AAChB;AACM6E,2B,GAAU,KAAKlB,KAAL,CAAW+C,sB,EAC3B;;AACMgnB,2B,GAAU,KAAK/pB,KAAL,CAAWa,wB,EAC3B;;AACMmpB,8B,GAAa,KAAKhqB,KAAL,CAAW2E,uB,EAE9B;;AACI3E,yB,GAAQ,E;AACZc,0BAAM,CAACC,MAAP,CAAcf,KAAd,EAAqBkB,OAArB;AACAJ,0BAAM,CAACC,MAAP,CAAcf,KAAd,EAAqB+pB,OAArB;AACAjpB,0BAAM,CAACC,MAAP,CAAcf,KAAd,EAAqBgqB,UAArB,E,CACA;;AACMxe,yB,GAAQ,KAAKxL,KAAL,CAAWiK,W,EAEzB;;;AACe,2BAAM,KAAKlK,GAAL,CAAS4pB,WAAT,CAAqBne,KAArB,EAA4BxL,KAA5B,CAAN;;;AAAf,yBAAK4E,O;AAEL;AACMqlB,wB,GAAO,CAAC,KAAKjqB,KAAL,CAAW2E,uBAAX,CAAmC8F,Q;AACjD,yBAAKyf,WAAL,CAAiBD,IAAjB,E,CAEA;;AACA,yBAAKE,kBAAL;AAEApc,2BAAO,CAACC,GAAR,CAAY,KAAKpJ,OAAjB;;;;;;;;;AACH;;;oCAGWqlB,I,EAAc;AACtB,cAAI,CAACA,IAAL,EAAW;AAAE;AAAS;;AAEtB,cAAMzuB,KAAK,GAAGsF,MAAM,CAAC5N,IAAP,CAAY,KAAK0R,OAAjB,EAA0B7F,MAA1B,CAAiC,UAAAvG,CAAC;AAAA,mBAAIA,CAAC,KAAK,KAAN,IAAeA,CAAC,KAAK,KAAzB;AAAA,WAAlC,EAAkEuG,MAAlE,CAAyE,UAAAvG,CAAC;AAAA,mBAAIA,CAAC,CAAC7C,KAAF,CAAQ,GAAR,EAAa,CAAb,MAAoB,GAAxB;AAAA,WAA1E,CAAd;AACA6F,eAAK,CAACjB,IAAN,CAAW,QAAX;AACAiB,eAAK,CAACyC,IAAN;AAEA,cAAMmsB,QAAQ,GAAG,EAAjB;;AACA,eAAK,IAAIC,GAAG,GAAG7uB,KAAK,CAACnD,MAAN,GAAe,CAA9B,EAAiCgyB,GAAG,IAAI,CAAxC,EAA2CA,GAAG,IAAIJ,IAAlD,EAAwD;AACpDG,oBAAQ,CAAC7vB,IAAT,CAAciB,KAAK,CAAC6uB,GAAD,CAAnB;AACH;;AACDD,kBAAQ,CAACvR,OAAT;AAEA,cAAMyR,WAAW,GAAG,EAApB;;AACA,eAAK,IAAID,IAAG,GAAG,CAAf,EAAkBA,IAAG,GAAGD,QAAQ,CAAC/xB,MAAjC,EAAyCgyB,IAAG,EAA5C,EAAgD;AAC5C,gBAAID,QAAQ,CAACC,IAAD,CAAR,KAAkB,QAAtB,EAAgC;AAC5BC,yBAAW,CAACF,QAAQ,CAACC,IAAD,CAAT,CAAX,GAA6B,KAAKzlB,OAAL,CAAa,QAAb,CAA7B;AACH,aAFD,MAGK;AACD0lB,yBAAW,CAACF,QAAQ,CAACC,IAAD,CAAT,CAAX,GAA6B,KAAKzlB,OAAL,CAAawlB,QAAQ,CAACC,IAAD,CAArB,CAA7B;AACH;AACJ;;AACDC,qBAAW,CAAC,KAAD,CAAX,GAAqB,KAAK1lB,OAAL,CAAa,KAAb,CAArB;AACA0lB,qBAAW,CAAC,KAAD,CAAX,GAAqB,KAAK1lB,OAAL,CAAa,KAAb,CAArB;AAEA,eAAKA,OAAL,GAAe0lB,WAAf;AACH;;;6CAEoB;AACjB,eAAK1lB,OAAL,CAAaC,SAAb,GAAyB0lB,QAAzB;AACA,eAAK3lB,OAAL,CAAaE,SAAb,GAAyB,CAACylB,QAA1B;AAEA,cAAMtuB,IAAI,GAAG,EAAb;AACA,cAAMuuB,IAAI,GAAG,EAAb,CALiB,CAOjB;AACA;AACA;;AAEA,cAAMhvB,KAAK,GAAGsF,MAAM,CAAC5N,IAAP,CAAY,KAAK0R,OAAjB,EAA0B7F,MAA1B,CAAiC,UAAAzK,GAAG;AAAA,mBAAI,CAACsB,KAAK,CAAC,CAACtB,GAAF,CAAV;AAAA,WAApC,CAAd;;AAEA,eAAK,IAAI+1B,GAAG,GAAG,CAAf,EAAkBA,GAAG,GAAG7uB,KAAK,CAACnD,MAA9B,EAAsCgyB,GAAG,EAAzC,EAA6C;AACzC,gBAAMnvB,IAAI,GAAGM,KAAK,CAAC6uB,GAAD,CAAlB;;AAEA,iBAAK,IAAI5jB,GAAG,GAAG,CAAf,EAAkBA,GAAG,GAAG,KAAK7B,OAAL,CAAa1J,IAAb,EAAmB7C,MAA3C,EAAmDoO,GAAG,EAAtD,EAA0D;AACtD,kBAAI4jB,GAAG,KAAK,CAAZ,EAAe;AACX,qBAAKzlB,OAAL,CAAa1J,IAAb,EAAmBuL,GAAnB,EAAwBgkB,MAAxB,GAAiC,CAAjC;AACA,qBAAK7lB,OAAL,CAAa1J,IAAb,EAAmBuL,GAAnB,EAAwBrH,WAAxB,GAAsC,KAAtC;AACH,eAHD,MAIK;AACD,oBAAMsB,IAAI,GAAGlF,KAAK,CAAC6uB,GAAG,GAAG,CAAP,CAAlB,CADC,CAGD;;AACA,oBAAI,KAAKzlB,OAAL,CAAa1J,IAAb,EAAmBuL,GAAnB,EAAwBxH,OAAxB,IAAmC,KAAK2F,OAAL,CAAalE,IAAb,EAAmB+F,GAAnB,EAAwBxH,OAA3D,IAAsE,KAAK2F,OAAL,CAAa1J,IAAb,EAAmBuL,GAAnB,EAAwBtH,OAA9F,IAAyG,KAAKyF,OAAL,CAAalE,IAAb,EAAmB+F,GAAnB,EAAwBtH,OAArI,EAA8I;AAC1I,uBAAKyF,OAAL,CAAa1J,IAAb,EAAmBuL,GAAnB,EAAwBgkB,MAAxB,GAAiC,KAAK7lB,OAAL,CAAa1J,IAAb,EAAmBuL,GAAnB,EAAwBnN,KAAxB,GAAgC,KAAKsL,OAAL,CAAalE,IAAb,EAAmB+F,GAAnB,EAAwBnN,KAAzF;AACA,uBAAKsL,OAAL,CAAa1J,IAAb,EAAmBuL,GAAnB,EAAwBrH,WAAxB,GAAsC,IAAtC;AACH,iBAHD,CAIA;AAJA,qBAKK,IAAI,CAAC,KAAKwF,OAAL,CAAa1J,IAAb,EAAmBuL,GAAnB,EAAwBxH,OAAzB,IAAoC,KAAK2F,OAAL,CAAalE,IAAb,EAAmB+F,GAAnB,EAAwBxH,OAA5D,IAAuE,KAAK2F,OAAL,CAAalE,IAAb,EAAmB+F,GAAnB,EAAwBtH,OAAnG,EAA4G;AAC7G,yBAAKyF,OAAL,CAAa1J,IAAb,EAAmBuL,GAAnB,EAAwBgkB,MAAxB,GAAiC,CAAC,KAAK7lB,OAAL,CAAalE,IAAb,EAAmB+F,GAAnB,EAAwBnN,KAA1D;AACA,yBAAKsL,OAAL,CAAa1J,IAAb,EAAmBuL,GAAnB,EAAwBrH,WAAxB,GAAsC,IAAtC;AACH,mBAHI,CAIL;AAJK,uBAKA,IAAI,KAAKwF,OAAL,CAAa1J,IAAb,EAAmBuL,GAAnB,EAAwBxH,OAAxB,IAAmC,CAAC,KAAK2F,OAAL,CAAalE,IAAb,EAAmB+F,GAAnB,EAAwBxH,OAA5D,IAAuE,KAAK2F,OAAL,CAAa1J,IAAb,EAAmBuL,GAAnB,EAAwBtH,OAAnG,EAA4G;AAC7G,2BAAKyF,OAAL,CAAa1J,IAAb,EAAmBuL,GAAnB,EAAwBgkB,MAAxB,GAAiC,KAAK7lB,OAAL,CAAa1J,IAAb,EAAmBuL,GAAnB,EAAwBnN,KAAzD;AACA,2BAAKsL,OAAL,CAAa1J,IAAb,EAAmBuL,GAAnB,EAAwBrH,WAAxB,GAAsC,IAAtC;AACH,qBAHI,CAIL;AAJK,yBAKA,IAAI,KAAKwF,OAAL,CAAa1J,IAAb,EAAmBuL,GAAnB,EAAwBxH,OAAxB,IAAmC,KAAK2F,OAAL,CAAalE,IAAb,EAAmB+F,GAAnB,EAAwBxH,OAA3D,IAAsE,CAAC,KAAK2F,OAAL,CAAa1J,IAAb,EAAmBuL,GAAnB,EAAwBtH,OAA/F,IAA0G,KAAKyF,OAAL,CAAalE,IAAb,EAAmB+F,GAAnB,EAAwBtH,OAAtI,EAA+I;AAChJ,6BAAKyF,OAAL,CAAa1J,IAAb,EAAmBuL,GAAnB,EAAwBgkB,MAAxB,GAAiC,CAAC,KAAK7lB,OAAL,CAAalE,IAAb,EAAmB+F,GAAnB,EAAwBnN,KAA1D;AACA,6BAAKsL,OAAL,CAAa1J,IAAb,EAAmBuL,GAAnB,EAAwBrH,WAAxB,GAAsC,IAAtC;AACH,uBAHI,CAIL;AAJK,2BAKA,IAAI,KAAKwF,OAAL,CAAa1J,IAAb,EAAmBuL,GAAnB,EAAwBxH,OAAxB,IAAmC,KAAK2F,OAAL,CAAalE,IAAb,EAAmB+F,GAAnB,EAAwBxH,OAA3D,IAAsE,KAAK2F,OAAL,CAAa1J,IAAb,EAAmBuL,GAAnB,EAAwBtH,OAA9F,IAAyG,CAAC,KAAKyF,OAAL,CAAalE,IAAb,EAAmB+F,GAAnB,EAAwBtH,OAAtI,EAA+I;AAChJ,+BAAKyF,OAAL,CAAa1J,IAAb,EAAmBuL,GAAnB,EAAwBgkB,MAAxB,GAAiC,KAAK7lB,OAAL,CAAa1J,IAAb,EAAmBuL,GAAnB,EAAwBnN,KAAzD;AACA,+BAAKsL,OAAL,CAAa1J,IAAb,EAAmBuL,GAAnB,EAAwBrH,WAAxB,GAAsC,IAAtC;AACH,yBAHI,MAIA;AACD,+BAAKwF,OAAL,CAAa1J,IAAb,EAAmBuL,GAAnB,EAAwBgkB,MAAxB,GAAiC,CAAjC;AACA,+BAAK7lB,OAAL,CAAa1J,IAAb,EAAmBuL,GAAnB,EAAwBrH,WAAxB,GAAsC,KAAtC;AACH;AACJ;;AAEDnD,kBAAI,CAAC1B,IAAL,CAAU,KAAKqK,OAAL,CAAa1J,IAAb,EAAmBuL,GAAnB,EAAwBnN,KAAlC;AACAkxB,kBAAI,CAACjwB,IAAL,CAAU,KAAKqK,OAAL,CAAa1J,IAAb,EAAmBuL,GAAnB,EAAwBgkB,MAAlC;AACH;AACJ;;AAED,cAAI,KAAKzqB,KAAL,CAAW+C,sBAAX,CAAkCgC,eAAtC,EAAuD;AACnD,iBAAKH,OAAL,CAAa1I,GAAb,GAAoB,wDAAWD,IAAX,EAAkB,CAAlB,CAApB;AACA,iBAAK2I,OAAL,CAAazI,GAAb,GAAoB,wDAAWF,IAAX,EAAiB,EAAjB,CAApB;AACA,iBAAK2I,OAAL,CAAaC,SAAb,GAAyB,wDAAW2lB,IAAX,EAAiB,CAAjB,CAAzB;AACA,iBAAK5lB,OAAL,CAAaE,SAAb,GAAyB,wDAAW0lB,IAAX,EAAgB,EAAhB,CAAzB;AACH,WALD,MAMK;AACD,iBAAK5lB,OAAL,CAAa1I,GAAb,GAAoB,uCAAOD,IAAP,CAApB;AACA,iBAAK2I,OAAL,CAAazI,GAAb,GAAoB,uCAAOF,IAAP,CAApB;AACA,iBAAK2I,OAAL,CAAaC,SAAb,GAAyB,uCAAO2lB,IAAP,CAAzB;AACA,iBAAK5lB,OAAL,CAAaE,SAAb,GAAyB,uCAAO0lB,IAAP,CAAzB;AACH;AACJ;;;gDAE6B;;;;;;;;AAC1B,yBAAKj3B,MAAL,CAAY0N,OAAZ,CAAoBmC,aAApB,CAAkCnB,SAAlC,CAA4C,KAAKunB,uBAAL,CAA6B9xB,IAA7B,CAAkC,IAAlC,CAA5C;;;;;;;;;AACH;;;sCAEmB;;;;;;;;;;;AACVwJ,2B,GAAY,KAAKlB,KAAL,CAAW+C,sBAAX,CAAkC7B,O;AAC9CG,2B,GAAY,KAAKrB,KAAL,CAAW+C,sBAAX,CAAkC1B,O;AAC9CO,6B,GAAY,KAAK5B,KAAL,CAAW+C,sBAAX,CAAkCnB,S;AAC9CX,2B,GAAUH,MAAM,CAAC5N,IAAP,CAAY,KAAK8M,KAAL,CAAWgB,sBAAvB,EAA+ClL,GAA/C,CAAmD,UAAAxB,GAAG,EAAI;AACtE,0BAAMsD,GAAG,GAAG,OAAI,CAACoI,KAAL,CAAWgB,sBAAX,CAAkC1M,GAAlC,CAAZ;;AAEA,0BAAI,CAACsD,GAAG,CAACT,KAAL,IAAcS,GAAG,CAACT,KAAJ,CAAUkB,MAAV,KAAqB,CAAvC,EAA0C;AACtC,+BAAO,IAAP;AACH;;AAED,0BAAI6D,GAAG,GAAG,CAACtE,GAAG,CAACT,KAAJ,CAAU,CAAV,EAAaxB,KAAb,CAAmB,GAAnB,EAAwB,CAAxB,CAAX;AACAuG,yBAAG,GAAGtG,KAAK,CAACsG,GAAD,CAAL,GAAatE,GAAG,CAACT,KAAJ,CAAU,CAAV,CAAb,GAA4B+E,GAAlC;AAEA,0BAAIC,GAAG,GAAG,CAACvE,GAAG,CAACT,KAAJ,CAAUS,GAAG,CAACT,KAAJ,CAAUkB,MAAV,GAAmB,CAA7B,EAAgC1C,KAAhC,CAAsC,GAAtC,EAA2C,CAA3C,CAAX;AACAwG,yBAAG,GAAGvG,KAAK,CAACuG,GAAD,CAAL,GAAavE,GAAG,CAACT,KAAJ,CAAUS,GAAG,CAACT,KAAJ,CAAUkB,MAAV,GAAmB,CAA7B,CAAb,GAA+C8D,GAArD;AAEA,6BAAO;AACH7H,2BAAG,EAAEA,GADF;AAEH0O,iCAAS,EAAEpL,GAAG,CAACoL,SAFZ;AAGHC,gCAAQ,EAAErL,GAAG,CAACqL,QAHX;AAIH/G,2BAAG,EAAHA,GAJG;AAKHC,2BAAG,EAAHA;AALG,uBAAP;AAOH,qBApBe,C;;AAsBhB,2BAAM,KAAK4D,GAAL,CAAS2pB,WAAT,CAAqBxoB,OAArB,EAA8BG,OAA9B,EAAuCJ,OAAO,CAAClC,MAAR,CAAe,UAAAnH,GAAG;AAAA,6BAAIA,GAAG,KAAK,IAAZ;AAAA,qBAAlB,CAAvC,EAA4EgK,SAA5E,CAAN;;;;;;;;;AACH;;;mCAEgBtN,G,EAAa;;;;;;;;;AACpB2K,2B,GAAU6B,MAAM,CAAC5N,IAAP,CAAY,KAAK8M,KAAL,CAAWgB,sBAAvB,EAA+C5H,QAA/C,WAA2D9E,GAA3D,E;;wBAEX2K,O;;;;;AACD,2BAAO,KAAKgC,OAAL,CAAa3M,GAAb,CAAP;;;;;AAGM4M,2B,GAAU,KAAKlB,KAAL,CAAW+C,sBAAX,CAAkC7B,O;AAC5CG,2B,GAAU,KAAKrB,KAAL,CAAW+C,sBAAX,CAAkC7B,O;AAC5C4B,0B,GAAS,KAAK9C,KAAL,CAAWgB,sBAAX,CAAkC1M,GAAlC,C;;AAEA,2BAAM,KAAKyL,GAAL,CAASspB,UAAT,CAAoBnoB,OAApB,EAA6BG,OAA7B,EAAsCyB,MAAM,CAACE,SAA7C,EAAwDF,MAAM,CAACG,QAA/D,CAAN;;;AAATlE,0B;AACN,yBAAKkC,OAAL,CAAa3M,GAAb,IAAoByK,MAApB;;;AAGJ,yBAAKxL,MAAL,CAAY6C,IAAZ,CAAiB+L,aAAjB,CAA+BxO,IAA/B;;;;;;;;;AACH;;;yCAEsB;;;;;;;;;;AACbT,wB,GAAO4N,MAAM,CAAC5N,IAAP,CAAY,KAAK8M,KAAL,CAAWgB,sBAAvB,C;qCAEG9N,I;;;;;;;;AAAPoB,uB;AACC4M,2B,GAAU,KAAKlB,KAAL,CAAW+C,sBAAX,CAAkC7B,O;AAC5CG,2B,GAAU,KAAKrB,KAAL,CAAW+C,sBAAX,CAAkC7B,O;AAC5C4B,0B,GAAS,KAAK9C,KAAL,CAAWgB,sBAAX,CAAkC1M,GAAlC,C;;AAEA,2BAAM,KAAKyL,GAAL,CAASspB,UAAT,CAAoBnoB,OAApB,EAA6BG,OAA7B,EAAsCyB,MAAM,CAACE,SAA7C,EAAwDF,MAAM,CAACG,QAA/D,CAAN;;;AAATlE,0B;AACN,yBAAKkC,OAAL,CAAa3M,GAAb,IAAoByK,MAApB;;;;;;;;AAGJ,yBAAKxL,MAAL,CAAY6C,IAAZ,CAAiB+L,aAAjB,CAA+BxO,IAA/B;;;;;;;;;AACH;;;;;;;uBA3UQi0B,W,EAAW,+G,EAAA,qH,EAAA,mH;AAAA,K;;;aAAXA,W;AAAW,eAAXA,WAAW,K;AAAA,kBAFR;;;;;sEAEHA,W,EAAW;cAHvB,wDAGuB;eAHZ;AACRD,oBAAU,EAAE;AADJ,S;AAGY,Q;;;;;;;;;;;;;;;;;;;;;;;;;;ACZxB;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;;QAKa+C,a,GAuFX,yBAAc;AAAA;;AAtFd;AACO,WAAAj3B,IAAA,GAAO;AACZC,mBAAW,EAAE,IAAI,0DAAJ;AADD,OAAP;AAIA,WAAAyN,MAAA,GAAS;AACdC,4BAAoB,EAAE,IAAI,0DAAJ,EADR;AAEdE,4BAAoB,EAAE,IAAI,0DAAJ,EAFR;AAGdE,+BAAuB,EAAE,IAAI,0DAAJ,EAHX;AAIdC,yBAAiB,EAAE,IAAI,0DAAJ;AAJL,OAAT,CAiFO,CA1Ed;;AACO,WAAAkpB,IAAA,GAAO;AACZC,qBAAa,EAAE,IAAI,0DAAJ;AADH,OAAP,CAyEO,CArEd;;AACO,WAAA90B,GAAA,GAAM;AACXpC,mBAAW,EAAE,IAAI,0DAAJ,EADF;AAEXuT,kBAAU,EAAE,IAAI,0DAAJ;AAFD,OAAN,CAoEO,CA/Dd;;AACO,WAAA9G,GAAA,GAAM;AACXuK,6BAAqB,EAAE,IAAI,0DAAJ,EADZ;AAEXG,8BAAsB,EAAE,IAAI,0DAAJ,EAFb;AAGXE,2BAAmB,EAAE,IAAI,0DAAJ,EAHV;AAIXD,6BAAqB,EAAE,IAAI,0DAAJ,EAJZ;AAKXrJ,yBAAiB,EAAE,IAAI,0DAAJ,EALR;AAMXuJ,2BAAmB,EAAE,IAAI,0DAAJ,EANV;AAQX7C,wBAAgB,EAAE,IAAI,0DAAJ,EARP;AASXiD,2BAAmB,EAAE,IAAI,0DAAJ,EATV;AAUXF,2BAAmB,EAAE,IAAI,0DAAJ,EAVV;AAYXO,wBAAgB,EAAE,IAAI,0DAAJ,EAZP;AAaXK,sBAAc,EAAE,IAAI,0DAAJ,EAbL;AAeXxD,uBAAe,EAAE,IAAI,0DAAJ,EAfN;AAgBXlI,uBAAe,EAAE,IAAI,0DAAJ;AAhBN,OAAN;AAmBA,WAAAa,OAAA,GAAU;AACfkC,eAAO,EAAE,IAAI,0DAAJ,EADM;AAEfO,eAAO,EAAE,IAAI,0DAAJ,EAFM;AAGfN,qBAAa,EAAE,IAAI,0DAAJ;AAHA,OAAV,CA2CO,CArCd;;AACO,WAAAhN,IAAA,GAAO;AACZ+L,qBAAa,EAAE,IAAI,0DAAJ,EADH;AAGZmC,uBAAe,EAAE,IAAI,0DAAJ,EAHL;AAKZG,yBAAiB,EAAE,IAAI,0DAAJ,EALP;AAMZD,oCAA4B,EAAE,IAAI,0DAAJ,EANlB;AAQZslB,4BAAoB,EAAE,IAAI,0DAAJ;AARV,OAAP,CAoCO,CAzBd;;AACO,WAAA9pB,KAAA,GAAQ;AACb8oB,4BAAoB,EAAE,IAAI,0DAAJ,EADT;AAEbE,4BAAoB,EAAE,IAAI,0DAAJ,EAFT;AAGbC,+BAAuB,EAAE,IAAI,0DAAJ,EAHZ;AAIbC,yBAAiB,EAAE,IAAI,0DAAJ,EAJN;AAKblkB,yBAAiB,EAAE,IAAI,0DAAJ,EALN;AAObskB,iCAAyB,EAAE,IAAI,0DAAJ,EAPd;AAQbC,gCAAwB,EAAE,IAAI,0DAAJ,EARb;AAUb9jB,8BAAsB,EAAE,IAAI,0DAAJ,EAVX;AAWbzB,0BAAkB,EAAE,IAAI,0DAAJ,EAXP;AAabiF,6BAAqB,EAAE,IAAI,0DAAJ,EAbV;AAcbC,6BAAqB,EAAE,IAAI,0DAAJ,EAdV;AAebC,yBAAiB,EAAE,IAAI,0DAAJ,EAfN;AAiBbigB,+BAAuB,EAAE,IAAI,0DAAJ;AAjBZ,OAAR;AAoBA,WAAArlB,MAAA,GAAS;AACdC,0BAAkB,EAAE,IAAI,0DAAJ;AADN,OAAT;AAIU,K;;;uBAvFN0mB,a;AAAa,K;;;aAAbA,a;AAAa,eAAbA,aAAa,K;AAAA,kBAFZ;;;;;sEAEDA,a,EAAa;cAHzB,wDAGyB;eAHd;AACV/C,oBAAU,EAAE;AADF,S;AAGc,Q;;;;;;;;;;;;;;;;;;;;ACL1B;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;;QAMakD,Y;;;AAoDX,4BAAmBt3B,MAAnB,EAA0C;AAAA;;AAAvB,aAAAA,MAAA,GAAAA,MAAA;AAnDnB,aAAAiU,YAAA,GAAe,IAAf;AACA,aAAAkE,YAAA,GAAe,IAAf;AACA,aAAApE,YAAA,GAAe,KAAf;AACA,aAAAG,YAAA,GAAe,IAAf;AAEA,aAAA5D,YAAA,GAAe,KAAf;AACA,aAAAC,WAAA,GAAc,EAAd;AAEA,aAAAf,sBAAA,GAA8B;AAC5B7B,iBAAO,EAAE,WADmB;AAE5BG,iBAAO,EAAE,eAFmB;AAG5BE,oBAAU,EAAE,UAHgB;AAI5BvD,cAAI,EAAE,QAJsB;AAK5B4D,mBAAS,EAAE,EALiB;AAM5BmD,yBAAe,EAAE;AANW,SAA9B;AASA,aAAAlE,wBAAA,GAAgC;AAC9BsK,sBAAY,EAAExK,SADgB;AAE9B0K,eAAK,EAAE1K,SAFuB;AAG9B2K,aAAG,EAAE3K,SAHyB;AAI9BzF,cAAI,EAAE;AAJwB,SAAhC;AAOA,aAAAyJ,uBAAA,GAA+B;AAC7B3B,mBAAS,EAAE,WADkB;AAE7BC,kBAAQ,EAAE,MAFmB;AAG7B0H,gBAAM,EAAE,OAHqB;AAI7B3M,cAAI,EAAE,QAJuB;AAK7ByM,kBAAQ,EAAE;AALmB,SAA/B;AAQA,aAAAjB,oBAAA,GAA4B;AAC1BC,qBAAW,EAAE,IADa;AAE1BoC,oBAAU,EAAE,IAFc;AAG1BnC,kBAAQ,EAAE,IAHgB;AAI1BohB,yBAAe,EAAE;AAJS,SAA5B;AAOA,aAAAzhB,oBAAA,GAA4B;AAC1BC,gBAAM,EAAE;AADkB,SAA5B;AAIA,aAAAU,qBAAA,GAAwB,EAAxB;AAEA,aAAAhJ,sBAAA,GAA8B,EAA9B;AAEA,aAAA+pB,iBAAA,GAAoB,CAApB;AAEA,aAAA5jB,eAAA,GAAkB,EAAlB;AAGE,aAAKrF,mBAAL;AACA,aAAKkpB,qBAAL;AAEA,aAAKC,qBAAL;AAEA,aAAKhD,kBAAL;AACA,aAAKiD,kBAAL;AACA,aAAKhD,qBAAL;AACD;;;;AAmCD;6CAEqB;AACnB,eAAK30B,MAAL,CAAYuC,GAAZ,CAAgBmR,UAAhB,CAA2BhF,SAA3B,CAAqC,KAAKkpB,qBAAL,CAA2BzzB,IAA3B,CAAgC,IAAhC,CAArC;AACD;;;8CAEqBsI,K,EAAO;AAC3B,eAAKmH,eAAL,GAAuBnH,KAAK,CAAC3D,IAA7B;AACA,eAAK9I,MAAL,CAAYyM,KAAZ,CAAkByF,sBAAlB,CAAyC9R,IAAzC,CAA8CqM,KAAK,CAACkH,MAApD;AACD,S,CAED;;;;gDAEwB;AACtB,eAAK3T,MAAL,CAAY4N,MAAZ,CAAmBC,oBAAnB,CAAwCa,SAAxC,CAAkD,KAAKmpB,yBAAL,CAA+B1zB,IAA/B,CAAoC,IAApC,CAAlD;AACA,eAAKnE,MAAL,CAAY4N,MAAZ,CAAmBG,oBAAnB,CAAwCW,SAAxC,CAAkD,KAAKopB,yBAAL,CAA+B3zB,IAA/B,CAAoC,IAApC,CAAlD;AACA,eAAKnE,MAAL,CAAY4N,MAAZ,CAAmBK,uBAAnB,CAA2CS,SAA3C,CAAqD,KAAKqpB,4BAAL,CAAkC5zB,IAAlC,CAAuC,IAAvC,CAArD;AACA,eAAKnE,MAAL,CAAY4N,MAAZ,CAAmBM,iBAAnB,CAAqCQ,SAArC,CAA+C,KAAKspB,sBAAL,CAA4B7zB,IAA5B,CAAiC,IAAjC,CAA/C;AACD,S,CAED;;;;6CAEqB;AACnB;AACA,eAAKnE,MAAL,CAAY4M,GAAZ,CAAgBiL,mBAAhB,CAAoCnJ,SAApC,CAA8C,KAAKupB,8BAAL,CAAoC9zB,IAApC,CAAyC,IAAzC,CAA9C;AACA,eAAKnE,MAAL,CAAY4M,GAAZ,CAAgB+K,mBAAhB,CAAoCjJ,SAApC,CAA8C,KAAKkpB,qBAAL,CAA2BzzB,IAA3B,CAAgC,IAAhC,CAA9C;AACA,eAAKnE,MAAL,CAAY4M,GAAZ,CAAgBgI,gBAAhB,CAAiClG,SAAjC,CAA2C,KAAKupB,8BAAL,CAAoC9zB,IAApC,CAAyC,IAAzC,CAA3C;AACA,eAAKnE,MAAL,CAAY4M,GAAZ,CAAgBsL,gBAAhB,CAAiCxJ,SAAjC,CAA2C,KAAKupB,8BAAL,CAAoC9zB,IAApC,CAAyC,IAAzC,CAA3C,EALmB,CAOnB;;AACA,eAAKnE,MAAL,CAAY4M,GAAZ,CAAgBuK,qBAAhB,CAAsCzI,SAAtC,CAAgD,KAAKwpB,6BAAL,CAAmC/zB,IAAnC,CAAwC,IAAxC,CAAhD;AACA,eAAKnE,MAAL,CAAY4M,GAAZ,CAAgB0K,sBAAhB,CAAuC5I,SAAvC,CAAiD,KAAKwpB,6BAAL,CAAmC/zB,IAAnC,CAAwC,IAAxC,CAAjD;AACA,eAAKnE,MAAL,CAAY4M,GAAZ,CAAgB2K,qBAAhB,CAAsC7I,SAAtC,CAAgD,KAAKwpB,6BAAL,CAAmC/zB,IAAnC,CAAwC,IAAxC,CAAhD;AACA,eAAKnE,MAAL,CAAY4M,GAAZ,CAAgB4K,mBAAhB,CAAoC9I,SAApC,CAA8C,KAAKwpB,6BAAL,CAAmC/zB,IAAnC,CAAwC,IAAxC,CAA9C;AACA,eAAKnE,MAAL,CAAY4M,GAAZ,CAAgBsB,iBAAhB,CAAkCQ,SAAlC,CAA4C,KAAKwpB,6BAAL,CAAmC/zB,IAAnC,CAAwC,IAAxC,CAA5C,EAZmB,CAcnB;;AACA,eAAKnE,MAAL,CAAY4M,GAAZ,CAAgB6K,mBAAhB,CAAoC/I,SAApC,CAA8C,KAAKypB,0BAAL,CAAgCh0B,IAAhC,CAAqC,IAArC,CAA9C,EAfmB,CAiBnB;;AACA,eAAKnE,MAAL,CAAY4M,GAAZ,CAAgB2L,cAAhB,CAA+B7J,SAA/B,CAAyC,KAAK0pB,0BAAL,CAAgCj0B,IAAhC,CAAqC,IAArC,CAAzC;AACA,eAAKnE,MAAL,CAAY4M,GAAZ,CAAgBmI,eAAhB,CAAgCrG,SAAhC,CAA0C,KAAKypB,0BAAL,CAAgCh0B,IAAhC,CAAqC,IAArC,CAA1C;AACA,eAAKnE,MAAL,CAAY4M,GAAZ,CAAgBC,eAAhB,CAAgC6B,SAAhC,CAA0C,KAAK2pB,2BAAL,CAAiCl0B,IAAjC,CAAsC,IAAtC,CAA1C;AACD;;;+CAEsBsI,K,EAAO;AAC5B,cAAMY,QAAQ,GAAG,KAAKmC,sBAAtB;AACA,eAAKA,sBAAL,GAA8BjC,MAAM,CAACC,MAAP,CAAcH,QAAd,EAAwBZ,KAAxB,CAA9B,CAF4B,CAI5B;;AACA,eAAKzM,MAAL,CAAYyM,KAAZ,CAAkBkpB,iBAAlB,CAAoCv1B,IAApC;AACD;;;kDAEyBqM,K,EAAO;AAC/B,cAAMY,QAAQ,GAAG,KAAKmC,sBAAtB;AACA,eAAKA,sBAAL,GAA8BjC,MAAM,CAACC,MAAP,CAAcH,QAAd,EAAwBZ,KAAxB,CAA9B,CAF+B,CAI/B;;AACA,eAAKzM,MAAL,CAAYyM,KAAZ,CAAkB8oB,oBAAlB,CAAuCn1B,IAAvC;AACD;;;kDAEyBqM,K,EAAO;AAC/B,cAAMY,QAAQ,GAAG,KAAKmC,sBAAtB;AACA,eAAKA,sBAAL,GAA8BjC,MAAM,CAACC,MAAP,CAAcH,QAAd,EAAwBZ,KAAxB,CAA9B,CAF+B,CAI/B;;AACA,eAAKzM,MAAL,CAAYyM,KAAZ,CAAkBgpB,oBAAlB,CAAuCr1B,IAAvC;AACD;;;qDAE4BqM,K,EAAO;AAClC,cAAMY,QAAQ,GAAG,KAAKmC,sBAAtB;AACA,eAAKA,sBAAL,GAA8BjC,MAAM,CAACC,MAAP,CAAcH,QAAd,EAAwBZ,KAAxB,CAA9B,CAFkC,CAIlC;;AACA,eAAKzM,MAAL,CAAYyM,KAAZ,CAAkBipB,uBAAlB,CAA0Ct1B,IAA1C;AACD;;;uDAE8BqM,K,EAAO;AACpC,cAAMY,QAAQ,GAAG,KAAKC,wBAAtB;AACA,eAAKA,wBAAL,GAAgCC,MAAM,CAACC,MAAP,CAAcH,QAAd,EAAwBZ,KAAxB,CAAhC,CAFoC,CAIpC;;AACA,eAAKzM,MAAL,CAAYyM,KAAZ,CAAkBspB,yBAAlB,CAA4C31B,IAA5C,CAAiDmN,MAAM,CAAC5N,IAAP,CAAY8M,KAAZ,EAAmB5G,QAAnB,CAA4B,MAA5B,CAAjD;AACD;;;sDAE6B4G,K,EAAO;AACnC,cAAMY,QAAQ,GAAG,KAAK+D,uBAAtB;AACA,eAAKA,uBAAL,GAA+B7D,MAAM,CAACC,MAAP,CAAcH,QAAd,EAAwBZ,KAAxB,CAA/B,CAFmC,CAInC;;AACA,eAAKzM,MAAL,CAAYyM,KAAZ,CAAkBupB,wBAAlB,CAA2C51B,IAA3C;AACD;;;mDAE0BqM,K,EAAO;AAChC,cAAMY,QAAQ,GAAG,KAAK4I,oBAAtB;AACA,eAAKA,oBAAL,GAA4B1I,MAAM,CAACC,MAAP,CAAcH,QAAd,EAAwBZ,KAAxB,CAA5B,CAFgC,CAIhC;;AACA,eAAKzM,MAAL,CAAYyM,KAAZ,CAAkBiJ,qBAAlB,CAAwCtV,IAAxC;AACD;;;mDAE0BqM,K,EAAO;AAChC,cAAMY,QAAQ,GAAG,KAAKyI,oBAAtB;AACA,eAAKA,oBAAL,GAA4BvI,MAAM,CAACC,MAAP,CAAcH,QAAd,EAAwBZ,KAAxB,CAA5B,CAFgC,CAIhC;;AACA,eAAKzM,MAAL,CAAYyM,KAAZ,CAAkBkJ,qBAAlB,CAAwCvV,IAAxC;AACD;;;oDAE2BqM,K,EAAO;AACjC,eAAKgK,qBAAL,GAA6BhK,KAA7B,CADiC,CAGjC;;AACA,eAAKzM,MAAL,CAAYyM,KAAZ,CAAkBmJ,iBAAlB,CAAoCxV,IAApC;AACD;;;gDAGuB;AACtB,eAAKJ,MAAL,CAAY0N,OAAZ,CAAoBkC,OAApB,CAA4BlB,SAA5B,CAAsC,KAAK4pB,sBAAL,CAA4Bn0B,IAA5B,CAAiC,IAAjC,CAAtC;AACA,eAAKnE,MAAL,CAAY0N,OAAZ,CAAoByC,OAApB,CAA4BzB,SAA5B,CAAsC,KAAK6pB,iBAAL,CAAuBp0B,IAAvB,CAA4B,IAA5B,CAAtC;AACD;;;+CAEsBsI,K,EAAO;AAAA,cACpB1L,GADoB,GACZ0L,KADY,CACpB1L,GADoB;;AAG5B,cAAI0L,KAAK,CAAC8C,MAAN,KAAiB,IAArB,EAA2B;AACzB,mBAAO,KAAK9B,sBAAL,CAA4B1M,GAA5B,CAAP;AACD,WAFD,MAEO;AACL,gBAAMsM,QAAQ,GAAG,KAAKI,sBAAL,CAA4B1M,GAA5B,KAAoC,EAArD;AACA,iBAAK0M,sBAAL,CAA4B1M,GAA5B,IAAmCwM,MAAM,CAACC,MAAP,CAAcH,QAAd,EAAwBZ,KAAK,CAAC8C,MAA9B,CAAnC;AACD;;AAED,eAAKvP,MAAL,CAAYyM,KAAZ,CAAkBopB,uBAAlB,CAA0Cz1B,IAA1C,CAA+CW,GAA/C;AACD;;;0CAEiB0L,K,EAAO;AAAA,cACf1L,GADe,GACP0L,KADO,CACf1L,GADe;AAGvB,cAAMsM,QAAQ,GAAG,KAAKI,sBAAL,CAA4B1M,GAA5B,KAAoC,EAArD;AACA,eAAK0M,sBAAL,CAA4B1M,GAA5B,IAAmCwM,MAAM,CAACC,MAAP,CAAcH,QAAd,EAAwBZ,KAAK,CAAC8C,MAA9B,CAAnC;AACD;;;8CAEqB;AACpB,eAAKvP,MAAL,CAAY6C,IAAZ,CAAiB0zB,oBAAjB,CAAsC7nB,SAAtC,CAAgD,KAAK6nB,oBAAL,CAA0BpyB,IAA1B,CAA+B,IAA/B,CAAhD;AACD;;;6CAEoBW,M,EAAgB;AACnC,cAAI0zB,GAAG,GAAG,CAAV;;AACA,iBAAQ1zB,MAAM,GAAG0zB,GAAV,GAAiB,KAAKviB,oBAAL,CAA0BshB,eAAlD,EAAmE;AACjEiB,eAAG,IAAI,CAAP;AACD;;AAED,eAAKviB,oBAAL,CAA0BC,WAA1B,GAAwC,CAAxC;AACA,eAAKD,oBAAL,CAA0BqC,UAA1B,GAAuCkgB,GAAvC;AACA,eAAKviB,oBAAL,CAA0BE,QAA1B,GAAqCtP,IAAI,CAACC,IAAL,CAAUhC,MAAM,GAAG0zB,GAAnB,CAArC;AACD;;;gDAEuB;AACtB,eAAKx4B,MAAL,CAAYwQ,MAAZ,CAAmBC,kBAAnB,CAAsC/B,SAAtC,CAAgD,KAAK+pB,iBAAL,CAAuBt0B,IAAvB,CAA4B,IAA5B,CAAhD;AACD;;;0CAEiBsI,K,EAAO;AACvB,eAAK6D,YAAL,GAAoB7D,KAAK,CAAC6D,YAA1B;AACA,eAAKC,WAAL,GAAmB9D,KAAK,CAAC8D,WAAzB;AAEA,eAAKvQ,MAAL,CAAYyM,KAAZ,CAAkBgE,kBAAlB,CAAqCrQ,IAArC;AACD;;;4BAvMiB;AAChB,cACE,KAAKoP,sBAAL,CAA4B7B,OAA5B,IACA,KAAKL,wBAAL,CAA8BsK,YAD9B,KAEC,KAAKtK,wBAAL,CAA8BwK,KAA9B,IAAuC,KAAKtI,sBAAL,CAA4BxB,UAA5B,KAA2C,aAFnF,KAGA,KAAKV,wBAAL,CAA8ByK,GAH9B,IAIA,KAAKzK,wBAAL,CAA8B3F,IALhC,EAME;AAAE,mBAAO,KAAP;AAAc;;AAElB,cACE,KAAK6H,sBAAL,CAA4B7B,OAA5B,IACA,KAAKL,wBAAL,CAA8BsK,YAD9B,IAEC,KAAKtK,wBAAL,CAA8BwK,KAA9B,IAAuC,KAAKtI,sBAAL,CAA4BxB,UAA5B,KAA2C,UAFnF,IAGA,KAAKV,wBAAL,CAA8B3F,IAJhC,EAKE;AAAE,mBAAO,OAAP;AAAgB;;AAEpB,cACE,KAAK6H,sBAAL,CAA4B7B,OAA5B,IACA,KAAKL,wBAAL,CAA8BsK,YAD9B,IAEA,KAAKtK,wBAAL,CAA8B3F,IAHhC,EAIE;AAAE,mBAAO,cAAP;AAAuB;;AAE3B,cACE,KAAK6H,sBAAL,CAA4B7B,OAD9B,EAEE;AAAE,mBAAO,SAAP;AAAkB;;AAEtB,iBAAO,SAAP;AACD;;;4BAEqB;AACpB,iBAAO,KAAK6pB,iBAAL,EAAP;AACD;;;;;;;uBA9FUF,Y,EAAY,qH;AAAA,K;;;aAAZA,Y;AAAY,eAAZA,YAAY,K;AAAA,kBAFX;;;;;sEAEDA,Y,EAAY;cAHxB,wDAGwB;eAHb;AACVlD,oBAAU,EAAE;AADF,S;AAGa,Q;;;;;;;;;;;;;;;;;;;;;;ACNzB;AAAA;;;AAAA;AAAA;AAAA,O,CAAA;AACA;AACA;;;AAEO,QAAMsE,WAAW,GAAG;AACzBC,gBAAU,EAAE,KADa;AAEzBnR,aAAO,EAAE,uBAFgB;AAGzBC,YAAM,EAAE;AAHiB,KAApB;AAMP;;;;;;;AAOA;;;;;;;;;;;;;;;;;ACjBA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;;AAMA,QAAI,sEAAYkR,UAAhB,EAA4B;AAC1B;AACD;;AAED,gFAAyBC,eAAzB,CAAyC,yDAAzC,EACGC,KADH,CACS,UAAAC,GAAG;AAAA,aAAIte,OAAO,CAAC8E,KAAR,CAAcwZ,GAAd,CAAJ;AAAA,KADZ","file":"main-es5.js","sourcesContent":["function webpackEmptyAsyncContext(req) {\n\t// Here Promise.resolve().then() is used instead of new Promise() to prevent\n\t// uncaught exception popping up in devtools\n\treturn Promise.resolve().then(function() {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t});\n}\nwebpackEmptyAsyncContext.keys = function() { return []; };\nwebpackEmptyAsyncContext.resolve = webpackEmptyAsyncContext;\nmodule.exports = webpackEmptyAsyncContext;\nwebpackEmptyAsyncContext.id = \"./$$_lazy_route_resource lazy recursive\";","import { Component, OnInit } from '@angular/core';\nimport { EventsService } from './services/events.service';\n\n@Component({\n  selector: 'app-root',\n  templateUrl: './app.component.html',\n})\nexport class AppComponent implements OnInit {\n  title = 'Pluto Vis';\n\n  constructor(public events: EventsService) { }\n\n  ngOnInit() {\n    this.events.root.initialized.emit();\n  }\n}\n","<!-- Mapview component -->\n<app-map></app-map>\n<!-- Visualization components -->\n<app-vis></app-vis>\n<app-filter></app-filter>\n<!-- Assessory components -->\n<app-menu></app-menu>\n<app-legend></app-legend>\n","import { NgModule } from '@angular/core';\nimport { BrowserModule } from '@angular/platform-browser';\nimport { BrowserAnimationsModule } from '@angular/platform-browser/animations';\n\nimport { MaterialModule } from './material/material.module';\n\nimport { AppComponent } from './app.component';\nimport { MapComponent } from './components/map/map.component';\nimport { VisComponent } from './components/vis/vis.component';\nimport { MenuComponent } from './components/menu/menu.component';\nimport { LegendComponent } from './components/legend/legend.component';\nimport { FilterComponent } from './components/filter/filter.component';\nimport { ConfigComponent } from './components/config/config.component';\nimport { TooltipComponent } from './components/tooltip/tooltip.component';\nimport { LayersComponent } from './components/layers/layers.component';\n\n@NgModule({\n  declarations: [\n    AppComponent,\n    MapComponent,\n    VisComponent,\n    MenuComponent,\n    LegendComponent,\n    FilterComponent,\n    ConfigComponent,\n    TooltipComponent,\n    LayersComponent,\n  ],\n  imports: [\n    BrowserModule,\n    BrowserAnimationsModule,\n    MaterialModule\n  ],\n  providers: [],\n  bootstrap: [AppComponent]\n})\nexport class AppModule { }\n","import * as d3 from 'd3';\nimport { min } from 'd3';\n\nexport class Bar {\n  // chart data\n  protected _data: any = null;\n\n  // Chart div\n  protected _chartDiv: HTMLElement = null;\n  // Svg element\n  protected _svgCanvas: any = null;\n  // Group element\n  protected _svgGroup: any = null;\n\n  // margin object\n  protected _margin = { top: 10, right: 15, bottom: 75, left: 70 };\n\n  // svg width\n  protected _width: number;\n  // charts height\n  protected _height: number;\n\n  // scales and axis\n  protected _xScale: any = null;\n  protected _yScale: any = null;\n  // ----\n  protected _xAxis: any = null;\n  protected _yAxis: any = null;\n\n  // brush object\n  protected _brush = d3.brushX();\n  protected _brushedBins = [];\n\n  // callbacks\n  protected _callbacks = null;\n  protected _key = null;\n\n  // label\n  protected labelFormat = (label) => {\n    let parts = label.split('-');\n\n    if (isNaN(+parts[0])) {\n      return label.split(',').join('-');\n    }\n\n    parts = parts.map(el => d3.format('.2s')(el));\n    return parts.join('-');\n  }\n\n  constructor(chartDiv: HTMLElement, callbacks: any, key: string) {\n    this._chartDiv = chartDiv;\n    this._callbacks = callbacks;\n    this._key = key;\n\n    this.initSvgAndGroups();\n    this.initScalesAndAxes();\n    this.initWindowEvents();\n    this.initBrush();\n  }\n\n  setData(data: any, brush: any) {\n    this._data = data;\n    this._brushedBins = brush;\n  }\n\n  render() {\n    this.updateScales();\n    this.updateAxes();\n    this.updateBars();\n    this.initBrush();\n  }\n\n  resize() {\n    this._svgCanvas.remove();\n\n    this.initSvgAndGroups();\n    this.initScalesAndAxes();\n    this.render();\n  }\n\n\n  initSvgAndGroups() {\n    // dimensions using margins convention\n    this._width = this._chartDiv.clientWidth - this._margin.left - this._margin.right;\n    this._height = this._chartDiv.clientHeight - this._margin.top - this._margin.bottom;\n\n    // creates the new canvas element\n    this._svgCanvas = d3.select(this._chartDiv)\n      .append('svg')\n      .attr('width', this._chartDiv.clientWidth)\n      .attr('height', this._chartDiv.clientHeight);\n\n    // creates the group\n    this._svgGroup = this._svgCanvas\n      .append('g')\n      .attr('class', 'svgGroup')\n      .attr('transform', 'translate(' + this._margin.left + ',' + this._margin.top + ')');\n\n    // axis groups\n    this._svgGroup\n      .append('g')\n      .attr('class', 'axis axis--x')\n      .attr('transform', 'translate(0,' + (this._height) + ')');\n\n    this._svgGroup\n      .append('g')\n      .attr('class', 'brush')\n\n    this._svgGroup\n      .append('g')\n      .attr('class', 'axis axis--y');\n\n    // text label for the x axis\n    this._svgGroup\n      .append(\"text\")\n      .attr('class', 'xaxis-label')\n      .attr(\"transform\", `translate(${\n        this._width / 2\n        }, ${\n        this._height + this._margin.top + 45\n        })`)\n      .style(\"text-anchor\", \"middle\")\n      .text(\"attribute bins\");\n\n    // text label for the y axis\n    this._svgGroup\n      .append(\"text\")\n      .attr('class', 'yaxis-label')\n      .attr(\"transform\", \"rotate(-90)\")\n      .attr(\"y\", 0 - this._margin.left + 10)\n      .attr(\"x\", 0 - this._height / 2)\n      .attr(\"dy\", \"1em\")\n      .style(\"text-anchor\", \"middle\")\n      .text(`frequency`);\n\n  }\n\n  initScalesAndAxes() {\n    this._xScale = d3.scaleBand().range([0, this._width]).padding(0.1);\n    this._xAxis = d3.axisBottom(this._xScale).tickFormat(this.labelFormat);\n\n    this._yScale = d3.scaleLinear().range([this._height, 0]);\n    this._yAxis = d3.axisLeft(this._yScale).ticks(10, \"~s\");\n  }\n\n  initWindowEvents() {\n    window.addEventListener('resize', this.resize.bind(this));\n  }\n\n  updateScales() {\n    const bins = this._data.map(obj => `${obj.bin}`);\n    const extent = d3.extent(this._data.map(obj => obj.count));\n\n    // sets the domains\n    this._xScale.domain(bins);\n    this._yScale.domain(extent);\n  }\n\n  updateAxes() {\n    const bins = this._data.map(obj => `${obj.bin}`);\n\n    this._xAxis.scale(this._xScale);\n    this._svgGroup.select('.axis--x').call(this._xAxis)\n      .selectAll('text')\n      .style('text-anchor', 'end')\n      .attr('font-size', () => {\n        if (bins.length > 20) {\n          return '8px'\n        }\n        return '10px';\n      })\n      .attr('dx', '-.8em')\n      .attr('dy', () => bins.length > 20 ? '-.8em' : '.15em')\n      .attr('transform', () => {\n        if (bins.length > 20) {\n          return 'rotate(-90)'\n        }\n        return 'rotate(-25)'\n      });\n\n    this._yAxis.scale(this._yScale);\n    this._svgGroup.select('.axis--y').call(this._yAxis);\n  }\n\n  updateBars() {\n    const barsGroup = this._svgGroup\n      .selectAll(\".line-group\")\n      .data([this._data])\n      .join(\"g\");\n\n    barsGroup\n      .attr('class', 'line-group');\n\n    const rects = barsGroup\n      .selectAll(\"rect\")\n      .data(d => d)\n      .join(\"rect\");\n\n    rects\n      .attr('class', 'bar')\n      .attr(\"x\", d => this._xScale(`${d.bin}`))\n      .attr(\"y\", d => this._yScale(d.count))\n      .attr(\"width\", this._xScale.bandwidth())\n      .attr(\"height\", d => this._height - this._yScale(d.count))\n      .attr(\"fill\", \"#673ab7\");\n  }\n\n  initBrush() {\n    this._brush\n      .on(\"start brush end\", this.barChartOnBrush.bind(this))\n      .extent([[0, 0], [this._width, this._height]]);\n\n    this._svgGroup.select('.brush').call(this._brush);\n\n    if (this._brushedBins.length) {\n      const first = this._brushedBins[0];\n      const final = this._brushedBins[this._brushedBins.length - 1];\n      const range = [this._xScale(first) - this._xScale.paddingInner(), this._xScale(final) + this._xScale.bandwidth()];\n\n      this._svgGroup.select(\".brush\").call(this._brush.move, range);\n    }\n  }\n\n  barChartOnBrush() {\n    const selection = d3.event.selection;\n\n    const rects = this._svgGroup\n      .selectAll(\".line-group\")\n      .selectAll(\".bar\")\n\n    if (selection) {\n      const range = this._xScale.domain().map(this._xScale);\n\n      const i0 = d3.bisectRight(range, selection[0]);\n      const i1 = d3.bisectRight(range, selection[1]);\n\n      this._brushedBins = this._xScale.domain().slice(i0, i1);\n    } else {\n      this._brushedBins = [];\n    }\n\n    rects.attr(\"fill\", d => this._brushedBins.includes(d.bin) ? \"#f44336\" : \"#673ab7\");\n\n    const event = { value: this._brushedBins };\n    this._callbacks.brush(this._key, event);\n  }\n}","import * as d3 from 'd3';\n\nexport class Cmap {\n  // chart data\n  protected _data: any = {};\n\n  // Chart div\n  protected _chartDiv: HTMLElement = null;\n  // Svg element\n  protected _svgCanvas: any = null;\n  // Group element\n  protected _svgGroup: any = null;\n\n  // margin object\n  protected _margin = { top: 0, right: 20, bottom: 30, left: 16 };\n\n  // svg width\n  protected _width: number;\n  // charts height\n  protected _height: number;\n\n  // scales and axis\n  protected _xScale: any = null;\n  protected _cScale: any = null;\n  protected _xAxis: any = null;\n\n  // number of colors\n  protected N_COLORS = 40;\n\n  // Is Alive : the lot existis in the selected year\n  // Is Active: the lot fits the filter condition \n  // Is Valid : the selected attribute is a valid value in the lot\n  protected ALIVE_COLOR = d3.color('#8f8f8f');\n  protected ACTVE_COLOR = d3.color('#afafaf');\n  protected VALID_COLOR = d3.color('#cfcfcf');\n\n  protected ALIVE_LABEL = 'A';\n  protected ACTVE_LABEL = 'F';\n  protected VALID_LABEL = 'V';\n\n  // format\n  protected tickFormat = (val) => {\n    if ( isNaN(val) ) {\n        return val;\n    }\n    else {\n        return d3.format('.2s')(val);\n    }\n  }\n\n\n  constructor(chartDiv: HTMLElement) {\n    this._chartDiv = chartDiv;\n\n    this.initSvgAndGroups();\n    this.initScalesAndAxes();\n    this.initWindowEvents();\n  }\n\n  initWindowEvents() {\n    window.addEventListener('resize', this.resize.bind(this));\n  }\n\n\n  setData(minMax: any) {\n\n    let zero = 0;\n\n    if (minMax[0] < 0 && minMax[1] > 0) {\n      zero = 0\n    } else if (minMax[0] >= 0 && minMax[1] > 0) {\n      zero = minMax[0];\n    } else if (minMax[0] < 0 && minMax[1] <= 0) {\n      zero = minMax[1];\n    }\n    \n    if (minMax[0] !== minMax[1]) {\n      let frac = Math.ceil( this.N_COLORS * (zero - minMax[0]) / (minMax[1] - minMax[0]) );\n      \n      if (frac < 5) {\n        frac = 5;\n      }\n      if (frac > this.N_COLORS - 5) {\n        frac = this.N_COLORS - 5; \n      }\n\n      this._data.values = [];\n      \n      for (let id = 0; id < frac; id ++) {\n        const val = minMax[0] + id * (zero - minMax[0]) / (frac - 1);\n        this._data.values.push(val.toFixed(3)) \n      }\n  \n      for (let id = 0; id < this.N_COLORS - frac; id ++) {\n        const val = zero + id * (minMax[1] - zero) / (this.N_COLORS - frac - 1);\n        this._data.values.push(val.toFixed(3)) \n      }\n  \n      this._data.minMax = minMax.map(el => el.toFixed(3));\n      this._data.zero = zero.toFixed(3);  \n    } \n    else {\n      this._data.minMax = minMax;\n      this._data.zero = minMax[0];\n      this._data.values = [this._data.zero];\n    }\n\n    this._data.values.unshift(this.ALIVE_LABEL, this.ACTVE_LABEL, this.VALID_LABEL);\n  }\n\n  render() {\n    this.updateScales();\n    this.updateAxes();\n    this.updateRectangles();\n  }\n\n  resize() {\n    this._svgCanvas.remove();\n\n    this.initSvgAndGroups();\n    this.initScalesAndAxes();\n    this.render();\n  }\n\n  initSvgAndGroups() {\n    // dimensions using margins convention\n    this._width = this._chartDiv.clientWidth - this._margin.left - this._margin.right;\n    this._height = this._chartDiv.clientHeight - this._margin.top - this._margin.bottom;\n\n    // creates the new canvas element\n    this._svgCanvas = d3.select(this._chartDiv)\n      .append('svg')\n      .attr('width', this._chartDiv.clientWidth)\n      .attr('height', this._chartDiv.clientHeight);\n\n    // creates the group\n    this._svgGroup = this._svgCanvas\n      .append('g')\n      .attr('class', 'svgGroup')\n      .attr('transform', 'translate(' + this._margin.left + ',' + this._margin.top + ')');\n\n    // axis groups\n    this._svgGroup\n      .append('g')\n      .attr('class', 'axis axis--x')\n      .attr('transform', 'translate(0,' + (this._height) + ')');\n  }\n\n  initScalesAndAxes() {\n    this._xScale = d3.scaleBand().range([0, this._width]).padding(0.0);\n    this._xAxis = d3.axisBottom(this._xScale);\n    this._cScale = d3.scaleDiverging(d3.interpolateRdBu);\n  }\n\n  updateScales() {\n    this._xScale.domain(this._data.values);\n\n    this._cScale.domain([\n      this._data.minMax[0], this._data.zero, this._data.minMax[1]\n    ]);\n  }\n\n  updateAxes() {\n    this._xAxis.scale(this._xScale).tickValues([\n        this.ALIVE_LABEL,\n        this.ACTVE_LABEL,\n        this.VALID_LABEL,\n        this._data.minMax[0],\n        this._data.zero,\n        this._data.minMax[1]\n      ]);\n\n      this._svgGroup.select('.axis--x').call(this._xAxis.tickFormat(this.tickFormat))\n      .selectAll('text')\n      .style('text-anchor', 'end')\n      .attr('dy', '.5em')\n      .attr('dx', '-.25em')\n      .attr('transform', 'rotate(-35)');\n    \n      this._svgGroup.select('.axis--x').select(\".domain\").remove();\n  }\n\n  updateRectangles() {\n    const cmap = this._svgGroup\n      .selectAll(\".cmap-group\")\n      .data([this._data.values])\n      .join(\"g\");\n    \n    cmap.attr(\"class\", \"cmap-group\");\n\n    const rects = cmap\n      .selectAll(\"rect\")\n      .data(d => d)\n      .join(\"rect\");\n\n    rects\n      .attr(\"x\", d =>this._xScale(d))\n      .attr(\"y\", 0)\n      .attr(\"width\", this._xScale.bandwidth())\n      .attr(\"height\", this._height)\n      .attr(\"fill\", d => {\n        if(d === this.ALIVE_LABEL) {\n            return this.ALIVE_COLOR;\n        }\n        else if (d === this.VALID_LABEL) {\n            return this.VALID_COLOR;\n        }\n        else if (d === this.ACTVE_LABEL) {\n            return this.ACTVE_COLOR;\n        }\n        else {\n            return this._cScale(d);\n        }\n      })\n      .attr(\"stroke\", \"none\");\n  }\n}","import * as d3 from 'd3';\n\nexport class Line {\n  // chart data\n  protected _data: any = null;\n\n  // Chart div\n  protected _chartDiv: HTMLElement = null;\n  // Svg element\n  protected _svgCanvas: any = null;\n  // Group element\n  protected _svgGroup: any = null;\n\n  // margin object\n  protected _margin = { top: 40, right: 35, bottom: 60, left: 125 };\n\n  // svg width\n  protected _width: number;\n  // charts height\n  protected _height: number;\n\n  // scales and axis\n  protected _xScale: any = null;\n  protected _yScale: any = null;\n  protected _cScale: any = null;\n\n  protected _yLabel: string = '';\n\n  // ----\n  protected _xAxis: any = null;\n  protected _yAxis: any = null;\n\n  // callbacks\n  protected _callbacks = null;\n\n  // d3's line generator\n  protected _line = d3.line()\n    .x((d: any) => this._xScale(d.year))\n    .y((d: any) => this._yScale(d.value))\n    .curve(d3.curveLinear)\n    .defined(function (d: any) { return d.valid; })\n\n  constructor(chartDiv: HTMLElement, callbacks: any, defaults: any) {\n    this._chartDiv = chartDiv;\n    this._callbacks = callbacks;\n    this._yLabel = defaults.yLabel;\n\n    this.initSvgAndGroups();\n    this.initScalesAndAxes();\n    this.initWindowEvents();\n  }\n\n  setData(data: any, years: any) {\n    this._data = data;\n    this._data.years = years;\n  }\n\n  setYLabel(label: string) {\n    this._yLabel = label;\n  }\n\n  render() {\n    this.updateScales();\n    this.updateAxes();\n    this.updateLines();\n    this.updateLegend();\n  }\n\n  resize() {\n    this._svgCanvas.remove();\n\n    this.initSvgAndGroups();\n    this.initScalesAndAxes();\n    this.render();\n  }\n\n\n  initSvgAndGroups() {\n    // dimensions using margins convention\n    this._width = this._chartDiv.clientWidth - this._margin.left - this._margin.right;\n    this._height = this._chartDiv.clientHeight - this._margin.top - this._margin.bottom;\n\n    // creates the new canvas element\n    this._svgCanvas = d3.select(this._chartDiv)\n      .append('svg')\n      .attr('width', this._chartDiv.clientWidth)\n      .attr('height', this._chartDiv.clientHeight);\n\n    // creates the group\n    this._svgGroup = this._svgCanvas\n      .append('g')\n      .attr('class', 'svgGroup')\n      .attr('transform', 'translate(' + this._margin.left + ',' + this._margin.top + ')');\n\n    this._svgGroup\n      .append('g')\n      .attr('class', 'legend')\n      .attr('transform', 'translate(0, 0)');\n\n    // axis groups\n    this._svgGroup\n      .append('g')\n      .attr('class', 'axis axis--x')\n      .attr('transform', 'translate(0,' + (this._height) + ')');\n\n    this._svgGroup\n      .append('g')\n      .attr('class', 'axis axis--y');\n\n    // text label for the x axis\n    this._svgGroup\n      .append(\"text\")\n      .attr('class', 'xaxis-label')\n      .attr(\"transform\", `translate(${\n        this._width / 2\n        }, ${\n        this._height + this._margin.top + 15\n        })`)\n      .style(\"text-anchor\", \"middle\")\n      .text(() => {\n            const parts = this._yLabel.split(' ');\n            if (parts[parts.length - 1] === 'change') {\n                return `${parts[0]} ${parts[1]} value matrix`;\n            }\n            if (parts[parts.length - 1] === 'value') {\n                return `${parts[0]} ${parts[1]} change matrix`;\n            }\n      });\n\n    // text label for the y axis\n    this._svgGroup\n      .append(\"text\")\n      .attr('class', 'yaxis-label')\n      .attr(\"transform\", \"rotate(-90)\")\n      .attr(\"y\", 0 - this._margin.left / 2)\n      .attr(\"x\", 0 - (this._height / 2))\n      .attr(\"dy\", \"1em\")\n      .style(\"text-anchor\", \"middle\")\n      .text(`${this._yLabel}`);\n  }\n\n  initScalesAndAxes() {\n    this._xScale = d3.scalePoint().range([0, this._width]).padding(0.2);\n    this._xAxis = d3.axisBottom(this._xScale);\n\n    this._yScale = d3.scaleLinear().range([this._height, 0]);\n    this._yAxis = d3.axisLeft(this._yScale);\n\n    this._cScale = d3.scaleOrdinal(d3.schemeCategory10);\n  }\n\n  initWindowEvents() {\n    window.addEventListener('resize', this.resize.bind(this));\n  }\n\n  updateScales() {\n    const years = this._data.years;\n\n    let range = [Number.MAX_VALUE, Number.MIN_VALUE];\n    this._data.lines.forEach(line => {\n      const vals = line.data.map(el => el.value);\n\n      const min = Math.min(...vals);\n      const max = Math.max(...vals);\n\n      range[0] = Math.min(range[0], min);\n      range[1] = Math.max(range[1], max);\n    });\n\n    if (this._data.lines.length === 0) {\n      range = this._data.minMax;\n    }\n\n    // sets the domains\n    this._xScale.domain(years);\n    this._yScale.domain(range);\n\n    const names = this._data.lines.map(obj => obj.name);\n    this._cScale.domain(names);\n  }\n\n  updateAxes() {\n    this._xAxis.scale(this._xScale);\n    this._svgGroup.select('.axis--x').call(this._xAxis)\n      .selectAll('text')\n      .style('text-anchor', 'end')\n      .attr('dx', '-.8em')\n      .attr('dy', '.15em')\n      .attr('transform', 'rotate(-25)');\n\n    this._yAxis.scale(this._yScale);\n    this._svgGroup.select('.axis--y').call(this._yAxis.tickFormat(d3.format(\".2s\")));\n\n    this._svgGroup.select('.yaxis-label').text(`${this._yLabel}`)\n    this._svgGroup.select('.xaxis-label').text(() => {\n        const parts = this._yLabel.split(' ');\n        if (parts[parts.length - 1] === 'change') {\n            return `${parts[0]} ${parts[1]} value matrix`;\n        }\n        if (parts[parts.length - 1] === 'value') {\n            return `${parts[0]} ${parts[1]} change matrix`;\n        }\n    });\n  }\n\n  updateLines() {\n    const lines = this._svgGroup.selectAll('.curve')\n      .data(this._data.lines)\n      .join('path');\n\n    lines\n      .attr(\"class\", \"curve\")\n      .attr(\"d\", d => this._line(d.data))\n      .attr(\"stroke\", d => this._cScale(d.name));\n  }\n\n  updateLegend() {\n    const elements = this._svgGroup.select('.legend')\n      .selectAll('.legend-element')\n      .data(this._data.lines)\n      .join('g')\n      .attr('transform', (d, i) => `translate(${this._width / 4 + i * (3 * this._width / 4) / this._data.lines.length}, ${-this._margin.top / 2})`);\n\n    elements\n      .attr('class', 'legend-element')\n      .attr('width', 3 * this._width / 4 / this._data.lines.length)\n\n\n    const circles = elements\n      .selectAll('circle')\n      .data(d => [d.name])\n      .join('circle');\n\n    circles\n      .attr('r', 6)\n      .attr('fill', d => this._cScale(d))\n\n    const labels = elements\n      .selectAll('text')\n      .data(d => [d.name])\n      .join('text');\n\n    let width = (this._width / 4) / this._data.lines.length;\n    let lSize = 20;\n\n    labels\n      .attr('class', 'legend-text')\n      .attr('text-anchor', 'start')\n      .attr('x', 15)\n      .attr('y', 5)\n      .text(d => {\n        const content = d.length > lSize ? d.slice(0, lSize) + '...' : d;\n        return content;\n      })\n      .text(function (d) {\n        const content = d.length > lSize ? d.slice(0, lSize) + '...' : d;\n        const size = this.getComputedTextLength();\n        return size < width ? content : content.slice(0, lSize * width / size) + '...';\n      })\n      .on('mouseover', d => {\n        const mouse = [d3.event.pageX+10, d3.event.pageY+10];\n        this._callbacks.lHover({line: d, mouse});\n      })\n      .on('mouseout', this._callbacks.svgOut);\n  }\n}","import * as d3 from 'd3';\n\nexport class Matrix {\n    // chart data\n    protected _data: any = null;\n\n    // Chart div\n    protected _chartDiv: HTMLElement = null;\n    // Svg element\n    protected _svgCanvas: any = null;\n    // Group element\n    protected _svgGroup: any = null;\n\n    // margin object\n    protected _margin = { top: 10, right: 35, bottom: 40, left: 125 };\n\n    // svg width\n    protected _width: number;\n    // charts height\n    protected _height: number;\n\n    // scales and axis\n    protected _xScale: any = null;\n    protected _yScale: any = null;\n    protected _cScale: any = null;\n    protected _lScale: any = null;\n    // ----\n    protected _xAxis: any = null;\n    protected _yAxis: any = null;\n\n    // labels on y axis\n    protected Y_LABEL_SIZE = 22;\n\n    // Is Alive : the lot existis in the selected year\n    // Is Active: the lot fits the filter condition \n    // Is Valid : the selected attribute is a valid value in the lot\n    protected ALIVE_COLOR = d3.color('#8f8f8f');\n    protected ACTVE_COLOR = d3.color('#afafaf');\n    protected VALID_COLOR = d3.color('#cfcfcf');\n\n    protected MODE = null;\n\n    // callback enabled\n    protected _yCallbackEnabled = true;\n\n    // selected labels\n    protected _xLabelSelected = null;\n    protected _yLabelSelected = null;\n\n    protected _sortIconSelected = null;\n    protected _lineIconSelected = [];\n\n\n    // callbacks\n    protected _callbacks = null;\n\n    constructor(chartDiv: HTMLElement, callbacks: any, defaults: any) {\n        this._chartDiv = chartDiv;\n        this._callbacks = callbacks;\n\n        this._xLabelSelected = defaults.xLabel;\n        this._yLabelSelected = null;\n\n        this._sortIconSelected = defaults.sIcon;\n        this._lineIconSelected = defaults.lIcon;\n\n        this.initSvgAndGroups();\n        this.initScalesAndAxes();\n        this.initWindowEvents();\n    }\n\n    setData(data: any, mode: string, line: any, sort: string, click: boolean) {\n        this.MODE = mode;\n        this._data = data;\n        this._lineIconSelected = line;\n        this._sortIconSelected = sort;\n        this._yCallbackEnabled = click;\n    }\n\n    setHighlight(label: string) {\n        this._yLabelSelected = label;\n    }\n\n    render() {\n        this.updateScales();\n        this.updateAxes();\n\n        this.updateRectangles();\n        this.updateSortIcons();\n        this.updateLineIcons();\n\n        this.highlightSortIcon();\n        this.highlightLineIcon();\n\n        this.highlightXLabel();\n        this.highlightYLabel();\n    }\n\n    resize() {\n        this._svgCanvas.remove();\n\n        this.initSvgAndGroups();\n        this.initScalesAndAxes();\n        this.render();\n    }\n\n    initSvgAndGroups() {\n        // dimensions using margins convention\n        this._width = this._chartDiv.clientWidth - this._margin.left - this._margin.right;\n        this._height = this._chartDiv.clientHeight - this._margin.top - this._margin.bottom;\n\n        // creates the new canvas element\n        this._svgCanvas = d3.select(this._chartDiv)\n            .append('svg')\n            .attr('width', this._chartDiv.clientWidth)\n            .attr('height', this._chartDiv.clientHeight)\n            .on('mouseout', this._callbacks.svgOut);\n\n        // creates the group\n        this._svgGroup = this._svgCanvas\n            .append('g')\n            .attr('class', 'svgGroup')\n            .attr('transform', 'translate(' + this._margin.left + ',' + this._margin.top + ')');\n\n        // axis groups\n        this._svgGroup\n            .append('g')\n            .attr('class', 'axis axis--x')\n            .attr('transform', 'translate(0,' + (this._height) + ')');\n\n        this._svgGroup\n            .append('g')\n            .attr('class', 'axis axis--y');\n\n        // icons groups\n        this._svgGroup\n            .append('g')\n            .attr('class', 'sort-icons-group')\n\n        this._svgGroup\n            .append('g')\n            .attr('class', 'line-icons-group')\n    }\n\n    initScalesAndAxes() {\n        this._xScale = d3.scaleBand().range([0, this._width]).padding(0.075);\n        this._xAxis = d3.axisBottom(this._xScale);\n\n        this._yScale = d3.scaleBand().range([this._height, 0]).paddingInner(0.075).paddingOuter(0.25).align(1.0);\n        this._yAxis = d3.axisLeft(this._yScale);\n\n        this._cScale = d3.scaleDiverging(d3.interpolateRdBu);\n        this._lScale = d3.scaleOrdinal(d3.schemeCategory10);\n    }\n\n    initWindowEvents() {\n        window.addEventListener('resize', this.resize.bind(this));\n    }\n\n    updateScales() {\n        const keys = this._data.map(obj => obj.key);\n        if (keys.length < 1) { return; }\n\n        const polys = this._data[0].value.map(obj => obj.name);\n        if (polys.length < 1) { return; }\n\n        // sets the domains\n        this._xScale.domain(keys);\n        this._yScale.domain(polys);\n\n        let zero = 0;\n        if (this._data.minMax[0] < 0 && this._data.minMax[1] > 0) {\n            zero = 0\n        } else if (this._data.minMax[0] >= 0 && this._data.minMax[1] > 0) {\n            zero = this._data.minMax[0];\n        } else if (this._data.minMax[0] < 0 && this._data.minMax[1] <= 0) {\n            zero = this._data.minMax[1];\n        }\n\n        this._cScale.domain([\n            this._data.minMax[0], zero, this._data.minMax[1]\n        ]);\n        this._lScale.domain(this._lineIconSelected);\n    }\n\n    updateAxes() {\n        this._xAxis.scale(this._xScale);\n        this._svgGroup.select('.axis--x').call(this._xAxis)\n            .selectAll('text')\n            .style('text-anchor', 'end')\n            .style('pointer-events', 'auto')\n            .style('cursor', 'pointer')\n            .attr('dx', '-.8em')\n            .attr('dy', '.15em')\n            .attr('transform', 'rotate(-25)')\n            .on('click', d => {\n                this._xLabelSelected = d;\n                this._callbacks.xLabel(d);\n                this.highlightXLabel();\n            });\n\n\n        this._yAxis.scale(this._yScale);\n        const texts = this._svgGroup.select('.axis--y').call(this._yAxis)\n            .selectAll('text')\n            .text(d => {\n                if (d.length > this.Y_LABEL_SIZE) {\n                    return `${d.substring(0, this.Y_LABEL_SIZE - 3)}...`;\n                }\n                return d;\n            })\n            .style('pointer-events', 'auto')\n            .style('cursor', 'not-allowed')\n            .on('mouseover', d => {\n                let current = this._data[0].value.filter(obj => obj.name === d);\n                current = current.length > 0 ? current[0].name : '';\n\n                this._yLabelSelected = current;\n                this._callbacks.yHover(current);\n                this.highlightYLabel();\n            })\n\n        if (this._yCallbackEnabled) {\n            texts\n                .style('cursor', 'pointer')\n                .on('click', d => this._callbacks.yLabel(d));\n\n        }\n    }\n\n    updateRectangles() {\n        const polys = this._svgGroup\n            .selectAll(\".line-group\")\n            .data(this._data)\n            .join(\"g\");\n\n        polys\n            .attr('class', 'line-group')\n            .attr('transform', d => `translate(${this._xScale(d.key)}, 0)`);\n\n        const rects = polys\n            .selectAll(\"rect\")\n            .data(d => d.value)\n            .join(\"rect\");\n\n        rects\n            .attr(\"y\", d => this._yScale(d.name))\n            .attr(\"width\", this._xScale.bandwidth())\n            .attr(\"height\", this._yScale.bandwidth())\n            .attr(\"fill\", d => {\n                if (this.MODE === 'value') {\n                    if (!d.isAlive) {\n                        return this.ALIVE_COLOR;\n                    }\n                    else if (!d.isActive) {\n                        return this.ACTVE_COLOR;\n                    }\n                    else if (!d.isValid) {\n                        return this.VALID_COLOR;\n                    }\n                    else {\n                        return this._cScale(d[this.MODE]);\n                    }\n                }\n\n                else if (this.MODE === 'change') {\n                    if (!d.isAlive) {\n                        return this.ALIVE_COLOR;\n                    }\n                    else if (!d.isActive) {\n                        return this.ACTVE_COLOR;\n                    }\n                    else if (!d.changeValid) {\n                        return this.VALID_COLOR;\n                    }\n                    else {\n                        return this._cScale(d[this.MODE]);\n                    }\n                }\n            })\n            .on('mouseover', (d, i, nodes) => {\n                const year = nodes[i].parentNode.__data__.key;\n                const mouse = [d3.event.pageX + 10, d3.event.pageY + 10];\n                this._callbacks.rHover({ year, data: d, mouse });\n            });\n    }\n\n    updateSortIcons() {\n        const icons = this._svgGroup.select('.sort-icons-group')\n            .selectAll(\"path\")\n            .data(this._data)\n            .join(\"path\");\n\n        icons\n            .attr(\"d\", d3.symbol().type(d3.symbolTriangle).size(100))\n            .style('pointer-events', 'auto')\n            .style('cursor', 'pointer')\n            .attr('transform', d => {\n                return `rotate(180) translate(${-this._xScale(d.key) - 0.5 * this._xScale.bandwidth()}, ${0})`;\n            })\n            .on('click', d => {\n                this._sortIconSelected = this._sortIconSelected === d.key ? 'name' : d.key;\n                this._callbacks.sIcon(this._sortIconSelected);\n                this.highlightSortIcon();\n            });\n    }\n\n    updateLineIcons() {\n        const icons = this._svgGroup.select('.line-icons-group')\n            .selectAll(\"path\")\n            .data(this._data[0].value)\n            .join(\"path\");\n\n        icons\n            .attr(\"d\", d3.symbol().type(d3.symbolCircle).size(100))\n            .style('pointer-events', 'auto')\n            .style('cursor', 'pointer')\n            .attr('transform', d => {\n                return `translate(${this._width + 0.5 * this._margin.right\n                    }, ${this._yScale(d.name) + 0.5 * this._yScale.bandwidth()\n                    })`;\n            })\n            .on('click', this.updateLineIconsClick.bind(this));\n    }\n\n    highlightYLabel() {\n\n        this._svgGroup.select('.axis--y').call(this._yAxis)\n            .selectAll('text')\n            .text(d => {\n                if (d.length > this.Y_LABEL_SIZE) {\n                    return `${d.substring(0, this.Y_LABEL_SIZE - 3)}...`;\n                }\n                return d;\n            })\n            .attr('fill', d => {\n                let current = this._data[0].value.filter(obj => obj.name === this._yLabelSelected);\n                current = current.length > 0 ? current[0].name : '';\n\n                return current === d ? 'limegreen' : 'currentColor';\n            })\n            .attr('font-weight', d => {\n                let current = this._data[0].value.filter(obj => obj.name === this._yLabelSelected);\n                current = current.length > 0 ? current[0].name : '';\n\n                return current === d ? 'bold' : 'normal'\n            });\n    }\n\n    highlightXLabel() {\n        this._svgGroup.select('.axis--x').call(this._xAxis)\n            .selectAll('text')\n            .attr('fill', d => d === this._xLabelSelected ? '#f44336' : 'currentColor')\n            .attr('font-weight', d => d === this._xLabelSelected ? 'bold' : 'normal');\n    }\n\n    highlightSortIcon() {\n        this._svgGroup.select('.sort-icons-group')\n            .selectAll('path')\n            .attr('fill', d => {\n                return +this._sortIconSelected && d.key === this._sortIconSelected ? '#f44336' : '#bfbfbf';\n            });\n    }\n\n    highlightLineIcon() {\n        this._svgGroup.select('.line-icons-group')\n            .selectAll('path')\n            .attr('fill', d => {\n                return this._lineIconSelected.includes(d.name) ? this._lScale(d.name) : '#bfbfbf';\n            });\n    }\n\n    updateLineIconsClick(d: any) {\n        const id = this._lineIconSelected.indexOf(d.name);\n\n        if (id < 0) {\n            this._lineIconSelected.push(d.name);\n        } else {\n            this._lineIconSelected.splice(id, 1);\n        }\n\n        this._lScale.domain(this._lineIconSelected);\n\n        this._callbacks.lIcon(this._lineIconSelected);\n        this.highlightLineIcon();\n    }\n}\n","import { Component, OnInit } from '@angular/core';\nimport { FormControl } from '@angular/forms';\n\nimport { ApiService } from 'src/app/services/api.service';\nimport { DataService } from 'src/app/services/data.service';\nimport { EventsService } from 'src/app/services/events.service';\nimport { StateService } from 'src/app/services/state.service';\n\n@Component({\n  selector: 'app-config',\n  templateUrl: './config.component.html',\n  styleUrls: ['./config.component.css']\n})\nexport class ConfigComponent implements OnInit {\n  public colorControl = new FormControl('warn');\n  public fontSizeControl = new FormControl(12);\n\n  constructor(public api: ApiService, public data: DataService, public events: EventsService, public state: StateService) { }\n\n  ngOnInit(): void {}\n\n  boroughSelectChanged(event) {\n    // cleans the line chart\n    this.events.vis.lineIconClicked.emit([]);\n    // cleans the levels\n    const levels = this.data.meta.levels;\n    let updates = levels\n        .filter(str => str !== 'borough')\n        .reduce((prev, key) => ({...prev, [key]: undefined}), {})\n\n    const previous = this.state.activeGeometryParameters;\n    this.state.activeGeometryParameters = Object.assign(previous, updates);\n\n    // cleans the filters\n    this.state.activeFilterParameters = {};\n    this.data.filters = {};\n\n    // changed value\n    const borough = {borough: event.value};\n    // emits the event\n    this.events.config.boroughSelectChanged.emit(borough);\n  }\n\n  polygonsSelectChanged(event) {\n    // cleans the line chart\n    this.events.vis.lineIconClicked.emit([]);\n\n    // cleans the levels\n    const levels = this.data.meta.levels;\n    let updates = levels\n        .filter(str => str !== 'borough')\n        .reduce((prev, key) => ({...prev, [key]: undefined}), {})\n\n    const previous = this.state.activeGeometryParameters;\n    this.state.activeGeometryParameters = Object.assign(previous, updates);\n\n    // cleans the filters\n    this.state.activeFilterParameters = {};\n    this.data.filters = {};\n\n    // changed value\n    const polygon = {polygon: event.value};\n    // emits the event\n    this.events.config.polygonSelectChanged.emit(polygon);\n  }\n\n  navigationSelectChanged(event) {\n    // cleans the line chart\n    this.events.vis.lineIconClicked.emit([]);\n\n    // cleans the levels\n    const levels = this.data.meta.levels;\n    let updates = levels\n        .filter(str => str !== 'borough')\n        .reduce((prev, key) => ({...prev, [key]: undefined}), {})\n\n    const previous = this.state.activeGeometryParameters;\n    this.state.activeGeometryParameters = Object.assign(previous, updates);\n\n    // cleans the filters\n    this.state.activeFilterParameters = {};\n    this.data.filters = {};\n\n    // changed value\n    const navigation = {navigation: event.value};\n    // emits the event\n    this.events.config.navigationSelectChanged.emit(navigation);\n\n  }\n\n  mapModeSelectChanged(event) {\n    // changed value\n    const mode = {mode: event.value};\n\n    // emits the event\n    this.events.config.modeSelectChanged.emit(mode);\n  }\n}\n","<div class=\"widget top submenu\" [style.opacity]=\"this.state.configActive ? 100 : 0\"\n  [style.z-index]=\"this.state.configActive ? 2 : -1\">\n  <form class=\"options\" [style.fontSize.px]=\"fontSizeControl.value\">\n    <mat-form-field [color]=\"colorControl.value\">\n      <mat-label>Borough</mat-label>\n      <mat-select [value]=\"this.state.activeConfigParameters.borough\"\n        (selectionChange)=\"this.boroughSelectChanged($event)\">\n        <mat-option *ngFor=\"let boro of this.data.meta.boroughs\" [value]=\"boro\">\n          {{boro.toUpperCase()}}\n        </mat-option>\n      </mat-select>\n    </mat-form-field>\n\n    <mat-form-field [color]=\"colorControl.value\">\n      <mat-label>Polygons</mat-label>\n      <mat-select [value]=\"this.state.activeConfigParameters.polygon\"\n        (selectionChange)=\"this.polygonsSelectChanged($event)\">\n        <mat-option *ngFor=\"let poly of this.data.meta.polygons\" [value]=\"poly\">\n          {{poly.toUpperCase()}}\n        </mat-option>\n      </mat-select>\n    </mat-form-field>\n\n    <mat-form-field [color]=\"colorControl.value\">\n      <mat-label>Navigation</mat-label>\n      <mat-select [value]=\"this.state.activeConfigParameters.navigation\"\n        (selectionChange)=\"this.navigationSelectChanged($event)\">\n        <mat-option *ngFor=\"let nav of this.data.meta.navigation\" [value]=\"nav\">\n          {{nav.toUpperCase()}}\n        </mat-option>\n      </mat-select>\n    </mat-form-field>\n\n    <mat-form-field [color]=\"colorControl.value\">\n      <mat-label>Map mode</mat-label>\n      <mat-select [value]=\"this.state.activeConfigParameters.mode\"\n        (selectionChange)=\"this.mapModeSelectChanged($event)\">\n        <mat-option *ngFor=\"let mode of this.data.meta.modes\" [value]=\"mode\">\n          {{mode.toUpperCase()}}\n        </mat-option>\n      </mat-select>\n    </mat-form-field>\n  </form>\n\n</div>","import { Component, OnInit, ViewChildren, QueryList, ElementRef, AfterViewInit } from '@angular/core';\nimport { FormControl } from '@angular/forms';\n\nimport { ApiService } from 'src/app/services/api.service';\nimport { DataService } from 'src/app/services/data.service';\nimport { EventsService } from 'src/app/services/events.service';\nimport { StateService } from 'src/app/services/state.service';\n\nimport { Bar } from 'src/app/charts/bar';\nimport { empty } from 'rxjs';\n\n@Component({\n  selector: 'app-filter',\n  templateUrl: './filter.component.html',\n  styleUrls: ['./filter.component.css']\n})\nexport class FilterComponent implements OnInit, AfterViewInit {\n  public colorControl = new FormControl('warn');\n  public fontSizeControl = new FormControl(12);\n  public filterExp = '';\n\n  @ViewChildren('filter') _filtersDivs: QueryList<ElementRef>;\n  private _filters: any = {};\n\n  constructor(public api: ApiService, public data: DataService, public events: EventsService, public state: StateService) {}\n\n  ngOnInit(): void {\n    this.subscribeDataEvents();\n  }\n\n  ngAfterViewInit(): void {\n    this._filtersDivs.changes.subscribe(this.renderFilters.bind(this));\n  }\n\n  subscribeDataEvents() {\n    this.events.data.updateFilters.subscribe(this.renderFilters.bind(this));\n  }\n\n  renderFilters(keepBrush: boolean) {\n    const keys = Object.keys(this.data.filters);\n\n    this._filtersDivs.forEach((el, divId) => {\n      const key = keys[divId];\n      if (!key) { return; }\n\n      const div = el.nativeElement;\n      const cbs = {\n        brush: this.brushChanged.bind(this)\n      };\n\n      const hist = new Bar(div, cbs, key);\n      this._filters[key] = hist;\n\n      const range = keepBrush ? this.state.activeFilterParameters[key].range || [] : [];\n\n      const id = this.data.filters[key].findIndex((obj) => {\n        return obj.bin === 'empty';\n      });\n      if (id>=0) {\n        this.data.filters[key].splice(id, 1);\n      }\n\n      const data = this.data.filters[key].filter((obj) => {\n        return obj.count > 0;\n      })\n\n      // runs\n      this._filters[key].setData(data, range);\n      this._filters[key].render();\n    });\n  }\n\n  // ---- Toolbar events\n\n  addFilter() {\n    const state = {\n      key: this.state.currentFilterId,\n      params: {\n        borough: this.state.activeConfigParameters.borough,\n        attribute: 'AREA',\n        category: 'RES'\n      }\n    };\n\n    this.addFilterExp(state.key);\n    this.events.filters.updated.emit(state);\n  }\n\n  addFilterExp(key) {\n    if (this.filterExp === '') {\n        this.filterExp = `${key}`;\n    } \n    else {\n        this.filterExp += ` and ${key}`;\n    }\n  }\n\n  updateSummary() {\n    this.state.activeConfigParameters.filterExp = this.filterExp;\n    this.events.filters.updateSummary.emit();\n  }\n\n  // ---- Filter events\n \n  delFilter(key: string) {\n    const state = {\n      key: key,\n      params: null\n    };\n\n    this.delFilterExp(key);\n    this.events.filters.updated.emit(state);\n  }\n\n  delFilterExp(key) {\n    let parts = this.filterExp.split(' ');\n    \n    let id = parts.indexOf(key);\n    if (id === 0) {\n        parts.splice(id, 2);\n    }\n    else {\n        parts.splice(id-1, 2);\n    }\n\n    this.filterExp = parts.join(' ')\n  }\n\n\n  attributeSelectChanged(key, event) {\n    const state = {\n      key,\n      params: { \n        attribute: event.value,\n        category: this.data.meta.attributes[event.value].categories[0]\n      }\n    }\n    this.events.filters.updated.emit(state);\n  }\n\n  getAttributes() {\n    const filtered = Object.keys(this.data.meta.attributes).filter(key => {\n      const obj = this.data.meta.attributes[key];\n      return obj.histogramAlloed;\n    });\n\n    return filtered;\n  }\n\n  categorySelectChanged(key, event) {\n    const state = {\n      key,\n      params: { category: event.value }\n    }\n    this.events.filters.updated.emit(state);\n  }\n\n  getCategory(key) {\n    const attr = this.state.activeFilterParameters[key].attribute;\n\n    if (this.state.activeFilterParameters[key].attribute) {\n      return this.data.meta.attributes[attr].categories;\n    }\n    return [];\n  }\n\n  // ----- Bar chart events\n\n  brushChanged(key, event) {\n    const state = {\n      key,\n      params: { range: event.value }\n    }\n    this.events.filters.brushed.emit(state);\n  }\n}\n","<div class=\"widget top left\" [style.opacity]=\"this.state.matrixActive && this.state.filterActive ? 100 : 0\"\n    [style.z-index]=\"this.state.matrixActive && this.state.filterActive ? 2 : -1\">\n\n    <div class=\"filtersContainer\">\n        <div *ngFor=\"let hist of this.data.filters | keyvalue\" class=\"filter\">\n            <mat-toolbar class=\"centered mat-toolbar-top\">\n                <span style=\"margin-right: 20px;\">{{hist.key}}</span>\n                <form class=\"options\" [style.fontSize.px]=\"fontSizeControl.value\">\n\n                    <mat-form-field [color]=\"colorControl.value\">\n                        <mat-label>Attributes</mat-label>\n                        <mat-select [value]=\"this.state.activeFilterParameters[hist.key].attribute\"\n                            (selectionChange)=\"this.attributeSelectChanged(hist.key, $event)\">\n                            <mat-option *ngFor=\"let attr of this.getAttributes()\" [value]=\"attr\">\n                                {{attr.toUpperCase()}}\n                            </mat-option>\n                        </mat-select>\n                    </mat-form-field>\n\n                    <mat-form-field [color]=\"colorControl.value\"\n                        *ngIf=\"this.state.activeFilterParameters[hist.key].attribute !== 'LANDUSE' && this.state.activeFilterParameters[hist.key].attribute !== 'SPDIST1'\">\n                        <mat-label>Categories</mat-label>\n                        <mat-select [value]=\"this.state.activeFilterParameters[hist.key].category\"\n                            (selectionChange)=\"this.categorySelectChanged(hist.key, $event)\">\n                            <mat-option *ngFor=\"let cat of this.getCategory(hist.key)\" [value]=\"cat\">\n                                {{cat.toUpperCase()}}\n                            </mat-option>\n                        </mat-select>\n                    </mat-form-field>\n\n                </form>\n\n                <span class=\"spacer\"></span>\n\n                <button mat-icon-button (click)=\"this.delFilter(hist.key)\">\n                    <mat-icon [color]=\"'warn'\">cancel</mat-icon>\n                </button>\n            </mat-toolbar>\n            <div #filter class=\"bar-chart\"></div>\n        </div>\n    </div>\n\n    <mat-toolbar class=\"addToolbar mat-toolbar-bottom\">\n        <button mat-icon-button (click)=\"this.addFilter()\">\n            <mat-icon [color]=\"'primary'\">add_circle</mat-icon>\n        </button>\n\n        <span style=\"font-size: 12px !important; margin-right: 10px;\">Boolean expression:</span>\n        <input style=\"width: 25% !important;\" #currentFilterExp matInput [(ngModel)]=\"this.filterExp\">\n\n        <span class=\"spacer\"></span>\n\n        <button mat-icon-button (click)=\"this.updateSummary()\">\n            <mat-icon [color]=\"'primary'\">play_circle_filled</mat-icon>\n        </button>\n    </mat-toolbar>\n</div>","import { Component, OnInit } from '@angular/core';\n\nimport { ApiService } from 'src/app/services/api.service';\nimport { DataService } from 'src/app/services/data.service';\nimport { EventsService } from 'src/app/services/events.service';\nimport { StateService } from 'src/app/services/state.service';\n\n@Component({\n  selector: 'app-layers',\n  templateUrl: './layers.component.html',\n  styleUrls: ['./layers.component.css']\n})\nexport class LayersComponent implements OnInit {\n\n  constructor(public api: ApiService, public data: DataService, public events: EventsService, public state: StateService) { }\n\n  ngOnInit(): void {}\n\n  layerSelected(layer: string) {\n\n    const state = {\n      layersActive: false,\n      activeLayer: this.state.activeLayer === layer ? '' : layer\n    }\n\n    this.events.layers.activeLayerChanged.emit(state);\n  }\n\n}\n","<div class=\"widget submenu\" [style.opacity]=\"this.state.layersActive ? 100 : 0\" [style.z-index]=\"this.state.layersActive ? 2 : -1\">\n\n  <button class=\"item\" mat-button (click)=\"this.layerSelected('pops')\">\n    <mat-icon [color]=\"this.state.activeLayer === 'pops' ? 'warn' : 'primary'\">location_on</mat-icon>\n    <div [ngClass]=\"{'label': true}\">POPs</div>\n  </button>\n\n\n</div>","import { Component, OnInit, ViewChild, ElementRef } from '@angular/core';\n\nimport { DataService } from 'src/app/services/data.service';\nimport { EventsService } from 'src/app/services/events.service';\nimport { StateService } from 'src/app/services/state.service';\n\nimport { Cmap } from 'src/app/charts/cmap';\n\n@Component({\n  selector: 'app-legend',\n  templateUrl: './legend.component.html',\n  styleUrls: ['./legend.component.css']\n})\nexport class LegendComponent implements OnInit {\n  // matrix div\n  @ViewChild('matcolormap', {static: true}) _matColorMatDiv: ElementRef;\n  private _matColorMap: any;\n  // map div\n  @ViewChild('mapcolormap', {static: true}) _mapColorMapDiv: ElementRef;\n  private _mapColorMap: any;\n\n  constructor(public data: DataService, public events: EventsService,  public state: StateService) { }\n\n  ngOnInit(): void {\n    this.subscribeDataEvents();\n    this._matColorMap = new Cmap(this._matColorMatDiv.nativeElement);\n    this._mapColorMap = new Cmap(this._mapColorMapDiv.nativeElement);\n  }\n\n  subscribeDataEvents() {\n    this.events.data.updateVisMatrix.subscribe(this.loadCmap.bind(this, 'mat'));\n\n    this.events.data.updateMapGeometryAndFunction.subscribe(this.loadCmap.bind(this, 'map'));\n    this.events.data.updateMapFunction.subscribe(this.loadCmap.bind(this, 'map'));\n  }\n\n  loadCmap(visElement) {\n    const mode = visElement === 'mat' ? this.state.activeSummaryParameters.mode : this.state.activeConfigParameters.mode;\n    \n    // get the min and max values\n    let minMax = [];\n    if (mode === 'value') {\n      minMax = [+this.data.summary.min.toFixed(2), +this.data.summary.max.toFixed(2)];\n    } else {\n      minMax = [+this.data.summary.changeMin.toFixed(2), +this.data.summary.changeMax.toFixed(2)];\n    }\n\n    if (visElement === 'mat') {\n      this._matColorMap.setData(minMax);\n      this._matColorMap.render(); \n    } else {\n      this._mapColorMap.setData(minMax);\n      this._mapColorMap.render();\n    }\n  }\n\n  changeCMap() {\n      this.state.activeConfigParameters.cmapPercentiles = !this.state.activeConfigParameters.cmapPercentiles;\n      this.events.state.configCMapChanged.emit();\n    }\n}\n","<div class=\"widget bottom right\" [style.opacity]=\"this.state.legendActive ? 100 : 0\"\n[style.z-index]=\"this.state.legendActive ? 2 : -1\">\n  <div class=\"levels\">\n    <mat-toolbar class=\"mat-toolbar-top\">\n      <div class=\"centered\">\n        <p class=\"levels-p\">{{this.state.activeGeometryParameters.year}}</p>\n      </div>\n\n      <div class=\"centered\">\n        <mat-icon>keyboard_arrow_right</mat-icon>\n        <p class=\"levels-p\">{{this.state.activeConfigParameters.borough}}</p>\n      </div>\n\n      <div class=\"centered\" *ngIf=\"this.state.activeGeometryParameters.neighborhood\">\n        <mat-icon>keyboard_arrow_right</mat-icon>\n        <p class=\"levels-p\">{{this.state.activeGeometryParameters.neighborhood | slice:0:22}}{{this.state.activeGeometryParameters.neighborhood.length >= 22 ? '...' : ''}}</p>\n      </div>\n\n      <div class=\"centered\" *ngIf=\"this.state.activeGeometryParameters.block\">\n        <mat-icon>keyboard_arrow_right</mat-icon>\n        <p class=\"levels-p\">{{this.state.activeGeometryParameters.block}}</p>\n      </div>\n\n      <span class=\"spacer\"></span>\n\n      <mat-checkbox class=\"check\" [color]='\"warn\"' (change)=\"this.changeCMap()\" >Percentile</mat-checkbox>\n    </mat-toolbar>\n  </div>\n  <div class=\"cmap\">\n    <div style=\"display: flex; padding-left: 16px;\">\n      <div class=\"centered\">\n        <p class=\"levels-p\">MAT</p>\n      </div>\n\n      <div class=\"centered\">\n        <mat-icon>keyboard_arrow_right</mat-icon>\n        <p class=\"levels-p\">{{this.state.activeSummaryParameters.attribute.toUpperCase()}}</p>\n      </div>\n\n      <div class=\"centered\" *ngIf=\"this.state.activeSummaryParameters.category !== 'NONE'\">\n        <mat-icon>keyboard_arrow_right</mat-icon>\n        <p class=\"levels-p\">{{this.state.activeSummaryParameters.category.toUpperCase()}}</p>\n      </div>\n\n      <div class=\"centered\">\n        <mat-icon>keyboard_arrow_right</mat-icon>\n        <p class=\"levels-p\">{{this.state.activeSummaryParameters.metric.toUpperCase()}}</p>\n      </div>\n\n      <div class=\"centered\">\n        <mat-icon>keyboard_arrow_right</mat-icon>\n        <p class=\"levels-p\">{{this.state.activeSummaryParameters.mode.toUpperCase()}}</p>\n      </div>\n    </div>\n    <div #matcolormap style=\"height: 70px\" class=\"bottom\"></div>\n  </div>\n\n\n  <div class=\"cmap\">\n    <div style=\"display: flex; padding-left: 16px;\">\n      <div class=\"centered\">\n        <p class=\"levels-p\">MAP</p>\n      </div>\n\n      <div class=\"centered\">\n        <mat-icon>keyboard_arrow_right</mat-icon>\n        <p class=\"levels-p\">{{this.state.activeSummaryParameters.attribute.toUpperCase()}}</p>\n      </div>\n\n      <div class=\"centered\" *ngIf=\"this.state.activeSummaryParameters.category !== 'NONE'\">\n        <mat-icon>keyboard_arrow_right</mat-icon>\n        <p class=\"levels-p\">{{this.state.activeSummaryParameters.category.toUpperCase()}}</p>\n      </div>\n\n      <div class=\"centered\">\n        <mat-icon>keyboard_arrow_right</mat-icon>\n        <p class=\"levels-p\">{{this.state.activeSummaryParameters.metric.toUpperCase()}}</p>\n      </div>\n\n      <div class=\"centered\">\n        <mat-icon>keyboard_arrow_right</mat-icon>\n        <p class=\"levels-p\">{{this.state.activeConfigParameters.mode.toUpperCase()}}</p>\n      </div>\n    </div>\n    <div #mapcolormap style=\"height: 70px\" class=\"bottom\"></div>\n  </div>\n\n</div>","// angular imports\nimport { Component, OnInit, ViewChild, ElementRef } from '@angular/core';\n\n// mapview imports\nimport { MapView } from 'src/app/mapview/mapview';\n\n// services\nimport { ApiService } from 'src/app/services/api.service';\nimport { DataService } from 'src/app/services/data.service';\nimport { EventsService } from 'src/app/services/events.service';\nimport { StateService } from 'src/app/services/state.service';\n\n@Component({\n  selector: 'app-map',\n  templateUrl: './map.component.html',\n  styleUrls: ['./map.component.css']\n})\nexport class MapComponent implements OnInit {\n  // map div\n  @ViewChild('mapView', {static: true}) _mapDiv: ElementRef;\n  // map view instance\n  protected _mapView: MapView = null;\n\n  // map component constructor\n  constructor(public api: ApiService, public data: DataService, public events: EventsService, public state: StateService) { }\n\n  // initialization hook\n  async ngOnInit() {\n    // map callbacks\n    const callbacks = {\n      mouse: { mouseDown: this.highlightPoly.bind(this), },\n      key: {}\n    };\n\n    // cretes the map\n    this._mapView =  new MapView(this._mapDiv.nativeElement, callbacks);\n    await this._mapView.initLayers('index.json')\n\n    // subscribe events\n    this.subscribeDataEvents();\n    this.subscribeStateEvents();\n\n    // sinalizes that mapview is ready\n    this.events.map.initialized.emit();\n  }\n\n  // events handled by mapview\n  subscribeStateEvents() {\n    this.events.state.selectedPolygonChanged.subscribe(this.updateHighlightedPolygon.bind(this));\n    this.events.state.activeLayerChanged.subscribe(this.loadPopsLayer.bind(this));\n  }\n\n\n  // events handled by mapview\n  subscribeDataEvents() {\n    this.events.data.updateMapGeometryAndFunction.subscribe(this.loadLayerGeometryAndFunction.bind(this));\n    this.events.data.updateMapFunction.subscribe(this.loadLayerScalarField.bind(this));\n  }\n\n  async loadLayerGeometryAndFunction() {\n    await this.loadLayerGeometry();\n    await this.loadLayerScalarField();\n    // open the POPs layer\n    await this.loadPopsLayer();\n  }\n\n  async loadPopsLayer() {\n    // removes the previous loaded layer    \n    this._mapView.delLayer('pops');\n\n    // layer config\n    const config = {selectable: false, visible: this.state.activeLayer === 'pops'};\n    \n    // loads the payer\n    await this._mapView.addLayer('point', 'pops', this.data.layers['pops'], config);\n  }\n\n  // loads the polygon layer\n  async loadLayerGeometry() {\n    // removes the previous loaded layer    \n    this._mapView.delLayer('pluto');\n\n    // layer config\n    const config = {selectable: true};\n\n    // loads the payer\n    await this._mapView.addLayer('polygon', 'pluto', this.data.geometry, config);\n  }\n\n  // loads the scalar function\n  async loadLayerScalarField() {\n    const mode = this.state.activeConfigParameters.mode;\n    const year = this.state.activeGeometryParameters.year;\n    if (!year) { return; }\n\n    const feats = this.data.geometry.features;\n        \n    const values = this.data.summary[year].filter(obj => obj.isAlive);\n    values.sort((a, b) => a.name < b.name ? 1 : -1);\n\n    const func = [];\n    for (let nId = 0; nId < feats.length; nId++) {\n      const count = feats[nId].geometry.length;\n      const name = feats[nId].properties.name;\n\n      const pos = values.findIndex(obj => {\n        return obj.name === name;\n      });\n\n      let value = null;\n      if (pos >= 0) {\n        const current = values[pos];\n4\n        if ( !current.isAlive ) {\n            value = 'notAlive';\n        }\n        else if ( !current.isActive ) {\n            value = 'notActive';\n        }\n        else if ( mode === 'value' && !current.isValid) {\n            value = 'notValid';\n        }\n        else if ( mode === 'change' && !current.changeValid) {\n            value = 'notChange';\n        }\n        else {\n            value = current[mode];\n        }\n      }\n      func.push(...Array(count).fill(value));\n    } \n\n    let fMin = null, fMax = null;\n    if (mode === 'value') {\n      [fMin, fMax] = [this.data.summary.min, this.data.summary.max];\n    } \n    else {\n      [fMin, fMax] = [this.data.summary.changeMin, this.data.summary.changeMax];\n    }  \n\n    await this._mapView.updateLayerFunction('pluto', {func, fMin, fMax});\n  }\n\n  highlightPoly(polygon: string) {\n    let name = \"\";\n    const id = +polygon[0];\n\n    if (id >= 0) {\n      name = this.data.geometry.features[id].properties.name;\n    }\n\n    this.events.map.polyPicked.emit({name, origin: 'map'});\n  }\n\n  updateHighlightedPolygon(origin: string) {\n    if (origin === 'vis') {\n      const id = this.data.geometry.features.findIndex(obj => obj.properties.name === this.state.selectedPolygon);\n      this._mapView.pick('pluto', id);\n    }\n  }\n\n}\n","<div #mapView class=\"full-screen\"></div>\n","// angular imports\nimport { Component, OnInit } from '@angular/core';\n\n// service imports\nimport { ApiService } from 'src/app/services/api.service';\nimport { DataService } from 'src/app/services/data.service';\nimport { EventsService } from 'src/app/services/events.service';\nimport { StateService } from 'src/app/services/state.service';\n\n@Component({\n  selector: 'app-menu',\n  templateUrl: './menu.component.html',\n  styleUrls: ['./menu.component.css']\n})\nexport class MenuComponent implements OnInit {\n\n  public configActive = false;\n\n  constructor(public api: ApiService, public data: DataService, public events: EventsService, public state: StateService) { }\n\n  ngOnInit(): void {}\n\n  buttonClicked(widget: string) {\n    if (widget === 'config') {\n      this.state.configActive = !this.state.configActive;\n    } else if (widget === 'layers') {\n      this.state.layersActive = !this.state.layersActive;\n    } else if (widget === 'matrix'){\n      this.state.matrixActive = !this.state.matrixActive;\n    }\n  }\n\n  toggleLegend() {\n    this.state.legendActive = !this.state.legendActive;\n  }\n \n}\n","<div class=\"menu top right\">\n\n  <button class=\"item\" mat-button (click)=\"this.buttonClicked('config')\">\n    <mat-icon [color]=\"this.state.configActive ? 'warn' : 'primary'\">settings</mat-icon>\n    <div [ngClass]=\"{'label': true}\">Config</div>\n  </button>\n\n  <button class=\"item\" mat-button (click)=\"this.buttonClicked('matrix')\">\n    <mat-icon [color]=\"this.state.matrixActive ? 'warn' : 'primary'\">apps</mat-icon>\n    <div [ngClass]=\"{'label': true}\">Matrix</div>\n  </button>\n\n  <button class=\"item\" mat-button (click)=\"this.buttonClicked('layers')\">\n    <mat-icon [color]=\"this.state.layersActive ? 'warn' : 'primary'\">layers</mat-icon>\n    <div [ngClass]=\"{'label': true}\">Layers</div>\n  </button>\n\n  <button class=\"toogle-button\" mat-button (click)=\"this.toggleLegend()\">\n    <mat-icon class=\"item\" [color]=\"this.state.legendActive ? 'warn' : 'primary'\">color_lens</mat-icon>\n    <div [ngClass]=\"{'label': true}\">Legend</div>\n  </button>\n\n</div>\n\n<app-config></app-config>\n<app-layers></app-layers>","import { Component, OnInit, Input } from '@angular/core';\n\n@Component({\n  selector: 'app-tooltip',\n  templateUrl: './tooltip.component.html',\n  styleUrls: ['./tooltip.component.css']\n})\nexport class TooltipComponent implements OnInit {\n\n  @Input() isActive: boolean;\n  @Input() top: number;\n  @Input() left: number;\n  @Input() info: any;\n \n  constructor() { }\n\n  ngOnInit(): void {}\n\n  tooltipContent() {\n    if (!this.info.data) return '';\n    \n    if( !this.info.data.isAlive ) {\n        return 'Lot Not Alive';\n    }\n    else if ( !this.info.data.isActive ) {\n        return 'Inactive Lot';\n    }\n    else if ( this.info.mode === 'value' && !this.info.data.isValid ) {\n        return 'Invalid Value';\n    }\n    else if ( this.info.mode === 'change' && !this.info.data.changeValid ) {\n        return 'Invalid Change';\n    }\n    else {\n        return this.info.data[this.info.mode].toLocaleString(\n            undefined, { minimumFractionDigits: 2 }\n          );\n     }\n  }\n}\n","<div [class]=\"this.info.line === undefined ? 'widgetMat' : 'widgetLine'\" \n[style.opacity]=\"this.isActive ? 100 : 0\" [style.z-index]=\"this.isActive ? 5 : -1\"\n[style.left.px]=\"this.left\"\n[style.top.px]=\"this.top\">\n\n<mat-toolbar class=\"mat-toolbar-top header\" *ngIf=\"this.info.line === undefined\">\n  <div class=\"centered\">\n    <p class=\"levels-p\">{{this.info.year}}</p>\n  </div>\n\n  <div class=\"centered\">\n    <mat-icon>keyboard_arrow_right</mat-icon>\n    <p class=\"levels-p\">{{\n      this.info.data ?\n      (this.info.data.name | slice:0:22) : ''}}{{\n      this.info.data ?\n      (this.info.data.name.length >= 22 ? '...' : '') : ''}}\n    </p>\n  </div>\n</mat-toolbar>\n<div *ngIf=\"this.info.line === undefined\" style=\"width: 100%; height: calc(100% - 30px);\">\n  <div class=\"centered\">\n    <p class=\"levels-p\">{{this.tooltipContent()}}</p>\n  </div>\n</div>\n\n<mat-toolbar class=\"mat-toolbar-top header centered\" *ngIf=\"this.info.line\">\n  <div class=\"centered\">\n    <p class=\"levels-p\">{{this.info.line}}</p>\n  </div>\n</mat-toolbar>\n</div>","import { Component, OnInit, ViewChild, ElementRef } from '@angular/core';\nimport { FormControl } from '@angular/forms';\n\nimport { ApiService } from 'src/app/services/api.service';\nimport { DataService } from 'src/app/services/data.service';\nimport { EventsService } from 'src/app/services/events.service';\nimport { StateService } from 'src/app/services/state.service';\n\nimport { Matrix } from 'src/app/charts/matrix';\nimport { Line } from 'src/app/charts/line';\n\n@Component({\n    selector: 'app-vis',\n    templateUrl: './vis.component.html',\n    styleUrls: ['./vis.component.css']\n})\nexport class VisComponent implements OnInit {\n    public colorControl = new FormControl('warn');\n    public fontSizeControl = new FormControl(12);\n\n    public tooltip = {\n        show: false, top: 10,\n        left: 10, info: {}\n    };\n\n    // matrix div\n    @ViewChild('matrix', { static: true }) _matrixDiv: ElementRef;\n    private _matrix: any;\n\n    // line div\n    @ViewChild('line', { static: true }) _lineDiv: ElementRef;\n    private _line: any;\n\n    constructor(public api: ApiService, public data: DataService, public events: EventsService, public state: StateService) {\n    }\n\n    ngOnInit(): void {\n        this.subscribeDataEvents();\n        this.subscribeStateEvents();\n\n        const matDefaults = {\n            xLabel: this.state.activeGeometryParameters.year,\n            sIcon: 'name'\n        }\n        const matCallbacks = {\n            xLabel: this.yearLabelClicked.bind(this),\n\n            yLabel: this.polyLabelClicked.bind(this),\n            yHover: this.polyLabelHovered.bind(this),\n\n            sIcon: this.sortIconClicked.bind(this),\n            lIcon: this.lineIconClicked.bind(this),\n\n            rHover: this.polyRectHovered.bind(this),\n            svgOut: this.svgOut.bind(this)\n        };\n\n        this._matrix = new Matrix(this._matrixDiv.nativeElement, matCallbacks, matDefaults);\n\n        let attr = `${this.state.activeSummaryParameters.attribute} (${this.state.activeSummaryParameters.category})`.toLowerCase();\n        const lineDefaults = {\n            yLabel: this.state.activeSummaryParameters.mode === 'change' ? `${attr} value` : `${attr} change`\n        }\n        const lineCallbacks = {\n            lHover: this.lineLegendHovered.bind(this),\n            svgOut: this.svgOut.bind(this)\n        }\n        this._line = new Line(this._lineDiv.nativeElement, lineCallbacks, lineDefaults);\n    }\n\n    // ---- Component subscriptions\n\n    subscribeDataEvents() {\n        this.events.data.updateVisMatrix.subscribe(() => {\n            this.loadMatrix();\n            this.loadLine();\n        });\n    }\n\n    subscribeStateEvents() {\n        this.events.state.pageParametersChanged.subscribe(() => {\n            this.loadMatrix();\n            this.loadLine();\n        });\n\n        this.events.state.sortParametersChanged.subscribe(() => {\n            this.loadMatrix();\n            this.loadLine();\n        });\n\n        this.events.state.lineCurvesChanged.subscribe(this.loadLine.bind(this));\n\n        this.events.state.selectedPolygonChanged.subscribe(this.highlightPolyLabel.bind(this));\n    }\n\n    matrixSortFunction() {\n        if (this.state.activeSortParameters.sortBy === 'name') {\n            return (a, b) => a.name.toLowerCase() < b.name.toLowerCase() ? -1 : 1;\n        }\n\n        if (!isNaN(+this.state.activeSortParameters.sortBy)) {\n            return (a, b) => {\n                const mode = this.state.activeSummaryParameters.mode;\n\n                if (!a.isAlive || !a.isActive ) {\n                    return -1;\n                }\n\n                if (!b.isAlive || !b.isActive ) {\n                    return 1;\n                }\n\n                if (mode === 'value') {\n                    if (!a.isValid) {\n                        return -1;\n                    }\n\n                    if (!b.isValid) {\n                        return 1;\n                    }\n                }\n\n                if (mode === 'change') {\n                    if (!a.changeValid) {\n                        return -1;\n                    }\n\n                    if (!b.changeValid) {\n                        return 1;\n                    }\n                }\n\n                return a[mode] < b[mode] ? -1 : 1;\n            };\n        }\n    }\n\n    prepareMatrixData() {\n        const data = this.data.summary;\n        const mode = this.state.activeSummaryParameters.mode;\n\n        const page = this.state.activePageParameters.currentPage;\n        const size = this.state.activePageParameters.pageSize;\n\n        const years = Object.keys(data).filter(d => !isNaN(+d));\n\n        let sortYear = '';\n        if (isNaN(+this.state.activeSortParameters.sortBy)) {\n            sortYear = years[0];\n        } else {\n            sortYear = this.state.activeSortParameters.sortBy;\n        }\n\n        // original order\n        const original = {};\n        data[sortYear].forEach((d, i) => {\n            original[d.name] = i;\n        });\n\n        // copies the year to be sorted\n        let yearCopy = [...data[sortYear]];\n        yearCopy.sort(this.matrixSortFunction().bind(this));\n\n        // pagination\n        yearCopy = yearCopy.slice(page * size, (page + 1) * size);\n\n        // sort the other years\n        const matData = [];\n        for (let year of years) {\n            const obj = {\n                key: year,\n                value: yearCopy.map(\n                    d => {\n                        const pos = original[d.name]\n                        return data[year][pos];\n                    }\n                )\n            }\n\n            matData.push(obj);\n        }\n\n        // get the min and max values\n        let minMax = [];\n        if (mode === 'value') {\n            minMax = [+data.min.toFixed(2), +data.max.toFixed(2)];\n        } else {\n            minMax = [+data.changeMin.toFixed(2), +data.changeMax.toFixed(2)];\n        }\n        matData['minMax'] = minMax;\n\n        return matData;\n    }\n\n    loadMatrix() {\n        const mode = this.state.activeSummaryParameters.mode;\n        const line = this.state.activeLineChartCurves;\n        const sort = this.state.activeSortParameters.sortBy;\n        const click = !(this.state.activeLevel === 'neighborhood' && this.state.activeConfigParameters.navigation === 'skip blocks') &&\n            !(this.state.activeLevel === 'block' && this.state.activeConfigParameters.navigation === 'complete');\n\n        const data = this.prepareMatrixData();\n\n        this._matrix.setData(data, mode, line, sort, click);\n        this._matrix.render();\n    }\n\n    prepareLineData() {\n        const data = this.data.summary;\n        const years = Object.keys(data).filter(d => !isNaN(+d));\n        const mode = this.state.activeSummaryParameters.mode === 'change' ? 'value' : 'change';\n        const neighs = this.state.activeLineChartCurves;\n\n        const lineData = { minMax: [], lines: [] };\n\n        for (let name of neighs) {\n            const neighData = { name, data: [] };\n\n            for (let year of years) {\n                const current = data[year].find(obj => obj.name === name);\n\n                const value = current[mode];\n                const valid = current.isAlive && current.isActive && current.isValid;\n\n                neighData.data.push({ year, value, valid });\n            }\n\n            lineData.lines.push(neighData);\n        }\n\n        // get the min and max values\n        let minMax = [];\n        if (mode === 'value') {\n            minMax = [+data.min.toFixed(2), +data.max.toFixed(2)];\n        } else {\n            minMax = [+data.changeMin.toFixed(2), +data.changeMax.toFixed(2)];\n        }\n\n        lineData['minMax'] = minMax;\n        return { lineData, years };\n    }\n\n    loadLine() {\n        const { lineData, years } = this.prepareLineData();\n        let attr = `${this.state.activeSummaryParameters.attribute} (${this.state.activeSummaryParameters.category})`.toLowerCase();\n        let yLabel = this.state.activeSummaryParameters.mode === 'change' ? `${attr} value` : `${attr} change`;\n\n        this._line.setYLabel(yLabel);\n        this._line.setData(lineData, years, yLabel);\n        this._line.render();\n    }\n\n    // ---- Component menu events\n    yearStepSelectChanged(event) {\n        const yearStep = { yearStep: event.value }\n        this.events.vis.yearStepSelectChanged.emit(yearStep);\n    }\n\n    attributeSelectChanged(event) {\n        const attribute = {\n            attribute: event.value,\n            category: this.data.meta.attributes[event.value].categories[0],\n            metric: this.data.meta.attributes[event.value].metrics[0],\n        };\n        this.events.vis.attributeSelectChanged.emit(attribute);\n    }\n\n    categorySelectChanged(event) {\n        const metric = { category: event.value };\n        this.events.vis.categorySelectChanged.emit(metric);\n    }\n\n    getCategories() {\n        if (this.data.meta.attributes[this.state.activeSummaryParameters.attribute]) {\n            return this.data.meta.attributes[this.state.activeSummaryParameters.attribute].categories;\n        }\n        return [];\n    }\n\n    metricSelectChanged(event) {\n        const metric = { metric: event.value };\n        this.events.vis.metricSelectChanged.emit(metric);\n    }\n\n    getMetrics() {\n        if (this.data.meta.attributes[this.state.activeSummaryParameters.attribute]) {\n            return this.data.meta.attributes[this.state.activeSummaryParameters.attribute].metrics;\n        }\n        return [];\n    }\n\n    modeSelectChanged(event) {\n        const mode = { mode: event.value };\n        this.events.vis.modeSelectChanged.emit(mode);\n    }\n\n    sortSelectChanged(event) {\n        const sort = { sortBy: event.value };\n        this.events.vis.sortBySelectChanged.emit(sort);\n    }\n    // ---- Component matrix events\n\n    yearLabelClicked(value) {\n        const year = { year: value };\n        this.events.vis.yearLabelClicked.emit(year);\n    }\n\n    polyLabelHovered(value) {\n        const poly = { name: value, origin: 'vis' };\n        this.events.vis.polygonLabelHovered.emit(poly);\n    }\n\n    polyLabelClicked(value) {\n        // cleans the line chart\n        this.events.vis.lineIconClicked.emit([]);\n\n        if (this.state.activeLevel === 'borough') {\n            const neighborhood = { neighborhood: value };\n            this.events.vis.polygonLabelClicked.emit(neighborhood);\n        }\n        else if (this.state.activeLevel === 'neighborhood') {\n            const block = { block: value };\n            this.events.vis.polygonLabelClicked.emit(block);\n        }\n        else if (this.state.activeLevel === 'block') {\n            const lot = { lot: value };\n            this.events.vis.polygonLabelClicked.emit(lot);\n        }\n    }\n\n    highlightPolyLabel(origin: string) {\n        if (origin === 'map') {\n            this._matrix.setHighlight(this.state.selectedPolygon);\n            this._matrix.render();\n        }\n    }\n\n    navButtonClicked(level) {\n        // cleans the line chart\n        this.events.vis.lineIconClicked.emit([]);\n\n        const levels = this.data.meta.levels;\n\n        let updates = {};\n        if (level === 'borough') {\n            updates = levels\n                .filter(str => str !== 'borough')\n                .reduce((prev, key) => ({ ...prev, [key]: undefined }), {})\n        }\n        else if (level === 'neighborhood') {\n            updates = levels\n                .filter(str => str !== 'borough' && str !== 'neighborhood')\n                .reduce((prev, key) => ({ ...prev, [key]: undefined }), {})\n        }\n        else if (level === 'block') {\n            updates = levels\n                .filter(str => str !== 'borough' && str !== 'neighborhood' && str !== 'block')\n                .reduce((prev, key) => ({ ...prev, [key]: undefined }), {})\n        }\n\n        // emits the event\n        this.events.vis.navButtonClicked.emit(updates);\n    }\n\n    activeFilters() {\n        this.state.filterActive = !this.state.filterActive;\n    }\n\n    getFilterIconColor() {\n        return this.state.filterActive ? 'warn' : (Object.keys(this.state.activeFilterParameters).length === 0 ? 'primary' : 'accent');\n    }\n\n    navPageChanged(direction: string) {\n        let current = this.state.activePageParameters.currentPage;\n        let total = this.state.activePageParameters.totalPages - 1;\n\n        if (direction === 'left' && current > 0) {\n            current -= 1;\n        }\n        else if (direction === 'right' && current < total) {\n            current += 1;\n        }\n        else if (direction === 'first') {\n            current = 0;\n        }\n        else if (direction === 'last') {\n            current = total;\n        }\n        else if (!isNaN(+direction)){\n\n            let val = +direction - 1;\n            \n            if (val < 0) { val = 0; }\n            if (val > total) { val = total; }\n\n            current = val;\n        }\n\n        const page = { currentPage: current }\n        this.events.vis.navPageChanged.emit(page)\n    }\n\n    sortIconClicked(value) {\n        const sort = { sortBy: value };\n        this.events.vis.sortIconClicked.emit(sort);\n    }\n\n    lineIconClicked(value) {\n        const state = value;\n        this.events.vis.lineIconClicked.emit(state);\n    }\n\n    lineLegendHovered(value) {\n        this.tooltip = {\n            show: true,\n            left: value.mouse[0],\n            top: value.mouse[1],\n            info: { line: value.line }\n        }\n    }\n\n    polyRectHovered(value) {\n        const mode = this.state.activeSummaryParameters.mode;\n\n        this.tooltip = {\n            show: true,\n            left: value.mouse[0],\n            top: value.mouse[1],\n            info: { year: value.year, mode, data: value.data }\n        };\n    }\n\n    svgOut() {\n        this.tooltip.show = false;\n        this.tooltip.info = {};\n    }\n}","<div class=\"widget top left\" [style.opacity]=\"this.state.matrixActive ? 100 : 0\"\n    [style.z-index]=\"this.state.matrixActive ? 2 : -1\">\n    <mat-toolbar class=\"centered mat-toolbar-top\">\n        <form class=\"options\" [style.fontSize.px]=\"fontSizeControl.value\">\n\n            <mat-form-field id='year' [color]=\"colorControl.value\">\n                <mat-label>Year Step</mat-label>\n                <mat-select [value]=\"''+this.state.activeSummaryParameters.yearStep\"\n                    (selectionChange)=\"this.yearStepSelectChanged($event)\">\n                    <mat-option *ngFor=\"let step of this.data.meta.yearStep\" [value]=\"step\">\n                        {{step}}\n                    </mat-option>\n                </mat-select>\n            </mat-form-field>\n\n            <mat-form-field [color]=\"colorControl.value\">\n                <mat-label>Attributes</mat-label>\n                <mat-select [value]=\"this.state.activeSummaryParameters.attribute\"\n                    (selectionChange)=\"this.attributeSelectChanged($event)\">\n                    <mat-option *ngFor=\"let attr of this.data.meta.attributes | keyvalue\" [value]=\"attr.key\">\n                        {{attr.key.toUpperCase()}}\n                    </mat-option>\n                </mat-select>\n            </mat-form-field>\n\n            <mat-form-field [color]=\"colorControl.value\">\n                <mat-label>Categories</mat-label>\n                <mat-select [value]=\"this.state.activeSummaryParameters.category\"\n                    (selectionChange)=\"this.categorySelectChanged($event)\">\n                    <mat-option *ngFor=\"let cat of this.getCategories()\" [value]=\"cat\" [disabled]=\"cat === 'NONE'\">\n                        {{cat.toUpperCase()}}\n                    </mat-option>\n                </mat-select>\n            </mat-form-field>\n\n            <mat-form-field [color]=\"colorControl.value\">\n                <mat-label>Metrics</mat-label>\n                <mat-select [value]=\"this.state.activeSummaryParameters.metric\"\n                    (selectionChange)=\"this.metricSelectChanged($event)\">\n                    <mat-option *ngFor=\"let met of this.getMetrics()\" [value]=\"met\">\n                        {{met.toUpperCase()}}\n                    </mat-option>\n                </mat-select>\n            </mat-form-field>\n\n            <mat-form-field [color]=\"colorControl.value\">\n                <mat-label>Mode</mat-label>\n                <mat-select [value]=\"this.state.activeSummaryParameters.mode\"\n                    (selectionChange)=\"this.modeSelectChanged($event)\">\n                    <mat-option *ngFor=\"let mode of this.data.meta.modes\" [value]=\"mode\">\n                        {{mode === 'change' ? 'VALUE' : 'CHANGE'}} & {{mode.toUpperCase()}}\n                    </mat-option>\n                </mat-select>\n            </mat-form-field>\n\n            <mat-form-field [color]=\"colorControl.value\">\n                <mat-label>Sort Matrix by</mat-label>\n                <mat-select\n                    [value]=\"+this.state.activeSortParameters.sortBy ? 'year' : this.state.activeSortParameters.sortBy\"\n                    (selectionChange)=\"this.sortSelectChanged($event)\">\n                    <mat-option *ngFor=\"let sort of this.data.meta.sortBy\" [value]=\"sort\" [disabled]=\"sort === 'year'\">\n                        {{sort.toUpperCase()}}\n                    </mat-option>\n                </mat-select>\n            </mat-form-field>\n\n        </form>\n    </mat-toolbar>\n\n    <div class=\"line\" #line></div>\n\n    <mat-divider></mat-divider>\n\n    <div class=\"matrix\" #matrix></div>\n\n    <mat-toolbar class=\"navigation mat-toolbar-bottom\">\n        <button class=\"item\" mat-button (click)=\"this.activeFilters()\">\n            <mat-icon [color]=\"this.getFilterIconColor()\">view_agenda</mat-icon>\n        </button>\n\n        <button mat-button [disabled]=\"this.state.activeLevel === 'borough'\"\n            (click)=\"this.navButtonClicked('borough')\">{{this.state.activeConfigParameters.borough}}</button>\n\n        <div class=\"centered\" *ngIf=\"this.state.activeGeometryParameters.neighborhood\">\n            <mat-icon>keyboard_arrow_right</mat-icon>\n            <button mat-button [disabled]=\"this.state.activeLevel === 'neighborhood'\"\n                (click)=\"this.navButtonClicked('neighborhood')\">{{this.state.activeGeometryParameters.neighborhood | slice:0:22}}{{this.state.activeGeometryParameters.neighborhood.length >= 22 ? '...' : ''}}</button>\n        </div>\n\n        <div class=\"centered\" *ngIf=\"this.state.activeGeometryParameters.block\">\n            <mat-icon>keyboard_arrow_right</mat-icon>\n            <button mat-button [disabled]=\"this.state.activeLevel === 'block'\"\n                (click)=\"this.navButtonClicked('block')\">{{this.state.activeGeometryParameters.block}}</button>\n        </div>\n\n        <span class=\"navigation-spacer\"></span>\n\n        <div class=\"centered\">\n            <div class=\"navigation-label\">Page</div>\n            <input class=\"current\" #currentPage matInput [value]=\"this.state.activePageParameters.currentPage + 1\" (change)=\"this.navPageChanged(currentPage.value)\">\n            <div class=\"navigation-label\">\n                /{{\n                   this.state.activePageParameters.totalPages\n                 }}\n            </div>\n            <button mat-icon-button aria-label=\"Left\" (click)=\"this.navPageChanged('first')\"\n                [disabled]=\"this.state.activePageParameters.currentPage === 0\">\n                <mat-icon>first_page</mat-icon>\n            </button>\n            <button mat-icon-button aria-label=\"Left\" (click)=\"this.navPageChanged('left')\"\n                [disabled]=\"this.state.activePageParameters.currentPage === 0\">\n                <mat-icon>keyboard_arrow_left</mat-icon>\n            </button>\n            <button mat-icon-button aria-label=\"Right\" (click)=\"this.navPageChanged('right')\"\n                [disabled]=\"this.state.activePageParameters.currentPage === this.state.activePageParameters.totalPages-1\">\n                <mat-icon>keyboard_arrow_right</mat-icon>\n            </button>\n            <button mat-icon-button aria-label=\"Right\" (click)=\"this.navPageChanged('last')\"\n                [disabled]=\"this.state.activePageParameters.currentPage === this.state.activePageParameters.totalPages-1\">\n                <mat-icon>last_page</mat-icon>\n            </button>\n        </div>\n    </mat-toolbar>\n</div>\n\n<app-tooltip [isActive]=\"this.tooltip.show\" [top]=\"this.tooltip.top\" [left]=\"this.tooltip.left\"\n    [info]=\"this.tooltip.info\">\n</app-tooltip>","/// <reference types=\"@types/webgl2\" />\n\nimport { Layer } from './layer';\n\nimport { DataApi } from './data-api';\nimport { DataLoader } from './data-loader';\n\nimport { vec3 } from 'gl-matrix';\n\nexport class BuildingLayer extends Layer {\n  // number of coordinates per vertex\n  protected static COORDS = 3;\n  // number of shaders\n  protected static N_SHADER = 2;\n\n  // primitive Ids\n  protected _features: any = {};\n\n  // OpenGL data buffer\n  protected _glPositionBuffer: WebGLBuffer = null;\n  protected _glIndexBuffer: WebGLBuffer = null;\n  protected _glBuildingIdBuffer: WebGLBuffer = null;\n\n  // shader attribute id\n  protected _positionId = -1;\n  protected _buildingIdId = -1;\n\n  // uniforms\n  protected _uModelViewMatrixId: WebGLUniformLocation = -1;\n  protected _uProjectionMatrixId: WebGLUniformLocation = -1;\n  protected _uWorldOrigin: WebGLUniformLocation = -1;\n  protected _uGroundRes: WebGLUniformLocation = -1;\n  protected _uEye: WebGLUniformLocation = -1;\n\n  // highlighted building ID id\n  protected _highlight = -1;\n\n  // FBO for edge detection\n  protected _fboWidth = -1;\n  protected _fboHeight = -1;\n  protected _fbo: WebGLFramebuffer = null;\n  protected _readfbo: WebGLFramebuffer = null;\n  protected _normalTexture: WebGLTexture = null;\n  protected _depthTexture: WebGLTexture = null;\n  protected _positionTexture: WebGLTexture = null;\n  protected _idTexture: WebGLTexture = null;\n\n  /**\n   * The Vector Layer constructor\n   * @param {string} id the layer id\n   */\n  constructor(id: string) {\n    super(id);\n  }\n\n  /**\n   * Shader load signature\n   * @param {WebGL2RenderingContext} glContext WebGL context\n   */\n  async loadShaders(glContext: WebGL2RenderingContext) {\n    // load the required shaders\n    for (let id = 0; id < BuildingLayer.N_SHADER; id++) {\n      // shaders url\n      const vertUrl = `assets/shaders/building(${id}).vert`;\n      const fragUrl = `assets/shaders/building(${id}).frag`;\n\n      // Vertex shader program\n      const vsShader = await DataLoader.getTextData(vertUrl);\n      // Fragment shader program\n      const fsShader = await DataLoader.getTextData(fragUrl);\n\n      // load all shaders\n      this.initShaderProgram(vsShader, fsShader, glContext);\n    }\n\n    // uniforms definition\n    this._uModelViewMatrixId = glContext.getUniformLocation(this._shaderProgram[0], 'uModelViewMatrix');\n    this._uProjectionMatrixId = glContext.getUniformLocation(this._shaderProgram[0], 'uProjectionMatrix');\n    this._uWorldOrigin = glContext.getUniformLocation(this._shaderProgram[0], 'uWorldOrigin');\n    this._uGroundRes = glContext.getUniformLocation(this._shaderProgram[0], 'uGroundRes');\n    this._uEye = glContext.getUniformLocation(this._shaderProgram[0], 'uEye');\n\n    this._positionId = glContext.getAttribLocation(this._shaderProgram[0], 'vertPos');\n    this._buildingIdId = glContext.getAttribLocation(this._shaderProgram[0], 'buildingId');\n\n    // load message\n    console.log(`#${BuildingLayer.N_SHADER} shaders successfully loaded for layer ${this._layerId}.`);\n  }\n\n  /**\n   * Data update signature\n   * @returns {Promise<any>} The load data promise\n   */\n  async updateFeatures(glContext: WebGL2RenderingContext, data: any = null) {\n    // gets the feature of index id\n    data = await DataApi.getLayerFeature(this._layerId);\n\n    // new feature found\n    this._features = { 'position': [], 'ids': [], 'index': [] };\n\n    // iterates over the geometries\n    for (const feature of data.features) {\n      this._features['position'] = feature.geometry.coordinates;\n      this._features['ids'] = feature.geometry.ids;\n      this._features['index'] = feature.geometry.indices;\n    }\n\n    // creates the buffer\n    this.createBuffers(glContext);\n    // SSAO noise\n    this.generateNoise(glContext);\n  }\n\n  /**\n   * Layer render function signature\n   * @param {WebGL2RenderingContext} glContext WebGL context\n   * @param {number} x Mouse x position\n   * @param {number} y Mouse y position\n   */\n  pick(glContext: WebGL2RenderingContext, x: number, y: number) {\n    glContext.bindFramebuffer(glContext.FRAMEBUFFER, this._readfbo);\n\n    const result = new Float32Array(4);\n    glContext.readPixels(x, y, 1, 1, glContext.RGBA, glContext.FLOAT, result);\n\n    if (result[0] > 0) {\n      this._highlight = result[0];\n    }\n\n    glContext.bindFramebuffer(glContext.FRAMEBUFFER, null);\n  }\n\n  /**\n   * Layer render function signature\n   * @param {WebGL2RenderingContext} glContext WebGL context\n   */\n  render(glContext: WebGL2RenderingContext) {\n    // invalid layers\n    if (\n      this._shaderProgram.length === 0 ||\n      this._shaderProgram[0] === null ||\n      this._shaderProgram[1] === null ||\n      this._glPositionBuffer === null ||\n      this._glIndexBuffer === null ||\n      this._positionId < 0\n    ) {\n      return;\n    }\n    // FBO setup\n    this.setupFBO(glContext);\n\n    // enables the depth test\n    glContext.enable(glContext.DEPTH_TEST);\n    glContext.depthFunc(glContext.LESS);\n\n    // Picking\n    glContext.bindFramebuffer(glContext.FRAMEBUFFER, this._fbo);\n    this.renderBuildings(glContext);\n    glContext.bindFramebuffer(glContext.FRAMEBUFFER, null);\n\n    // SSAO render\n    this.renderSSAO(glContext);\n    // disables the depth buffer\n    glContext.disable(glContext.DEPTH_TEST);\n  }\n\n  /**\n   * Render the buildings for picking\n   * @param glContext\n   */\n  protected renderBuildings(glContext: WebGL2RenderingContext) {\n    // binds the shader program\n    glContext.useProgram(this._shaderProgram[0]);\n\n    // send matrices\n    glContext.uniformMatrix4fv(this._uModelViewMatrixId, false, this._camera.getModelViewMatrix());\n    glContext.uniformMatrix4fv(this._uProjectionMatrixId, false, this._camera.getProjectionMatrix());\n\n    // send world origin\n    const worldOrigin = this._camera.getWorldOrigin();\n    glContext.uniform2f(this._uWorldOrigin, worldOrigin[0], worldOrigin[1]);\n\n    // send eye and ground resolution\n    const eye = this._camera.getEye();\n    const gres = this._camera.getGroundResolution();\n    glContext.uniform1f(this._uGroundRes, gres);\n    glContext.uniform3f(this._uEye, eye[0], eye[1], eye[2]);\n\n    // binds the position buffer\n    glContext.bindBuffer(glContext.ARRAY_BUFFER, this._glPositionBuffer);\n    glContext.vertexAttribPointer(this._positionId, BuildingLayer.COORDS, glContext.FLOAT, false, 0, 0);\n    glContext.enableVertexAttribArray(this._positionId);\n\n    // binds the buildings id buffer\n    glContext.bindBuffer(glContext.ARRAY_BUFFER, this._glBuildingIdBuffer);\n    glContext.vertexAttribPointer(this._buildingIdId, 1, glContext.FLOAT, false, 0, 0);\n    glContext.enableVertexAttribArray(this._buildingIdId);\n\n    glContext.clearColor(0.0, 0.0, 0.0, 1.0);\n    // tslint:disable-next-line:no-bitwise\n    glContext.clear(glContext.COLOR_BUFFER_BIT | glContext.DEPTH_BUFFER_BIT);\n\n    // Tell WebGL which indices to use to index the vertices\n    glContext.bindBuffer(glContext.ELEMENT_ARRAY_BUFFER, this._glIndexBuffer);\n    // draw the geometry\n    glContext.drawElements(glContext.TRIANGLES, this._features['index'].length, glContext.UNSIGNED_INT, 0);\n  }\n\n\n  /**\n   * Render the buildings using SSAO\n   * @param glContext\n   */\n  protected renderSSAO(glContext: WebGL2RenderingContext) {\n    glContext.enable(glContext.BLEND);\n    glContext.blendFunc(glContext.SRC_ALPHA, glContext.ONE_MINUS_SRC_ALPHA);\n\n    glContext.useProgram(this._shaderProgram[1]);\n\n    const normalLocation: WebGLUniformLocation = glContext.getUniformLocation(this._shaderProgram[1], 'normalTex');\n    const positionLocation: WebGLUniformLocation = glContext.getUniformLocation(this._shaderProgram[1], 'positionTex');\n    const IDLocation: WebGLUniformLocation = glContext.getUniformLocation(this._shaderProgram[1], 'IDTex');\n    const depthLocation: WebGLUniformLocation = glContext.getUniformLocation(this._shaderProgram[1], 'depthTex');\n    const matModelView: WebGLUniformLocation = glContext.getUniformLocation(this._shaderProgram[1], 'matModelView');\n    const uProjectionMatrix: WebGLUniformLocation = glContext.getUniformLocation(this._shaderProgram[1], 'uProjectionMatrix');\n    const highlightId: WebGLUniformLocation = glContext.getUniformLocation(this._shaderProgram[1], 'highlightId');\n\n    glContext.uniformMatrix4fv(matModelView, false, this._camera.getViewMatrix());\n    glContext.uniformMatrix4fv(uProjectionMatrix, false, this._camera.getProjectionMatrix());\n    glContext.uniform1f(highlightId, this._highlight);\n\n    glContext.activeTexture(glContext.TEXTURE0);\n    glContext.bindTexture(glContext.TEXTURE_2D, this._normalTexture);\n    glContext.uniform1i(normalLocation, 0);\n\n    glContext.activeTexture(glContext.TEXTURE1);\n    glContext.bindTexture(glContext.TEXTURE_2D, this._positionTexture);\n    glContext.uniform1i(positionLocation, 1);\n\n    glContext.activeTexture(glContext.TEXTURE2);\n    glContext.bindTexture(glContext.TEXTURE_2D, this._idTexture);\n    glContext.uniform1i(IDLocation, 2);\n\n    glContext.activeTexture(glContext.TEXTURE3);\n    glContext.bindTexture(glContext.TEXTURE_2D, this._depthTexture);\n    glContext.uniform1i(depthLocation, 3);\n\n    glContext.drawArrays(glContext.TRIANGLE_STRIP, 0, 4);\n    glContext.disable(glContext.BLEND);\n  }\n\n  /**\n   * setup FBO used for edge detection\n   * @param {WebGL2RenderingContext} glContext WebGL context\n   */\n  protected setupFBO(glContext: WebGL2RenderingContext) {\n    if (this._fbo == null || this._readfbo == null) {\n      // creates the buffers\n      this._fbo = glContext.createFramebuffer();\n      this._readfbo = glContext.createFramebuffer();\n      this._depthTexture = glContext.createTexture();\n      this._normalTexture = glContext.createTexture();\n      this._positionTexture = glContext.createTexture();\n      this._idTexture = glContext.createTexture();\n\n      // check the availability of float buffers\n      const ext = glContext.getExtension('EXT_color_buffer_float');\n      if (!ext) {\n        console.error('float buffer extension not supported!!!');\n      }\n    }\n\n    // gets the viewport\n    const viewPort = this._camera.getViewportResolution();\n    if (this._fboWidth !== viewPort[0] || this._fboHeight !== viewPort[1]) {\n      // update FBO size\n      this._fboWidth = viewPort[0];\n      this._fboHeight = viewPort[1];\n\n      // normal texture\n      glContext.bindTexture(glContext.TEXTURE_2D, this._normalTexture);\n      glContext.texImage2D(\n        glContext.TEXTURE_2D, 0, glContext.RGBA32F,\n        this._fboWidth, this._fboHeight, 0, glContext.RGBA, glContext.FLOAT, null\n      );\n      glContext.texParameteri(glContext.TEXTURE_2D, glContext.TEXTURE_MIN_FILTER, glContext.NEAREST);\n      glContext.texParameteri(glContext.TEXTURE_2D, glContext.TEXTURE_MAG_FILTER, glContext.NEAREST);\n      glContext.texParameteri(glContext.TEXTURE_2D, glContext.TEXTURE_WRAP_S, glContext.CLAMP_TO_EDGE);\n      glContext.texParameteri(glContext.TEXTURE_2D, glContext.TEXTURE_WRAP_T, glContext.CLAMP_TO_EDGE);\n\n      // position texture\n      glContext.bindTexture(glContext.TEXTURE_2D, this._positionTexture);\n      glContext.texImage2D(\n        glContext.TEXTURE_2D, 0, glContext.RGBA32F,\n        this._fboWidth, this._fboHeight, 0, glContext.RGBA, glContext.FLOAT, null\n      );\n      glContext.texParameteri(glContext.TEXTURE_2D, glContext.TEXTURE_MIN_FILTER, glContext.NEAREST);\n      glContext.texParameteri(glContext.TEXTURE_2D, glContext.TEXTURE_MAG_FILTER, glContext.NEAREST);\n      glContext.texParameteri(glContext.TEXTURE_2D, glContext.TEXTURE_WRAP_S, glContext.CLAMP_TO_EDGE);\n      glContext.texParameteri(glContext.TEXTURE_2D, glContext.TEXTURE_WRAP_T, glContext.CLAMP_TO_EDGE);\n\n      // building ID texture\n      glContext.bindTexture(glContext.TEXTURE_2D, this._idTexture);\n      glContext.texImage2D(\n        glContext.TEXTURE_2D, 0, glContext.RGBA32F,\n        this._fboWidth, this._fboHeight, 0, glContext.RGBA, glContext.FLOAT, null\n      );\n      glContext.texParameteri(glContext.TEXTURE_2D, glContext.TEXTURE_MIN_FILTER, glContext.NEAREST);\n      glContext.texParameteri(glContext.TEXTURE_2D, glContext.TEXTURE_MAG_FILTER, glContext.NEAREST);\n      glContext.texParameteri(glContext.TEXTURE_2D, glContext.TEXTURE_WRAP_S, glContext.CLAMP_TO_EDGE);\n      glContext.texParameteri(glContext.TEXTURE_2D, glContext.TEXTURE_WRAP_T, glContext.CLAMP_TO_EDGE);\n\n      // depth texture\n      glContext.bindTexture(glContext.TEXTURE_2D, this._depthTexture);\n      glContext.texImage2D(\n        glContext.TEXTURE_2D, 0, glContext.DEPTH_COMPONENT32F,\n        this._fboWidth, this._fboHeight, 0, glContext.DEPTH_COMPONENT, glContext.FLOAT, null\n      );\n      glContext.texParameteri(glContext.TEXTURE_2D, glContext.TEXTURE_MIN_FILTER, glContext.NEAREST);\n      glContext.texParameteri(glContext.TEXTURE_2D, glContext.TEXTURE_MAG_FILTER, glContext.NEAREST);\n      glContext.texParameteri(glContext.TEXTURE_2D, glContext.TEXTURE_WRAP_S, glContext.CLAMP_TO_EDGE);\n      glContext.texParameteri(glContext.TEXTURE_2D, glContext.TEXTURE_WRAP_T, glContext.CLAMP_TO_EDGE);\n\n      // fbo setup\n      glContext.bindFramebuffer(glContext.FRAMEBUFFER, this._fbo);\n      glContext.framebufferTexture2D(glContext.FRAMEBUFFER, glContext.DEPTH_ATTACHMENT, glContext.TEXTURE_2D, this._depthTexture, 0);\n      glContext.framebufferTexture2D(glContext.FRAMEBUFFER, glContext.COLOR_ATTACHMENT0, glContext.TEXTURE_2D, this._normalTexture, 0);\n      glContext.framebufferTexture2D(glContext.FRAMEBUFFER, glContext.COLOR_ATTACHMENT1, glContext.TEXTURE_2D, this._positionTexture, 0);\n      glContext.framebufferTexture2D(glContext.FRAMEBUFFER, glContext.COLOR_ATTACHMENT2, glContext.TEXTURE_2D, this._idTexture, 0);\n      glContext.drawBuffers([glContext.COLOR_ATTACHMENT0, glContext.COLOR_ATTACHMENT1, glContext.COLOR_ATTACHMENT2]);\n\n      // readfbo setup\n      glContext.bindFramebuffer(glContext.FRAMEBUFFER, this._readfbo);\n      glContext.framebufferTexture2D(glContext.FRAMEBUFFER, glContext.COLOR_ATTACHMENT0, glContext.TEXTURE_2D, this._idTexture, 0);\n\n      // unbind fbos\n      glContext.bindFramebuffer(glContext.FRAMEBUFFER, null);\n    }\n  }\n\n  /**\n   * Layer VBO creation signature\n   * @param {WebGL2RenderingContext} glContext WebGL context\n   */\n  protected createBuffers(glContext: WebGL2RenderingContext) {\n    // Create a buffer for the positions.\n    this._glPositionBuffer = glContext.createBuffer();\n    // Select the positionBuffer as the one to apply buffer\n    glContext.bindBuffer(glContext.ARRAY_BUFFER, this._glPositionBuffer);\n    // send data to gpu\n    glContext.bufferData(\n      glContext.ARRAY_BUFFER, new Float32Array(this._features['position']), glContext.STATIC_DRAW\n    );\n\n    // Create a buffer for the indices.\n    this._glIndexBuffer = glContext.createBuffer();\n    // Select the index buffer as the one to apply buffer\n    glContext.bindBuffer(glContext.ELEMENT_ARRAY_BUFFER, this._glIndexBuffer);\n    // send data to gpu\n    glContext.bufferData(\n      glContext.ELEMENT_ARRAY_BUFFER, new Uint32Array(this._features['index']), glContext.STATIC_DRAW\n    );\n\n    // Create a buffer for the positions.\n    this._glBuildingIdBuffer = glContext.createBuffer();\n    // Select the positionBuffer as the one to apply buffer\n    glContext.bindBuffer(glContext.ARRAY_BUFFER, this._glBuildingIdBuffer);\n    // send data to gpu\n    glContext.bufferData(\n      glContext.ARRAY_BUFFER, new Float32Array(this._features['ids']), glContext.STATIC_DRAW\n    );\n  }\n\n  protected generateNoise(glContext: WebGL2RenderingContext) {\n    glContext.useProgram(this._shaderProgram[1]);\n\n    const uNoiseLocation: WebGLUniformLocation = glContext.getUniformLocation(this._shaderProgram[1], 'uNoise');\n    const uSamplesLocation: WebGLUniformLocation = glContext.getUniformLocation(this._shaderProgram[1], 'uSamples');\n\n    const samples = [];\n    const nSamples = 64;\n    for (let i = 0; i < nSamples; i++) {\n      const sample = vec3.fromValues(\n        Math.random() * 2.0 - 1.0,\n        Math.random() * 2.0 - 1.0,\n        Math.random()\n      );\n      vec3.normalize(sample, sample);\n      // weight samples towards center point\n      const scale = i / nSamples;\n      const s2 = scale * scale;\n      vec3.scale(sample, sample, 0.1 + 0.9 * s2);\n      samples.push(sample[0]);\n      samples.push(sample[1]);\n      samples.push(sample[2]);\n    }\n    glContext.uniform3fv(uSamplesLocation, samples, 0, nSamples * 3);\n\n    const noise = [];\n    const noiseSize = 256;\n    for (let i = 0; i < noiseSize; i++) {\n      const n = vec3.fromValues(\n        Math.random() * 2.0 - 1.0,\n        Math.random() * 2.0 - 1.0,\n        0.0\n      );\n      noise.push(n[0]);\n      noise.push(n[1]);\n      noise.push(n[2]);\n    }\n    glContext.uniform3fv(uNoiseLocation, noise, 0, noiseSize * 3);\n  }\n}\n","import { GeoUtils } from './geoutils';\nimport { vec3, mat4, vec2 } from 'gl-matrix';\nimport { CameraStatus } from './constants';\n\n/**\n * 3D Camera representation\n */\nexport class Camera {\n  // View parameters\n  protected wOrigin: vec2 = vec2.create();\n  protected wEye: vec3 = vec3.create();\n  protected wEyeDir: vec3 = vec3.create();\n  protected wEyeLength: number;\n  protected wLookAt: vec3 = vec3.create();\n  protected wUp: vec3 = vec3.create();\n  protected wNear: number;\n  protected wFar: number;\n\n  protected groundRes: number; // 1 unit in worldspace equals to {groundRes} meters in the z-axis\n\n  protected fovy = 45 * Math.PI / 180.0;\n\n  protected mProjectionMatrix: mat4 = mat4.create();\n  protected mViewMatrix: mat4 = mat4.create();\n  protected mModelMatrix: mat4 = mat4.create();\n\n  // camera status\n  private status: CameraStatus;\n\n  // view resolution\n  private viewportWidth: number;\n  private viewportHeight: number;\n\n  /**\n   * The Camera constructor\n   */\n  constructor(wx: number, wy: number, wz: number) {\n    this.groundRes = GeoUtils.groundResolution(wx, wy, 0);\n    // z-values start from here are in meters\n    this.wNear = 10 / this.groundRes;\n    this.wFar = 1e9 / this.groundRes;\n\n    // const projectedCenter = GeoUtils.latLng2Coord(wx, wy);\n    this.wOrigin = vec2.fromValues(wx, wy);\n    const projectedCenter = [0, 0];\n    this.wLookAt = vec3.fromValues(projectedCenter[0], projectedCenter[1], 0);\n    this.wEye = vec3.fromValues(projectedCenter[0], projectedCenter[1], 10000); // TODO: calculate the camera height instead of hardcoding\n    this.zScaling(1 / this.groundRes);\n    // meter is not longer used in the remaining code\n    this.wUp = vec3.fromValues(0, 1, 0);\n    //\n    this.status = CameraStatus.Camera3D;\n  }\n\n  getCameraStatus(): CameraStatus {\n    return this.status;\n  }\n\n  setCameraStatus(status: CameraStatus) {\n    this.status = status;\n    if (this.status === CameraStatus.Camera2D) {\n      // set parameters\n      this.wLookAt = vec3.fromValues(this.wEye[0], this.wEye[1], 0);\n      // meter is not longer used in the remaining code\n      this.wUp = vec3.fromValues(0, 1, 0);\n      this.wEyeDir = vec3.fromValues(0, 0, -1);\n      this.wEyeLength = vec3.length(this.wEyeDir);\n    }\n  }\n\n  getProjectionMatrix(): Float32Array | number[] {\n    return this.mProjectionMatrix;\n  }\n\n  getViewMatrix(): Float32Array | number[] {\n    return this.mViewMatrix;\n  }\n\n  getModelViewMatrix(): Float32Array | number[] {\n    const modelViewMatrix = mat4.mul(mat4.create(), this.mViewMatrix, this.mModelMatrix); // modelView matrix\n    return modelViewMatrix;\n  }\n\n  getWorldOrigin(): Float32Array | number[] {\n    return this.wOrigin;\n  }\n\n  getEye(): Float32Array | number[] {\n    return this.wEye;\n  }\n\n  getGroundResolution(): number {\n    return this.groundRes;\n  }\n\n  setViewportResolution(x: number, y: number) {\n    this.viewportWidth = x;\n    this.viewportHeight = y;\n  }\n\n  getViewportResolution(): number[] {\n    return [\n      this.viewportWidth,\n      this.viewportHeight\n    ];\n  }\n\n  updateEyeDirAndLen() {\n    vec3.sub(this.wEyeDir, this.wLookAt, this.wEye);\n    this.wEyeLength = vec3.length(this.wEyeDir);\n    vec3.normalize(this.wEyeDir, this.wEyeDir);\n  }\n\n  zScaling(scale: number) {\n    this.wEye[2] = this.wEye[2] * scale;\n    this.wLookAt[2] = this.wLookAt[2] * scale;\n\n    this.updateEyeDirAndLen();\n  }\n\n  zoom(delta: number, x: number, y: number) {\n    delta = delta < 0 ? 0.003 : -0.003;\n\n    const dir = this.screenCoordToWorldDir(x, y);\n    vec3.scaleAndAdd(this.wEye, this.wEye, dir, delta); // this.wEye += dir * delta;\n    vec3.scaleAndAdd(this.wLookAt, this.wEye, this.wEyeDir, this.wEyeLength); // this.wLookAt = this.wEye + this.wEyeDir * this.wEyeLength;\n  }\n\n  translate(dx: number, dy: number) {\n    const scale = this.wEye[2];\n    const X = vec3.create();\n    vec3.normalize(X, vec3.cross(X, this.wEyeDir, this.wUp));\n\n    // D = X * dx * scale + this.wUp * dy * scale;\n    const D = vec3.add(vec3.create(), vec3.scale(vec3.create(), X, dx * scale), vec3.scale(vec3.create(), this.wUp, dy * scale));\n    vec3.add(this.wEye, this.wEye, D);\n\n    vec3.scaleAndAdd(this.wLookAt, this.wEye, this.wEyeDir, this.wEyeLength); // this.wLookAt = this.wEye + this.wEyeDir * this.wEyeLength;\n  }\n\n  yaw(delta: number) {\n    vec3.rotateZ(this.wEyeDir, this.wEyeDir, vec3.fromValues(0, 0, 0), delta);\n    vec3.rotateZ(this.wUp, this.wUp, vec3.fromValues(0, 0, 0), delta);\n\n    vec3.scaleAndAdd(this.wLookAt, this.wEye, this.wEyeDir, this.wEyeLength); // this.wLookAt = this.wEye + this.wEyeDir * this.wEyeLength;\n  }\n\n  pitch(delta: number) {\n    delta = -delta;\n    // this.wEyeDir = this.wUp * sin(delta) + this.wEyeDir * cos(delta);\n    vec3.add(this.wEyeDir, vec3.scale(vec3.create(), this.wUp, Math.sin(delta)), vec3.scale(vec3.create(), this.wEyeDir, Math.cos(delta)));\n    vec3.normalize(this.wEyeDir, this.wEyeDir);\n\n    vec3.scaleAndAdd(this.wLookAt, this.wEye, this.wEyeDir, this.wEyeLength); // this.wLookAt = this.wEye + this.wEyeDir * this.wEyeLength;\n\n    vec3.cross(this.wUp, vec3.cross(vec3.create(), this.wEyeDir, this.wUp), this.wEyeDir);\n    vec3.normalize(this.wUp, this.wUp);\n  }\n\n  update() {\n    this.mModelMatrix = mat4.fromScaling(mat4.create(), vec3.fromValues(1, 1, 1 / this.groundRes)); // model matrix\n    mat4.lookAt(this.mViewMatrix, this.wEye, this.wLookAt, this.wUp); // view matrix\n    mat4.perspective(this.mProjectionMatrix, this.fovy, 1, this.wNear, this.wFar); // TODO: get the aspect ratio from canvas\n  }\n\n  screenCoordToWorldDir(x: number, y: number) {\n    const wRight = vec3.create();\n    vec3.normalize(wRight, vec3.cross(wRight, this.wEyeDir, this.wUp));\n\n    const upOffset = vec3.scale(vec3.create(), this.wUp, Math.tan(this.fovy / 2) * (y - 0.5) * 2);\n    const rightOffset = vec3.scale(vec3.create(), wRight, Math.tan(this.fovy / 2) * (x - 0.5) * 2);\n    const offset = vec3.add(vec3.create(), upOffset, rightOffset);\n    const dir = vec3.add(vec3.create(), this.wEyeDir, offset);\n    vec3.normalize(dir, dir);\n\n    return dir;\n  }\n\n  screenCoordToLatLng(x: number, y: number) {\n    const dir = this.screenCoordToWorldDir(x, y);\n\n    const t = -this.wEye[2] / dir[2];\n    if (t > 0) {\n      const intersectPoint = vec3.scaleAndAdd(vec3.create(), this.wEye, dir, t);\n      const originCoord = GeoUtils.latLng2Coord(this.wOrigin[0], this.wOrigin[1]);\n      const latLng = GeoUtils.coord2LatLng(intersectPoint[0] + originCoord[0], intersectPoint[1] + originCoord[1]);\n      console.log(latLng);\n      return latLng;\n    }\n    return null;\n  }\n}\n","import * as d3 from 'd3';\nimport { ColorMapType } from './constants';\n\nexport abstract class ColorMap {\n /**\n   * Color brewer sequential red\n   */\n  public static sequentialRed(reverse: boolean = false, size = 515): number [] {\n    const cscale = d3.scaleDiverging(d3.interpolateReds).domain([-1, 0, 1]);\n\n    const colors = [];\n\n    for (let id = 0 ; id < size; id++) {\n        const val  = -1 + id * 2 / (size - 1);\n        const color = cscale(val).match(/\\d+/g).map(d => +d);\n        \n        colors.push(...color);\n        colors.push(255)\n    }\n\n    if (reverse) {\n      return colors.reverse();\n    } else {\n      return colors;\n    }\n  }\n\n  /**\n   * Color brewer sequential blue\n   */\n  public static sequentialBlue(reverse: boolean = false, size = 515): number [] {\n    const cscale = d3.scaleDiverging(d3.interpolateBlues).domain([-1, 0, 1]);\n\n    const colors = [];\n\n    for (let id = 0 ; id < size; id++) {\n        const val  = -1 + id * 2 / (size - 1);\n        const color = cscale(val).match(/\\d+/g).map(d => +d);\n        \n        colors.push(...color);\n        colors.push(255)\n    }\n\n\n    if (reverse) {\n      return colors.reverse();\n    } else {\n      return colors;\n    }\n  }\n\n  /**\n   * Color brewer diverging blue and red\n   */\n  public static divergingRedYelBlue(reverse: boolean = false, size = 515): number [] {\n    const cscale = d3.scaleDiverging(d3.interpolateRdYlBu).domain([-1, 0, 1]);\n\n    const colors = [];\n\n    for (let id = 0 ; id < size; id++) {\n        const val  = -1 + id * 2 / (size - 1);\n        const color = cscale(val).match(/\\d+/g).map(d => +d);\n        \n        colors.push(...color);\n        colors.push(255)\n    }\n\n    if (reverse) {\n      return colors.reverse();\n    } else {\n      return colors;\n    }\n  }\n\n\n  /**\n   * Color brewer diverging blue and red\n   */\n  public static divergingRedBlue(reverse: boolean = false, size = 515): number [] {\n    const cscale = d3.scaleDiverging(d3.interpolateRdBu).domain([-1, 0, 1]);\n\n    const colors = [];\n\n    for (let id = 0 ; id < size; id++) {\n        const val  = -1 + id * 2 / (size - 1);\n        const color = cscale(val).match(/\\d+/g).map(d => +d);\n        \n        colors.push(...color);\n        colors.push(255)\n    }\n\n\n    if (reverse) {\n      return colors.reverse();\n    } else {\n      return colors;\n    }\n  }\n\n  /**\n   * Color brewer diverging blue and red\n   */\n  public static divergingGreenBrown(reverse: boolean = false, size = 515): number [] {\n    const cscale = d3.scaleDiverging(d3.interpolateGnBu).domain([-1, 0, 1]);\n\n    const colors = [];\n\n    for (let id = 0 ; id < size; id++) {\n        const val  = -1 + id * 2 / (size - 1);\n        const color = cscale(val).match(/\\d+/g).map(d => +d);\n        \n        colors.push(...color);\n        colors.push(255)\n    }\n\n    if (reverse) {\n      return colors.reverse();\n    } else {\n      return colors;\n    }\n  }\n\n  /**\n   * Color brewer qualitative colors\n   */\n  public static qualitative(reverse: boolean = false): number [] {\n    // TODO: FIX\n\n    const colors = [\n      166, 206, 227, 255,\n      178, 223, 138, 255,\n      251, 154, 153, 255,\n      253, 191, 111, 255,\n      202, 178, 214, 255,\n       31, 120, 180, 255,\n       51, 160,  44, 255,\n      227,  26,  28, 255,\n      255, 127,   0, 255,\n    ];\n\n    if (reverse) {\n      return colors.reverse();\n    } else {\n      return colors;\n    }\n  }\n\n  public static getColorMap(color: ColorMapType, reverse: boolean = false): number[] {\n    switch (color) {\n      case ColorMapType.SEQUENTIAL_RED_MAP:\n      return ColorMap.sequentialRed(reverse);\n\n      case ColorMapType.SEQUENTIAL_BLUE_MAP:\n      return ColorMap.sequentialBlue(reverse);\n\n      case ColorMapType.DIVERGING_RED_BLUE_MAP:\n      return ColorMap.divergingRedBlue(reverse);\n\n      case ColorMapType.DIVERGING_RED_YEL_BLUE_MAP:\n      return ColorMap.divergingRedYelBlue(reverse);\n\n      case ColorMapType.DIVERGING_GREEN_BROWN_MAP:\n      return ColorMap.divergingGreenBrown(reverse);\n\n      case ColorMapType.QUALITATIVE_MAP:\n      return ColorMap.qualitative(reverse);\n\n      default:\n      return ColorMap.sequentialRed(reverse);\n    }\n  }\n\n  static computeScalarValue(val, min, max, neutral = 0) {\n    let sValue = null; \n\n    if ((min < neutral && max < neutral) || (min > neutral && max > neutral)) {\n      neutral = (min + max) * 0.5;\n    }    \n\n    if (val < neutral) {\n      sValue = (val - min) / (neutral - min) * 0.5; \n    } else {\n      sValue = 0.5 + (val - neutral) / (max - neutral) * 0.5;\n    }\n\n    if (val === neutral && neutral === min && min === max) {\n      return 0.5;\n    }\n\n    return sValue;\n  }\n\n}\n","/**\n * Layer types definition\n */\nexport class LayerTypes {\n  public static PHYSICAL_LAYER = 'physical';\n  public static BUILDING_LAYER = 'building';\n  public static POLYGON_LAYER = 'polygon';\n  public static HEATMAP_LAYER = 'heatmap';\n  public static POINT_LAYER = 'point';\n  public static LINE_LAYER = 'line';\n}\n\n/**\n * Colormap types definition\n */\nexport class ColorMapType {\n  public static SEQUENTIAL_RED_MAP = 'sequential_red';\n  public static SEQUENTIAL_BLUE_MAP = 'sequential_blue';\n  public static DIVERGING_RED_BLUE_MAP = 'diverging_blue_red';\n  public static DIVERGING_RED_YEL_BLUE_MAP = 'diverging_red_yellow_blue';\n  public static DIVERGING_GREEN_BROWN_MAP = 'diverging_green_brown';\n  public static QUALITATIVE_MAP = 'qualitative';\n}\n\n/**\n * Mapview interaction status\n */\nexport class MapViewStatus {\n  public static IDLE = 0;\n  public static DRAG = 1;\n}\n\n/**\n * Camera status\n */\nexport class CameraStatus {\n  public static Camera2D = 0;\n  public static Camera3D = 1;\n}\n","import { DataLoader } from './data-loader';\nimport { environment } from '../../environments/environment';\n\nexport abstract class DataApi {\n  /**\n   * Load all layers\n   * @returns {Promise<any>} The load index promise\n   */\n  static async getMapIndex(index): Promise<any> {\n    const url = `${environment.backend}/assets/${environment.folder}/${index}`;\n    console.log(url);\n\n    const datasets = await DataLoader.getJsonData(url);\n    return datasets;\n  }\n\n  /**\n   * Load the camera\n   * @returns {Promise<any>} The load camera promise\n   */\n  static async getCameraParameters(camera): Promise<any> {\n    const url = `${environment.backend}/assets/${environment.folder}/${camera}`;\n    console.log(url);\n\n    const params = await DataLoader.getJsonData(url);\n    return params;\n  }\n\n  /**\n   * Gets the layer data\n   * @param {Promise<any>} layerId the layer data\n   */\n  static async getLayerFeature(layerId: string): Promise<any> {\n    const url = `${environment.backend}/assets/${environment.folder}/${layerId}.json`;\n    console.log(url);\n\n    const feature = await DataLoader.getJsonData(url);\n    return feature;\n  }\n\n  /**\n   * Gets the layer function\n   * @param {Promise<any>} layerId the layer data\n   */\n  static async getLayerFunction(layerId: string): Promise<any> {\n    // TODO\n    const url = `${environment.backend}/assets/${environment.folder}/${layerId}.json`;\n    console.log(url);\n\n    const feature = await DataLoader.getJsonData(url);\n    return feature;\n  }\n}\n","export abstract class DataLoader {\n  /**\n   * Loads a json file\n   * @param {string} url json file url\n   * @returns {Promise<any>} The load json promise\n   */\n  static async getJsonData(url: string): Promise<any> {\n    // Return a new promise.\n    const response = await fetch(url);\n    const json = await response.json();\n\n    return json;\n  }\n\n  /**\n   * Loads a text file\n   * @param {string} url text file url\n   * @returns {Promise<string>} The load text promise\n   */\n  static async getTextData(url: string): Promise<string> {\n    // Return a new promise.\n    const response = await fetch(url);\n    const txt = await response.text();\n\n    return txt;\n  }\n}\n","\nexport abstract class GeoUtils {\n  /**\n   * Converts from lat, lng to world coordinates\n   * @param {number} latitude the latitude of the point\n   * @param {number} longitude the longitude of the point\n   * @returns {number[]} the point in world coordinates\n   */\n  public static latLng2Coord(latitude: number, longitude: number) {\n    const pi_4 = 12.56637061435917295385057353311801153678867759750042328389;\n    const pi_180 = 0.017453292519943295769236907684886127134428718885417254560;\n\n    const sinLatitude = Math.sin(latitude * pi_180);\n    const pixelY = 256.0 - ((0.5 - Math.log((1.0 + sinLatitude) / (1.0 - sinLatitude)) / (pi_4)) * 256.0);\n    const pixelX = ((longitude + 180.0) / 360.0) * 256.0;\n    return [pixelX, pixelY];\n  }\n\n  /**\n   * Converts from world coordinates to lat, lng\n   * @param {number} x the x coordinate of the point\n   * @param {number} y the y coordinate of the point\n   * @returns {number[]} the point in lat, lng\n   */\n  public static coord2LatLng(x: number, y: number) {\n    const pi_4 = 12.56637061435917295385057353311801153678867759750042328389;\n    const pi_180 = 0.017453292519943295769236907684886127134428718885417254560;\n\n    const longitude = ((x / 256.0) * 360.0) - 180.0;\n    let latitude = (256.0 - y) / 256.0;\n    latitude = Math.exp((0.5 - latitude) * pi_4);\n    latitude = (latitude - 1.0) / (1.0 + latitude);\n    latitude = Math.asin(latitude) / pi_180;\n    return [latitude, longitude];\n  }\n\n  /**\n   * Computes the ground resolution\n   * @param {number} lat the latitude value\n   * @param {number} lng the longitude value\n   * @param {number} zoom the zoom leevl\n   */\n  public static groundResolution(lat, lng, zoom) {\n    return Math.cos(lat * Math.PI / 180) * 6378137 * 2 * Math.PI / Math.pow(2, 8 + zoom);\n  }\n}\n","/// <reference types=\"@types/webgl2\" />\n\nimport { Layer } from './layer';\nimport { DataLoader } from './data-loader';\nimport { DataApi } from './data-api';\nimport { ColorMapType } from './constants';\nimport { ColorMap } from './colormap';\n\nimport { percentile } from 'stats-lite';\n\nexport class HeatmapLayer extends Layer {\n  // number of coordinates per vertex\n  protected static COORDS = 2;\n  // number of shaders\n  protected static N_SHADER = 1;\n\n  // primitive Ids\n  protected _features: any = {};\n\n  // OpenGL data buffer\n  protected _glPositionBuffer: WebGLBuffer = null;\n  protected _glTexCoordsBuffer: WebGLBuffer = null;\n  protected _glIndexBuffer: WebGLBuffer = null;\n\n  protected _glColorMapTex: WebGLTexture = null;\n  protected _glFunctionTex: WebGLTexture = null;\n\n  // function texture resolution\n  protected _functionResX = 0;\n  protected _functionResY = 0;\n\n  // shader attribute id\n  protected _positionId = -1;\n  protected _texCoordsId = -1;\n\n  // transformation uniforms\n  protected _uModelViewMatrixId: WebGLUniformLocation = -1;\n  protected _uProjectionMatrixId: WebGLUniformLocation = -1;\n  protected _uWorldOriginId: WebGLUniformLocation = -1;\n\n  // color map uniform\n  protected _uColorMapId: WebGLUniformLocation = -1;\n  protected _uFunctionId: WebGLUniformLocation = -1;\n\n  /**\n   * The Vector Layer constructor\n   * @param {string} id the layer id\n   */\n  constructor(id: string) {\n    super(id);\n    this._visible = false;\n  }\n\n  /**\n   * Shader load signature\n   * @param {WebGL2RenderingContext} glContext WebGL context\n   */\n  async loadShaders(glContext: WebGL2RenderingContext) {\n    // load the shaders\n    for (let id = 0; id < HeatmapLayer.N_SHADER; id++) {\n      // shaders url\n      const vertUrl = `assets/shaders/heatmap(${id}).vert`;\n      const fragUrl = `assets/shaders/heatmap(${id}).frag`;\n\n      // Vertex shader program\n      const vsShader = await DataLoader.getTextData(vertUrl);\n      // Fragment shader program\n      const fsShader = await DataLoader.getTextData(fragUrl);\n\n      // load all shaders\n      this.initShaderProgram(vsShader, fsShader, glContext);\n    }\n\n    // vertex data on the shader\n    this._positionId = glContext.getAttribLocation(this._shaderProgram[0], 'vertPos');\n    this._texCoordsId = glContext.getAttribLocation(this._shaderProgram[0], 'vertTexCoords');\n\n    // transformation uniforms on the shader\n    this._uModelViewMatrixId = glContext.getUniformLocation(this._shaderProgram[0], 'uModelViewMatrix');\n    this._uProjectionMatrixId = glContext.getUniformLocation(this._shaderProgram[0], 'uProjectionMatrix');\n    this._uWorldOriginId = glContext.getUniformLocation(this._shaderProgram[0], 'uWorldOrigin');\n\n    // colorMap texture\n    this._uColorMapId = glContext.getUniformLocation(this._shaderProgram[0], 'uColorMap');\n    this._uFunctionId = glContext.getUniformLocation(this._shaderProgram[0], 'uFunction');\n\n    // load message\n    console.log(`#${HeatmapLayer.N_SHADER} shaders successfully loaded for layer ${this._layerId}.`);\n  }\n\n  /**\n   * Data update signature\n   * @returns {Promise<any>} The load data promise\n   */\n  async updateFeatures(glContext: WebGL2RenderingContext, data: any = null) {\n    if (data === null) {\n      // gets the feature of index id\n      data = await DataApi.getLayerFeature(this._layerId);\n    }\n\n    // new feature found\n    this._features = {'position': [], 'texCoords': [], 'scalar': [], 'index': []};\n\n    // grid corners\n    const corners = data.coordinates;\n    // quad geometry\n    const position = [\n      corners[0][0], corners[0][1],\n      corners[1][0], corners[0][1],\n      corners[1][0], corners[1][1],\n      corners[0][0], corners[1][1],\n    ];\n    // build the indices\n    const indices = [0, 1, 3, 1, 2, 3];\n    // texture coordinates\n    const texCoords = [\n      0, 0, 0, 1,\n      1, 1, 1, 0,\n    ];\n\n    // resolution\n    this._functionResX = data.resX;\n    this._functionResY = data.resY;\n\n    // add to the feature\n    this._features['position'] = position;\n    this._features['texCoords'] = texCoords;\n\n    // scalar function\n    const scalar = data.grid;\n    const noNull = scalar.filter(d => d > 0);\n\n    const min = percentile(noNull, 0.15);\n    const max = percentile(noNull, 0.95);\n\n    // add to the feature\n    this._features['scalar'] = scalar.map(val => {\n      return val ? Math.max(0, Math.min((val - min) / (max - min), 1)) : -1;\n    });\n\n    this._features['index'] = indices;\n\n    // creates the buffer\n    this.createBuffers(glContext);\n    // creates the scalar data vbo\n    this.createFunctionTexture(glContext);\n    // creates the color map\n    this.createColorMapTexture(glContext, ColorMapType.SEQUENTIAL_RED_MAP, false);\n  }\n\n  /**\n   * Function update signature\n   * @param {WebGL2RenderingContext} glContext WebGL context\n   */\n  async updateFunction(glContext: WebGL2RenderingContext, data: any) {\n    // resolution\n    this._functionResX = data.resX;\n    this._functionResY = data.resY;\n\n    // scalar function\n    const scalar = data.grid;\n    const noNull = scalar.filter(d => d > 0);\n\n    const min = percentile(noNull, 0.15);\n    const max = percentile(noNull, 0.95);\n\n    // add to the feature\n    this._features['scalar'] = scalar.map(val => {\n      return val ? Math.max(0, Math.min((val - min) / (max - min), 1)) : -1;\n    });\n\n    // creates the scalar data vbo\n    this.createFunctionTexture(glContext);\n  }\n\n  /**\n   * Changes the color map\n   * @param {WebGL2RenderingContext} glContext WebGL context\n   * @param {ColorMapType} cMap Color Map\n   */\n  updateColorMap(glContext: WebGL2RenderingContext, cMap: ColorMapType) {\n    // creates the color map\n    this.createColorMapTexture(glContext, cMap, false);\n  }\n\n  /**\n   * Layer render function signature\n   * @param {WebGL2RenderingContext} glContext WebGL context\n   */\n  render(glContext: WebGL2RenderingContext) {\n    // invalid layers\n    if (\n      this._shaderProgram.length === 0 ||\n      this._shaderProgram[0] === null ||\n      this._glPositionBuffer === null ||\n      this._glTexCoordsBuffer === null ||\n      this._glIndexBuffer === null ||\n      this._glColorMapTex === null ||\n      this._glFunctionTex === null ||\n      this._positionId < 0 ||\n      this._texCoordsId < 0\n    ) {\n      return;\n    }\n\n    // sends the uniforms\n    this.setUniforms(glContext);\n\n    // bending\n    glContext.enable(glContext.BLEND);\n    glContext.blendFunc(glContext.SRC_ALPHA, glContext.ONE_MINUS_SRC_ALPHA);\n\n    // binds the position buffer\n    glContext.bindBuffer(glContext.ARRAY_BUFFER, this._glPositionBuffer);\n    glContext.vertexAttribPointer(this._positionId, HeatmapLayer.COORDS, glContext.FLOAT, false, 0, 0);\n    glContext.enableVertexAttribArray(this._positionId);\n\n    // binds the position buffer\n    glContext.bindBuffer(glContext.ARRAY_BUFFER, this._glTexCoordsBuffer);\n    glContext.vertexAttribPointer(this._texCoordsId, HeatmapLayer.COORDS, glContext.FLOAT, false, 0, 0);\n    glContext.enableVertexAttribArray(this._texCoordsId);\n\n    // Tell WebGL which indices to use to index the vertices\n    glContext.bindBuffer(glContext.ELEMENT_ARRAY_BUFFER, this._glIndexBuffer);\n\n    // Tell WebGL we want to affect texture unit 0\n    glContext.activeTexture(glContext.TEXTURE0);\n    // Bind the texture to texture unit 0\n    glContext.bindTexture(glContext.TEXTURE_2D, this._glFunctionTex);\n\n    // Tell WebGL we want to affect texture unit 1\n    glContext.activeTexture(glContext.TEXTURE1);\n    // Bind the texture to texture unit 1\n    glContext.bindTexture(glContext.TEXTURE_2D, this._glColorMapTex);\n\n    // binds the shader program\n    glContext.useProgram(this._shaderProgram[0]);\n\n    // draw the geometry\n    glContext.drawElements(glContext.TRIANGLES, this._features['index'].length, glContext.UNSIGNED_INT, 0);\n\n    // disable blend\n    glContext.disable(glContext.BLEND);\n  }\n\n  /**\n   * Send uniforms to the shader\n   * @param {WebGL2RenderingContext} glContext WebGL context\n   */\n  protected setUniforms(glContext: WebGL2RenderingContext) {\n    if (!this._shaderProgram.length || this._shaderProgram[0] === null) {\n      return;\n    }\n    // selects the shader\n    glContext.useProgram(this._shaderProgram[0]);\n\n    // send matrices\n    glContext.uniformMatrix4fv(this._uModelViewMatrixId, false, this._camera.getModelViewMatrix());\n    glContext.uniformMatrix4fv(this._uProjectionMatrixId, false, this._camera.getProjectionMatrix());\n    // send world origin\n    const worldOrigin = this._camera.getWorldOrigin();\n    glContext.uniform2f(this._uWorldOriginId, worldOrigin[0], worldOrigin[1]);\n\n    // functions texture\n    glContext.uniform1i(this._uFunctionId, 0);\n    // color map\n    glContext.uniform1i(this._uColorMapId, 1);\n  }\n\n  /**\n   * Layer VBO creation signature\n   * @param {WebGL2RenderingContext} glContext WebGL context\n   */\n  protected createBuffers(glContext: WebGL2RenderingContext) {\n    // Create a buffer for the positions.\n    this._glPositionBuffer = glContext.createBuffer();\n    // Select the positionBuffer as the one to apply buffer\n    glContext.bindBuffer(glContext.ARRAY_BUFFER, this._glPositionBuffer);\n    // send data to gpu\n    glContext.bufferData(\n      glContext.ARRAY_BUFFER, new Float32Array(this._features['position']), glContext.STATIC_DRAW\n    );\n\n    // Create a buffer for the positions.\n    this._glTexCoordsBuffer = glContext.createBuffer();\n    // Select the positionBuffer as the one to apply buffer\n    glContext.bindBuffer(glContext.ARRAY_BUFFER, this._glTexCoordsBuffer);\n    // send data to gpu\n    glContext.bufferData(\n      glContext.ARRAY_BUFFER, new Float32Array(this._features['texCoords']), glContext.STATIC_DRAW\n    );\n\n    // Create a buffer for the indices.\n    this._glIndexBuffer = glContext.createBuffer();\n    // Select the index buffer as the one to apply buffer\n    glContext.bindBuffer(glContext.ELEMENT_ARRAY_BUFFER, this._glIndexBuffer);\n    // send data to gpu\n    glContext.bufferData(\n      glContext.ELEMENT_ARRAY_BUFFER, new Uint32Array(this._features['index']), glContext.STATIC_DRAW);\n  }\n\n  /**\n   * Scalar data vbo creation\n   * @param {WebGL2RenderingContext} glContext WebGL context\n   */\n  protected createFunctionTexture(glContext: WebGL2RenderingContext) {\n    // gl color map texture\n    if (this._glFunctionTex === null) {\n      this._glFunctionTex = glContext.createTexture();\n    }\n    // send the color map\n    glContext.bindTexture(glContext.TEXTURE_2D, this._glFunctionTex);\n    glContext.texImage2D(\n      glContext.TEXTURE_2D, 0, glContext.R16F, this._functionResX, this._functionResY, 0,\n      glContext.RED, glContext.FLOAT, new Float32Array(this._features['scalar'])\n    );\n    // texture resize\n    glContext.texParameteri(glContext.TEXTURE_2D, glContext.TEXTURE_MIN_FILTER, glContext.LINEAR);\n    glContext.texParameteri(glContext.TEXTURE_2D, glContext.TEXTURE_MAG_FILTER, glContext.LINEAR);\n    // Prevents s-coordinate wrapping (repeating).\n    glContext.texParameteri(glContext.TEXTURE_2D, glContext.TEXTURE_WRAP_S, glContext.CLAMP_TO_EDGE);\n    // Prevents t-coordinate wrapping (repeating).\n    glContext.texParameteri(glContext.TEXTURE_2D, glContext.TEXTURE_WRAP_T, glContext.CLAMP_TO_EDGE);\n  }\n\n    /**\n   * Color map texture creation\n   * @param {WebGL2RenderingContext} glContext WebGL context\n   * @param {ColorMapType} color Selected color map\n   * @param {boolean} get the reverse color map\n   */\n  protected createColorMapTexture(glContext: WebGL2RenderingContext, color: ColorMapType, reverse: boolean = false) {\n    // gets the color map\n    const cmap = ColorMap.getColorMap(color, reverse);\n    // gl color map texture\n    if (this._glColorMapTex === null) {\n      this._glColorMapTex = glContext.createTexture();\n    }\n\n    // send the color map\n    glContext.bindTexture(glContext.TEXTURE_2D, this._glColorMapTex);\n    glContext.texImage2D(\n      glContext.TEXTURE_2D, 0, glContext.RGBA, cmap.length / 4, 1, 0,\n      glContext.RGBA, glContext.UNSIGNED_BYTE, new Uint8Array(cmap)\n    );\n    // texture resize\n    glContext.texParameteri(glContext.TEXTURE_2D, glContext.TEXTURE_MIN_FILTER, glContext.LINEAR);\n    glContext.texParameteri(glContext.TEXTURE_2D, glContext.TEXTURE_MAG_FILTER, glContext.LINEAR);\n    // Prevents s-coordinate wrapping (repeating).\n    glContext.texParameteri(glContext.TEXTURE_2D, glContext.TEXTURE_WRAP_S, glContext.CLAMP_TO_EDGE);\n    // Prevents t-coordinate wrapping (repeating).\n    glContext.texParameteri(glContext.TEXTURE_2D, glContext.TEXTURE_WRAP_T, glContext.CLAMP_TO_EDGE);\n  }\n}\n","import { MapView } from './mapview';\n\nexport class KeyEvents {\n  // div to attach the events\n  private _map: MapView;\n  // callbacks\n  private _callbacks: any;\n\n  /**\n   * Mouse events constructor\n   * @param map the map to bind the events\n   */\n  constructor(map, callbacks = null) {\n    this._map = map;\n    this._callbacks = callbacks;\n  }\n\n  bindEvents() {\n    // sets the key listeners\n    window.addEventListener('keydown', this.keyDown.bind(this), false);\n  }\n\n  /**\n  * Handles key down event\n  */\n  keyDown(event: KeyboardEvent) {\n    // key value\n    const key = +event.key;\n    const layers = this._map.layerManager.layers;\n\n    // number key\n    // if (!isNaN(key) && key < layers.length) {\n    //   // makes in visible\n    //   const isVisible = layers[key].visible;\n    //   layers[key].visible = !isVisible;\n\n    //   // render\n    //   this._map.render();\n    // }\n\n    // change camera mode\n    if (event.key === 'd') {\n      this._map.toggleCameraMode();\n    }\n  }\n}\n","// data loader\nimport { DataLoader } from './data-loader';\n\n// layers base classes\nimport { Layer } from './layer';\nimport { LayerTypes } from './constants';\n// layer types\nimport { BuildingLayer } from './building-layer';\nimport { PhysicalLayer } from './physical-layer';\nimport { PolygonLayer } from './polygon-layer';\nimport { HeatmapLayer } from './heatmap-layer';\nimport { PointLayer } from './point-layer';\n\nexport class LayerManager {\n  // index file\n  protected _index: string;\n  // Loaded layers\n  protected _layers: Layer[] = [];\n\n  /**\n   * Layer manager constructor\n   * @param {string} indexUrl Layers index file\n   */\n  constructor(indexUrl: string) {\n    this._index = indexUrl;\n  }\n\n  /**\n   * Layers vector accessor\n   * @returns {Layer[]} The array of layers\n   */\n  get layers(): Layer[] {\n    return this._layers;\n  }\n\n  /*\n   * Load all layers\n   * @returns {Promise<any>} The load index promise\n   */\n  loadIndex(): Promise<any> {\n    return DataLoader.getJsonData(this._index).then( (layers) => {\n      return layers;\n    });\n  }\n\n   /**\n   * Creates a layer from the server\n   * @param {string} layerType layer type\n   * @param {string} layerId layer identifier\n   * @returns {Promise<Layer>} The load layer promise\n   */\n  createLayer(layerType: string, layerId: string) {\n    // loaded layer\n    let layer = null;\n\n    // loads based on type\n    switch (layerType) {\n      case LayerTypes.PHYSICAL_LAYER:\n        layer = new PhysicalLayer(layerId);\n      break;\n      case LayerTypes.BUILDING_LAYER:\n        layer = new BuildingLayer(layerId);\n      break;\n      case LayerTypes.POLYGON_LAYER:\n        layer = new PolygonLayer(layerId);\n      break;\n      case LayerTypes.HEATMAP_LAYER:\n        layer = new HeatmapLayer(layerId);\n      break;\n      case LayerTypes.POINT_LAYER:\n        layer = new PointLayer(layerId);\n      break;\n      default:\n        console.error(`File ${layerId}.json has an unknown layer type: {layerType}.`);\n      break;\n    }\n\n    // adds the the list of layers\n    this._layers.push(layer);\n\n    // returns the layer\n    return layer;\n  }\n\n  getLayer(layerId: string) {\n    for(const layer of this._layers) {\n      if (layerId === layer.layerId) {\n        return layer;\n      }\n    }\n\n    return null;\n  }\n}\n","/// <reference types=\"@types/webgl2\" />\n\nimport { Camera } from './camera';\nimport { ColorMapType } from './constants';\n\nexport class Layer {\n  // is visible\n  protected _visible: boolean;\n  // is selectable\n  protected _selectable: boolean;\n\n  // layer id\n  protected _layerId: string;\n  // layer's shader\n  protected _shaderProgram: WebGLShader[] = [];\n  // layer's camera\n  protected _camera: Camera;\n\n  /**\n   * Layer constructor\n   * @param {string} id The Mapview layer Identifier\n   */\n  constructor(id: string) {\n    this._layerId = id;\n    this._visible = true;\n    this._selectable = false;\n  }\n\n  /**\n   * Accessor for the layer id\n   */\n  get layerId() {\n    return this._layerId;\n  }\n\n  /**\n   * Returns if the layers is visible\n   */\n  get visible(): boolean {\n    return this._visible;\n  }\n\n  /**\n   * Sets the visibility\n   */\n  set visible(visible: boolean) {\n    this._visible = visible;\n  }\n\n  /**\n   * Returns if the layers is selectable\n   */\n  get selectable(): boolean {\n    return this._selectable;\n  }\n\n  /**\n   * Sets the selection\n   */\n  set selectable(selectable: boolean) {\n    this._selectable = selectable;\n  }\n\n  /**\n   * Sends the camera to the layer\n   */\n  set camera(camera: Camera) {\n    this._camera = camera;\n  }\n\n  /**\n   * Shader load signature\n   * @param {WebGL2RenderingContext} glContext WebGL context\n   */\n  loadShaders(glContext: WebGL2RenderingContext) {\n    throw new Error('Each layer has to implement it!');\n  }\n\n  /**\n   * Data update signature\n   * @param {WebGL2RenderingContext} glContext WebGL context\n   * @param data layer data\n   */\n  updateFeatures(glContext: WebGL2RenderingContext, data: any = null) {\n    throw new Error('Each layer has to implement it!');\n  }\n\n  /**\n   * Function update signature\n   * @param {WebGL2RenderingContext} glContext WebGL context\n   * @param data layer function\n   */\n  updateFunction(glContext: WebGL2RenderingContext, data: any) {\n    throw new Error('Each layer has to implement it!');\n  }\n\n  /**\n   * Function update signature\n   * @param {WebGL2RenderingContext} glContext WebGL context\n   * @param data layer function\n   */\n  cleanFunction(glContext: WebGL2RenderingContext) {\n    throw new Error('Each layer has to implement it!');\n  }\n\n  /**\n   * Changes the color map\n   * @param {WebGL2RenderingContext} glContext WebGL context\n   * @param {ColorMapType} cMap Color Map\n   */\n  updateColorMap(glContext: WebGL2RenderingContext, cMap: ColorMapType) {}\n\n\n  /**\n   * Layer render function signature\n   * @param {WebGL2RenderingContext} glContext WebGL context\n   */\n  render(glContext: WebGL2RenderingContext) {\n    throw new Error('Each layer has to implement it!');\n  }\n\n  /**\n   * Layer picking function signature\n   * @param {WebGL2RenderingContext} glContext WebGL context\n   */\n  pick(glContext: WebGL2RenderingContext,  x: number, y: number) {\n    throw new Error('Each layer has to implement it!');\n  }\n  /**\n   * Layer picking function signature\n   * @param {WebGL2RenderingContext} glContext WebGL context\n   */\n  pickId() {\n    throw new Error('Each layer has to implement it!');\n  }\n  /**\n   * Layer picking function signature\n   * @param {WebGL2RenderingContext} glContext WebGL context\n   */\n  setPickId(id: number = null) {\n    throw new Error('Each layer has to implement it!');\n  }\n\n  /**\n   * Inits the layer's shader program\n   * @param {string} vsSource Vertex shader source\n   * @param {string} fsSource Fragment shader source\n   * @param {WebGL2RenderingContext} glContext WebGL context\n   */\n  protected initShaderProgram(vsSource: string, fsSource: string, glContext: WebGL2RenderingContext) {\n    // load the shaders\n    const vertexShader = this.buildShader(glContext.VERTEX_SHADER, vsSource, glContext);\n    const fragmentShader = this.buildShader(glContext.FRAGMENT_SHADER, fsSource, glContext);\n\n    // Create the shader program\n    const shader = glContext.createProgram();\n    glContext.attachShader(shader, vertexShader);\n    glContext.attachShader(shader, fragmentShader);\n    glContext.linkProgram(shader);\n\n    // If creating the shader program failed, alert\n    if (!glContext.getProgramParameter(shader, glContext.LINK_STATUS)) {\n      throw new Error('Unable to initialize the shader program: ' + glContext.getProgramInfoLog(shader));\n    }\n\n    // stores the shader\n    this._shaderProgram.push(shader);\n  }\n\n  /**\n   * Builds the layer shader\n   * @param {string} type The shader type\n   * @param {string} source The shader source string\n   * @param {WebGL2RenderingContext} glContext The WebGL context\n   * @returns {WebGLShader} The shader object\n   */\n  protected buildShader(type, source, glContext): WebGLShader {\n    // creates the shader\n    const shader = glContext.createShader(type);\n\n    // Send the source to the shader object\n    glContext.shaderSource(shader, source);\n    // Compile the shader program\n    glContext.compileShader(shader);\n\n    // See if it compiled successfully\n    if (!glContext.getShaderParameter(shader, glContext.COMPILE_STATUS)) {\n      console.error('An error occurred compiling the shaders: ');\n      console.error(source);\n      console.error(glContext.getShaderInfoLog(shader));\n\n      glContext.deleteShader(shader);\n      throw new Error('Unable to load the shader');\n    }\n\n    return shader;\n  }\n}\n","/// <reference types=\"@types/webgl2\" />\nimport { DataApi } from './data-api';\nimport { LayerManager } from './layer-manager';\nimport { Camera } from './camera';\nimport { KeyEvents } from './key-events';\nimport { MouseEvents } from './mouse-events';\nimport { CameraStatus, ColorMapType } from './constants';\nimport { BuildingLayer } from './building-layer';\nimport { Layer } from './layer';\nimport { PolygonLayer } from './polygon-layer';\n\nexport class MapView {\n  // Map div\n  protected _mapDiv: HTMLElement = null;\n  // Html canvas\n  protected _canvas: HTMLCanvasElement = null;\n  // WebGL context\n  public _glContext: WebGL2RenderingContext = null;\n\n  // Layer manager object\n  protected _layerManager: LayerManager = null;\n\n  // interaction variables\n  private _camera: Camera;\n\n  // mouse events\n  private _mouse: MouseEvents;\n  // keyboard events\n  private _keyboard: KeyEvents;\n  // callbacks\n  private _callbacks: any;\n\n  public _buildingLayer: BuildingLayer;\n\n  /**\n   * MapView constructor\n   * @param {HTMLElement} mapDiv The html element to hold the map.\n   */\n  constructor(mapDiv: HTMLElement, callbacks = null) {\n    // stores the map div\n    this._mapDiv = mapDiv;\n    // creates the new canvas element\n    this._canvas = document.createElement('canvas');\n    // gets the webgl context\n    this._glContext = this._canvas.getContext('webgl2');\n    // appends the canvas\n    this._mapDiv.appendChild(this._canvas);\n    // callbacks\n    this._callbacks = callbacks;\n\n    // inits the camera\n    this.initCamera('camera.json').then(() => {\n      // resizes the canvas\n      this.resize();\n    });\n\n    // inits the mouse events\n    this.initMouseEvents();\n    // inits the mouse events\n    this.initKeyboardEvents();\n    // bind events\n    this.initWindowEvents();\n  }\n\n  /**\n   * gets the canvas element\n   */\n  get canvas(): HTMLCanvasElement {\n    return this._canvas;\n  }\n\n  /**\n   * gets the map div\n   */\n  get div(): HTMLElement {\n    return this._mapDiv;\n  }\n\n  /**\n   * gets the map div\n   */\n  get glContext(): WebGL2RenderingContext {\n    return this._glContext;\n  }\n\n  /**\n   * gets the camera object\n   */\n  get camera(): Camera {\n    return this._camera;\n  }\n\n  /**\n   * gets the layers\n   */\n  get layerManager(): LayerManager {\n    return this._layerManager;\n  }\n\n  /**\n   * Toggle Camera Mode\n   */\n  toggleCameraMode() {\n    const currentCameraStatus: CameraStatus = this._camera.getCameraStatus();\n    if (currentCameraStatus === CameraStatus.Camera2D) {\n      this._camera.setCameraStatus(CameraStatus.Camera3D);\n    } else {\n      this._camera.setCameraStatus(CameraStatus.Camera2D);\n    }\n\n    this.render();\n  }\n\n  async initCamera(camera: string) {\n    // load the index file and its layers\n    const params = await DataApi.getMapIndex(camera);\n    // sets the camera\n    this._camera = new Camera(params.coordinates[0][0], params.coordinates[0][1], params.properties.zoom);\n    // renders the scene\n    this.render();\n  }\n\n  /**\n   * Map layers initialization\n   */\n  async initLayers(index: string) {\n    // creates the manager\n    this._layerManager = new LayerManager(index);\n\n    // load the index file and its layers\n    const data = await DataApi.getMapIndex(index);\n\n    // loop over the index file\n    for (const element of data) {\n      // skips the layer\n      if ('skip' in element && element['skip']) {\n        continue;\n      }\n\n      // loads the layers data\n      const layer = this._layerManager.createLayer(\n        element['type'], element['id']\n      );\n      // layer configuration\n      this.layerConfig(layer, element);\n\n      // loads the shaders\n      await layer.loadShaders(this._glContext);\n\n      // update the features\n      await layer.updateFeatures(this._glContext);\n      this.render();\n\n      if (element['type'] === 'building') {\n        this._buildingLayer = layer;\n      }\n    }\n  }\n\n  /**\n   * Map layers configuration\n   */\n  layerConfig(layer: Layer, config: any) {\n    // color map\n    if (config['color'] !== undefined) {\n      layer.updateColorMap(this._glContext, config['color']);\n    } else {\n      layer.updateColorMap(this._glContext, ColorMapType.SEQUENTIAL_RED_MAP);\n    }\n\n    // selectable\n    if (config['selectable'] !== undefined) {\n      layer.selectable = config['selectable'];\n    } else {\n      layer.selectable = false;\n    }\n\n    // visibility\n    if (config['visible'] !== undefined) {\n      layer.visible = config['visible'];\n    } else {\n      layer.visible = true;\n    }\n  }\n\n  /**\n   * Add layer geometry and function function\n   */\n  async addLayer(layerType: string, layerId: string, data: any, config: any = {visible: true, selectable: false}) {\n    // loads the layers data\n    const layer = this._layerManager.createLayer(\n      layerType, layerId\n    );\n\n    // loads the shaders\n    await layer.loadShaders(this._glContext);\n    // update the features\n    await layer.updateFeatures(this._glContext, data);\n\n    // make visible\n    layer.visible = config.visible;\n    layer.selectable = config.selectable;\n\n    // render\n    this.render();\n  }\n\n  /**\n   * Delete layer function\n   */\n  delLayer(layerId: string) {\n    let pos = -1;\n    for(let lId = 0; lId < this._layerManager.layers.length; lId++) {\n      // gets the layer\n      const layer = this._layerManager.layers[lId];\n\n      // check for the layer\n      if (layer.layerId !== layerId) { continue; }\n\n      // id found\n      pos = lId;\n      break;\n    }\n\n    if (pos > -1) {\n      // removes the layer\n      this._layerManager.layers.splice(pos, 1);\n    }\n  }\n\n  /**\n   * update layer function function\n   */\n  async updateLayerFunction(layerId: string, data: any) {\n    // searches the layer\n    let layer = null;\n    for (const lay of this._layerManager.layers) {\n      if (lay.layerId === layerId) {\n        layer = lay;\n        break;\n      }\n    }\n\n    // not found\n    if (layer === null) { return; }\n    // update the function\n    await layer.updateFunction(this._glContext, data);\n\n    // make it visible\n    layer.visible = true;\n\n    // render\n    this.render();\n  }\n\n  /**\n   * cleans the layer function\n   */\n  cleanLayerFunction(layerId: string) {\n    // searches the layer\n    let layer = null;\n    for (const lay of this._layerManager.layers) {\n      if (lay.layerId === layerId) {\n        layer = lay;\n        break;\n      }\n    }\n\n    // not found\n    if (layer === null) { return; }\n    // update the function\n    layer.cleanFunction(this._glContext);\n\n    // make it visible\n    layer.visible = true;\n\n    // render\n    this.render();\n  }\n\n  /**\n   * Inits the mouse events\n   */\n  initMouseEvents() {\n    // creates the mouse events manager\n    this._mouse = new MouseEvents(this, this._callbacks);\n    // binds the mouse events\n    this._mouse.bindEvents();\n  }\n\n  /**\n   * Inits the mouse events\n   */\n  initKeyboardEvents() {\n    // creates the mouse events manager\n    this._keyboard = new KeyEvents(this, this._callbacks);\n    // binds the mouse events\n    this._keyboard.bindEvents();\n  }\n\n  /**\n   * inits the window events\n   */\n  initWindowEvents() {\n    // resize listener\n    window.addEventListener('resize', () => {\n      // resizes the canvas\n      this.resize();\n      this.render();\n    });\n  }\n\n  pick(layerId: string, elementId: number) {\n    const layer = this._layerManager.getLayer(layerId);\n\n    if (layer) {\n      layer.setPickId(elementId);\n      this.render();\n    }\n  }\n\n  /**\n   * Renders the map\n   */\n  render() {\n    if (!this._camera) {\n      return;\n    }\n    // sky\n    this._glContext.clearColor(0.7451, 0.8235, 0.8431, 1.0);\n    // tslint:disable-next-line:no-bitwise\n    this._glContext.clear(this._glContext.COLOR_BUFFER_BIT | this._glContext.DEPTH_BUFFER_BIT);\n\n    // updates the camera\n    this._camera.update();\n\n    // render the layers\n    for (const layer of this._layerManager.layers) {\n      // skips based on visibility\n      if (!layer.visible) { continue; }\n\n      // sends the camera\n      layer.camera = this.camera;\n      // render\n      layer.render(this._glContext);\n    }\n  }\n\n  /**\n   * Resizes the html canvas\n   */\n  resize() {\n    const targetWidth = this._mapDiv.clientWidth;\n    const targetHeight = this._mapDiv.clientHeight;\n\n    const value = Math.max(targetWidth, targetHeight);\n    this._glContext.viewport(0, 0, value, value);\n    //\n    this._canvas.width = targetWidth;\n    this._canvas.height = targetHeight;\n\n    // stores in the camera\n    this._camera.setViewportResolution(targetWidth, targetHeight);\n  }\n}\n","import { MapView } from './mapview';\nimport { MapViewStatus, CameraStatus } from './constants';\n\nexport class MouseEvents {\n  // div to attach the events\n  private _map: MapView;\n  // callbacks\n  private _callbacks: any;\n\n  // mouse movement control.\n  private _status: MapViewStatus;\n  private _lastPoint: number[];\n\n  /**\n   * Mouse events constructor\n   * @param map the map to bind the events\n   */\n  constructor(map, callbacks = null) {\n    this._map = map;\n    this._callbacks = callbacks;\n\n    // default values\n    this._status = MapViewStatus.IDLE;\n    this._lastPoint = [0, 0];\n  }\n\n  bindEvents() {\n    // sets the mouse listeners\n    this._map.canvas.addEventListener('wheel', this.mouseWheel.bind(this), false);\n    this._map.canvas.addEventListener('mousedown', this.mouseDown.bind(this), false);\n    document.addEventListener('mousemove', this.mouseMove.bind(this), false);\n    document.addEventListener('mouseup', this.mouseUp.bind(this), false);\n  }\n\n  /**\n   * Handles mouse down event\n   */\n  mouseDown(event: MouseEvent) {\n    this._lastPoint = [event.x, event.y];\n\n    if (event.ctrlKey) {\n      const x = event.x;\n      const y = (this._map.canvas.height - event.y);\n\n      const picks = [];\n      for (const layer of this._map.layerManager.layers) {\n        if (!layer.selectable) { continue; }\n        \n        layer.pick(this._map.glContext, x, y);\n        picks.push(layer.pickId());\n\n        this._callbacks.mouse.mouseDown(picks);\n      }\n    } else {\n      this._status = MapViewStatus.DRAG;\n    }\n\n    this._map.render();\n  }\n\n  /**\n     * Handles mouse down event\n     */\n  mouseMove(event: MouseEvent) {\n    // changes the values\n    if (this._status === MapViewStatus.DRAG) {\n      const dx = (-event.x + this._lastPoint[0]);\n      const dy = event.y - this._lastPoint[1];\n\n      if (event.buttons === 1 && event.shiftKey && this._map.camera.getCameraStatus() === CameraStatus.Camera3D) { // left button\n        this._map.camera.yaw(dx / this._map.canvas.clientWidth);\n        this._map.camera.pitch(dy / this._map.canvas.clientHeight);\n      } else {\n        this._map.camera.translate(dx / this._map.canvas.clientWidth, dy / this._map.canvas.clientHeight);\n      }\n\n      this._lastPoint = [event.x, event.y];\n      this._map.render();\n    }\n  }\n\n  /**\n   * Handles mouse down event\n   */\n  mouseUp(event: MouseEvent) {\n    // changes the values\n    this._status = MapViewStatus.IDLE;\n    this._map.render();\n  }\n\n  /**\n   * Handles mouse down event\n   */\n  mouseWheel(event: WheelEvent) {\n    // changes the values\n    const maxAxisLength = Math.max(this._map.canvas.width, this._map.canvas.height);\n    const x = event.x / maxAxisLength;\n    const y = (this._map.canvas.height - event.y) / maxAxisLength;\n    this._map.camera.zoom(event.deltaY, x, y);\n    this._map.render();\n  }\n\n  /**\n   * Handles mouse down event\n   */\n  mouseOver(event: MouseEvent) {\n    console.log('called', event.ctrlKey);\n\n  }\n\n}\n","/// <reference types=\"@types/webgl2\" />\n\nimport { Layer } from './layer';\nimport { DataLoader } from './data-loader';\nimport { DataApi } from './data-api';\n\nexport class PhysicalLayer extends Layer {\n  // number of coordinates per vertex\n  protected static COORDS = 2;\n  // number of shaders\n  protected static N_SHADER = 1;\n\n  // primitive Ids\n  protected _features: any = {};\n\n  // OpenGL data buffer\n  protected _glPositionBuffer: WebGLBuffer = null;\n  protected _glColorBuffer: WebGLBuffer = null;\n  protected _glIndexBuffer: WebGLBuffer = null;\n\n  // data buffer\n  protected _positionBuffer: number[] = [];\n  protected _colorBuffer: number[] = [];\n  protected _indexBuffer: number[] = [];\n\n  // shader attribute id\n  protected _positionId = -1;\n  protected _colorId = -1;\n\n  // uniforms\n  protected _uModelViewMatrixId: WebGLUniformLocation = -1;\n  protected _uProjectionMatrixId: WebGLUniformLocation = -1;\n  protected _uWorldOrigin: WebGLUniformLocation = -1;\n\n  /**\n   * The Vector Layer constructor\n   * @param {string} id the layer id\n   */\n  constructor(id: string) {\n    super(id);\n  }\n\n  /**\n   * Shader load signature\n   * @param {WebGL2RenderingContext} glContext WebGL context\n   */\n  async loadShaders(glContext: WebGL2RenderingContext) {\n    // load the shaders\n    for (let id = 0; id < PhysicalLayer.N_SHADER; id++) {\n      // shaders url\n      const vertUrl = `assets/shaders/physical(${id}).vert`;\n      const fragUrl = `assets/shaders/physical(${id}).frag`;\n\n      // Vertex shader program\n      const vsShader = await DataLoader.getTextData(vertUrl);\n      // Fragment shader program\n      const fsShader = await DataLoader.getTextData(fragUrl);\n\n      // load all shaders\n      this.initShaderProgram(vsShader, fsShader, glContext);\n    }\n\n    // uniforms definition\n    this._positionId = glContext.getAttribLocation(this._shaderProgram[0], 'vertPos');\n    this._colorId = glContext.getAttribLocation(this._shaderProgram[0], 'vertRgb');\n    this._uModelViewMatrixId = glContext.getUniformLocation(this._shaderProgram[0], 'uModelViewMatrix');\n    this._uProjectionMatrixId = glContext.getUniformLocation(this._shaderProgram[0], 'uProjectionMatrix');\n    this._uWorldOrigin = glContext.getUniformLocation(this._shaderProgram[0], 'uWorldOrigin');\n\n    // load message\n    console.log(`Shaders successfully loaded for layer ${this._layerId}.`);\n  }\n\n  /**\n   * Data update signature\n   * @returns {Promise<any>} The load data promise\n   */\n  async updateFeatures(glContext: WebGL2RenderingContext, data: any = null) {\n    // gets the feature of index id\n    data = await DataApi.getLayerFeature(this._layerId);\n\n    // new feature found\n    this._features = {\n      'position': [], 'color': [], 'index': [], 'function': [], 'size': []\n    };\n\n    // loaded number of vertices\n    let nverts = 0;\n\n    // iterates over the geometries\n    for (const feature of data.features) {\n      // gets the feature color\n      const hex = feature.properties.color.slice(2, 8);\n      const rgb = [0, 2, 4].map((start) => {\n        return parseInt(hex.slice(start, start + 2), 16) / 255;\n      });\n\n      // get the coordinates\n      const position = feature.geometry.coordinates;\n      // get the colors\n      const colors = [];\n      for (let id = 0; id < position.length / PhysicalLayer.COORDS; id++) {\n        colors.push(...rgb);\n      }\n\n      // build the indices\n      const indices = feature.geometry.indices;\n      for (let id = 0; id < indices.length; id++) {\n        indices[id] += nverts;\n      }\n\n      // add to the feature\n      this._features['position'].push.apply(this._features['position'], position);\n      this._features['color'].push.apply(this._features['color'], colors);\n      this._features['index'].push.apply(this._features['index'], indices);\n\n      // loaded vertices\n      nverts += position.length / PhysicalLayer.COORDS;\n    }\n    // formats the buffer\n    this._positionBuffer = this._features['position'];\n    // formats the buffer\n    this._colorBuffer = this._features['color'];\n    // formats the buffer\n    this._indexBuffer = this._features['index'];\n\n    // creates the buffer\n    this.createBuffers(glContext);\n  }\n\n  /**\n   * Layer render function signature\n   * @param {WebGL2RenderingContext} glContext WebGL context\n   */\n  render(glContext: WebGL2RenderingContext) {\n    // invalid layers\n    if (\n      this._shaderProgram.length === 0 ||\n      this._shaderProgram[0] === null ||\n      this._glPositionBuffer === null ||\n      this._glColorBuffer === null ||\n      this._glIndexBuffer === null ||\n      this._positionId < 0 ||\n      this._colorId < 0\n    ) {\n      return;\n    }\n\n    // sends the uniforms\n    this.setUniforms(glContext);\n\n    // binds the position buffer\n    glContext.bindBuffer(glContext.ARRAY_BUFFER, this._glPositionBuffer);\n    glContext.vertexAttribPointer(this._positionId, PhysicalLayer.COORDS, glContext.FLOAT, false, 0, 0);\n    glContext.enableVertexAttribArray(this._positionId);\n\n    // binds the position buffer\n    glContext.bindBuffer(glContext.ARRAY_BUFFER, this._glColorBuffer);\n    glContext.vertexAttribPointer(this._colorId, 3, glContext.FLOAT, false, 0, 0);\n    glContext.enableVertexAttribArray(this._colorId);\n\n    // Tell WebGL which indices to use to index the vertices\n    glContext.bindBuffer(glContext.ELEMENT_ARRAY_BUFFER, this._glIndexBuffer);\n    // binds the shader program\n    glContext.useProgram(this._shaderProgram[0]);\n    // draw the geometry\n    glContext.drawElements(glContext.TRIANGLES, this._indexBuffer.length, glContext.UNSIGNED_INT, 0);\n  }\n\n  /**\n   * Send uniforms to the shader\n   * @param {WebGL2RenderingContext} glContext WebGL context\n   */\n  protected setUniforms(glContext: WebGL2RenderingContext) {\n    if (!this._shaderProgram.length || this._shaderProgram[0] === null) {\n      return;\n    }\n    glContext.useProgram(this._shaderProgram[0]);\n    // send matrices\n    glContext.uniformMatrix4fv(this._uModelViewMatrixId, false, this._camera.getModelViewMatrix());\n    glContext.uniformMatrix4fv(this._uProjectionMatrixId, false, this._camera.getProjectionMatrix());\n    // send world origin\n    const worldOrigin = this._camera.getWorldOrigin();\n    glContext.uniform2f(this._uWorldOrigin, worldOrigin[0], worldOrigin[1]);\n  }\n\n  /**\n   * Layer VBO creation signature\n   * @param {WebGL2RenderingContext} glContext WebGL context\n   */\n  protected createBuffers(glContext: WebGL2RenderingContext) {\n    // Create a buffer for the positions.\n    this._glPositionBuffer = glContext.createBuffer();\n    // Select the positionBuffer as the one to apply buffer\n    glContext.bindBuffer(glContext.ARRAY_BUFFER, this._glPositionBuffer);\n    // send data to gpu\n    glContext.bufferData(\n      glContext.ARRAY_BUFFER, new Float32Array(this._positionBuffer), glContext.STATIC_DRAW\n    );\n\n    // Create a buffer for the colors.\n    this._glColorBuffer = glContext.createBuffer();\n    // Select the color buffer as the one to apply buffer\n    glContext.bindBuffer(glContext.ARRAY_BUFFER, this._glColorBuffer);\n    // send data to gpu\n    glContext.bufferData(\n      glContext.ARRAY_BUFFER, new Float32Array(this._colorBuffer), glContext.STATIC_DRAW\n    );\n\n    // Create a buffer for the indices.\n    this._glIndexBuffer = glContext.createBuffer();\n    // Select the index buffer as the one to apply buffer\n    glContext.bindBuffer(glContext.ELEMENT_ARRAY_BUFFER, this._glIndexBuffer);\n    // send data to gpu\n    glContext.bufferData(\n      glContext.ELEMENT_ARRAY_BUFFER, new Uint32Array(this._indexBuffer), glContext.STATIC_DRAW);\n  }\n}\n","/// <reference types=\"@types/webgl2\" />\n\nimport { Layer } from './layer';\nimport { DataLoader } from './data-loader';\nimport { DataApi } from './data-api';\nimport { ColorMapType } from './constants';\nimport { ColorMap } from './colormap';\n\nexport class PointLayer extends Layer {\n  // number of coordinates per vertex\n  protected static COORDS = 2;\n  // number of shaders\n  protected static N_SHADER = 1;\n\n  // primitive Ids\n  protected _features: any = {};\n\n  // OpenGL data buffer\n  protected _glPositionBuffer: WebGLBuffer = null;\n  protected _glScalarBuffer: WebGLBuffer = null;\n  protected _glColorMapTex: WebGLTexture = null;\n\n  // shader attribute id\n  protected _positionId = -1;\n  protected _scalarId = -1;\n\n  // transformation uniforms\n  protected _uModelViewMatrixId: WebGLUniformLocation = -1;\n  protected _uProjectionMatrixId: WebGLUniformLocation = -1;\n  protected _uWorldOriginId: WebGLUniformLocation = -1;\n\n  // color map uniform\n  protected _uColorMapId: WebGLUniformLocation = -1;\n\n  /**\n   * The Vector Layer constructor\n   * @param {string} id the layer id\n   */\n  constructor(id: string) {\n    super(id);\n    this._visible = false;\n  }\n\n  /**\n   * Shader load signature\n   * @param {WebGL2RenderingContext} glContext WebGL context\n   */\n  async loadShaders(glContext: WebGL2RenderingContext) {\n    // load the shaders\n    for (let id = 0; id < PointLayer.N_SHADER; id++) {\n      // shaders url\n      const vertUrl = `assets/shaders/point(${id}).vert`;\n      const fragUrl = `assets/shaders/point(${id}).frag`;\n\n      // Vertex shader program\n      const vsShader = await DataLoader.getTextData(vertUrl);\n      // Fragment shader program\n      const fsShader = await DataLoader.getTextData(fragUrl);\n\n      // load all shaders\n      this.initShaderProgram(vsShader, fsShader, glContext);\n    }\n\n    // vertex data on the shader\n    this._positionId = glContext.getAttribLocation(this._shaderProgram[0], 'vertPos');\n    this._scalarId = glContext.getAttribLocation(this._shaderProgram[0], 'vertScalar');\n\n    // transformation uniforms on the shader\n    this._uModelViewMatrixId = glContext.getUniformLocation(this._shaderProgram[0], 'uModelViewMatrix');\n    this._uProjectionMatrixId = glContext.getUniformLocation(this._shaderProgram[0], 'uProjectionMatrix');\n    this._uWorldOriginId = glContext.getUniformLocation(this._shaderProgram[0], 'uWorldOrigin');\n\n    // colorMap texture\n    this._uColorMapId = glContext.getUniformLocation(this._shaderProgram[0], 'uColorMap');\n    // load message\n    console.log(`Shaders successfully loaded for layer ${this._layerId}.`);\n  }\n\n  /**\n   * Data update signature\n   * @returns {Promise<any>} The load data promise\n   */\n  async updateFeatures(glContext: WebGL2RenderingContext, data: any = null) {\n    // gets the feature of index id\n    if (data === null) {\n      data = await DataApi.getLayerFeature(this._layerId);\n    }\n\n    // new feature found\n    this._features = {'position': [], 'scalar': []};\n\n    // iterates over the geometries\n    for (const feature of data.features) {\n      // feature data\n      const position = feature.geometry.coordinates;\n\n      const scalar = [];\n      for (let id = 0; id < position.length / PointLayer.COORDS; id++) {\n        const val = feature.properties && feature.properties.scalar ? feature.properties.scalar : -1;\n        scalar.push(val);\n      }\n\n      // add to the feature\n      this._features['position'].push.apply(this._features['position'], position);\n      this._features['scalar'].push.apply(this._features['scalar'], scalar);\n    }\n\n    // creates the buffer\n    this.createBuffers(glContext);\n    // creates the scalar data vbo\n    this.createScalarBuffer(glContext);\n    // creates the color map\n    this.createColorMapTexture(glContext, ColorMapType.DIVERGING_RED_BLUE_MAP, false);\n  }\n\n  /**\n   * Function update signature\n   * @returns {Promise<any>} The load data promise\n   */\n  async updateFunction(glContext: WebGL2RenderingContext) {\n    // gets the feature of index id\n    const data = await DataApi.getLayerFunction(this._layerId);\n\n    // new feature found\n    this._features = {'scalar': []};\n\n    // formats the buffer\n    this._features['scalar'] = data.properties.scalar;\n\n    // creates the scalar data vbo\n    this.createScalarBuffer(glContext);\n  }\n\n  /**\n   * Changes the color map\n   * @param {WebGL2RenderingContext} glContext WebGL context\n   * @param {ColorMapType} cMap Color Map\n   */\n  updateColorMap(glContext: WebGL2RenderingContext, cMap: ColorMapType) {\n    // creates the color map\n    this.createColorMapTexture(glContext, cMap, false);\n  }\n\n  /**\n   * Layer render function signature\n   * @param {WebGL2RenderingContext} glContext WebGL context\n   */\n  render(glContext: WebGL2RenderingContext) {\n    // invalid layers\n    if (\n      this._shaderProgram.length === 0 ||\n      this._shaderProgram[0] === null ||\n      this._glPositionBuffer === null ||\n      this._glScalarBuffer === null ||\n      this._positionId < 0 ||\n      this._scalarId < 0\n    ) {\n      return;\n    }\n\n    // sends the uniforms\n    this.setUniforms(glContext);\n\n    // bending\n    glContext.enable(glContext.BLEND);\n    glContext.blendFunc(glContext.SRC_ALPHA, glContext.ONE_MINUS_SRC_ALPHA);\n\n    // binds the position buffer\n    glContext.bindBuffer(glContext.ARRAY_BUFFER, this._glPositionBuffer);\n    glContext.vertexAttribPointer(this._positionId, PointLayer.COORDS, glContext.FLOAT, false, 0, 0);\n    glContext.enableVertexAttribArray(this._positionId);\n\n    // binds the position buffer\n    glContext.bindBuffer(glContext.ARRAY_BUFFER, this._glScalarBuffer);\n    glContext.vertexAttribPointer(this._scalarId, 1, glContext.FLOAT, false, 0, 0);\n    glContext.enableVertexAttribArray(this._scalarId);\n\n    // Tell WebGL we want to affect texture unit 0\n    glContext.activeTexture(glContext.TEXTURE0);\n    // Bind the texture to texture unit 0\n    glContext.bindTexture(glContext.TEXTURE_2D, this._glColorMapTex);\n\n    // binds the shader program\n    glContext.useProgram(this._shaderProgram[0]);\n\n    // draw the geometry\n    glContext.drawArrays(glContext.POINTS, 0, this._features['position'].length / PointLayer.COORDS);\n\n    // disable blend\n    glContext.disable(glContext.BLEND);\n  }\n\n  /**\n   * Send uniforms to the shader\n   * @param {WebGL2RenderingContext} glContext WebGL context\n   */\n  protected setUniforms(glContext: WebGL2RenderingContext) {\n    if (!this._shaderProgram.length || this._shaderProgram[0] === null) {\n      return;\n    }\n    glContext.useProgram(this._shaderProgram[0]);\n    // send matrices\n    glContext.uniformMatrix4fv(this._uModelViewMatrixId, false, this._camera.getModelViewMatrix());\n    glContext.uniformMatrix4fv(this._uProjectionMatrixId, false, this._camera.getProjectionMatrix());\n    // send world origin\n    const worldOrigin = this._camera.getWorldOrigin();\n    glContext.uniform2f(this._uWorldOriginId, worldOrigin[0], worldOrigin[1]);\n\n    // send the color map\n    glContext.uniform1i(this._uColorMapId, 0);\n  }\n\n  /**\n   * Layer VBO creation signature\n   * @param {WebGL2RenderingContext} glContext WebGL context\n   */\n  protected createBuffers(glContext: WebGL2RenderingContext) {\n    // Create a buffer for the positions.\n    this._glPositionBuffer = glContext.createBuffer();\n    // Select the positionBuffer as the one to apply buffer\n    glContext.bindBuffer(glContext.ARRAY_BUFFER, this._glPositionBuffer);\n    // send data to gpu\n    glContext.bufferData(\n      glContext.ARRAY_BUFFER, new Float32Array(this._features['position']), glContext.STATIC_DRAW\n    );\n  }\n\n  /**\n   * Scalar data vbo creation\n   * @param {WebGL2RenderingContext} glContext WebGL context\n   */\n  protected createScalarBuffer(glContext: WebGL2RenderingContext) {\n    // Create a buffer for the colors.\n    if (this._glScalarBuffer === null) {\n      this._glScalarBuffer = glContext.createBuffer();\n    }\n    // Select the color buffer as the one to apply buffer\n    glContext.bindBuffer(glContext.ARRAY_BUFFER, this._glScalarBuffer);\n    // send data to gpu\n    glContext.bufferData(\n      glContext.ARRAY_BUFFER, new Float32Array(this._features['scalar']), glContext.STATIC_DRAW\n    );\n  }\n\n    /**\n   * Color map texture creation\n   * @param {WebGL2RenderingContext} glContext WebGL context\n   * @param {ColorMapType} color Selected color map\n   * @param {boolean} get the reverse color map\n   */\n  protected createColorMapTexture(glContext: WebGL2RenderingContext, color: ColorMapType, reverse: boolean = false) {\n    // gets the color map\n    const cmap = ColorMap.getColorMap(color, reverse);\n    // gl color map texture\n    if (this._glColorMapTex === null) {\n      this._glColorMapTex = glContext.createTexture();\n    }\n\n    // send the color map\n    glContext.bindTexture(glContext.TEXTURE_2D, this._glColorMapTex);\n    glContext.texImage2D(\n      glContext.TEXTURE_2D, 0, glContext.RGBA, cmap.length / 4, 1, 0,\n      glContext.RGBA, glContext.UNSIGNED_BYTE, new Uint8Array(cmap)\n    );\n    // glContext.NEAREST is also allowed, instead of glContext.LINEAR, as neither mipmap.\n    glContext.texParameteri(glContext.TEXTURE_2D, glContext.TEXTURE_MIN_FILTER, glContext.LINEAR);\n    // Prevents s-coordinate wrapping (repeating).\n    glContext.texParameteri(glContext.TEXTURE_2D, glContext.TEXTURE_WRAP_S, glContext.CLAMP_TO_EDGE);\n    // Prevents t-coordinate wrapping (repeating).\n    glContext.texParameteri(glContext.TEXTURE_2D, glContext.TEXTURE_WRAP_T, glContext.CLAMP_TO_EDGE);\n  }\n}\n","/// <reference types=\"@types/webgl2\" />\n\nimport { Layer } from './layer';\nimport { DataLoader } from './data-loader';\nimport { DataApi } from './data-api';\nimport { ColorMapType } from './constants';\nimport { ColorMap } from './colormap';\n\nexport class PolygonLayer extends Layer {\n    // number of coordinates per vertex\n    protected static COORDS = 2;\n    // number of shaders\n    protected static N_SHADER = 3;\n\n    // primitive Ids\n    protected _features: any = {};\n\n    // data buffers\n    protected _glPositionBuffer: WebGLBuffer = null;\n    protected _glIndexBuffer: WebGLBuffer = null;\n    protected _glPolygonIdBuffer: WebGLBuffer = null;\n    protected _glScalarBuffer: WebGLBuffer = null;\n\n    // shader attribute id\n    protected _positionId = -1;\n    protected _polygonId = -1;\n    protected _scalarId = -1;\n\n    // transformation uniforms\n    protected _uModelViewMatrixId: WebGLUniformLocation = -1;\n    protected _uProjectionMatrixId: WebGLUniformLocation = -1;\n    protected _uWorldOriginId: WebGLUniformLocation = -1;\n    protected _uScalarTextureId: WebGLUniformLocation = -1;\n\n    // highlighted building ID id\n    protected _highlight = -1;\n    protected _uHighlightId: WebGLUniformLocation = -1;\n\n    // FBO for picking\n    protected _fboWidth = -1;\n    protected _fboHeight = -1;\n    protected _fbo: WebGLFramebuffer = null;\n    protected _readFbo: WebGLFramebuffer = null;\n\n    // first pass textures\n    protected _scalarTexture: WebGLTexture = null;\n    protected _polygonIdTexture: WebGLTexture = null;\n\n    // color map\n    protected _uColorMapId: WebGLUniformLocation = -1;\n    protected _colorMapTexture: WebGLTexture = null;\n\n    /**\n     * The Vector Layer constructor\n     * @param {string} id the layer id\n     */\n    constructor(id: string) {\n        super(id);\n    }\n\n    /**\n     * Shader load signature\n     * @param {WebGL2RenderingContext} glContext WebGL context\n     */\n    async loadShaders(glContext: WebGL2RenderingContext) {\n        // load the shaders\n        for (let id = 0; id < PolygonLayer.N_SHADER; id++) {\n            // shaders url\n            const vertUrl = `assets/shaders/polygon(${id}).vert`;\n            const fragUrl = `assets/shaders/polygon(${id}).frag`;\n\n            // Vertex shader program\n            const vsShader = await DataLoader.getTextData(vertUrl);\n            // Fragment shader program\n            const fsShader = await DataLoader.getTextData(fragUrl);\n\n            // load all shaders\n            this.initShaderProgram(vsShader, fsShader, glContext);\n        }\n        // load message\n        console.log(`#${PolygonLayer.N_SHADER} shaders successfully loaded for layer ${this._layerId}.`);\n    }\n\n    /**\n     * Data update signature\n     * @returns {Promise<any>} The load data promise\n     */\n    async updateFeatures(glContext: WebGL2RenderingContext, data: any = null) {\n        // gets the feature of index id\n        if (data === null) {\n            data = await DataApi.getLayerFeature(this._layerId);\n        }\n\n        // feature definition found\n        this._features = { 'position': [], 'scalar': [], 'polygonId': [], 'index': [], 'offset': [] };\n\n        // loaded number of vertices\n        let nverts = 0;\n        // number of loaded features\n        let nfeatures = 0;\n\n        // iterates over the geometries\n        for (const feature of data.features) {\n            // renders multi polygons\n            for (const part of feature.geometry) {\n                // get the coordinates\n                const position = part.coordinates;\n\n                // get the colors\n                const ids = [];\n                const scalar = [];\n                for (let id = 0; id < position.length / PolygonLayer.COORDS; id++) {\n                    const val = feature.properties && feature.properties.scalar ? feature.properties.scalar : -1;\n                    scalar.push(val);\n                    ids.push(nfeatures / data.features.length);\n                }\n\n                // build the indices\n                const index = part.indices;\n                for (let id = 0; id < index.length; id++) {\n                    index[id] += nverts;\n                }\n\n                // loaded vertices\n                nverts += position.length / PolygonLayer.COORDS;\n\n                // add to the feature\n                this._features['position'].push.apply(this._features['position'], position);\n                this._features['scalar'].push.apply(this._features['scalar'], scalar);\n                this._features['polygonId'].push.apply(this._features['polygonId'], ids);\n                this._features['index'].push.apply(this._features['index'], index);\n                this._features['offset'].push(position.length / PolygonLayer.COORDS);\n            }\n\n            nfeatures += 1;\n        }\n\n        // creates the buffer\n        this.createBuffers(glContext);\n        // creates the scalar data vbo\n        this.createScalarBuffer(glContext);\n        // creates the color map\n        this.createColorMapTexture(glContext, ColorMapType.DIVERGING_RED_BLUE_MAP, false);\n    }\n\n    /**\n     * Function update signature\n     * @returns {Promise<any>} The load data promise\n     */\n    async updateFunction(glContext: WebGL2RenderingContext, data: any) {\n        // scalar function\n        const scalar = data.func;\n\n        // invalid data layout\n        if (scalar.length !== this._features['offset'].length) {\n            return;\n        }\n\n        // new feature found\n        this._features['scalar'] = [];\n\n        let zero = 0;\n        if (data.fMin < 0 && data.fMax > 0) {\n            zero = 0\n        } else if (data.fMin >= 0 && data.fMax > 0) {\n            zero = data.fMin;\n        } else if (data.fMin < 0 && data.fMax <= 0) {\n            zero = data.fMax;\n        }\n\n        // fill the function array\n        for (let fId = 0; fId < scalar.length; fId++) {\n            // get the values\n            const nVerts = this._features['offset'][fId];\n\n            let sValue = null;\n            if (scalar[fId] === 'notAlive') {\n                sValue = -1;\n            }\n            else if (scalar[fId] === 'notActive') {\n                sValue = -2;\n            }\n            else if (scalar[fId] === 'notValid') {\n                sValue = -3;\n            }\n            else if (scalar[fId] === 'notChange') {\n                sValue = -3;\n            }\n            else {\n                sValue = ColorMap.computeScalarValue(scalar[fId], data.fMin, data.fMax, zero);\n            }\n\n            // fill the feature array\n            const vals = new Array(nVerts).fill(sValue);\n            // push to the function\n            this._features['scalar'].push.apply(this._features['scalar'], vals);\n        }\n\n        // creates the scalar data vbo\n        this.createScalarBuffer(glContext);\n    }\n\n    /**\n     * Function update signature\n     * @param {WebGL2RenderingContext} glContext WebGL context\n     * @param data layer function\n     */\n    cleanFunction(glContext: WebGL2RenderingContext) {\n        for (let id = 0; id < this._features['scalar'].length; id++) {\n            this._features['scalar'][id] = -1;\n        }\n\n        // creates the scalar data vbo\n        this.createScalarBuffer(glContext);\n    }\n\n    /**\n     * Changes the color map\n     * @param {WebGL2RenderingContext} glContext WebGL context\n     * @param {ColorMapType} cMap Color Map\n     */\n    updateColorMap(glContext: WebGL2RenderingContext, cMap: ColorMapType) {\n        // creates the color map\n        this.createColorMapTexture(glContext, cMap, false);\n    }\n\n    /**\n     * Layer render function signature\n     * @param {WebGL2RenderingContext} glContext WebGL context\n     * @param {number} x Mouse x position\n     * @param {number} y Mouse y position\n     */\n    pick(glContext: WebGL2RenderingContext, x: number, y: number) {\n        glContext.bindFramebuffer(glContext.FRAMEBUFFER, this._readFbo);\n\n        const result = new Float32Array(4);\n        glContext.readPixels(x, y, 1, 1, glContext.RGBA, glContext.FLOAT, result);\n\n        if (result[0] >= 0) {\n            this._highlight = result[0] === this._highlight ? -1 : result[0];\n        }\n\n        glContext.bindFramebuffer(glContext.FRAMEBUFFER, null);\n\n        this.render(glContext);\n    }\n\n    /**\n     * Layer picking function signature\n     * @param {WebGL2RenderingContext} glContext WebGL context\n     */\n    pickId() {\n        if (this._highlight === -1) {\n            return this._highlight;\n        }\n\n        if (!this._features['polygonId']) {\n            return this._highlight;\n        }\n\n        let previous = -1;\n        let polyId = -1;\n\n        for (let pId = 0; pId < this._features['polygonId'].length; pId++) {\n            const current = this._features['polygonId'][pId];\n\n            if (previous === current) {\n                continue;\n            }\n            else {\n                polyId += 1;\n                previous = current;\n                if (Math.abs(current - this._highlight) < 1e-5) {\n                    return polyId;\n                }\n            }\n        }\n\n        return polyId;\n    }\n\n    setPickId(id: number) {\n        let previous = -1;\n        let polyId = -1;\n\n        if (!this._features['polygonId']) {\n            this._highlight = -1;\n            return;\n        }\n\n        for (let pId = 0; pId < this._features['polygonId'].length; pId++) {\n            const current = this._features['polygonId'][pId];\n\n            if (previous === current) {\n                continue;\n            }\n            else {\n                polyId += 1;\n                previous = current;\n                if (polyId === id) {\n                    this._highlight = current;\n                    return;\n                }\n            }\n        }\n    }\n\n    /**\n     * Layer render function signature\n     * @param {WebGL2RenderingContext} glContext WebGL context\n     */\n    render(glContext: WebGL2RenderingContext) {\n        // invalid layers\n        if (\n            this._shaderProgram.length !== PolygonLayer.N_SHADER ||\n            this._glPositionBuffer === null ||\n            this._glPolygonIdBuffer === null ||\n            this._glScalarBuffer === null ||\n            this._glIndexBuffer === null\n        ) {\n            return;\n        }\n        // FBO setup\n        this.setupFBO(glContext);\n\n        // Picking\n        glContext.bindFramebuffer(glContext.FRAMEBUFFER, this._fbo);\n        this.renderToTexture(glContext);\n        glContext.bindFramebuffer(glContext.FRAMEBUFFER, null);\n\n        // render\n        this.renderTexture(glContext);\n\n        // render selected polygon\n        this.renderSelection(glContext);\n    }\n\n    protected renderSelection(glContext: WebGL2RenderingContext) {\n        // uniforms and attrib locations\n        this._uModelViewMatrixId = glContext.getUniformLocation(this._shaderProgram[2], 'uModelViewMatrix');\n        this._uProjectionMatrixId = glContext.getUniformLocation(this._shaderProgram[2], 'uProjectionMatrix');\n        this._uWorldOriginId = glContext.getUniformLocation(this._shaderProgram[2], 'uWorldOrigin');\n        this._positionId = glContext.getAttribLocation(this._shaderProgram[2], 'vertPos');\n        this._polygonId = glContext.getAttribLocation(this._shaderProgram[2], 'vertPolyId');\n        this._uHighlightId = glContext.getUniformLocation(this._shaderProgram[2], 'uHighlightId');\n\n        // binds the shader program\n        glContext.useProgram(this._shaderProgram[2]);\n\n        // send matrices\n        glContext.uniformMatrix4fv(this._uModelViewMatrixId, false, this._camera.getModelViewMatrix());\n        glContext.uniformMatrix4fv(this._uProjectionMatrixId, false, this._camera.getProjectionMatrix());\n\n        // send world origin\n        const worldOrigin = this._camera.getWorldOrigin();\n        glContext.uniform2f(this._uWorldOriginId, worldOrigin[0], worldOrigin[1]);\n\n        // render unselected\n        glContext.uniform1f(this._uHighlightId, this._highlight);\n\n        // binds the position buffer\n        glContext.bindBuffer(glContext.ARRAY_BUFFER, this._glPositionBuffer);\n        glContext.vertexAttribPointer(this._positionId, PolygonLayer.COORDS, glContext.FLOAT, false, 0, 0);\n        glContext.enableVertexAttribArray(this._positionId);\n\n        // binds the polygon id buffer\n        glContext.bindBuffer(glContext.ARRAY_BUFFER, this._glPolygonIdBuffer);\n        glContext.vertexAttribPointer(this._polygonId, 1, glContext.FLOAT, false, 0, 0);\n        glContext.enableVertexAttribArray(this._polygonId);\n\n        let first = 0;\n\n        const high = [];\n        this._features['offset'].forEach(vertsCount => {\n            // skips selected\n            if (Math.abs(this._features['polygonId'][first] - this._highlight) < 1e-5) {\n                const curr = { first, vertsCount };\n                high.push(curr);\n            } else {\n                glContext.drawArrays(glContext.LINE_STRIP, first, vertsCount);\n            }\n            first += vertsCount;\n        });\n\n        high.forEach(cHigh => {\n            glContext.drawArrays(glContext.LINE_STRIP, cHigh.first, cHigh.vertsCount);\n        });\n    }\n\n    /**\n     * Send uniforms to the shader\n     * @param {WebGL2RenderingContext} glContext WebGL context\n     */\n    protected renderTexture(glContext: WebGL2RenderingContext) {\n        // polygons texture\n        this._uScalarTextureId = glContext.getUniformLocation(this._shaderProgram[1], 'uScalarTex');\n\n        glContext.enable(glContext.BLEND);\n        glContext.blendFunc(glContext.SRC_ALPHA, glContext.ONE_MINUS_SRC_ALPHA);\n\n        glContext.useProgram(this._shaderProgram[1]);\n\n        glContext.activeTexture(glContext.TEXTURE0);\n        glContext.bindTexture(glContext.TEXTURE_2D, this._scalarTexture);\n        glContext.uniform1i(this._uScalarTextureId, 0);\n\n        glContext.drawArrays(glContext.TRIANGLE_STRIP, 0, 4);\n        glContext.disable(glContext.BLEND);\n    }\n\n    /**\n     * Send uniforms to the shader\n     * @param {WebGL2RenderingContext} glContext WebGL context\n     */\n    protected renderToTexture(glContext: WebGL2RenderingContext) {\n        // tuniforms and attrib locations\n        this._uModelViewMatrixId = glContext.getUniformLocation(this._shaderProgram[0], 'uModelViewMatrix');\n        this._uProjectionMatrixId = glContext.getUniformLocation(this._shaderProgram[0], 'uProjectionMatrix');\n        this._uWorldOriginId = glContext.getUniformLocation(this._shaderProgram[0], 'uWorldOrigin');\n        this._positionId = glContext.getAttribLocation(this._shaderProgram[0], 'vertPos');\n        this._polygonId = glContext.getAttribLocation(this._shaderProgram[0], 'vertPolyId');\n        this._scalarId = glContext.getAttribLocation(this._shaderProgram[0], 'vertScalar');\n        this._uColorMapId = glContext.getUniformLocation(this._shaderProgram[0], 'uColorMap');\n\n        // binds the shader program\n        glContext.useProgram(this._shaderProgram[0]);\n\n        // send matrices\n        glContext.uniformMatrix4fv(this._uModelViewMatrixId, false, this._camera.getModelViewMatrix());\n        glContext.uniformMatrix4fv(this._uProjectionMatrixId, false, this._camera.getProjectionMatrix());\n\n        // send world origin\n        const worldOrigin = this._camera.getWorldOrigin();\n        glContext.uniform2f(this._uWorldOriginId, worldOrigin[0], worldOrigin[1]);\n\n        // send the color map\n        glContext.uniform1i(this._uColorMapId, 0);\n\n        // binds the position buffer\n        glContext.bindBuffer(glContext.ARRAY_BUFFER, this._glPositionBuffer);\n        glContext.vertexAttribPointer(this._positionId, PolygonLayer.COORDS, glContext.FLOAT, false, 0, 0);\n        glContext.enableVertexAttribArray(this._positionId);\n\n        // binds the polygon id buffer\n        glContext.bindBuffer(glContext.ARRAY_BUFFER, this._glPolygonIdBuffer);\n        glContext.vertexAttribPointer(this._polygonId, 1, glContext.FLOAT, false, 0, 0);\n        glContext.enableVertexAttribArray(this._polygonId);\n\n        // binds the scalar buffer\n        glContext.bindBuffer(glContext.ARRAY_BUFFER, this._glScalarBuffer);\n        glContext.vertexAttribPointer(this._scalarId, 1, glContext.FLOAT, false, 0, 0);\n        glContext.enableVertexAttribArray(this._scalarId);\n\n        // Tell WebGL we want to affect texture unit 0\n        glContext.activeTexture(glContext.TEXTURE0);\n        glContext.bindTexture(glContext.TEXTURE_2D, this._colorMapTexture);\n\n        glContext.clearColor(0.0, 0.0, 0.0, 0.0);\n        // tslint:disable-next-line:no-bitwise\n        glContext.clear(glContext.COLOR_BUFFER_BIT | glContext.DEPTH_BUFFER_BIT);\n\n        // Tell WebGL which indices to use to index the vertices\n        glContext.bindBuffer(glContext.ELEMENT_ARRAY_BUFFER, this._glIndexBuffer);\n        // draw the geometry\n        glContext.drawElements(glContext.TRIANGLES, this._features['index'].length, glContext.UNSIGNED_INT, 0);\n    }\n\n    /**\n     * setup FBO used for edge detection\n     * @param {WebGL2RenderingContext} glContext WebGL context\n     */\n    protected setupFBO(glContext: WebGL2RenderingContext) {\n        if (this._fbo == null || this._readFbo == null) {\n            // creates the buffers\n            this._fbo = glContext.createFramebuffer();\n            this._readFbo = glContext.createFramebuffer();\n            this._polygonIdTexture = glContext.createTexture();\n            this._scalarTexture = glContext.createTexture();\n\n            // check the availability of float buffers\n            const ext = glContext.getExtension('EXT_color_buffer_float');\n            if (!ext) {\n                console.error('float buffer extension not supported!!!');\n            }\n        }\n\n        // gets the viewport\n        const viewPort = this._camera.getViewportResolution();\n        if (this._fboWidth !== viewPort[0] || this._fboHeight !== viewPort[1]) {\n            // update FBO size\n            this._fboWidth = viewPort[0];\n            this._fboHeight = viewPort[1];\n\n            // building ID texture\n            glContext.bindTexture(glContext.TEXTURE_2D, this._polygonIdTexture);\n            glContext.texImage2D(\n                glContext.TEXTURE_2D, 0, glContext.RGBA32F,\n                this._fboWidth, this._fboHeight, 0, glContext.RGBA, glContext.FLOAT, null\n            );\n            glContext.texParameteri(glContext.TEXTURE_2D, glContext.TEXTURE_MIN_FILTER, glContext.NEAREST);\n            glContext.texParameteri(glContext.TEXTURE_2D, glContext.TEXTURE_MAG_FILTER, glContext.NEAREST);\n            glContext.texParameteri(glContext.TEXTURE_2D, glContext.TEXTURE_WRAP_S, glContext.CLAMP_TO_EDGE);\n            glContext.texParameteri(glContext.TEXTURE_2D, glContext.TEXTURE_WRAP_T, glContext.CLAMP_TO_EDGE);\n\n            // building ID texture\n            glContext.bindTexture(glContext.TEXTURE_2D, this._scalarTexture);\n            glContext.texImage2D(\n                glContext.TEXTURE_2D, 0, glContext.RGBA32F,\n                this._fboWidth, this._fboHeight, 0, glContext.RGBA, glContext.FLOAT, null\n            );\n            glContext.texParameteri(glContext.TEXTURE_2D, glContext.TEXTURE_MIN_FILTER, glContext.NEAREST);\n            glContext.texParameteri(glContext.TEXTURE_2D, glContext.TEXTURE_MAG_FILTER, glContext.NEAREST);\n            glContext.texParameteri(glContext.TEXTURE_2D, glContext.TEXTURE_WRAP_S, glContext.CLAMP_TO_EDGE);\n            glContext.texParameteri(glContext.TEXTURE_2D, glContext.TEXTURE_WRAP_T, glContext.CLAMP_TO_EDGE);\n\n            // fbo setup\n            glContext.bindFramebuffer(glContext.FRAMEBUFFER, this._fbo);\n            glContext.framebufferTexture2D(glContext.FRAMEBUFFER, glContext.COLOR_ATTACHMENT0, glContext.TEXTURE_2D, this._scalarTexture, 0);\n            glContext.framebufferTexture2D(glContext.FRAMEBUFFER, glContext.COLOR_ATTACHMENT1, glContext.TEXTURE_2D, this._polygonIdTexture, 0);\n            glContext.drawBuffers([glContext.COLOR_ATTACHMENT0, glContext.COLOR_ATTACHMENT1]);\n\n            // readfbo setup\n            glContext.bindFramebuffer(glContext.FRAMEBUFFER, this._readFbo);\n            glContext.framebufferTexture2D(glContext.FRAMEBUFFER, glContext.COLOR_ATTACHMENT0, glContext.TEXTURE_2D, this._polygonIdTexture, 0);\n\n            // unbind fbos\n            glContext.bindFramebuffer(glContext.FRAMEBUFFER, null);\n        }\n    }\n\n    /**\n     * Layer VBO creation signature\n     * @param {WebGL2RenderingContext} glContext WebGL context\n     */\n    protected createBuffers(glContext: WebGL2RenderingContext) {\n        // Create a buffer for the positions.\n        this._glPositionBuffer = glContext.createBuffer();\n        // Select the positionBuffer as the one to apply buffer\n        glContext.bindBuffer(glContext.ARRAY_BUFFER, this._glPositionBuffer);\n        // send data to gpu\n        glContext.bufferData(\n            glContext.ARRAY_BUFFER, new Float32Array(this._features['position']), glContext.STATIC_DRAW\n        );\n\n        // Create a buffer for the positions.\n        this._glPolygonIdBuffer = glContext.createBuffer();\n        // Select the positionBuffer as the one to apply buffer\n        glContext.bindBuffer(glContext.ARRAY_BUFFER, this._glPolygonIdBuffer);\n        // send data to gpu\n        glContext.bufferData(\n            glContext.ARRAY_BUFFER, new Float32Array(this._features['polygonId']), glContext.STATIC_DRAW\n        );\n\n        // Create a buffer for the indices.\n        this._glIndexBuffer = glContext.createBuffer();\n        // Select the index buffer as the one to apply buffer\n        glContext.bindBuffer(glContext.ELEMENT_ARRAY_BUFFER, this._glIndexBuffer);\n        // send data to gpu\n        glContext.bufferData(\n            glContext.ELEMENT_ARRAY_BUFFER, new Uint32Array(this._features['index']), glContext.STATIC_DRAW);\n    }\n\n    /**\n     * Scalar data vbo creation\n     * @param {WebGL2RenderingContext} glContext WebGL context\n     */\n    protected createScalarBuffer(glContext: WebGL2RenderingContext) {\n        // Create a buffer for the colors.\n        if (this._glScalarBuffer === null) {\n            this._glScalarBuffer = glContext.createBuffer();\n        }\n        // Select the color buffer as the one to apply buffer\n        glContext.bindBuffer(glContext.ARRAY_BUFFER, this._glScalarBuffer);\n        // send data to gpu\n        glContext.bufferData(\n            glContext.ARRAY_BUFFER, new Float32Array(this._features['scalar']), glContext.STATIC_DRAW\n        );\n    }\n\n    /**\n   * Color map texture creation\n   * @param {WebGL2RenderingContext} glContext WebGL context\n   * @param {ColorMapType} color Selected color map\n   * @param {boolean} get the reverse color map\n   */\n    protected createColorMapTexture(glContext: WebGL2RenderingContext, color: ColorMapType, reverse: boolean = false) {\n        // gets the color map\n        const colors = ColorMap.getColorMap(color, reverse);\n        // gl color map texture\n        if (this._colorMapTexture === null) {\n            this._colorMapTexture = glContext.createTexture();\n        }\n\n        // send the color map\n        glContext.bindTexture(glContext.TEXTURE_2D, this._colorMapTexture);\n        glContext.texImage2D(\n            glContext.TEXTURE_2D, 0, glContext.RGBA, colors.length / 4, 1, 0,\n            glContext.RGBA, glContext.UNSIGNED_BYTE, new Uint8Array(colors)\n        );\n        glContext.texParameteri(glContext.TEXTURE_2D, glContext.TEXTURE_MIN_FILTER, glContext.NEAREST);\n        glContext.texParameteri(glContext.TEXTURE_2D, glContext.TEXTURE_MAG_FILTER, glContext.NEAREST);\n        glContext.texParameteri(glContext.TEXTURE_2D, glContext.TEXTURE_WRAP_S, glContext.CLAMP_TO_EDGE);\n        glContext.texParameteri(glContext.TEXTURE_2D, glContext.TEXTURE_WRAP_T, glContext.CLAMP_TO_EDGE);\n    }\n}\n","// moved this to independent file keeping the app.module cleaner\nimport { NgModule } from '@angular/core';\n\nimport { MatCheckboxModule } from '@angular/material/checkbox';\nimport { MatInputModule } from '@angular/material/input';\nimport { MatSelectModule } from '@angular/material/select';\nimport { MatRadioModule } from '@angular/material/radio';\nimport { MatMenuModule } from '@angular/material/menu';\nimport { MatToolbarModule } from '@angular/material/toolbar';\nimport { MatListModule } from '@angular/material/list';\nimport { MatGridListModule } from '@angular/material/grid-list';\nimport { MatCardModule } from '@angular/material/card';\nimport { MatTabsModule } from '@angular/material/tabs';\nimport { MatButtonModule } from '@angular/material/button';\nimport { MatChipsModule } from '@angular/material/chips';\nimport { MatIconModule } from '@angular/material/icon';\nimport { MatProgressSpinnerModule } from '@angular/material/progress-spinner';\nimport { MatProgressBarModule } from '@angular/material/progress-bar';\nimport { MatDialogModule } from '@angular/material/dialog';\nimport { MatTooltipModule } from '@angular/material/tooltip';\nimport { MatSnackBarModule } from '@angular/material/snack-bar';\nimport { MatSlideToggleModule } from '@angular/material/slide-toggle';\nimport { MatTableModule } from '@angular/material/table';\nimport { MatPaginatorModule } from '@angular/material/paginator';\nimport { MatSortModule } from '@angular/material/sort';\nimport { MatAutocompleteModule } from '@angular/material/autocomplete';\nimport { MatExpansionModule } from '@angular/material/expansion';\nimport { FormsModule } from '@angular/forms';\nimport { ReactiveFormsModule } from '@angular/forms';\n\n\nconst materialModules = [\n    MatCheckboxModule,\n    MatInputModule,\n    MatSelectModule,\n    MatRadioModule,\n    MatMenuModule,\n    MatToolbarModule,\n    MatListModule,\n    MatGridListModule,\n    MatCardModule,\n    MatTabsModule,\n    MatButtonModule,\n    MatChipsModule,\n    MatIconModule,\n    MatProgressSpinnerModule,\n    MatProgressBarModule,\n    MatDialogModule,\n    MatTooltipModule,\n    MatSnackBarModule,\n    MatSlideToggleModule,\n    MatTableModule,\n    MatPaginatorModule,\n    MatSortModule,\n    MatAutocompleteModule,\n    MatExpansionModule,\n    FormsModule,\n    ReactiveFormsModule\n];\n\n@NgModule({\n    declarations: [\n    ],\n    imports: materialModules,\n    exports: materialModules\n})\nexport class MaterialModule { }","import { Injectable } from '@angular/core';\nimport { environment } from '../../environments/environment';\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class ApiService {\n\n  constructor() { }\n\n  \n  loadModes() {\n    return ['value', 'change'];\n  }\n\n  loadLevels() {\n    return ['borough', 'neighborhood', 'block', 'lot'];\n  }\n\n  loadSortBy() {\n    return ['name', 'year'];\n  }\n\n  loadYearStep() {\n    return ['0', '1', '2', '3', '4', '5'];\n  }\n\n  loadPolygons() {\n    return ['neighborhoods', 'community districs'];\n  }\n\n  loadNavigation() {\n    return ['complete', 'skip blocks'];\n  }\n\n  async loadBoroughs() {\n    const url = `${environment.backend}/plutovis/meta.boroughs`;\n    console.log(url);\n\n    // Return a new promise.\n    const response = await fetch(url);\n    return await response.json();\n  }\n\n  async loadYears() {\n    const url = `${environment.backend}/plutovis/meta.years`;\n    console.log(url);\n\n    // Return a new promise.\n    const response = await fetch(url);\n    return  await response.json();\n  }\n\n  async loadAttributes() {\n    const url = `${environment.backend}/plutovis/meta.nattributes`;\n    console.log(url);\n\n    // Return a new promise.\n    const response = await fetch(url);\n  \n    const obj = {};\n    const arr = await response.json();\n\n    arr.forEach(elm => {\n      obj[elm.attribute] = elm;\n      if (elm.categories.length <= 1) {\n        elm.categories = ['NONE'];\n      }\n    });\n\n    return obj;\n  }\n\n  async loadMetrics() {\n    const url = `${environment.backend}/plutovis/meta.metrics`;\n    console.log(url);\n\n    // Return a new promise.\n    const response = await fetch(url);\n    return await response.json();\n  }\n\n  async loadPopsGeometry(borough: string) {\n    const url = `${environment.backend}/plutovis/popslayer`;\n    console.log(url);\n\n    // post parameters\n    const params = { borough };\n    console.log(`post data: ${JSON.stringify(params)}`);\n\n    // post header\n    const headers = {\n      'Content-Type': 'application/json',\n    };\n\n    // Return a new promise.\n    const response = await fetch(url, {\n      method: 'POST',\n      headers,\n      body: JSON.stringify(params),\n    });\n\n    return await response.json();\n  }\n\n  async loadGeometry(level: string, state: any) {\n    if (level === 'borough') {\n      return await this.loadNeighborhoodsGeometry(state.borough, state.polygon);\n    }\n    \n    if (level === 'neighborhood') {\n      if (state.navigation === 'complete') {\n        return await this.loadBlocksGeometry(state.borough, state.polygon, state.neighborhood, state.year);\n      } else {\n        return await this.loadLotsGeometry(state.borough, state.polygon, state.neighborhood, '', state.year);\n      }\n    }\n\n    if (level === 'block') {\n      return await this.loadLotsGeometry(state.borough, state.polygon, state.neighborhood, state.block, state.year);\n    }\n  }\n\n  private async loadNeighborhoodsGeometry(borough: string, polygon: string) {\n    const url = `${environment.backend}/plutovis/geometries.neighborhoods`;\n    console.log(url);\n\n    // post parameters\n    const params = { borough, polygon };\n    console.log(`post data: ${JSON.stringify(params)}`);\n\n    // post header\n    const headers = {\n      'Content-Type': 'application/json',\n    };\n\n    // Return a new promise.\n    const response = await fetch(url, {\n      method: 'POST',\n      headers,\n      body: JSON.stringify(params),\n    });\n    return await response.json();\n  }\n\n  private async loadBlocksGeometry(borough: string, polygon: string, neighborhood: string, year: number) {\n    const url = `${environment.backend}/plutovis/geometries.blocks`;\n    console.log(url);\n\n    // post parameters\n    const params = { borough, polygon, neighborhood, year };\n    console.log(`post data: ${JSON.stringify(params)}`);\n\n    // post header\n    const headers = {\n      'Content-Type': 'application/json',\n    };\n\n    // Return a new promise.\n    const response = await fetch(url, {\n      method: 'POST',\n      headers,\n      body: JSON.stringify(params),\n    });\n    return await response.json();\n  }\n\n  private async loadLotsGeometry(borough: string, polygon: string, neighborhood: string, block: string, year: number) {\n    const url = `${environment.backend}/plutovis/geometries.lots`;\n    console.log(url);\n\n    // post parameters\n    const params = { borough, polygon, neighborhood, block, year };\n    console.log(`post data: ${JSON.stringify(params)}`);\n\n    // post header\n    const headers = {\n      'Content-Type': 'application/json',\n    };\n\n    // Return a new promise.\n    const response = await fetch(url, {\n      method: 'POST',\n      headers,\n      body: JSON.stringify(params),\n    });\n    return await response.json();\n  }\n\n\n  async loadSummary(level: string, state: any) {\n    if (level === 'borough') {\n      return await this.loadNeighborhoodsSummary(state.borough, state.polygon, state.attribute, state.category, state.metric);\n    }\n    \n    if (level === 'neighborhood') {\n      if (state.navigation === 'complete') {\n        return await this.loadBlocksSummary(state.borough, state.polygon, state.neighborhood, state.attribute, state.category, state.metric);\n      } else {\n        return await this.loadLotsSummary(state.borough, state.polygon, state.neighborhood, '', state.attribute, state.category, state.metric);\n      }\n    }\n\n    if (level === 'block') {\n      return await this.loadLotsSummary(state.borough, state.polygon, state.neighborhood, state.block, state.attribute, state.category, state.metric);\n    }\n  }\n\n  private async loadNeighborhoodsSummary(borough: string, polygon: string, attribute: string, category: string, metric: string) {\n    const url = `${environment.backend}/plutovis/summaries.neighborhoods`;\n    console.log(url);\n\n    // post parameters\n    category = category === 'NONE' ? (attribute === 'POPS' ? 'Y' : '') : category;\n    let params = { borough, polygon, attribute, category, metric };\n\n    console.log(`post data: ${JSON.stringify(params)}`);\n\n    // post header\n    const headers = {\n      'Content-Type': 'application/json',\n    };\n\n    // Return a new promise.\n    const response = await fetch(url, {\n      method: 'POST',\n      headers,\n      body: JSON.stringify(params),\n    });\n    return await response.json();\n  }\n\n  private async loadBlocksSummary(borough: string, polygon: string, neighborhood: string, attribute: string, category: string, metric: string) {\n    const url = `${environment.backend}/plutovis/summaries.blocks`;\n    console.log(url);\n\n    // post parameters\n    category = category === 'NONE' ? (attribute === 'POPS' ? 'Y' : '') : category;\n    let params = { borough, neighborhood, polygon, attribute, category, metric };\n\n    console.log(`post data: ${JSON.stringify(params)}`);\n\n    // post header\n    const headers = {\n      'Content-Type': 'application/json',\n    };\n\n    // Return a new promise.\n    const response = await fetch(url, {\n      method: 'POST',\n      headers,\n      body: JSON.stringify(params),\n    });\n    return await response.json();\n  }\n\n  private async loadLotsSummary(borough: string, polygon: string, neighborhood: string, block: string, attribute: string, category: string, metric: string) {\n    const url = `${environment.backend}/plutovis/summaries.lots`;\n    console.log(url);\n\n    // post parameters\n    category = category === 'NONE' ? (attribute === 'POPS' ? 'Y' : '') : category;\n    let params = { borough, neighborhood, polygon, block, attribute, category, metric };\n    \n    console.log(`post data: ${JSON.stringify(params)}`);\n\n    // post header\n    const headers = {\n      'Content-Type': 'application/json',\n    };\n\n    // Return a new promise.\n    const response = await fetch(url, {\n      method: 'POST',\n      headers,\n      body: JSON.stringify(params),\n    });\n    return await response.json();\n  }\n\n\n  async loadFilter(borough: string, polygon: string, attribute: string, category: string, bins: number = 20) {    \n    const url = `${environment.backend}/plutovis/histogram`;\n    console.log(url);\n\n    // post parameters\n    category = category === 'NONE' ? (attribute === 'POPS' ? 'Y' : '') : category;\n    const params = { borough, polygon, attribute, category, bins };\n\n    console.log(`post data: ${JSON.stringify(params)}`);\n\n    // post header\n    const headers = {\n      'Content-Type': 'application/json',\n    };\n\n    // Return a new promise.\n    const response = await fetch(url, {\n      method: 'POST',\n      headers,\n      body: JSON.stringify(params),\n    });\n    return await response.json();\n  }\n\n  async applyFilter(borough: string, polygon: string, limits: any, filterExp: string) {\n    const url = `${environment.backend}/plutovis/filter`;\n    console.log(url);\n\n    limits.forEach(el => {\n      if (el.attribute === 'LANDUSE' || el.attribute === 'SPDIST1') {\n        delete el.category;\n      }\n    })\n\n    // post parameters\n    const params = { borough, polygon, limits, filterExp };\n    console.log(`post data: ${JSON.stringify(params)}`);\n    \n    // post header\n    const headers = {\n      'Content-Type': 'application/json',\n    };\n\n    // Return a new promise.\n    const response = await fetch(url, {\n      method: 'POST',\n      headers,\n      body: JSON.stringify(params),\n    });\n    return await response.text();\n  }\n}\n","import percentile from 'stats-percentile';\nimport * as d3 from 'd3';\n\nimport { Injectable } from '@angular/core';\n\nimport { ApiService } from './api.service';\nimport { EventsService } from './events.service';\nimport { StateService } from './state.service';\n\n@Injectable({\n    providedIn: 'root'\n})\nexport class DataService {\n    public geometry = null;\n    public summary = null;\n    public filters = {};\n    public layers = {};\n\n    public meta = {\n        modes: [],\n        years: [],\n        attributes: {},\n        boroughs: [],\n        polygons: [],\n        levels: [],\n        navigation: [],\n        sortBy: [],\n        yearStep: [],\n    };\n\n    constructor(public api: ApiService, public events: EventsService, public state: StateService) {\n        this.subscribeRootEvents();\n        this.subscribeMapEvents();\n        this.subscribeStateEvents();\n        this.subscribeFilterEvents();\n    }\n\n    // --- Root app events subscriptions\n\n    subscribeRootEvents() {\n        this.events.root.initialized.subscribe(this.initializeMeta.bind(this));\n    }\n\n    async initializeMeta() {\n        this.meta.modes = this.api.loadModes();\n        this.meta.years = await this.api.loadYears();\n        this.meta.attributes = await this.api.loadAttributes();\n        this.meta.boroughs = await this.api.loadBoroughs();\n        this.meta.polygons = await this.api.loadPolygons();\n        this.meta.navigation = await this.api.loadNavigation();\n        this.meta.levels = this.api.loadLevels();\n        this.meta.sortBy = this.api.loadSortBy();\n        this.meta.yearStep = this.api.loadYearStep();\n    }\n\n    // --- Map events subscriptions\n\n    subscribeMapEvents() {\n        this.events.map.initialized.subscribe(this.loadSummaryThenGeometryAndFunction.bind(this));\n    }\n\n    // --- State events subscriptions\n\n    subscribeStateEvents() {\n        this.events.state.configBoroughChanged.subscribe(this.loadSummaryThenGeometryAndFunction.bind(this));\n        this.events.state.configBoroughChanged.subscribe(this.loadAllFilters.bind(this));\n\n        this.events.state.configPolygonChanged.subscribe(this.loadSummaryThenGeometryAndFunction.bind(this));\n        this.events.state.configPolygonChanged.subscribe(this.loadAllFilters.bind(this));\n\n        this.events.state.configNavigationChanged.subscribe(this.loadSummaryThenGeometryAndFunction.bind(this));\n        this.events.state.configNavigationChanged.subscribe(this.loadAllFilters.bind(this));\n\n        this.events.state.configModeChanged.subscribe(this.loadFunction.bind(this));\n        this.events.state.configCMapChanged.subscribe(this.loadSummaryThenGeometryAndFunction.bind(this));\n\n        this.events.state.filterParametersChanged.subscribe(this.loadFilter.bind(this));\n\n        this.events.state.geometryParametersChanged.subscribe(this.loadSummaryThenGeometryAndFunction.bind(this));\n        this.events.state.summaryParametersChanged.subscribe(this.loadSummaryThenFunction.bind(this));\n    }\n\n    async loadSummaryThenGeometryAndFunction(isYear: boolean) {\n        await this.applyFilter();\n        await this.loadSummary();\n        await this.loadGeometry();\n        // POPs layer\n        await this.loadPopsGeometry();\n\n        // elements per year\n        const length = this.summary[this.state.activeGeometryParameters.year].length;\n\n        // emits the event\n        if (!isYear) {\n            this.events.data.initializePagination.emit(length);\n            this.events.data.updateVisMatrix.emit();\n        }\n        this.events.data.updateMapGeometryAndFunction.emit();\n    }\n\n    async loadSummaryThenFunction() {\n        await this.applyFilter();\n        await this.loadSummary();\n\n        // elements per year\n        const length = this.summary[this.state.activeGeometryParameters.year].length;\n\n        // emits the event\n        this.events.data.initializePagination.emit(length);\n        this.events.data.updateVisMatrix.emit();\n        this.events.data.updateMapFunction.emit();\n    }\n\n    async loadFunction() {\n        this.events.data.updateMapFunction.emit();\n    }\n\n    async loadPopsGeometry() {\n        // get borough\n        const borough = this.state.activeConfigParameters.borough;\n\n        // gets the geometry\n        this.layers['pops'] = await this.api.loadPopsGeometry(borough);\n    }\n\n    async loadGeometry() {\n        // get borough\n        const borough = this.state.activeConfigParameters;\n        // get parents list\n        const parents = this.state.activeGeometryParameters;\n        // get current parameters\n        const parameters = this.state.activeSummaryParameters;\n\n        // current state\n        let state = {};\n        Object.assign(state, borough);\n        Object.assign(state, parents);\n        Object.assign(state, parameters);\n\n        // current level\n        const level = this.state.activeLevel;\n\n        // gets the geometry\n        this.geometry = await this.api.loadGeometry(level, state);\n        this.geometry.features.sort((a, b) => a.properties.name < b.properties.name ? 1 : -1);\n    }\n\n    async loadSummary() {\n        // get borough\n        const borough = this.state.activeConfigParameters;\n        // get parents list\n        const parents = this.state.activeGeometryParameters;\n        // get current parameters\n        const parameters = this.state.activeSummaryParameters;\n\n        // current state\n        let state = {};\n        Object.assign(state, borough);\n        Object.assign(state, parents);\n        Object.assign(state, parameters);\n        // current level\n        const level = this.state.activeLevel;\n\n        // gets the summary\n        this.summary = await this.api.loadSummary(level, state);\n\n        // year steps\n        const step = +this.state.activeSummaryParameters.yearStep;\n        this.filterYears(step);\n\n        // adds the difference field\n        this.computeDifferences();\n\n        console.log(this.summary);\n    }\n\n\n    filterYears(step: number) {\n        if (!step) { return; }\n        \n        const years = Object.keys(this.summary).filter(d => d !== 'min' && d !== 'max').filter(d => d.split('.')[1] === '1');\n        years.push('2008.1');\n        years.sort();\n\n        const subYears = [];\n        for (let yId = years.length - 1; yId >= 0; yId -= step) {\n            subYears.push(years[yId]);\n        }\n        subYears.reverse();\n\n        const stepSummary = {};\n        for (let yId = 0; yId < subYears.length; yId++) {\n            if (subYears[yId] === '2008.1') {\n                stepSummary[subYears[yId]] = this.summary['2007.1'];\n            }\n            else {\n                stepSummary[subYears[yId]] = this.summary[subYears[yId]];\n            }\n        }\n        stepSummary['min'] = this.summary['min'];\n        stepSummary['max'] = this.summary['max']; \n\n        this.summary = stepSummary;\n    }\n\n    computeDifferences() {\n        this.summary.changeMin = Infinity;\n        this.summary.changeMax = -Infinity;\n\n        const vals = [];\n        const cngs = []; \n\n        // Is Alive : the lot existis in the selected year\n        // Is Valid : the selected attribute is a valid value in the lot\n        // Is Active: the lot fits the filter condition \n\n        const years = Object.keys(this.summary).filter(key => !isNaN(+key));\n\n        for (let yId = 0; yId < years.length; yId++) {\n            const year = years[yId];\n\n            for (let nId = 0; nId < this.summary[year].length; nId++) {\n                if (yId === 0) {\n                    this.summary[year][nId].change = 0;\n                    this.summary[year][nId].changeValid = false;\n                }\n                else {\n                    const prev = years[yId - 1];\n\n                    // all data is ok\n                    if (this.summary[year][nId].isAlive && this.summary[prev][nId].isAlive && this.summary[year][nId].isValid && this.summary[prev][nId].isValid) {\n                        this.summary[year][nId].change = this.summary[year][nId].value - this.summary[prev][nId].value;\n                        this.summary[year][nId].changeValid = true;\n                    }\n                    // current not alive, previous alive and valid\n                    else if (!this.summary[year][nId].isAlive && this.summary[prev][nId].isAlive && this.summary[prev][nId].isValid) {\n                        this.summary[year][nId].change = -this.summary[prev][nId].value;\n                        this.summary[year][nId].changeValid = true;\n                    }\n                    // current alive and valid, previous not alive\n                    else if (this.summary[year][nId].isAlive && !this.summary[prev][nId].isAlive && this.summary[year][nId].isValid) {\n                        this.summary[year][nId].change = this.summary[year][nId].value;\n                        this.summary[year][nId].changeValid = true;\n                    }\n                    // current alive and not valid, previous alive and valid\n                    else if (this.summary[year][nId].isAlive && this.summary[prev][nId].isAlive && !this.summary[year][nId].isValid && this.summary[prev][nId].isValid) {\n                        this.summary[year][nId].change = -this.summary[prev][nId].value;\n                        this.summary[year][nId].changeValid = true;\n                    }\n                    // current alive and valid, previous alive and not valid\n                    else if (this.summary[year][nId].isAlive && this.summary[prev][nId].isAlive && this.summary[year][nId].isValid && !this.summary[prev][nId].isValid) {\n                        this.summary[year][nId].change = this.summary[year][nId].value;\n                        this.summary[year][nId].changeValid = true;\n                    }\n                    else {\n                        this.summary[year][nId].change = 0;\n                        this.summary[year][nId].changeValid = false;\n                    }\n                }\n\n                vals.push(this.summary[year][nId].value);\n                cngs.push(this.summary[year][nId].change);\n            }\n        }\n\n        if (this.state.activeConfigParameters.cmapPercentiles) {\n            this.summary.min  = percentile(vals,  2);\n            this.summary.max  = percentile(vals, 98);\n            this.summary.changeMin = percentile(cngs, 2);\n            this.summary.changeMax = percentile(cngs,98);    \n        }\n        else {\n            this.summary.min  = d3.min(vals);\n            this.summary.max  = d3.max(vals);\n            this.summary.changeMin = d3.min(cngs);\n            this.summary.changeMax = d3.max(cngs);\n        }\n    }\n\n    async subscribeFilterEvents() {\n        this.events.filters.updateSummary.subscribe(this.loadSummaryThenFunction.bind(this));\n    }\n\n    async applyFilter() {\n        const borough   = this.state.activeConfigParameters.borough;\n        const polygon   = this.state.activeConfigParameters.polygon;\n        const filterExp = this.state.activeConfigParameters.filterExp;\n        const filters = Object.keys(this.state.activeFilterParameters).map(key => {\n            const obj = this.state.activeFilterParameters[key];\n\n            if (!obj.range || obj.range.length === 0) {\n                return null;\n            }\n\n            let min = +obj.range[0].split('-')[0];\n            min = isNaN(min) ? obj.range[0] : min;\n\n            let max = +obj.range[obj.range.length - 1].split('-')[1];\n            max = isNaN(max) ? obj.range[obj.range.length - 1] : max;\n\n            return {\n                key: key,\n                attribute: obj.attribute,\n                category: obj.category,\n                min,\n                max\n            }\n        })\n\n        await this.api.applyFilter(borough, polygon, filters.filter(obj => obj !== null), filterExp);\n    }\n\n    async loadFilter(key: string) {\n        const isAlive = Object.keys(this.state.activeFilterParameters).includes(`${key}`);\n\n        if (!isAlive) {\n            delete this.filters[key];\n        }\n        else {\n            const borough = this.state.activeConfigParameters.borough;\n            const polygon = this.state.activeConfigParameters.borough;\n            const params = this.state.activeFilterParameters[key];\n\n            const filter = await this.api.loadFilter(borough, polygon, params.attribute, params.category);\n            this.filters[key] = filter;\n        }\n\n        this.events.data.updateFilters.emit();\n    }\n\n    async loadAllFilters() {\n        const keys = Object.keys(this.state.activeFilterParameters);\n\n        for (let key of keys) {\n            const borough = this.state.activeConfigParameters.borough;\n            const polygon = this.state.activeConfigParameters.borough;\n            const params = this.state.activeFilterParameters[key];\n\n            const filter = await this.api.loadFilter(borough, polygon, params.attribute, params.category)\n            this.filters[key] = filter;\n        }\n\n        this.events.data.updateFilters.emit();\n    }\n}\n","import { Injectable, EventEmitter } from '@angular/core';\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class EventsService {\n  // Events fired by the root-app\n  public root = {\n    initialized: new EventEmitter<void>(),\n  }\n\n  public config = {\n    boroughSelectChanged: new EventEmitter<any>(),\n    polygonSelectChanged: new EventEmitter<any>(),\n    navigationSelectChanged: new EventEmitter<any>(),\n    modeSelectChanged: new EventEmitter<any>()\n  }\n\n  // Events fired by mapview\n  public menu = {\n    buttonClicked: new EventEmitter<string>(),\n  }\n  \n  // Events fired by mapview\n  public map = {\n    initialized: new EventEmitter<void>(),\n    polyPicked: new EventEmitter<any>(),\n  }\n\n  // Events fired by the vis window\n  public vis = {\n    yearStepSelectChanged: new EventEmitter<any>(),\n    attributeSelectChanged: new EventEmitter<any>(),\n    metricSelectChanged: new EventEmitter<any>(),\n    categorySelectChanged: new EventEmitter<any>(),\n    modeSelectChanged: new EventEmitter<any>(),\n    sortBySelectChanged: new EventEmitter<any>(),\n    \n    yearLabelClicked: new EventEmitter<any>(),\n    polygonLabelClicked: new EventEmitter<any>(),\n    polygonLabelHovered: new EventEmitter<any>(),\n\n    navButtonClicked: new EventEmitter<any>(),\n    navPageChanged: new EventEmitter<any>(),\n\n    sortIconClicked: new EventEmitter<any>(), \n    lineIconClicked: new EventEmitter<any>()\n  }\n\n  public filters = {\n    updated: new EventEmitter<any>(),\n    brushed: new EventEmitter<any>(),\n    updateSummary: new EventEmitter<void>()\n  }\n\n  // Events fired by the data service\n  public data = {\n    updateFilters: new EventEmitter<void>(),\n\n    updateVisMatrix: new EventEmitter<void>(),\n\n    updateMapFunction: new EventEmitter<void>(),\n    updateMapGeometryAndFunction: new EventEmitter<void>(),\n  \n    initializePagination: new EventEmitter<number>()\n  }\n\n  // events fired by the state service\n  public state = {\n    configBoroughChanged: new EventEmitter<void>(),\n    configPolygonChanged: new EventEmitter<void>(),\n    configNavigationChanged: new EventEmitter<void>(),\n    configModeChanged: new EventEmitter<void>(),\n    configCMapChanged: new EventEmitter<void>(),\n\n    geometryParametersChanged: new EventEmitter<boolean>(),\n    summaryParametersChanged: new EventEmitter<void>(), \n\n    selectedPolygonChanged: new EventEmitter<string>(),\n    activeLayerChanged: new EventEmitter<string>(),\n\n    pageParametersChanged: new EventEmitter<void>(),\n    sortParametersChanged: new EventEmitter<void>(),\n    lineCurvesChanged: new EventEmitter<void>(),\n\n    filterParametersChanged: new EventEmitter<string>()\n  }\n\n  public layers = {\n    activeLayerChanged: new EventEmitter<any>()\n  }\n\n  constructor() { }\n}\n","import { Injectable } from '@angular/core';\nimport { EventsService } from './events.service';\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class StateService {\n  matrixActive = null;\n  filterActive = null;\n  configActive = false;\n  legendActive = true;\n\n  layersActive = false;\n  activeLayer = '';\n\n  activeConfigParameters: any = {\n    borough: 'Manhattan',\n    polygon: 'neighborhoods',\n    navigation: 'complete',\n    mode: 'change',\n    filterExp: '',\n    cmapPercentiles: false\n  };\n\n  activeGeometryParameters: any = { \n    neighborhood: undefined,\n    block: undefined,\n    lot: undefined,\n    year: '2017.1'\n  };\n\n  activeSummaryParameters: any = {\n    attribute: 'LOTSALIVE',\n    category: 'NONE',\n    metric: 'COUNT',\n    mode: 'change',\n    yearStep: 0\n  };\n\n  activePageParameters: any = {\n    currentPage: null,\n    totalPages: null,\n    pageSize: null,\n    PAGINATION_SIZE: 35\n  }\n\n  activeSortParameters: any = {\n    sortBy: 'name',\n  }\n\n  activeLineChartCurves = [];\n\n  activeFilterParameters: any = {}\n\n  CURRENT_FILTER_ID = 0;\n\n  selectedPolygon = '';\n\n  constructor(public events: EventsService) {\n    this.subscribeDataEvents();\n    this.subscribeLayersEvents();\n\n    this.subscribeConfigEvents();\n\n    this.subscribeMapEvents();\n    this.subscribeVisEvents();\n    this.subscribeFilterEvents();\n  }\n\n  get activeLevel() {\n    if (\n      this.activeConfigParameters.borough &&\n      this.activeGeometryParameters.neighborhood &&\n      (this.activeGeometryParameters.block || this.activeConfigParameters.navigation === 'skip blocks') &&\n      this.activeGeometryParameters.lot &&\n      this.activeGeometryParameters.year\n    ) { return 'lot' }\n\n    if (\n      this.activeConfigParameters.borough &&\n      this.activeGeometryParameters.neighborhood &&\n      (this.activeGeometryParameters.block && this.activeConfigParameters.navigation === 'complete') &&\n      this.activeGeometryParameters.year\n    ) { return 'block' }\n\n    if (\n      this.activeConfigParameters.borough &&\n      this.activeGeometryParameters.neighborhood &&\n      this.activeGeometryParameters.year\n    ) { return 'neighborhood' }\n\n    if (\n      this.activeConfigParameters.borough\n    ) { return 'borough' }\n\n    return 'invalid';\n  }\n\n  get currentFilterId() {\n    return this.CURRENT_FILTER_ID++;\n  }\n\n  // ---- Map events subscriptions\n\n  subscribeMapEvents() {\n    this.events.map.polyPicked.subscribe(this.updateSelectedPolygon.bind(this));\n  }\n\n  updateSelectedPolygon(state) {\n    this.selectedPolygon = state.name;\n    this.events.state.selectedPolygonChanged.emit(state.origin);\n  }\n\n  // ---- Config events subscription\n\n  subscribeConfigEvents() {\n    this.events.config.boroughSelectChanged.subscribe(this.updateActiveConfigBorough.bind(this));\n    this.events.config.polygonSelectChanged.subscribe(this.updateActiveConfigPolygon.bind(this));\n    this.events.config.navigationSelectChanged.subscribe(this.updateActiveConfigNavigation.bind(this));\n    this.events.config.modeSelectChanged.subscribe(this.updateActiveConfigMode.bind(this));\n  }\n\n  // ---- Vis events subscriptions\n\n  subscribeVisEvents() {\n    // changes on these parameters must trigger an update on the layer geometry / function and on the summary matrix\n    this.events.vis.polygonLabelClicked.subscribe(this.updateActiveGeometryParameters.bind(this));\n    this.events.vis.polygonLabelHovered.subscribe(this.updateSelectedPolygon.bind(this));\n    this.events.vis.yearLabelClicked.subscribe(this.updateActiveGeometryParameters.bind(this));\n    this.events.vis.navButtonClicked.subscribe(this.updateActiveGeometryParameters.bind(this));\n\n    // chages on these parameters must trigger an update on the layer function and on the summary matrix\n    this.events.vis.yearStepSelectChanged.subscribe(this.updateActiveSummaryParameters.bind(this));\n    this.events.vis.attributeSelectChanged.subscribe(this.updateActiveSummaryParameters.bind(this));\n    this.events.vis.categorySelectChanged.subscribe(this.updateActiveSummaryParameters.bind(this));\n    this.events.vis.metricSelectChanged.subscribe(this.updateActiveSummaryParameters.bind(this));\n    this.events.vis.modeSelectChanged.subscribe(this.updateActiveSummaryParameters.bind(this));\n\n    // changes that don't require data reload\n    this.events.vis.sortBySelectChanged.subscribe(this.updateActiveSortParameters.bind(this));\n\n    // changes on these parameters must trigger an summary matrix update\n    this.events.vis.navPageChanged.subscribe(this.updateActivePageParameters.bind(this));\n    this.events.vis.sortIconClicked.subscribe(this.updateActiveSortParameters.bind(this));\n    this.events.vis.lineIconClicked.subscribe(this.updateActiveLineChartCurves.bind(this));\n  }\n\n  updateActiveConfigMode(state) {\n    const previous = this.activeConfigParameters;\n    this.activeConfigParameters = Object.assign(previous, state);\n\n    // emits the changes\n    this.events.state.configModeChanged.emit();\n  }\n\n  updateActiveConfigBorough(state) {\n    const previous = this.activeConfigParameters;\n    this.activeConfigParameters = Object.assign(previous, state);\n\n    // emits the changes\n    this.events.state.configBoroughChanged.emit();\n  }\n\n  updateActiveConfigPolygon(state) {\n    const previous = this.activeConfigParameters;\n    this.activeConfigParameters = Object.assign(previous, state);\n\n    // emits the changes\n    this.events.state.configPolygonChanged.emit();\n  }\n\n  updateActiveConfigNavigation(state) {\n    const previous = this.activeConfigParameters;\n    this.activeConfigParameters = Object.assign(previous, state);\n\n    // emits the changes\n    this.events.state.configNavigationChanged.emit();\n  }\n\n  updateActiveGeometryParameters(state) {\n    const previous = this.activeGeometryParameters;\n    this.activeGeometryParameters = Object.assign(previous, state);\n\n    // emits the changes\n    this.events.state.geometryParametersChanged.emit(Object.keys(state).includes('year'));\n  }\n\n  updateActiveSummaryParameters(state) {\n    const previous = this.activeSummaryParameters;\n    this.activeSummaryParameters = Object.assign(previous, state);\n\n    // emits the changes\n    this.events.state.summaryParametersChanged.emit();\n  }\n\n  updateActivePageParameters(state) {\n    const previous = this.activePageParameters;\n    this.activePageParameters = Object.assign(previous, state);\n\n    // emits the changes\n    this.events.state.pageParametersChanged.emit();\n  }\n\n  updateActiveSortParameters(state) {\n    const previous = this.activeSortParameters;\n    this.activeSortParameters = Object.assign(previous, state);\n\n    // emits the changes\n    this.events.state.sortParametersChanged.emit();\n  }\n\n  updateActiveLineChartCurves(state) {\n    this.activeLineChartCurves = state;\n\n    // emits the changes\n    this.events.state.lineCurvesChanged.emit();\n  }\n\n\n  subscribeFilterEvents() {\n    this.events.filters.updated.subscribe(this.updateFilterParameters.bind(this));\n    this.events.filters.brushed.subscribe(this.updateFilterBrush.bind(this));\n  }\n\n  updateFilterParameters(state) {\n    const { key } = state;\n       \n    if (state.params === null) {\n      delete this.activeFilterParameters[key];\n    } else {\n      const previous = this.activeFilterParameters[key] || {} ;\n      this.activeFilterParameters[key] = Object.assign(previous, state.params);\n    }\n\n    this.events.state.filterParametersChanged.emit(key);\n  }\n\n  updateFilterBrush(state) {\n    const { key } = state;\n\n    const previous = this.activeFilterParameters[key] || {} ;\n    this.activeFilterParameters[key] = Object.assign(previous, state.params);\n  }\n\n  subscribeDataEvents() {\n    this.events.data.initializePagination.subscribe(this.initializePagination.bind(this))\n  }\n\n  initializePagination(length: number) {\n    let den = 1;\n    while ((length / den) > this.activePageParameters.PAGINATION_SIZE) {\n      den += 1;\n    }\n\n    this.activePageParameters.currentPage = 0;\n    this.activePageParameters.totalPages = den;\n    this.activePageParameters.pageSize = Math.ceil(length / den);\n  }\n\n  subscribeLayersEvents() {\n    this.events.layers.activeLayerChanged.subscribe(this.changeActiveLayer.bind(this));\n  }\n\n  changeActiveLayer(state) {\n    this.layersActive = state.layersActive;\n    this.activeLayer = state.activeLayer;\n\n    this.events.state.activeLayerChanged.emit();\n  }\n\n}\n","// This file can be replaced during build by using the `fileReplacements` array.\n// `ng build --prod` replaces `environment.ts` with `environment.prod.ts`.\n// The list of file replacements can be found in `angular.json`.\n\nexport const environment = {\n  production: false,\n  backend: 'http://localhost:4200',\n  folder: 'nyc'\n};\n\n/*\n * For easier debugging in development mode, you can import the following file\n * to ignore zone related error stack frames such as `zone.run`, `zoneDelegate.invokeTask`.\n *\n * This import should be commented out in production mode because it will have a negative impact\n * on performance if an error is thrown.\n */\n// import 'zone.js/dist/zone-error';  // Included with Angular CLI.\n","import { enableProdMode } from '@angular/core';\nimport { platformBrowserDynamic } from '@angular/platform-browser-dynamic';\n\nimport { AppModule } from './app/app.module';\nimport { environment } from './environments/environment';\n\nif (environment.production) {\n  enableProdMode();\n}\n\nplatformBrowserDynamic().bootstrapModule(AppModule)\n  .catch(err => console.error(err));\n"]}